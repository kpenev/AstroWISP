<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>SuperPhot: PSF::Piecewise Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SuperPhot
   &#160;<span id="projectnumber">unspecified</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classPSF_1_1Piecewise.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classPSF_1_1Piecewise-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">PSF::Piecewise Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> model consisting of a grid of rectangles each with a separate intensity function.  
 <a href="classPSF_1_1Piecewise.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Piecewise_8h_source.html">Piecewise.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for PSF::Piecewise:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classPSF_1_1Piecewise.png" usemap="#PSF::Piecewise_map" alt=""/>
  <map id="PSF::Piecewise_map" name="PSF::Piecewise_map">
<area href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. " alt="PSF::PSF" shape="rect" coords="0,0,141,24"/>
<area href="classPSF_1_1PiecewiseBicubic.html" title="A Piecewise defined as a bicubic interpolation over a grid, where at each grid point the value..." alt="PSF::PiecewiseBicubic" shape="rect" coords="0,112,141,136"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa3be68d72c6a1882248201c4cd1fb0e3"><td class="memTemplParams" colspan="2">template&lt;class RandomAccessIterator &gt; </td></tr>
<tr class="memitem:aa3be68d72c6a1882248201c4cd1fb0e3"><td class="memTemplItemLeft" align="right" valign="top">&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#aa3be68d72c6a1882248201c4cd1fb0e3">Piecewise</a> (RandomAccessIterator first_x, RandomAccessIterator last_x, RandomAccessIterator first_y, RandomAccessIterator last_y)</td></tr>
<tr class="memdesc:aa3be68d72c6a1882248201c4cd1fb0e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> model on a specified grid with invalid cells.  <a href="#aa3be68d72c6a1882248201c4cd1fb0e3">More...</a><br /></td></tr>
<tr class="separator:aa3be68d72c6a1882248201c4cd1fb0e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb6bb0761038b369ba32bb4f2f46431f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#acb6bb0761038b369ba32bb4f2f46431f">set_cell</a> (const <a class="el" href="classPSF_1_1PiecewiseCell.html">PiecewiseCell</a> *cell, const <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> &amp;x_index, const <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> &amp;y_index, bool clone=false)</td></tr>
<tr class="memdesc:acb6bb0761038b369ba32bb4f2f46431f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set one of the cells comprising the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a>.  <a href="#acb6bb0761038b369ba32bb4f2f46431f">More...</a><br /></td></tr>
<tr class="separator:acb6bb0761038b369ba32bb4f2f46431f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08362ad7e5bb978c4a68dcf30ed6b17c"><td class="memTemplParams" colspan="2">template&lt;class ConstCellIterator &gt; </td></tr>
<tr class="memitem:a08362ad7e5bb978c4a68dcf30ed6b17c"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#a08362ad7e5bb978c4a68dcf30ed6b17c">set_all_cells</a> (ConstCellIterator first_cell, bool clone=false)</td></tr>
<tr class="memdesc:a08362ad7e5bb978c4a68dcf30ed6b17c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set all cells.  <a href="#a08362ad7e5bb978c4a68dcf30ed6b17c">More...</a><br /></td></tr>
<tr class="separator:a08362ad7e5bb978c4a68dcf30ed6b17c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7184535e48a52059e77427bc6316e4a6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#a7184535e48a52059e77427bc6316e4a6">operator()</a> (double <a class="el" href="PhotColumns_8h.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>, double <a class="el" href="PhotColumns_8h.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>) const </td></tr>
<tr class="memdesc:a7184535e48a52059e77427bc6316e4a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluates the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> at the given position.  <a href="#a7184535e48a52059e77427bc6316e4a6">More...</a><br /></td></tr>
<tr class="separator:a7184535e48a52059e77427bc6316e4a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad30e36f12dbf9e7fbd1ab7d39ed69053"><td class="memItemLeft" align="right" valign="top">std::valarray&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#ad30e36f12dbf9e7fbd1ab7d39ed69053">operator()</a> (double <a class="el" href="PhotColumns_8h.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>, double <a class="el" href="PhotColumns_8h.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>, const std::vector&lt; std::valarray&lt; double &gt; &gt; &amp;parameter_sets) const </td></tr>
<tr class="memdesc:ad30e36f12dbf9e7fbd1ab7d39ed69053"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluates the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> at the given position assuming a list of cell parameters.  <a href="#ad30e36f12dbf9e7fbd1ab7d39ed69053">More...</a><br /></td></tr>
<tr class="separator:ad30e36f12dbf9e7fbd1ab7d39ed69053"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad870faa8d30e4438389b8295c4573e74"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#ad870faa8d30e4438389b8295c4573e74">grid_column_width</a> (<a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> column) const </td></tr>
<tr class="memdesc:ad870faa8d30e4438389b8295c4573e74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the width of the column-th cell column.  <a href="#ad870faa8d30e4438389b8295c4573e74">More...</a><br /></td></tr>
<tr class="separator:ad870faa8d30e4438389b8295c4573e74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9088d1d84afb8d054feb2aa41cb62292"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#a9088d1d84afb8d054feb2aa41cb62292">grid_row_height</a> (<a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> row) const </td></tr>
<tr class="memdesc:a9088d1d84afb8d054feb2aa41cb62292"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the height of the rowth-th cell row.  <a href="#a9088d1d84afb8d054feb2aa41cb62292">More...</a><br /></td></tr>
<tr class="separator:a9088d1d84afb8d054feb2aa41cb62292"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3a8a47a901b15b6fb685eb760518d15"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#af3a8a47a901b15b6fb685eb760518d15">min_x</a> () const </td></tr>
<tr class="memdesc:af3a8a47a901b15b6fb685eb760518d15"><td class="mdescLeft">&#160;</td><td class="mdescRight">The left boundary of the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> grid.  <a href="#af3a8a47a901b15b6fb685eb760518d15">More...</a><br /></td></tr>
<tr class="separator:af3a8a47a901b15b6fb685eb760518d15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad92caff8d26d497eca504bf2190ee8c1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#ad92caff8d26d497eca504bf2190ee8c1">max_x</a> () const </td></tr>
<tr class="memdesc:ad92caff8d26d497eca504bf2190ee8c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">The right boundary of the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> grid.  <a href="#ad92caff8d26d497eca504bf2190ee8c1">More...</a><br /></td></tr>
<tr class="separator:ad92caff8d26d497eca504bf2190ee8c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c6f4f8e4d98633481b8af6b12a6e33a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#a6c6f4f8e4d98633481b8af6b12a6e33a">min_y</a> () const </td></tr>
<tr class="memdesc:a6c6f4f8e4d98633481b8af6b12a6e33a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The bottom boundary of the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> grid.  <a href="#a6c6f4f8e4d98633481b8af6b12a6e33a">More...</a><br /></td></tr>
<tr class="separator:a6c6f4f8e4d98633481b8af6b12a6e33a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6defc7d4e710852c98284736d3cd8d2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#ac6defc7d4e710852c98284736d3cd8d2">max_y</a> () const </td></tr>
<tr class="memdesc:ac6defc7d4e710852c98284736d3cd8d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The top boundary of the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> grid.  <a href="#ac6defc7d4e710852c98284736d3cd8d2">More...</a><br /></td></tr>
<tr class="separator:ac6defc7d4e710852c98284736d3cd8d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dcf614097c8f2e447834a2b2a9ed1cf"><td class="memItemLeft" align="right" valign="top">std::valarray&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#a8dcf614097c8f2e447834a2b2a9ed1cf">integrate_rectangle_parameters</a> (double center_x, double center_y, double dx, double dy, const std::vector&lt; std::valarray&lt; double &gt; &gt; &amp;parameter_sets=std::vector&lt; std::valarray&lt; double &gt; &gt;()) const </td></tr>
<tr class="memdesc:a8dcf614097c8f2e447834a2b2a9ed1cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the integral of the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> over a rectangle.  <a href="#a8dcf614097c8f2e447834a2b2a9ed1cf">More...</a><br /></td></tr>
<tr class="separator:a8dcf614097c8f2e447834a2b2a9ed1cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classPSF_1_1PSF"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classPSF_1_1PSF')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classPSF_1_1PSF.html">PSF::PSF</a></td></tr>
<tr class="memitem:ae96622f6c53a6d1762a9eaae56c563c7 inherit pub_methods_classPSF_1_1PSF"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1PSF.html#ae96622f6c53a6d1762a9eaae56c563c7">set_precision</a> (double, double) const </td></tr>
<tr class="separator:ae96622f6c53a6d1762a9eaae56c563c7 inherit pub_methods_classPSF_1_1PSF"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1369bebdb9084b2f324a6b4ce883385 inherit pub_methods_classPSF_1_1PSF"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1PSF.html#ad1369bebdb9084b2f324a6b4ce883385">integrate</a> (double center_x, double center_y, double dx, double dy, double circle_radius=0) const </td></tr>
<tr class="separator:ad1369bebdb9084b2f324a6b4ce883385 inherit pub_methods_classPSF_1_1PSF"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0db2a110d671bff0522abaa41753326d inherit pub_methods_classPSF_1_1PSF"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1PSF.html#a0db2a110d671bff0522abaa41753326d">~PSF</a> ()</td></tr>
<tr class="memdesc:a0db2a110d671bff0522abaa41753326d inherit pub_methods_classPSF_1_1PSF"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual destructor.  <a href="#a0db2a110d671bff0522abaa41753326d">More...</a><br /></td></tr>
<tr class="separator:a0db2a110d671bff0522abaa41753326d inherit pub_methods_classPSF_1_1PSF"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:adcef587b2345da3103e10a254f3aeb75"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#adcef587b2345da3103e10a254f3aeb75">integrate_rectangle</a> (double center_x, double center_y, double dx, double dy) const </td></tr>
<tr class="memdesc:adcef587b2345da3103e10a254f3aeb75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the integral of the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> over a rectangle.  <a href="#adcef587b2345da3103e10a254f3aeb75">More...</a><br /></td></tr>
<tr class="separator:adcef587b2345da3103e10a254f3aeb75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefc070663de2ca53b62d8e6a21930ae4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#aefc070663de2ca53b62d8e6a21930ae4">integrate_wedge</a> (double <a class="el" href="PhotColumns_8h.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>, double <a class="el" href="PhotColumns_8h.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>, double radius, bool left=false, bool bottom=false) const </td></tr>
<tr class="memdesc:aefc070663de2ca53b62d8e6a21930ae4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integrates the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> over the smallest of the four wedges with the.  <a href="#aefc070663de2ca53b62d8e6a21930ae4">More...</a><br /></td></tr>
<tr class="separator:aefc070663de2ca53b62d8e6a21930ae4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a9b21044c37a2b0901e539742a8d9cde7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#a9b21044c37a2b0901e539742a8d9cde7">cell_index</a> (<a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> x_ind, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> y_ind) const </td></tr>
<tr class="memdesc:a9b21044c37a2b0901e539742a8d9cde7"><td class="mdescLeft">&#160;</td><td class="mdescRight">The index of the cell with the given x and y indices.  <a href="#a9b21044c37a2b0901e539742a8d9cde7">More...</a><br /></td></tr>
<tr class="separator:a9b21044c37a2b0901e539742a8d9cde7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac97b274ac5008c49dd0818d7beaa8b97"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#ac97b274ac5008c49dd0818d7beaa8b97">cell_index</a> (const std::vector&lt; double &gt; &amp;grid, const double &amp;<a class="el" href="PhotColumns_8h.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> hint_lower, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> hint_upper) const </td></tr>
<tr class="separator:ac97b274ac5008c49dd0818d7beaa8b97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d9358718ba764cb89934798af32b1a9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#a8d9358718ba764cb89934798af32b1a9">cell_index</a> (const std::vector&lt; double &gt; &amp;grid, const double &amp;<a class="el" href="PhotColumns_8h.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>) const </td></tr>
<tr class="memdesc:a8d9358718ba764cb89934798af32b1a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The index of the cell to which the given coordinate belongs.  <a href="#a8d9358718ba764cb89934798af32b1a9">More...</a><br /></td></tr>
<tr class="separator:a8d9358718ba764cb89934798af32b1a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31162fd2826c1f5ff85ecbdd65baf6b2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#a31162fd2826c1f5ff85ecbdd65baf6b2">cell_index</a> (const std::vector&lt; double &gt; &amp;grid, const double &amp;<a class="el" href="PhotColumns_8h.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> hint_lower) const </td></tr>
<tr class="memdesc:a31162fd2826c1f5ff85ecbdd65baf6b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The index of the cell to which the given coordinate belongs.  <a href="#a31162fd2826c1f5ff85ecbdd65baf6b2">More...</a><br /></td></tr>
<tr class="separator:a31162fd2826c1f5ff85ecbdd65baf6b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff963e13dae249b13cc49d38b4d2430b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#aff963e13dae249b13cc49d38b4d2430b">impose_boundaries</a> (<a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> &amp;index, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> boundary1, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> buondary2) const </td></tr>
<tr class="memdesc:aff963e13dae249b13cc49d38b4d2430b"><td class="mdescLeft">&#160;</td><td class="mdescRight">If an index is outside a range it is replaced by the closest boundary.  <a href="#aff963e13dae249b13cc49d38b4d2430b">More...</a><br /></td></tr>
<tr class="separator:aff963e13dae249b13cc49d38b4d2430b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a265919595e03f8563f9bfa2f845826e2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#a265919595e03f8563f9bfa2f845826e2">cell_span</a> (const std::vector&lt; double &gt; &amp;grid, double <a class="el" href="classPSF_1_1Piecewise.html#af3a8a47a901b15b6fb685eb760518d15">min_x</a>, double <a class="el" href="classPSF_1_1Piecewise.html#ad92caff8d26d497eca504bf2190ee8c1">max_x</a>, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> &amp;low, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> &amp;high) const </td></tr>
<tr class="memdesc:a265919595e03f8563f9bfa2f845826e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the range of cells that tightly cover a range of positions.  <a href="#a265919595e03f8563f9bfa2f845826e2">More...</a><br /></td></tr>
<tr class="separator:a265919595e03f8563f9bfa2f845826e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7ef67a815881fa9da06af08db4009cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#af7ef67a815881fa9da06af08db4009cb">check_inside_grid</a> (double <a class="el" href="PhotColumns_8h.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>, double <a class="el" href="PhotColumns_8h.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>) const </td></tr>
<tr class="memdesc:af7ef67a815881fa9da06af08db4009cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Throws an exception if x or y are not inside the grid range.  <a href="#af7ef67a815881fa9da06af08db4009cb">More...</a><br /></td></tr>
<tr class="separator:af7ef67a815881fa9da06af08db4009cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0616b31fb300595057adf5a93d903c9"><td class="memItemLeft" align="right" valign="top">std::valarray&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#aa0616b31fb300595057adf5a93d903c9">integrate_single_column_rectangle</a> (<a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> x_index, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> first_y_index, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> last_y_index, double xmin_cell, double xmax_cell, double ymin_cell, double ymax_cell, const std::vector&lt; std::valarray&lt; double &gt; &gt; &amp;parameter_sets=std::vector&lt; std::valarray&lt; double &gt; &gt;()) const </td></tr>
<tr class="memdesc:aa0616b31fb300595057adf5a93d903c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the integral over a rectangle that fits in a single column of cells.  <a href="#aa0616b31fb300595057adf5a93d903c9">More...</a><br /></td></tr>
<tr class="separator:aa0616b31fb300595057adf5a93d903c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba608aa611e18dff5e480868b5013a02"><td class="memItemLeft" align="right" valign="top">std::valarray&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#aba608aa611e18dff5e480868b5013a02">integrate_single_row_rectangle</a> (<a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> first_x_index, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> last_x_index, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> y_index, double xmin_cell, double xmax_cell, double ymin_cell, double ymax_cell, const std::vector&lt; std::valarray&lt; double &gt; &gt; &amp;parameter_sets=std::vector&lt; std::valarray&lt; double &gt; &gt;()) const </td></tr>
<tr class="memdesc:aba608aa611e18dff5e480868b5013a02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the integral over a rectangle that fits in a single row of cells.  <a href="#aba608aa611e18dff5e480868b5013a02">More...</a><br /></td></tr>
<tr class="separator:aba608aa611e18dff5e480868b5013a02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eafab62eb570adc3da07808495784e8"><td class="memItemLeft" align="right" valign="top">std::valarray&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#a2eafab62eb570adc3da07808495784e8">integrate_multi_row_column_rectangle</a> (<a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> first_x_index, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> last_x_index, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> first_y_index, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> last_y_index, double xmin_cell, double xmax_cell, double ymin_cell, double ymax_cell, const std::vector&lt; std::valarray&lt; double &gt; &gt; &amp;parameter_sets=std::vector&lt; std::valarray&lt; double &gt; &gt;()) const </td></tr>
<tr class="separator:a2eafab62eb570adc3da07808495784e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaac072a5bed871b631c66ee84948cdbb"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#aaac072a5bed871b631c66ee84948cdbb">integrate_single_column_wedge</a> (<a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> x_index, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> tip_y_index, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> corner_y_index, double cell_corner_x, double cell_corner_y, double cell_tip_y, double radius) const </td></tr>
<tr class="separator:aaac072a5bed871b631c66ee84948cdbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18a75bf1e74fe8ba82b065ac7afe5dc7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#a18a75bf1e74fe8ba82b065ac7afe5dc7">integrate_single_row_wedge</a> (<a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> tip_x_index, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> corner_x_index, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> y_index, double cell_corner_x, double cell_corner_y, double cell_tip_x, double radius) const </td></tr>
<tr class="separator:a18a75bf1e74fe8ba82b065ac7afe5dc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d1f05c5eac2a065f8c651a16b06911c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#a8d1f05c5eac2a065f8c651a16b06911c">integrate_inside_arc</a> (<a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> start_col, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> end_col, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> row, double radius) const </td></tr>
<tr class="memdesc:a8d1f05c5eac2a065f8c651a16b06911c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integrates over the area interior to a circle that overlaps with a row of cells.  <a href="#a8d1f05c5eac2a065f8c651a16b06911c">More...</a><br /></td></tr>
<tr class="separator:a8d1f05c5eac2a065f8c651a16b06911c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cb8911d0e404a2150d41139ae8ee0b9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#a7cb8911d0e404a2150d41139ae8ee0b9">integrate_bottom_row</a> (<a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> corner_col, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> corner_row, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> crossing_col, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> tip_col, double cell_crossing_x, double cell_tip_x, double cell_corner_x, double cell_corner_y, double radius, bool up) const </td></tr>
<tr class="memdesc:a7cb8911d0e404a2150d41139ae8ee0b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integrates the row containing the corner of a multi row and column wedge.  <a href="#a7cb8911d0e404a2150d41139ae8ee0b9">More...</a><br /></td></tr>
<tr class="separator:a7cb8911d0e404a2150d41139ae8ee0b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a805715d2d6c1d9e9376e374cd366c4e2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#a805715d2d6c1d9e9376e374cd366c4e2">integrate_middle_row</a> (<a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> row, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> corner_col, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> inner_crossing_col, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> last_col, double cell_corner_x, double inner_cell_crossing_x, double radius, int right) const </td></tr>
<tr class="memdesc:a805715d2d6c1d9e9376e374cd366c4e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integrates a row betweent the corner and the tip of a multi row and column wedge.  <a href="#a805715d2d6c1d9e9376e374cd366c4e2">More...</a><br /></td></tr>
<tr class="separator:a805715d2d6c1d9e9376e374cd366c4e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6979e575d69230bbf194115b37d0cb1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#ac6979e575d69230bbf194115b37d0cb1">integrate_tip_row</a> (<a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> tip_row, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> corner_col, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> crossing_col, double cell_corner_x, double cell_tip_y, double radius, bool up, bool right) const </td></tr>
<tr class="memdesc:ac6979e575d69230bbf194115b37d0cb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integrates the row of cells containing the tip of a wedge.  <a href="#ac6979e575d69230bbf194115b37d0cb1">More...</a><br /></td></tr>
<tr class="separator:ac6979e575d69230bbf194115b37d0cb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf7f55e2dc5b8663a19b6ed70c5e6a3f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#abf7f55e2dc5b8663a19b6ed70c5e6a3f">integrate_multi_row_column_wedge</a> (<a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> tip_col, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> corner_col, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> tip_row, <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> corner_row, double cell_corner_x, double cell_corner_y, double cell_tip_x, double cell_tip_y, double radius) const </td></tr>
<tr class="memdesc:abf7f55e2dc5b8663a19b6ed70c5e6a3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the integral over a wedge that spans multiple rows and colunms of cells.  <a href="#abf7f55e2dc5b8663a19b6ed70c5e6a3f">More...</a><br /></td></tr>
<tr class="separator:abf7f55e2dc5b8663a19b6ed70c5e6a3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a05cb6957a4238f6e9d1ea3e442d150a8"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#a05cb6957a4238f6e9d1ea3e442d150a8">__grid_x</a></td></tr>
<tr class="memdesc:a05cb6957a4238f6e9d1ea3e442d150a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">The horizontal boundaries of the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> grid cells.  <a href="#a05cb6957a4238f6e9d1ea3e442d150a8">More...</a><br /></td></tr>
<tr class="separator:a05cb6957a4238f6e9d1ea3e442d150a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a356a0c2bba3fa366da1909eab18b90b4"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#a356a0c2bba3fa366da1909eab18b90b4">__grid_y</a></td></tr>
<tr class="memdesc:a356a0c2bba3fa366da1909eab18b90b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">The vertical boundaries of the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> grid cells.  <a href="#a356a0c2bba3fa366da1909eab18b90b4">More...</a><br /></td></tr>
<tr class="separator:a356a0c2bba3fa366da1909eab18b90b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52c903196fd6261075785faf223a9ab1"><td class="memItemLeft" align="right" valign="top">std::vector&lt; const <a class="el" href="classPSF_1_1PiecewiseCell.html">PiecewiseCell</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#a52c903196fd6261075785faf223a9ab1">__cells</a></td></tr>
<tr class="memdesc:a52c903196fd6261075785faf223a9ab1"><td class="mdescLeft">&#160;</td><td class="mdescRight">The cells indexed as x_ind + y_ind*Nx.  <a href="#a52c903196fd6261075785faf223a9ab1">More...</a><br /></td></tr>
<tr class="separator:a52c903196fd6261075785faf223a9ab1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5291b7ceaddc2d8834b9fcf4af242d47"><td class="memItemLeft" align="right" valign="top">std::vector&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPSF_1_1Piecewise.html#a5291b7ceaddc2d8834b9fcf4af242d47">__cloned_cell</a></td></tr>
<tr class="memdesc:a5291b7ceaddc2d8834b9fcf4af242d47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flags for whether the corresponding cell was cloned.  <a href="#a5291b7ceaddc2d8834b9fcf4af242d47">More...</a><br /></td></tr>
<tr class="separator:a5291b7ceaddc2d8834b9fcf4af242d47"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> model consisting of a grid of rectangles each with a separate intensity function. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aa3be68d72c6a1882248201c4cd1fb0e3"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class RandomAccessIterator &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PSF::Piecewise::Piecewise </td>
          <td>(</td>
          <td class="paramtype">RandomAccessIterator&#160;</td>
          <td class="paramname"><em>first_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">RandomAccessIterator&#160;</td>
          <td class="paramname"><em>last_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">RandomAccessIterator&#160;</td>
          <td class="paramname"><em>first_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">RandomAccessIterator&#160;</td>
          <td class="paramname"><em>last_y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> model on a specified grid with invalid cells. </p>
<p>Use set_cell or set_all_cells to specify the cells. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">first_x</td><td>The first horizonatal boundary. </td></tr>
    <tr><td class="paramname">last_x</td><td>One past the last horizontal boundary. </td></tr>
    <tr><td class="paramname">first_y</td><td>The first vertical boundary. </td></tr>
    <tr><td class="paramname">last_y</td><td>One past the last vertical boundary. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a9b21044c37a2b0901e539742a8d9cde7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> PSF::Piecewise::cell_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>x_ind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>y_ind</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The index of the cell with the given x and y indices. </p>

</div>
</div>
<a class="anchor" id="ac97b274ac5008c49dd0818d7beaa8b97"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> PSF::Piecewise::cell_index </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>hint_lower</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>hint_upper</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The index of the cell to which the given coordinate belongs.</p>
<p>Cell boundaries are assumed to belong to the smaller cell index, except the boundary at hint_lower which belongs to the hint_lower cell. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">grid</td><td>The cell boundaries. </td></tr>
    <tr><td class="paramname">x</td><td>The coordinate whose cell index is required. </td></tr>
    <tr><td class="paramname">hint_lower</td><td>An index of a cell boundary known to be less than x. </td></tr>
    <tr><td class="paramname">hint_upper</td><td>An index of a cell boundary known to be greater than x. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a8d9358718ba764cb89934798af32b1a9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> PSF::Piecewise::cell_index </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The index of the cell to which the given coordinate belongs. </p>
<p>Cell boundaries are assumed to belong to the smaller cell index, except the smallest boundary which belongs to the first cell. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">grid</td><td>The cell boundaries. </td></tr>
    <tr><td class="paramname">x</td><td>The coordinate whose cell index is required. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a31162fd2826c1f5ff85ecbdd65baf6b2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> PSF::Piecewise::cell_index </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>hint_lower</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The index of the cell to which the given coordinate belongs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">grid</td><td>The cell boundaries. </td></tr>
    <tr><td class="paramname">x</td><td>The coordinate whose cell index is required. </td></tr>
    <tr><td class="paramname">hint_lower</td><td>An index of a cell boundary known to be less than x. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a265919595e03f8563f9bfa2f845826e2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PSF::Piecewise::cell_span </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>min_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> &amp;&#160;</td>
          <td class="paramname"><em>low</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> &amp;&#160;</td>
          <td class="paramname"><em>high</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Finds the range of cells that tightly cover a range of positions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">grid</td><td>The cell boundaries. </td></tr>
    <tr><td class="paramname">min_x</td><td>The lower bound of the range to cover. </td></tr>
    <tr><td class="paramname">max_x</td><td>The upper bound of the range to cover. </td></tr>
    <tr><td class="paramname">low</td><td>On output set to the index of the first cell that covers the range. </td></tr>
    <tr><td class="paramname">high</td><td>On output set to the index of the last cell that covers the range. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af7ef67a815881fa9da06af08db4009cb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PSF::Piecewise::check_inside_grid </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Throws an exception if x or y are not inside the grid range. </p>

</div>
</div>
<a class="anchor" id="ad870faa8d30e4438389b8295c4573e74"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PSF::Piecewise::grid_column_width </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>column</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the width of the column-th cell column. </p>

</div>
</div>
<a class="anchor" id="a9088d1d84afb8d054feb2aa41cb62292"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PSF::Piecewise::grid_row_height </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>row</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the height of the rowth-th cell row. </p>

</div>
</div>
<a class="anchor" id="aff963e13dae249b13cc49d38b4d2430b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PSF::Piecewise::impose_boundaries </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> &amp;&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>boundary1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>buondary2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>If an index is outside a range it is replaced by the closest boundary. </p>

</div>
</div>
<a class="anchor" id="a7cb8911d0e404a2150d41139ae8ee0b9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PSF::Piecewise::integrate_bottom_row </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>corner_col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>corner_row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>crossing_col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>tip_col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cell_crossing_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cell_tip_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cell_corner_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cell_corner_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Integrates the row containing the corner of a multi row and column wedge. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">corner_col</td><td>The column of the cell containing the corner. </td></tr>
    <tr><td class="paramname">corner_row</td><td>The row of the cells being integrated. </td></tr>
    <tr><td class="paramname">crossing_col</td><td>The column of the cell where the arc enters the row of cells. </td></tr>
    <tr><td class="paramname">tip_col</td><td>The column of the cell containing the tip furthest from the corner in the x direction. </td></tr>
    <tr><td class="paramname">cell_crossing_x</td><td>The x coordinate where the arc enters the row of cells in cell coordinates. </td></tr>
    <tr><td class="paramname">cell_tip_x</td><td>The x coordinate of the tip of the wedge in cell coordinates. </td></tr>
    <tr><td class="paramname">cell_corner_x</td><td>The x coordinate of the corner of the wedge in cell coordinates. </td></tr>
    <tr><td class="paramname">cell_corner_y</td><td>The y coordinate of the corner of the wedge in cell coordinates. </td></tr>
    <tr><td class="paramname">radius</td><td>The radius of the circle the wedge arc is part of. </td></tr>
    <tr><td class="paramname">up</td><td>Wether the wedge lies above the corner. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a8d1f05c5eac2a065f8c651a16b06911c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PSF::Piecewise::integrate_inside_arc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>start_col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>end_col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Integrates over the area interior to a circle that overlaps with a row of cells. </p>
<p>The configuration of the circle and cells must be such that the circle intersect the outside vertical wall of one end cells and one of the horizontal walls of the other end cell.</p>
<p>In addition the arc may not go through <img class="formulaInl" alt="$n\pi/2$" src="form_49.png"/>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">start_col</td><td>The column of the end cell whose vertical wall is intersected by the arc. </td></tr>
    <tr><td class="paramname">end_col</td><td>The column of the cell whose horizontal wall is intersected by the arc. </td></tr>
    <tr><td class="paramname">row</td><td>The row of the cells. </td></tr>
    <tr><td class="paramname">radius</td><td>The radius of the circle the arc is part of. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a805715d2d6c1d9e9376e374cd366c4e2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PSF::Piecewise::integrate_middle_row </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>corner_col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>inner_crossing_col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>last_col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cell_corner_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>inner_cell_crossing_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>right</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Integrates a row betweent the corner and the tip of a multi row and column wedge. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">row</td><td>The row being integrated. </td></tr>
    <tr><td class="paramname">corner_col</td><td>The column of the cell containing the corner. </td></tr>
    <tr><td class="paramname">inner_crossing_col</td><td>The column where the arc first enters the row being integrated. </td></tr>
    <tr><td class="paramname">last_col</td><td>The column furthest from the corner column which still contains a piece of the wedge. </td></tr>
    <tr><td class="paramname">cell_corner_x</td><td>The x coordinate of the wedge corner in cell coordinates. </td></tr>
    <tr><td class="paramname">inner_cell_crossing_x</td><td>The innermost x where the arc enters the row in cell coordinates. </td></tr>
    <tr><td class="paramname">radius</td><td>The radius of the circle the wedge arc is part of. </td></tr>
    <tr><td class="paramname">right</td><td>If the wedge extends to the right/left of the corner +/- 1. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2eafab62eb570adc3da07808495784e8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::valarray&lt; double &gt; PSF::Piecewise::integrate_multi_row_column_rectangle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>first_x_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>last_x_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>first_y_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>last_y_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmin_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmax_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ymin_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ymax_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::valarray&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>parameter_sets</em> = <code>std::vector&lt;&#160;std::valarray&lt;double&gt;&#160;&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculates the integral over a rectangle spanning multiple rows and columns.</p>
<div class="image">
<img src="PiecewisePSF_multi_row_column_rectangle_iiiidddd.png" alt="PiecewisePSF_multi_row_column_rectangle_iiiidddd.png"/>
<div class="caption">
The area being integrated along with the meaning of all function arguments.</div></div>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">first_x_index</td><td>The index of the first x cell that overlaps with the rectangle. </td></tr>
    <tr><td class="paramname">last_x_index</td><td>The index of the last x cell that overlaps with the rectangle. </td></tr>
    <tr><td class="paramname">first_y_index</td><td>The index of the first y cell that overlaps with the rectangle. </td></tr>
    <tr><td class="paramname">last_y_index</td><td>The index of the last y cell that overlaps with the rectangle. </td></tr>
    <tr><td class="paramname">xmin_cell</td><td>The left boundary of the rectangle in cell coordinates. </td></tr>
    <tr><td class="paramname">xmax_cell</td><td>The right boundary of the rectangle in cell coordinates. </td></tr>
    <tr><td class="paramname">ymin_cell</td><td>The bottom boundary of the rectangle in cell coordinates. </td></tr>
    <tr><td class="paramname">ymax_cell</td><td>The top boundary of the rectangle in cell coordinates. </td></tr>
    <tr><td class="paramname">parameter_sets</td><td>Optional sets of coefficients to try. The sets of coefficients to try for a cell with index i are parameter_sets[i]. Each set is 16 values long and all sets for a single pixel are concatenated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="abf7f55e2dc5b8663a19b6ed70c5e6a3f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PSF::Piecewise::integrate_multi_row_column_wedge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>tip_col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>corner_col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>tip_row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>corner_row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cell_corner_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cell_corner_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cell_tip_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cell_tip_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the integral over a wedge that spans multiple rows and colunms of cells. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tip_col</td><td>The index in __grid_x of the cell containing the most horizontally displaced from the corner tip of the wedge. </td></tr>
    <tr><td class="paramname">corner_col</td><td>The index in __grid_x of the cell containing the corner of the wedge. </td></tr>
    <tr><td class="paramname">tip_row</td><td>The index of the cell in __grid_y containing the most vertically displaced from the corner tip of the wedge. </td></tr>
    <tr><td class="paramname">corner_row</td><td>The index in __grid_y of the cell containing the corner of the wedge. </td></tr>
    <tr><td class="paramname">cell_corner_x</td><td>The x coordinate of the wedge corner in cell coordinates. </td></tr>
    <tr><td class="paramname">cell_corner_y</td><td>The y coordinate of the wedge corner in cell coordinates. </td></tr>
    <tr><td class="paramname">cell_tip_x</td><td>The x coordinate of the y tip of the wedge in cell coordinates. </td></tr>
    <tr><td class="paramname">cell_tip_y</td><td>The y coordinate of the y tip of the wedge in cell coordinates. </td></tr>
    <tr><td class="paramname">radius</td><td>The radius of curvature of the wedge arc. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="adcef587b2345da3103e10a254f3aeb75"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PSF::Piecewise::integrate_rectangle </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>center_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>center_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the integral of the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> over a rectangle. </p>

<p>Implements <a class="el" href="classPSF_1_1PSF.html#aa4c50c38cc4d6fda0373a83ff095980b">PSF::PSF</a>.</p>

</div>
</div>
<a class="anchor" id="a8dcf614097c8f2e447834a2b2a9ed1cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::valarray&lt; double &gt; PSF::Piecewise::integrate_rectangle_parameters </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>center_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>center_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::valarray&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>parameter_sets</em> = <code>std::vector&lt;&#160;std::valarray&lt;double&gt;&#160;&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the integral of the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> over a rectangle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">center_x</td><td>The x coordinate of the center of the rectangle </td></tr>
    <tr><td class="paramname">center_y</td><td>The x coordinate of the center of the rectangle </td></tr>
    <tr><td class="paramname">dx</td><td>The full width of the rectangle. </td></tr>
    <tr><td class="paramname">dy</td><td>The full height of the rectangle. </td></tr>
    <tr><td class="paramname">parameter_sets</td><td>Optional sets of coefficients to use. The sets of coefficients to use for a cell with index i are parameter_sets[i]. Each set is 16 values long and all sets for a single pixel are concatenated. If this argument is omitted or empty, the current <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> setup is used. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa0616b31fb300595057adf5a93d903c9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::valarray&lt; double &gt; PSF::Piecewise::integrate_single_column_rectangle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>x_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>first_y_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>last_y_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmin_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmax_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ymin_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ymax_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::valarray&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>parameter_sets</em> = <code>std::vector&lt;&#160;std::valarray&lt;double&gt;&#160;&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the integral over a rectangle that fits in a single column of cells. </p>
<div class="image">
<img src="PiecewisePSF_single_column_rectangle_iiidddd.png" alt="PiecewisePSF_single_column_rectangle_iiidddd.png"/>
<div class="caption">
The area being integrated along with the meaning of all function arguments.</div></div>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x_index</td><td>The index in __grid_x of the cell containing the rectangle. </td></tr>
    <tr><td class="paramname">first_y_index</td><td>The index of the first y cell that overlaps with the rectangle. </td></tr>
    <tr><td class="paramname">last_y_index</td><td>The index of the last y cell that overlaps with the rectangle. </td></tr>
    <tr><td class="paramname">xmin_cell</td><td>The left boundary of the rectangle in cell coordinates. </td></tr>
    <tr><td class="paramname">xmax_cell</td><td>The right boundary of the rectangle in cell coordinates. </td></tr>
    <tr><td class="paramname">ymin_cell</td><td>The bottom boundary of the rectangle in cell coordinates. </td></tr>
    <tr><td class="paramname">ymax_cell</td><td>The top boundary of the rectangle in cell coordinates. </td></tr>
    <tr><td class="paramname">parameter_sets</td><td>Optional sets of coefficients to try. The sets of coefficients to try for a cell with index i are parameter_sets[i]. Each set is 16 values long and all sets for a single pixel are concatenated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aaac072a5bed871b631c66ee84948cdbb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PSF::Piecewise::integrate_single_column_wedge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>x_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>tip_y_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>corner_y_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cell_corner_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cell_corner_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cell_tip_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculates the integral over a wedge that fits in a single column of cells.</p>
<p>The area being integrated matches one of the following diagrams. </p><div class="image">
<img src="PiecewisePSF_single_column_wedge_iiidddd_ur.png" alt="PiecewisePSF_single_column_wedge_iiidddd_ur.png"/>
</div>
 <div class="image">
<img src="PiecewisePSF_single_column_wedge_iiidddd_ul.png" alt="PiecewisePSF_single_column_wedge_iiidddd_ul.png"/>
</div>
 <div class="image">
<img src="PiecewisePSF_single_column_wedge_iiidddd_dr.png" alt="PiecewisePSF_single_column_wedge_iiidddd_dr.png"/>
</div>
 <div class="image">
<img src="PiecewisePSF_single_column_wedge_iiidddd_dl.png" alt="PiecewisePSF_single_column_wedge_iiidddd_dl.png"/>
</div>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x_index</td><td>The index in __grid_x of the cell containing the wedge. </td></tr>
    <tr><td class="paramname">tip_y_index</td><td>The index of the cell in __grid_y containing the tip of the wedge. </td></tr>
    <tr><td class="paramname">corner_y_index</td><td>The index of the cell in __grid_y containing the corner of the wedge. </td></tr>
    <tr><td class="paramname">cell_corner_x</td><td>The x coordinate of the wedge corner in cell coordinates. </td></tr>
    <tr><td class="paramname">cell_corner_y</td><td>The y coordinate of the wedge corner in cell coordinates. </td></tr>
    <tr><td class="paramname">cell_tip_y</td><td>The y coordinate of the y tip of the wedge in cell coordinates. </td></tr>
    <tr><td class="paramname">radius</td><td>The radius of curvature of the wedge arc. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aba608aa611e18dff5e480868b5013a02"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::valarray&lt; double &gt; PSF::Piecewise::integrate_single_row_rectangle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>first_x_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>last_x_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>y_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmin_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmax_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ymin_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ymax_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::valarray&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>parameter_sets</em> = <code>std::vector&lt;&#160;std::valarray&lt;double&gt;&#160;&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the integral over a rectangle that fits in a single row of cells. </p>
<div class="image">
<img src="PiecewisePSF_single_row_rectangle_iiidddd.png" alt="PiecewisePSF_single_row_rectangle_iiidddd.png"/>
<div class="caption">
The area being integrated along with the meaning of all function arguments.</div></div>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">first_x_index</td><td>The index of the first x cell that overlaps with the rectangle. </td></tr>
    <tr><td class="paramname">last_x_index</td><td>The index of the last x cell that overlaps with the rectangle. </td></tr>
    <tr><td class="paramname">y_index</td><td>The index of the y cell that contains the rectagle. </td></tr>
    <tr><td class="paramname">xmin_cell</td><td>The left boundary of the rectangle in cell coordinates. </td></tr>
    <tr><td class="paramname">xmax_cell</td><td>The right boundary of the rectangle in cell coordinates. </td></tr>
    <tr><td class="paramname">ymin_cell</td><td>The bottom boundary of the rectangle in cell coordinates. </td></tr>
    <tr><td class="paramname">ymax_cell</td><td>The top boundary of the rectangle in cell coordinates. </td></tr>
    <tr><td class="paramname">parameter_sets</td><td>Optional sets of coefficients to try. The sets of coefficients to try for a cell with index i are parameter_sets[i]. Each set is 16 values long and all sets for a single pixel are concatenated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a18a75bf1e74fe8ba82b065ac7afe5dc7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PSF::Piecewise::integrate_single_row_wedge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>tip_x_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>corner_x_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>y_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cell_corner_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cell_corner_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cell_tip_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculates the integral over a wedge that fits in a single row of cells. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tip_x_index</td><td>The index in __grid_x of the cell containing the tip of the wedge. </td></tr>
    <tr><td class="paramname">corner_x_index</td><td>The index in __grid_x of the cell containing the corner of the wedge. </td></tr>
    <tr><td class="paramname">y_index</td><td>The index of the cell in __grid_y containing the wedge. </td></tr>
    <tr><td class="paramname">cell_corner_x</td><td>The x coordinate of the wedge corner in cell coordinates. </td></tr>
    <tr><td class="paramname">cell_corner_y</td><td>The y coordinate of the wedge corner in cell coordinates. </td></tr>
    <tr><td class="paramname">cell_tip_x</td><td>The x coordinate of the y tip of the wedge in cell coordinates. </td></tr>
    <tr><td class="paramname">radius</td><td>The radius of curvature of the wedge arc. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac6979e575d69230bbf194115b37d0cb1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PSF::Piecewise::integrate_tip_row </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>tip_row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>corner_col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a>&#160;</td>
          <td class="paramname"><em>crossing_col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cell_corner_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cell_tip_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>up</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>right</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Integrates the row of cells containing the tip of a wedge. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tip_row</td><td>The row being integrated. </td></tr>
    <tr><td class="paramname">corner_col</td><td>The column of the cell containing the corner. </td></tr>
    <tr><td class="paramname">crossing_col</td><td>The column where the wedge crosses the row boundary. </td></tr>
    <tr><td class="paramname">cell_corner_x</td><td>The x coordinate of the wedge corner in cell coordinates. </td></tr>
    <tr><td class="paramname">cell_tip_y</td><td>The y coordinate of the wedge tip in cell coordinates. </td></tr>
    <tr><td class="paramname">radius</td><td>The radius of the circle the wedge arc is part of. </td></tr>
    <tr><td class="paramname">up</td><td>Does the wedge extend upwards of the corner? </td></tr>
    <tr><td class="paramname">right</td><td>Does the wedge extend rightward of the corner? </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aefc070663de2ca53b62d8e6a21930ae4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PSF::Piecewise::integrate_wedge </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>left</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bottom</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Integrates the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> over the smallest of the four wedges with the. </p>
<ul>
<li>the line x=x</li>
<li>the line y=y</li>
<li>the circle centered at (0, 0) with a radius=radius If x is 0 the left vs right wedge is chosen according to left Same for y0 and bottom. </li>
</ul>

<p>Implements <a class="el" href="classPSF_1_1PSF.html#a2555b23419b2f19f5c39f4ba45bfacac">PSF::PSF</a>.</p>

</div>
</div>
<a class="anchor" id="ad92caff8d26d497eca504bf2190ee8c1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PSF::Piecewise::max_x </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The right boundary of the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> grid. </p>

</div>
</div>
<a class="anchor" id="ac6defc7d4e710852c98284736d3cd8d2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PSF::Piecewise::max_y </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The top boundary of the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> grid. </p>

</div>
</div>
<a class="anchor" id="af3a8a47a901b15b6fb685eb760518d15"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PSF::Piecewise::min_x </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The left boundary of the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> grid. </p>

</div>
</div>
<a class="anchor" id="a6c6f4f8e4d98633481b8af6b12a6e33a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PSF::Piecewise::min_y </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The bottom boundary of the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> grid. </p>

</div>
</div>
<a class="anchor" id="a7184535e48a52059e77427bc6316e4a6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PSF::Piecewise::operator() </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluates the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> at the given position. </p>

<p>Implements <a class="el" href="classPSF_1_1PSF.html#a0bdcbd3f03020f4f8fdd112def8f0927">PSF::PSF</a>.</p>

</div>
</div>
<a class="anchor" id="ad30e36f12dbf9e7fbd1ab7d39ed69053"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::valarray&lt; double &gt; PSF::Piecewise::operator() </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::valarray&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>parameter_sets</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluates the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> at the given position assuming a list of cell parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>The x coordinate where to evaluate the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a>. </td></tr>
    <tr><td class="paramname">y</td><td>The y coordinate where to evaluate the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a>. </td></tr>
    <tr><td class="paramname">parameter_sets</td><td>The sets of coefficients to use. The sets of coefficients to use for a cell with index i are parameter_sets[i]. Each set is 16 values long and all sets for a single pixel are concatenated. If this argument is empty, the current <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> setup is used. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a08362ad7e5bb978c4a68dcf30ed6b17c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ConstCellIterator &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PSF::Piecewise::set_all_cells </td>
          <td>(</td>
          <td class="paramtype">ConstCellIterator&#160;</td>
          <td class="paramname"><em>first_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>clone</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set all cells. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">first_cell</td><td>An iterator over (const) pointers to cells pointing to the first cell (the one with x index = y index = 0. </td></tr>
    <tr><td class="paramname">clone</td><td>Whether to store clones of the cells instead of the cells </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="acb6bb0761038b369ba32bb4f2f46431f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PSF::Piecewise::set_cell </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classPSF_1_1PiecewiseCell.html">PiecewiseCell</a> *&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> &amp;&#160;</td>
          <td class="paramname"><em>x_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceCore.html#a285a47e008b3a371dddad36b58c18810">Core::vector_size_type</a> &amp;&#160;</td>
          <td class="paramname"><em>y_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>clone</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set one of the cells comprising the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a>. </p>
<p>Unless the clone argument is true, the cell must not be deallocated until the Picewise object is. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cell</td><td>The new cell to store. </td></tr>
    <tr><td class="paramname">x_index</td><td>The horizontal index of the grid cell to set. </td></tr>
    <tr><td class="paramname">y_index</td><td>The vertical index of the grid cell to set. </td></tr>
    <tr><td class="paramname">clone</td><td>Wether to store the cell directly or to clone it. The clones are destroyed by the destructor. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a52c903196fd6261075785faf223a9ab1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;const <a class="el" href="classPSF_1_1PiecewiseCell.html">PiecewiseCell</a>*&gt; PSF::Piecewise::__cells</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The cells indexed as x_ind + y_ind*Nx. </p>

</div>
</div>
<a class="anchor" id="a5291b7ceaddc2d8834b9fcf4af242d47"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;bool&gt; PSF::Piecewise::__cloned_cell</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flags for whether the corresponding cell was cloned. </p>

</div>
</div>
<a class="anchor" id="a05cb6957a4238f6e9d1ea3e442d150a8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; PSF::Piecewise::__grid_x</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The horizontal boundaries of the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> grid cells. </p>

</div>
</div>
<a class="anchor" id="a356a0c2bba3fa366da1909eab18b90b4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; PSF::Piecewise::__grid_y</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The vertical boundaries of the <a class="el" href="classPSF_1_1PSF.html" title="An abstract parent class for all PSF models. ">PSF</a> grid cells. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/PSF/<a class="el" href="Piecewise_8h_source.html">Piecewise.h</a></li>
<li>src/PSF/<a class="el" href="Piecewise_8cpp.html">Piecewise.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacePSF.html">PSF</a></li><li class="navelem"><a class="el" href="classPSF_1_1Piecewise.html">Piecewise</a></li>
    <li class="footer">Generated on Tue Jan 2 2018 17:31:30 for SuperPhot by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
