

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>C++ API &mdash; SuperPhot Python Interface  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/unlimited_width.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="C API" href="c_api.html" />
    <link rel="prev" title="superphot.superphot_io_tree module" href="_implementation/superphot.superphot_io_tree.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> SuperPhot Python Interface
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="user_documentation/index.html">User Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="_implementation/modules.html">Python Package Implementation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">C++ API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#fitpsf">FitPSF</a></li>
<li class="toctree-l2"><a class="reference internal" href="#subpixphot">SubPixPhot</a></li>
<li class="toctree-l2"><a class="reference internal" href="#psf">PSF</a></li>
<li class="toctree-l2"><a class="reference internal" href="#background">Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="#io">IO</a></li>
<li class="toctree-l2"><a class="reference internal" href="#core">Core</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="c_api.html">C API</a></li>
<li class="toctree-l1"><a class="reference internal" href="_unit_tests/modules.html">Unit Testing Code</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SuperPhot Python Interface</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>C++ API</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/cpp_api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="c-api">
<h1>C++ API<a class="headerlink" href="#c-api" title="Permalink to this headline">¶</a></h1>
<div class="section" id="fitpsf">
<h2>FitPSF<a class="headerlink" href="#fitpsf" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="_CPPv26FitPSF">
<span id="FitPSF"></span><span class="target" id="namespaceFitPSF"></span><em class="property">namespace </em><code class="descname">FitPSF</code><a class="headerlink" href="#_CPPv26FitPSF" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Typedefs</p>
<dl class="type">
<dt id="_CPPv2N6FitPSF16LinearSourceListE">
<span id="FitPSF::LinearSourceList"></span><span class="target" id="Common_8h_1a5432cdc9b255de958483cc386d5bba86"></span><em class="property">typedef </em>std::list&lt;<a class="reference internal" href="#_CPPv2N6FitPSF12LinearSourceE" title="FitPSF::LinearSource">LinearSource</a> *&gt; <code class="descname">LinearSourceList</code><a class="headerlink" href="#_CPPv2N6FitPSF16LinearSourceListE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Convenience alias. </p>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N6FitPSF13GSLSubPixTypeE">
<span id="FitPSF::GSLSubPixType"></span><span class="target" id="Common_8h_1ab82a21732b8a5824c90511e45a39c3b8"></span><em class="property">typedef </em><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> <code class="descname">GSLSubPixType</code><a class="headerlink" href="#_CPPv2N6FitPSF13GSLSubPixTypeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Convenience alias. </p>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N6FitPSF11ColNameListE">
<span id="FitPSF::ColNameList"></span><span class="target" id="IOSources_8cpp_1a5585e2324049472e68c6db7e176dc170"></span><em class="property">typedef </em>std::list&lt;std::string&gt; <code class="descname">ColNameList</code><a class="headerlink" href="#_CPPv2N6FitPSF11ColNameListE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="type">
<dt id="_CPPv2N6FitPSF10ColumnDataE">
<span id="FitPSF::ColumnData"></span><span class="target" id="IOSources_8cpp_1adfcf4eb2e56c5c1e97e8abe5d99c5d4e"></span><em class="property">typedef </em>std::vector&lt;std::list&lt;double&gt;&gt; <code class="descname">ColumnData</code><a class="headerlink" href="#_CPPv2N6FitPSF10ColumnDataE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="type">
<dt id="_CPPv2N6FitPSF14ConstPixelIterE">
<span id="FitPSF::ConstPixelIter"></span><span class="target" id="FitPSF_2PiecewiseBicubic_8h_1a3b874e6e467d332183786f4eb74e94b6"></span><em class="property">typedef </em>std::list&lt;<a class="reference internal" href="#_CPPv2N6FitPSF5PixelE" title="FitPSF::Pixel">Pixel</a>&lt;<a class="reference internal" href="#_CPPv2N6FitPSF12LinearSourceE" title="FitPSF::LinearSource">LinearSource</a>&gt; *&gt;::const_iterator <code class="descname">ConstPixelIter</code><a class="headerlink" href="#_CPPv2N6FitPSF14ConstPixelIterE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Convenience alias for unmutable iterator over pixels. </p>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N6FitPSF9PixelIterE">
<span id="FitPSF::PixelIter"></span><span class="target" id="FitPSF_2PiecewiseBicubic_8h_1a9d074040a6210284336f76232fa5526c"></span><em class="property">typedef </em>std::list&lt;<a class="reference internal" href="#_CPPv2N6FitPSF5PixelE" title="FitPSF::Pixel">Pixel</a>&lt;<a class="reference internal" href="#_CPPv2N6FitPSF12LinearSourceE" title="FitPSF::LinearSource">LinearSource</a>&gt; *&gt;::const_iterator <code class="descname">PixelIter</code><a class="headerlink" href="#_CPPv2N6FitPSF9PixelIterE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Convenience alias for mutable iterator over pixels. </p>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N6FitPSF16OverlapGroupListE">
<span id="FitPSF::OverlapGroupList"></span><span class="target" id="FitPSF_2PiecewiseBicubic_8h_1a6889732e1d26315f2d20c44e524a7f22"></span><em class="property">typedef </em>std::list&lt;<a class="reference internal" href="#_CPPv2N6FitPSF12OverlapGroupE" title="FitPSF::OverlapGroup">OverlapGroup</a>&lt;<a class="reference internal" href="#_CPPv2N6FitPSF12LinearSourceE" title="FitPSF::LinearSource">LinearSource</a>, <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF16PiecewiseBicubicE" title="PSF::PiecewiseBicubic">PiecewiseBicubic</a>&gt;&gt; <code class="descname">OverlapGroupList</code><a class="headerlink" href="#_CPPv2N6FitPSF16OverlapGroupListE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Convenience alias for a list of groups of overlapping sources. </p>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N6FitPSF21GSLSourceIteratorTypeE">
<span id="FitPSF::GSLSourceIteratorType"></span><span class="target" id="FitPSF_2SDKSource_8h_1a3d5c7354049649ad113478e573eba88a"></span><em class="property">typedef </em>std::list&lt;<a class="reference internal" href="#_CPPv2N6FitPSF9SDKSourceE" title="FitPSF::SDKSource">SDKSource</a>&lt;<a class="reference internal" href="#_CPPv2N6FitPSF13GSLSubPixTypeE" title="FitPSF::GSLSubPixType">GSLSubPixType</a>&gt;&gt;::iterator <code class="descname">GSLSourceIteratorType</code><a class="headerlink" href="#_CPPv2N6FitPSF21GSLSourceIteratorTypeE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Enums</p>
<dl class="type">
<dt id="_CPPv2N6FitPSF16SourceDropReasonE">
<span id="FitPSF::SourceDropReason"></span><span class="target" id="group__FitPSF_1gaf322f512b63bfe334b817be88e6c7820"></span><em class="property">enum </em><code class="descname">SourceDropReason</code><a class="headerlink" href="#_CPPv2N6FitPSF16SourceDropReasonE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Define tags for reasons to exclude sources from the fit. </p>
<p><em>Values:</em></p>
<dl class="enumerator">
<dt id="_CPPv2N6FitPSF10FEW_PIXELSE">
<span class="target" id="group__FitPSF_1ggaf322f512b63bfe334b817be88e6c7820a067d1fe9eb3de16e0568d6818dffb137"></span><code class="descname">FEW_PIXELS</code><a class="headerlink" href="#_CPPv2N6FitPSF10FEW_PIXELSE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Too few pixels were assigned to this source. </p>
</dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N6FitPSF11MANY_PIXELSE">
<span class="target" id="group__FitPSF_1ggaf322f512b63bfe334b817be88e6c7820a00d5564f730d22229a35181cd10761e2"></span><code class="descname">MANY_PIXELS</code><a class="headerlink" href="#_CPPv2N6FitPSF11MANY_PIXELSE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Too many pixels were assigned to this source. </p>
</dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N6FitPSF7TOO_BIGE">
<span class="target" id="group__FitPSF_1ggaf322f512b63bfe334b817be88e6c7820a26a3754bbbeb7176bdfe9d4d64c789b9"></span><code class="descname">TOO_BIG</code><a class="headerlink" href="#_CPPv2N6FitPSF7TOO_BIGE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Contains pixels too far from the source center. </p>
</dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N6FitPSF7OVERLAPE">
<span class="target" id="group__FitPSF_1ggaf322f512b63bfe334b817be88e6c7820ad7668d0f78318ce4146336e078b4e58c"></span><code class="descname">OVERLAP</code><a class="headerlink" href="#_CPPv2N6FitPSF7OVERLAPE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This source overlaps with another. </p>
</dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N6FitPSF16NON_POINT_SOURCEE">
<span class="target" id="group__FitPSF_1ggaf322f512b63bfe334b817be88e6c7820a66fe89ee58e07202f19000046a2a0a7b"></span><code class="descname">NON_POINT_SOURCE</code><a class="headerlink" href="#_CPPv2N6FitPSF16NON_POINT_SOURCEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This does not appear to be a point source. </p>
</dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N6FitPSF14BAD_BACKGROUNDE">
<span class="target" id="group__FitPSF_1ggaf322f512b63bfe334b817be88e6c7820ac12aed992ffea323d364b8f183ecd071"></span><code class="descname">BAD_BACKGROUND</code><a class="headerlink" href="#_CPPv2N6FitPSF14BAD_BACKGROUNDE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Failed to determine a reliable background. </p>
</dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N6FitPSF16PAST_MAX_SOURCESE">
<span class="target" id="group__FitPSF_1ggaf322f512b63bfe334b817be88e6c7820a7014b6c25370ae2167f1466cd5a0d21c"></span><code class="descname">PAST_MAX_SOURCES</code><a class="headerlink" href="#_CPPv2N6FitPSF16PAST_MAX_SOURCESE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>There is a sufficient number of &#8220;better&#8221; sources than this one. </p>
</dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N6FitPSF14MANY_SATURATEDE">
<span class="target" id="group__FitPSF_1ggaf322f512b63bfe334b817be88e6c7820ae68d3f01a5487e3f99815fc4b6d3a9c0"></span><code class="descname">MANY_SATURATED</code><a class="headerlink" href="#_CPPv2N6FitPSF14MANY_SATURATEDE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>There were too many saturated pixels in the source. </p>
</dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N6FitPSF16NUM_DROP_REASONSE">
<span class="target" id="group__FitPSF_1ggaf322f512b63bfe334b817be88e6c7820a5c9becf693d8a26c091e0cd2befe8574"></span><code class="descname">NUM_DROP_REASONS</code><a class="headerlink" href="#_CPPv2N6FitPSF16NUM_DROP_REASONSE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>How many reasons are there to drop sources. </p>
</dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N6FitPSF11NOT_DROPPEDE">
<span class="target" id="group__FitPSF_1ggaf322f512b63bfe334b817be88e6c7820a7e5d682d2cee5bfa3b378fcb4f73e9dc"></span><code class="descname">NOT_DROPPED</code> = NUM_DROP_REASONS<a class="headerlink" href="#_CPPv2N6FitPSF11NOT_DROPPEDE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The source was not dropped. </p>
</dd></dl>

</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSFlsERNSt7ostreamERK16SourceDropReason">
<span id="FitPSF::lshift-operator__osR.SourceDropReasonCR"></span><span class="target" id="Common_8cpp_1a561f639ef4df8fa2c937c5453400247a"></span>std::ostream &amp;<code class="descname">operator&lt;&lt;</code><span class="sig-paren">(</span>std::ostream &amp;<em>os</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF16SourceDropReasonE" title="FitPSF::SourceDropReason">SourceDropReason</a> &amp;<em>reason</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSFlsERNSt7ostreamERK16SourceDropReason" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Human readable output of the reasons to drop sources. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">os</span></code>: The stream to write to. </li>
<li><code class="docutils literal"><span class="pre">reason</span></code>: The reson for dropping the source to describe. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF14add_new_sourceER5ImageI12LinearSourceEPKN4Core11SubPixelMapERKN3PSF16PiecewiseBicubicEddRKNSt6stringEbRKN4Core14SourceLocationERKN10Background6SourceE6size_tR16LinearSourceList">
<span id="FitPSF::add_new_source__Image:LinearSource:R.Core::SubPixelMapCP.PSF::PiecewiseBicubicCR.double.double.ssCR.b.Core::SourceLocationCR.Background::SourceCR.s.LinearSourceListR"></span><span class="target" id="Common_8cpp_1a6ecf1533f885d36466aa0703308b0ab8"></span>void <code class="descname">add_new_source</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF5ImageE" title="FitPSF::Image">Image</a>&lt;<a class="reference internal" href="#_CPPv2N6FitPSF12LinearSourceE" title="FitPSF::LinearSource">LinearSource</a>&gt; &amp;<em>image</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> *<em>subpix_map</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF16PiecewiseBicubicE" title="PSF::PiecewiseBicubic">PiecewiseBicubic</a> &amp;<em>psf</em>, double <em>alpha</em>, double <em>max_circular_aperture</em>, <em class="property">const</em> std::string &amp;<em>output_fname</em>, bool <em>cover_psf</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core14SourceLocationE" title="Core::SourceLocation">SourceLocation</a> &amp;<em>location</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> &amp;<em>srcbg</em>, size_t <em>source_assignment_id</em>, <a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>destination</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF14add_new_sourceER5ImageI12LinearSourceEPKN4Core11SubPixelMapERKN3PSF16PiecewiseBicubicEddRKNSt6stringEbRKN4Core14SourceLocationERKN10Background6SourceE6size_tR16LinearSourceList" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Add a newly constructed PiecewiseBidcubic source to a list. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">image</span></code>: See same name argument to <a class="reference internal" href="#Common_8h_1a7dbaccbfd8b6981f9ce73bca215bfa25"><span class="std std-ref">get_fit_sources()</span></a>. </li>
<li><code class="docutils literal"><span class="pre">subpix_map</span></code>: See same name argument to <a class="reference internal" href="#Common_8h_1a7dbaccbfd8b6981f9ce73bca215bfa25"><span class="std std-ref">get_fit_sources()</span></a>. </li>
<li><code class="docutils literal"><span class="pre">psf</span></code>: See same name argument to <a class="reference internal" href="#Common_8h_1a7dbaccbfd8b6981f9ce73bca215bfa25"><span class="std std-ref">get_fit_sources()</span></a>. </li>
<li><code class="docutils literal"><span class="pre">alpha</span></code>: See same name argument to <a class="reference internal" href="#Common_8h_1a7dbaccbfd8b6981f9ce73bca215bfa25"><span class="std std-ref">get_fit_sources()</span></a>. </li>
<li><code class="docutils literal"><span class="pre">max_circular_aperture</span></code>: See same name argument to <a class="reference internal" href="#Common_8h_1a7dbaccbfd8b6981f9ce73bca215bfa25"><span class="std std-ref">get_fit_sources()</span></a>. </li>
<li><code class="docutils literal"><span class="pre">output_fname</span></code>: See same name argument to <a class="reference internal" href="#Common_8h_1a7dbaccbfd8b6981f9ce73bca215bfa25"><span class="std std-ref">get_fit_sources()</span></a>. </li>
<li><code class="docutils literal"><span class="pre">cover_psf</span></code>: See same name argument to <a class="reference internal" href="#Common_8h_1a7dbaccbfd8b6981f9ce73bca215bfa25"><span class="std std-ref">get_fit_sources()</span></a>. </li>
<li><code class="docutils literal"><span class="pre">location</span></code>: The location of the source to add. </li>
<li><code class="docutils literal"><span class="pre">srcbg</span></code>: The backgruond to assume under the source. </li>
<li><code class="docutils literal"><span class="pre">source_assignment_id</span></code>: The source assignment ID of the new source. </li>
<li><code class="docutils literal"><span class="pre">destination</span></code>: The list to which to add the new source. </li>
</ul>
</dd>
</dl>
</p>
<p>See get_fit_sources for descrption of undocumented arguments. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF16check_fit_sourceER11SOURCE_TYPERKN10Background6SourceEdjjdjb">
<span id="FitPSF::check_fit_source__SOURCE_TYPER.Background::SourceCR.double.unsigned.unsigned.double.unsigned.b"></span><em class="property">template </em>&lt;<em class="property">class</em> SOURCE_TYPE&gt;<br /><span class="target" id="Common_8h_1a5f506458d5dccf37ce0f49edd2004d86"></span>void <code class="descname">check_fit_source</code><span class="sig-paren">(</span>SOURCE_TYPE &amp;<em>last_source</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> &amp;<em>srcbg</em>, double <em>max_saturated_fraction</em>, unsigned <em>min_pixels_per_source</em>, unsigned <em>max_pixels_per_source</em>, double <em>max_circular_aperture</em>, unsigned <em>min_bg_pixels</em>, bool <em>ignore_overlaps</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF16check_fit_sourceER11SOURCE_TYPERKN10Background6SourceEdjjdjb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Checks of whether a source should be used for PSF fitting. </p>
<p>See get_fit_sources for a description of the arguments. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF27drop_unsuitable_fit_sourcesERNSt4listIP15FIT_SOURCE_TYPEEENSt4listIP15FIT_SOURCE_TYPEE8iteratorERNSt4listIP15FIT_SOURCE_TYPEEEA_j">
<span id="FitPSF::drop_unsuitable_fit_sources__std::list:FIT_SOURCE_TYPEP:R.std::list:FIT_SOURCE_TYPEP:::iterator.std::list:FIT_SOURCE_TYPEP:R.unsignedA"></span><em class="property">template </em>&lt;<em class="property">class</em> FIT_SOURCE_TYPE&gt;<br /><span class="target" id="Common_8h_1a85d42a1dc455617700fca43a63501136"></span>void <code class="descname">drop_unsuitable_fit_sources</code><span class="sig-paren">(</span>std::list&lt;FIT_SOURCE_TYPE *&gt; &amp;<em>psf_fit_sources</em>, <em class="property">typename</em> std::list&lt;FIT_SOURCE_TYPE *&gt;::iterator <em>check_start</em>, std::list&lt;FIT_SOURCE_TYPE *&gt; &amp;<em>dropped_sources</em>, unsigned <em>drop_statistics</em>[]<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF27drop_unsuitable_fit_sourcesERNSt4listIP15FIT_SOURCE_TYPEEENSt4listIP15FIT_SOURCE_TYPEE8iteratorERNSt4listIP15FIT_SOURCE_TYPEEEA_j" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Actually discard sources flagged as unsuitable during pixel selection. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">psf_fit_sources</span></code>: The list of sources to check. </li>
<li><code class="docutils literal"><span class="pre">check_start</span></code>: The first newly extracted source in the above list. </li>
<li><code class="docutils literal"><span class="pre">dropped_sources</span></code>: See get_fit_sources. </li>
<li><code class="docutils literal"><span class="pre">drop_statistics</span></code>: An output array filled with how many sources were dropped for each drop reason. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF16trim_fit_sourcesERNSt4listIP15FIT_SOURCE_TYPEEEjRNSt4listIP15FIT_SOURCE_TYPEEE">
<span id="FitPSF::trim_fit_sources__std::list:FIT_SOURCE_TYPEP:R.unsigned.std::list:FIT_SOURCE_TYPEP:R"></span><em class="property">template </em>&lt;<em class="property">class</em> FIT_SOURCE_TYPE&gt;<br /><span class="target" id="Common_8h_1a77c6c4738a354472292906cde7c05a59"></span>void <code class="descname">trim_fit_sources</code><span class="sig-paren">(</span>std::list&lt;FIT_SOURCE_TYPE *&gt; &amp;<em>psf_fit_sources</em>, unsigned <em>max_sources</em>, std::list&lt;FIT_SOURCE_TYPE *&gt; &amp;<em>dropped_sources</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF16trim_fit_sourcesERNSt4listIP15FIT_SOURCE_TYPEEEjRNSt4listIP15FIT_SOURCE_TYPEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Drop excess sources from PSF shape fitting. </p>
<p>See get_fit_sources for a description of the arguments. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF15get_fit_sourcesER5ImageI15FIT_SOURCE_TYPEEPKN4Core11SubPixelMapERKNSt4listIN4Core14SourceLocationEEERK8PSF_TYPEddjjRN10Background7MeasureEjjdRKNSt6stringERNSt4listIP15FIT_SOURCE_TYPEEERNSt4listIP15FIT_SOURCE_TYPEEEbbb">
<span id="FitPSF::get_fit_sources__Image:FIT_SOURCE_TYPE:R.Core::SubPixelMapCP.std::list:Core::SourceLocation:CR.PSF_TYPECR.double.double.unsigned.unsigned.Background::MeasureR.unsigned.unsigned.double.ssCR.std::list:FIT_SOURCE_TYPEP:R.std::list:FIT_SOURCE_TYPEP:R.b.b.b"></span><em class="property">template </em>&lt;<em class="property">class</em> FIT_SOURCE_TYPE, <em class="property">class</em> PSF_TYPE&gt;<br /><span class="target" id="Common_8h_1a7dbaccbfd8b6981f9ce73bca215bfa25"></span>void <code class="descname">get_fit_sources</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF5ImageE" title="FitPSF::Image">Image</a>&lt;FIT_SOURCE_TYPE&gt; &amp;<em>image</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> *<em>subpix_map</em>, <em class="property">const</em> std::list&lt;<a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core14SourceLocationE" title="Core::SourceLocation">SourceLocation</a>&gt; &amp;<em>source_locations</em>, <em class="property">const</em> PSF_TYPE &amp;<em>psf</em>, double <em>alpha</em>, double <em>max_saturated_fraction</em>, unsigned <em>min_pixels_per_source</em>, unsigned <em>max_pixels_per_source</em>, <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background7MeasureE" title="Background::Measure">Measure</a> &amp;<em>bg</em>, unsigned <em>min_bg_pixels</em>, unsigned <em>max_sources</em>, double <em>max_circular_aperture</em>, <em class="property">const</em> std::string &amp;<em>output_fname</em>, std::list&lt;FIT_SOURCE_TYPE *&gt; &amp;<em>psf_fit_sources</em>, std::list&lt;FIT_SOURCE_TYPE *&gt; &amp;<em>dropped_sources</em>, bool <em>cover_psf</em> = false, bool <em>do_not_drop</em> = false, bool <em>ignore_overlaps</em> = true<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF15get_fit_sourcesER5ImageI15FIT_SOURCE_TYPEEPKN4Core11SubPixelMapERKNSt4listIN4Core14SourceLocationEEERK8PSF_TYPEddjjRN10Background7MeasureEjjdRKNSt6stringERNSt4listIP15FIT_SOURCE_TYPEEERNSt4listIP15FIT_SOURCE_TYPEEEbbb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Select the sources to use for PSF fitting. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">image</span></code>: The image being processed. Should be a reference to the exact same variable for all sources in a single image! </li>
<li><code class="docutils literal"><span class="pre">subpix_map</span></code>: The sub-pixel sensitivity map to assume. Must not be destroyed while this object is in use. </li>
<li><code class="docutils literal"><span class="pre">source_locations</span></code>: The cental PSF coordinates of the sources in the image. </li>
<li><code class="docutils literal"><span class="pre">psf</span></code>: The PSF to assume for the sources. Obviously parameters cannot be correctly set-up since those are being fitted, but should have the correct structure (i.e. grid for piecewis PSFs). </li>
<li><code class="docutils literal"><span class="pre">alpha</span></code>: The minimum S/N threshold to considering a pixel above the background </li>
<li><code class="docutils literal"><span class="pre">max_saturated_fraction</span></code>: The maximum fraction of saturated pixels for a source to be used. </li>
<li><code class="docutils literal"><span class="pre">min_pixels_per_source</span></code>: The minimum number of pixels a source must have to be used. </li>
<li><code class="docutils literal"><span class="pre">max_pixels_per_source</span></code>: The maximum number of pixels allowed before excluding a source. </li>
<li><code class="docutils literal"><span class="pre">bg</span></code>: The background estimate of the sources. </li>
<li><code class="docutils literal"><span class="pre">min_bg_pixels</span></code>: The minimum number of pixels required in the background determination. </li>
<li><code class="docutils literal"><span class="pre">max_sources</span></code>: The largest number of sources allowed in the final list. </li>
<li><code class="docutils literal"><span class="pre">max_circular_aperture</span></code>: If source pixels outside this radius are found, the source is excluded </li>
<li><code class="docutils literal"><span class="pre">output_fname</span></code>: The name of the file where this source should be saved after the fit. </li>
<li><code class="docutils literal"><span class="pre">psf_fit_sources</span></code>: The output list of sources selected for PSF shape fitting. </li>
<li><code class="docutils literal"><span class="pre">dropped_sources</span></code>: The output list of sources rejected from the shape fit. </li>
<li><code class="docutils literal"><span class="pre">cover_psf</span></code>: If true, any pixel which even partially overlaps with the PSF gets included. Otherwise, pixels are assigned by signal to noise (optionally filling up a circular aperture). This must be false for </li>
<li><code class="docutils literal"><span class="pre">do_not_drop</span></code>: Do not drop any sources from PSF fitting (only used for zero PSF fit at the moment). </li>
<li><code class="docutils literal"><span class="pre">ignore_overlaps</span></code>: If false, any source which even partially overlaps with another is dropped from the fit. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF23get_section_fit_sourcesER5ImageI15FIT_SOURCE_TYPEERK6ConfigRK9IOSourcesRN10Background7MeasureERKN4Core11SubPixelMapERK8PSF_TYPERNSt4listIP15FIT_SOURCE_TYPEEERNSt4listIP15FIT_SOURCE_TYPEEE">
<span id="FitPSF::get_section_fit_sources__Image:FIT_SOURCE_TYPE:R.ConfigCR.IOSourcesCR.Background::MeasureR.Core::SubPixelMapCR.PSF_TYPECR.std::list:FIT_SOURCE_TYPEP:R.std::list:FIT_SOURCE_TYPEP:R"></span><em class="property">template </em>&lt;<em class="property">class</em> FIT_SOURCE_TYPE, <em class="property">class</em> PSF_TYPE&gt;<br /><span class="target" id="Common_8h_1a783aacdcc07a03202be9bba3731de75f"></span>void <code class="descname">get_section_fit_sources</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF5ImageE" title="FitPSF::Image">Image</a>&lt;FIT_SOURCE_TYPE&gt; &amp;<em>image</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF6ConfigE" title="FitPSF::Config">Config</a> &amp;<em>options</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF9IOSourcesE" title="FitPSF::IOSources">IOSources</a> &amp;<em>source_list</em>, <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background7MeasureE" title="Background::Measure">Measure</a> &amp;<em>backgrounds</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> &amp;<em>subpix_map</em>, <em class="property">const</em> PSF_TYPE &amp;<em>psf</em>, std::list&lt;FIT_SOURCE_TYPE *&gt; &amp;<em>fit_sources</em>, std::list&lt;FIT_SOURCE_TYPE *&gt; &amp;<em>dropped_sources</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF23get_section_fit_sourcesER5ImageI15FIT_SOURCE_TYPEERK6ConfigRK9IOSourcesRN10Background7MeasureERKN4Core11SubPixelMapERK8PSF_TYPERNSt4listIP15FIT_SOURCE_TYPEEERNSt4listIP15FIT_SOURCE_TYPEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Find the source to use for PSF fitting for a single input image. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">image</span></code>: The image where fit pixels are being tracked. </li>
<li><code class="docutils literal"><span class="pre">options</span></code>: The configuration with which to perform PSF fitting. </li>
<li><code class="docutils literal"><span class="pre">source_list</span></code>: The sources in the image, location and all variables requried for PSF fitting. </li>
<li><code class="docutils literal"><span class="pre">backgrounds</span></code>: The measured background for the image sources. </li>
<li><code class="docutils literal"><span class="pre">subpix_map</span></code>: The sub-pixel sensitivity map to assume. </li>
<li><code class="docutils literal"><span class="pre">psf</span></code>: See same name argument to get_fit_sources. </li>
<li><code class="docutils literal"><span class="pre">fit_sources</span></code>: See same name argument to get_fit_sources. </li>
<li><code class="docutils literal"><span class="pre">dropped_sources</span></code>: See same name argument to get_fit_sources. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF19add_expansion_termsERK9IOSourcesRKNSt6stringER16SOURCE_LIST_TYPER16SOURCE_LIST_TYPE">
<span id="FitPSF::add_expansion_terms__IOSourcesCR.ssCR.SOURCE_LIST_TYPER.SOURCE_LIST_TYPER"></span><em class="property">template </em>&lt;<em class="property">class</em> SOURCE_LIST_TYPE&gt;<br /><span class="target" id="Common_8h_1a09bced7834f5c96802ea8d802112cc7a"></span>void <code class="descname">add_expansion_terms</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF9IOSourcesE" title="FitPSF::IOSources">IOSources</a> &amp;<em>source_list</em>, <em class="property">const</em> std::string &amp;<em>expansion_term_expression</em>, SOURCE_LIST_TYPE &amp;<em>fit_sources</em>, SOURCE_LIST_TYPE &amp;<em>dropped_sources</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF19add_expansion_termsERK9IOSourcesRKNSt6stringER16SOURCE_LIST_TYPER16SOURCE_LIST_TYPE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>For each selected and dropped source subject to PSF fitting, add the terms the PSF is allowed to depend on. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">source_list</span></code>: A list of the source locations within the image. </li>
<li><code class="docutils literal"><span class="pre">expansion_term_expression</span></code>: The expression giving the PSF dependence on source variables. </li>
<li><code class="docutils literal"><span class="pre">fit_sources</span></code>: The sources which will participate in the shape fit. </li>
<li><code class="docutils literal"><span class="pre">dropped_sources</span></code>: The sources discarded from the shape fit. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF16sourceid_not_hatEPKN4Core14SourceLocationE">
<span id="FitPSF::sourceid_not_hat__Core::SourceLocationCP"></span><span class="target" id="Common_8h_1a48a7978e311520cf43573b3ef5ec74c1"></span>bool <code class="descname">sourceid_not_hat</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core14SourceLocationE" title="Core::SourceLocation">SourceLocation</a> *<em>source</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF16sourceid_not_hatEPKN4Core14SourceLocationE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>True if and only if the given source is not identified by a HAT ID. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF28fill_output_data_tree_commonERK16SOURCE_LIST_TYPERN2IO12H5IODataTreeEd">
<span id="FitPSF::fill_output_data_tree_common__SOURCE_LIST_TYPECR.IO::H5IODataTreeR.double"></span><em class="property">template </em>&lt;<em class="property">class</em> SOURCE_LIST_TYPE&gt;<br /><span class="target" id="Common_8h_1a1dad75399f74c0531081f9c4a039dca5"></span>void <code class="descname">fill_output_data_tree_common</code><span class="sig-paren">(</span><em class="property">const</em> SOURCE_LIST_TYPE &amp;<em>fit_result</em>, <a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>output_data_tree</em>, double <em>mag_1adu</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF28fill_output_data_tree_commonERK16SOURCE_LIST_TYPERN2IO12H5IODataTreeEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Creates an output data tree with information common to all PSF models. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fit_result</span></code>: The sources fitted for PSF. </li>
<li><code class="docutils literal"><span class="pre">output_data_tree</span></code>: The tree to fill. </li>
<li><code class="docutils literal"><span class="pre">mag_1adu</span></code>: The magnitude that corresponds to a flux of 1ADU. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF29compare_source_assignment_idsEPK11SOURCE_TYPEPK11SOURCE_TYPE">
<span id="FitPSF::compare_source_assignment_ids__SOURCE_TYPECP.SOURCE_TYPECP"></span><em class="property">template </em>&lt;<em class="property">class</em> SOURCE_TYPE&gt;<br /><span class="target" id="Common_8h_1aa97cde81a2041ea839314183cf93bf7d"></span>bool <code class="descname">compare_source_assignment_ids</code><span class="sig-paren">(</span><em class="property">const</em> SOURCE_TYPE *<em>s1</em>, <em class="property">const</em> SOURCE_TYPE *<em>s2</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF29compare_source_assignment_idsEPK11SOURCE_TYPEPK11SOURCE_TYPE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>True if and only if the ID of s1 is less than the ID of s2. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF19prepare_fit_sourcesERKN6FitPSF6ConfigERNSt4listIP15FIT_SOURCE_TYPEEERNSt4listIP15FIT_SOURCE_TYPEEERjRjRKN4Core11SubPixelMapERK8PSF_TYPERN2IO12H5IODataTreeE">
<span id="FitPSF::prepare_fit_sources__FitPSF::ConfigCR.std::list:FIT_SOURCE_TYPEP:R.std::list:FIT_SOURCE_TYPEP:R.unsignedR.unsignedR.Core::SubPixelMapCR.PSF_TYPECR.IO::H5IODataTreeR"></span><em class="property">template </em>&lt;<em class="property">class</em> FIT_SOURCE_TYPE, <em class="property">class</em> PSF_TYPE&gt;<br /><span class="target" id="fitpsf_8cpp_1a3308eeb8fd5174b7846d405bf6d80185"></span>std::list&lt;<a class="reference internal" href="#_CPPv26FitPSF" title="FitPSF">FitPSF</a>::<a class="reference internal" href="#_CPPv2N6FitPSF5ImageE" title="FitPSF::Image">Image</a>&lt;FIT_SOURCE_TYPE&gt; *&gt; <code class="descname">prepare_fit_sources</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv26FitPSF" title="FitPSF">FitPSF</a>::<a class="reference internal" href="#_CPPv2N6FitPSF6ConfigE" title="FitPSF::Config">Config</a> &amp;<em>options</em>, std::list&lt;FIT_SOURCE_TYPE *&gt; &amp;<em>fit_sources</em>, std::list&lt;FIT_SOURCE_TYPE *&gt; &amp;<em>dropped_sources</em>, unsigned &amp;<em>x_resolution</em>, unsigned &amp;<em>y_resolution</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> &amp;<em>subpix_map</em>, <em class="property">const</em> PSF_TYPE &amp;<em>psf</em>, <a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>output_data_tree</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF19prepare_fit_sourcesERKN6FitPSF6ConfigERNSt4listIP15FIT_SOURCE_TYPEEERNSt4listIP15FIT_SOURCE_TYPEEERjRjRKN4Core11SubPixelMapERK8PSF_TYPERN2IO12H5IODataTreeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fit the PSF of all sources simultaneously assuming smooth variation with position. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">options</span></code>: The parsed command line options. </li>
<li><code class="docutils literal"><span class="pre">fit_sources</span></code>: Gets filled with the sources to use for the shape fit. </li>
<li><code class="docutils literal"><span class="pre">dropped_sources</span></code>: Gets fiiled with the sources dropped from the shape fit, still fit their amplitudes. </li>
<li><code class="docutils literal"><span class="pre">x_resolution</span></code>: Gets set to the common resolution of the input images in the x direction. </li>
<li><code class="docutils literal"><span class="pre">y_resolution</span></code>: Gets set to the common resolution of the input images in the y direction. </li>
<li><code class="docutils literal"><span class="pre">subpix_map</span></code>: The sub-pixel sensitivity map to assume. </li>
<li><code class="docutils literal"><span class="pre">psf</span></code>: A PSF that has grid that should be used for fitting. </li>
<li><code class="docutils literal"><span class="pre">output_data_tree</span></code>: The tree to fill with output data. </li>
</ul>
</dd>
</dl>
</p>
<p>Perform a global fit for the polynomial expansions of S, D and K over the image using the given sources, starting from the given initial guess if supplied. Perform an individual fit to the PSFs of each source.</p>
<p>The starting point can optionally be specified. The arguments are identical to those of global_sdk_fit(). See there for a description of each argument. Fills an output data tree from SDK fit sources. Find the sources on which PSF fitting will be performed. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF8zero_fitERKN6FitPSF6ConfigERKN4Core11SubPixelMapERN2IO12H5IODataTreeE">
<span id="FitPSF::zero_fit__FitPSF::ConfigCR.Core::SubPixelMapCR.IO::H5IODataTreeR"></span><span class="target" id="fitpsf_8cpp_1a07c066dbcc5f3aabaec488b1dfc0b243"></span>bool <code class="descname">zero_fit</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv26FitPSF" title="FitPSF">FitPSF</a>::<a class="reference internal" href="#_CPPv2N6FitPSF6ConfigE" title="FitPSF::Config">Config</a> &amp;<em>options</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> &amp;<em>subpix_map</em>, <a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>output_data_tree</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF8zero_fitERKN6FitPSF6ConfigERKN4Core11SubPixelMapERN2IO12H5IODataTreeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Does not actually fit for the PSF but sets up a constant one. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">options</span></code>: The parsed command line options. </li>
<li><code class="docutils literal"><span class="pre">subpix_map</span></code>: The sub-pixel sensitivity map to assume. </li>
<li><code class="docutils literal"><span class="pre">output_data_tree</span></code>: The data tree to fill with the results. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF21piecewise_bicubic_fitERKN6FitPSF6ConfigERKN4Core11SubPixelMapERN2IO12H5IODataTreeE">
<span id="FitPSF::piecewise_bicubic_fit__FitPSF::ConfigCR.Core::SubPixelMapCR.IO::H5IODataTreeR"></span><span class="target" id="fitpsf_8cpp_1af6f4080f1716e09ba6ac66748804694c"></span>bool <code class="descname">piecewise_bicubic_fit</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv26FitPSF" title="FitPSF">FitPSF</a>::<a class="reference internal" href="#_CPPv2N6FitPSF6ConfigE" title="FitPSF::Config">Config</a> &amp;<em>options</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> &amp;<em>subpix_map</em>, <a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>output_data_tree</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF21piecewise_bicubic_fitERKN6FitPSF6ConfigERKN4Core11SubPixelMapERN2IO12H5IODataTreeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fit an elliptical gaussian PSF model according to the command line options. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">options</span></code>: The parsed command line options. </li>
<li><code class="docutils literal"><span class="pre">subpix_map</span></code>: The sub-pixel map to assume. </li>
<li><code class="docutils literal"><span class="pre">output_data_tree</span></code>: The data tree to fill with the results of the fit. </li>
</ul>
</dd>
</dl>
</p>
<p>Fit a piecewise bicubic PSF model according to the command line options.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>True if and only if the fit successfully converged. </dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF15fill_subpix_mapERKN6FitPSF6ConfigERN4Core11SubPixelMapE">
<span id="FitPSF::fill_subpix_map__FitPSF::ConfigCR.Core::SubPixelMapR"></span><span class="target" id="fitpsf_8cpp_1a6baa6774c390331c465aface822a97d2"></span>void <code class="descname">fill_subpix_map</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv26FitPSF" title="FitPSF">FitPSF</a>::<a class="reference internal" href="#_CPPv2N6FitPSF6ConfigE" title="FitPSF::Config">Config</a> &amp;<em>options</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> &amp;<em>subpix_map</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF15fill_subpix_mapERKN6FitPSF6ConfigERN4Core11SubPixelMapE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fills the sub-pixel map to use for PSF fitting. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">options</span></code>: The parsed command line options. </li>
<li><code class="docutils literal"><span class="pre">subpix_map</span></code>: The sub-pixel map to fill. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF6outputERKN2IO12H5IODataTreeE">
<span id="FitPSF::output__IO::H5IODataTreeCR"></span><span class="target" id="fitpsf_8cpp_1af2e634ae30775bc4d021a6c0763d9d23"></span>void <code class="descname">output</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>output_data_tree</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF6outputERKN2IO12H5IODataTreeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create/fill the output files with the newly derived PSF fit. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">output_data_tree</span></code>: The information to output. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF23fill_valarray_from_listERKNSt4listIdEERNSt8valarrayIdEE">
<span id="FitPSF::fill_valarray_from_list__std::list:double:CR.std::valarray:double:R"></span><span class="target" id="IOSources_8cpp_1a1aa574012af467b4a2c111efaadacefb"></span>void <code class="descname">fill_valarray_from_list</code><span class="sig-paren">(</span><em class="property">const</em> std::list&lt;double&gt; &amp;<em>from</em>, std::valarray&lt;double&gt; &amp;<em>to</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF23fill_valarray_from_listERKNSt4listIdEERNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSFlsERNSt7ostreamERK12OverlapGroupI11SOURCE_TYPE8PSF_TYPEE">
<span id="FitPSF::lshift-operator__osR.OverlapGroup:SOURCE_TYPE.PSF_TYPE:CR"></span><em class="property">template </em>&lt;<em class="property">class</em> SOURCE_TYPE, <em class="property">class</em> PSF_TYPE&gt;<br /><span class="target" id="OverlapGroup_8h_1afd017ede8a4dcbb302e8148554fd1d4b"></span>std::ostream &amp;<code class="descname">operator&lt;&lt;</code><span class="sig-paren">(</span>std::ostream &amp;<em>os</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF12OverlapGroupE" title="FitPSF::OverlapGroup">OverlapGroup</a>&lt;SOURCE_TYPE, PSF_TYPE&gt; &amp;<em>group</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSFlsERNSt7ostreamERK12OverlapGroupI11SOURCE_TYPE8PSF_TYPEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Output a human readable description of a group of overlapping sources. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">os</span></code>: The stream to output to. </li>
<li><code class="docutils literal"><span class="pre">group</span></code>: The group to describe </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF19find_overlap_groupsERNSt4listIP11SOURCE_TYPEEERNSt4listIP11SOURCE_TYPEEERNSt4listI12OverlapGroupI11SOURCE_TYPE8PSF_TYPEEEE">
<span id="FitPSF::find_overlap_groups__std::list:SOURCE_TYPEP:R.std::list:SOURCE_TYPEP:R.std::list:OverlapGroup:SOURCE_TYPE.PSF_TYPE::R"></span><em class="property">template </em>&lt;<em class="property">class</em> SOURCE_TYPE, <em class="property">class</em> PSF_TYPE&gt;<br /><span class="target" id="OverlapGroup_8h_1a5548fb9dab21dc33860bad83a56272dc"></span>void <code class="descname">find_overlap_groups</code><span class="sig-paren">(</span>std::list&lt;SOURCE_TYPE *&gt; &amp;<em>fit_sources</em>, std::list&lt;SOURCE_TYPE *&gt; &amp;<em>dropped_sources</em>, std::list&lt;<a class="reference internal" href="#_CPPv2N6FitPSF12OverlapGroupE" title="FitPSF::OverlapGroup">OverlapGroup</a>&lt;SOURCE_TYPE, PSF_TYPE&gt;&gt; &amp;<em>overlap_groups</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF19find_overlap_groupsERNSt4listIP11SOURCE_TYPEEERNSt4listIP11SOURCE_TYPEEERNSt4listI12OverlapGroupI11SOURCE_TYPE8PSF_TYPEEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Finds groups of overlapping sources among the given source list. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fit_sources</span></code>: The current list of shape fit sources. </li>
<li><code class="docutils literal"><span class="pre">dropped_sources</span></code>: The current list of sources dropped from shape fitting. </li>
<li><code class="docutils literal"><span class="pre">overlap_groups</span></code>: On output this updated with new overlapping groups found. Each group is a list of iterators pointing to the sources in the group. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF9time_thisEKNSt6stringE">
<span id="FitPSF::time_this__ssC"></span><span class="target" id="PiecewiseBicubic_8cpp_1a87e185ed617d2648d7a1dcdfc2b3ae2f"></span>void <code class="descname">time_this</code><span class="sig-paren">(</span><em class="property">const</em> std::string = &quot;&quot;<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF9time_thisEKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF19fill_parameter_setsERKNSt6vectorIdEERKNSt6vectorIdEERNSt6vectorINSt8valarrayIdEEEE">
<span id="FitPSF::fill_parameter_sets__std::vector:double:CR.std::vector:double:CR.std::vector:std::valarray:double::R"></span><span class="target" id="PiecewiseBicubic_8cpp_1a6a9b7a6123b6c7d44ca1ae1a3b064930"></span>void <code class="descname">fill_parameter_sets</code><span class="sig-paren">(</span><em class="property">const</em> std::vector&lt;double&gt; &amp;<em>x_grid</em>, <em class="property">const</em> std::vector&lt;double&gt; &amp;<em>y_grid</em>, std::vector&lt;std::valarray&lt;double&gt;&gt; &amp;<em>parameter_sets</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF19fill_parameter_setsERKNSt6vectorIdEERKNSt6vectorIdEERNSt6vectorINSt8valarrayIdEEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Generates the vector of bicubic cell parameter sets corresponding to single PSF parameter=1 while all others=0. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x_grid</span></code>: The vertical grid boundaries defining the PSF cells. </li>
<li><code class="docutils literal"><span class="pre">y_grid</span></code>: The horizontal grid boundaries defining the PSF cells. </li>
<li><code class="docutils literal"><span class="pre">parameter_sets</span></code>: The location to fill. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF20select_basis_vectorsERKNSt6vectorINSt8valarrayIdEEEERKN3PSF16PiecewiseBicubicERN5Eigen8MatrixXdE">
<span id="FitPSF::select_basis_vectors__std::vector:std::valarray:double::CR.PSF::PiecewiseBicubicCR.Eigen::MatrixXdR"></span><span class="target" id="PiecewiseBicubic_8cpp_1a06e98dd4fd278fae466bb6bb9009cf20"></span>void <code class="descname">select_basis_vectors</code><span class="sig-paren">(</span><em class="property">const</em> std::vector&lt;std::valarray&lt;double&gt;&gt; &amp;<em>parameter_sets</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF16PiecewiseBicubicE" title="PSF::PiecewiseBicubic">PiecewiseBicubic</a> &amp;<em>psf</em>, Eigen::MatrixXd &amp;<em>basis</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF20select_basis_vectorsERKNSt6vectorINSt8valarrayIdEEEERKN3PSF16PiecewiseBicubicERN5Eigen8MatrixXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Selects basis vectors in which the PSF will be decomposed, as well as the full PSF integral vector. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">parameter_sets</span></code>: The sets of parameters returned by fill_parameter_sets(). </li>
<li><code class="docutils literal"><span class="pre">psf</span></code>: A PSF with the correct grid of cells. </li>
<li><code class="docutils literal"><span class="pre">basis</span></code>: The matrix to fill. The first column will be <span class="math">\(\mathbf{I}/I^2\)</span>, and subsequent columns will be the basis vectors. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF25fill_basis_parameter_setsERKNSt6vectorINSt8valarrayIdEEEERN5Eigen8MatrixXdERNSt6vectorINSt8valarrayIdEEEE">
<span id="FitPSF::fill_basis_parameter_sets__std::vector:std::valarray:double::CR.Eigen::MatrixXdR.std::vector:std::valarray:double::R"></span><span class="target" id="PiecewiseBicubic_8cpp_1a2e92ac9b9868ace721ba3d7036f300a6"></span>void <code class="descname">fill_basis_parameter_sets</code><span class="sig-paren">(</span><em class="property">const</em> std::vector&lt;std::valarray&lt;double&gt;&gt; &amp;<em>parameter_sets</em>, Eigen::MatrixXd &amp;<em>basis</em>, std::vector&lt;std::valarray&lt;double&gt;&gt; &amp;<em>basis_parameter_sets</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF25fill_basis_parameter_setsERKNSt6vectorINSt8valarrayIdEEEERN5Eigen8MatrixXdERNSt6vectorINSt8valarrayIdEEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF25prepare_linear_regressionER16LinearSourceListR16LinearSourceListRKNSt6vectorINSt8valarrayIdEEEERN5Eigen8VectorXdERN5Eigen8MatrixXdERN5Eigen8VectorXdERN5Eigen8MatrixXdERN5Eigen8VectorXdERN5Eigen8VectorXdE">
<span id="FitPSF::prepare_linear_regression__LinearSourceListR.LinearSourceListR.std::vector:std::valarray:double::CR.Eigen::VectorXdR.Eigen::MatrixXdR.Eigen::VectorXdR.Eigen::MatrixXdR.Eigen::VectorXdR.Eigen::VectorXdR"></span><span class="target" id="PiecewiseBicubic_8cpp_1ad0ae581b7498385b4fb9af2533fa8e38"></span>void <code class="descname">prepare_linear_regression</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em>, <a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>dropped_sources</em>, <em class="property">const</em> std::vector&lt;std::valarray&lt;double&gt;&gt; &amp;<em>basis_parameter_sets</em>, Eigen::VectorXd &amp;<em>pixel_excesses</em>, Eigen::MatrixXd &amp;<em>pixel_integral_matrix</em>, Eigen::VectorXd &amp;<em>rhs_offset</em>, Eigen::MatrixXd &amp;<em>symmetrized_pix_integral_matrix</em>, Eigen::VectorXd &amp;<em>modified_pixel_excesses</em>, Eigen::VectorXd &amp;<em>modified_rhs_offset</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF25prepare_linear_regressionER16LinearSourceListR16LinearSourceListRKNSt6vectorINSt8valarrayIdEEEERN5Eigen8VectorXdERN5Eigen8MatrixXdERN5Eigen8VectorXdERN5Eigen8MatrixXdERN5Eigen8VectorXdERN5Eigen8VectorXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF21fill_poly_coef_matrixERK16LinearSourceListRN5Eigen8MatrixXdE">
<span id="FitPSF::fill_poly_coef_matrix__LinearSourceListCR.Eigen::MatrixXdR"></span><span class="target" id="PiecewiseBicubic_8cpp_1ab6ddc3cbae4eabcb4e76ba5085fea8c5"></span>void <code class="descname">fill_poly_coef_matrix</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em>, Eigen::MatrixXd &amp;<em>poly_coef_matrix</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF21fill_poly_coef_matrixERK16LinearSourceListRN5Eigen8MatrixXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fills a stack of matrices, containing the outer product of the PSF terms for each source. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fit_sources</span></code>: The input list of sources. </li>
<li><code class="docutils literal"><span class="pre">poly_coef_matrix</span></code>: The location to fill with the result. Should have the correct dimensions on input. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF21fill_matrix_to_invertERK16LinearSourceListRKN5Eigen8MatrixXdERKN5Eigen8MatrixXdERN5Eigen8MatrixXdE">
<span id="FitPSF::fill_matrix_to_invert__LinearSourceListCR.Eigen::MatrixXdCR.Eigen::MatrixXdCR.Eigen::MatrixXdR"></span><span class="target" id="PiecewiseBicubic_8cpp_1ab154fed2637185fbd5322ad4db9fa059"></span>void <code class="descname">fill_matrix_to_invert</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em>, <em class="property">const</em> Eigen::MatrixXd &amp;<em>symmetrized_pix_integral_matrix</em>, <em class="property">const</em> Eigen::MatrixXd &amp;<em>poly_coef_matrix</em>, Eigen::MatrixXd &amp;<em>matrix_to_invert</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF21fill_matrix_to_invertERK16LinearSourceListRKN5Eigen8MatrixXdERKN5Eigen8MatrixXdERN5Eigen8MatrixXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fills the matrix defining the equations of the linear regression for the full psf expansion. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fit_sources</span></code>: The input list of sources. </li>
<li><code class="docutils literal"><span class="pre">symmetrized_pix_integral_matrix</span></code>: See the argument with the same name in prepare_linear_regression. </li>
<li><code class="docutils literal"><span class="pre">poly_coef_matrix</span></code>: The result produced by fill_poly_coef_matrix. </li>
<li><code class="docutils literal"><span class="pre">matrix_to_invert</span></code>: The location to fill with the result. Should have the correct </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF29fill_flux_scaled_modified_rhsERK16LinearSourceListRKN5Eigen8VectorXdERKN5Eigen8VectorXdERN5Eigen8VectorXdE">
<span id="FitPSF::fill_flux_scaled_modified_rhs__LinearSourceListCR.Eigen::VectorXdCR.Eigen::VectorXdCR.Eigen::VectorXdR"></span><span class="target" id="PiecewiseBicubic_8cpp_1ad28c36cc0b8d11fdeb5ed1a16f2a18b3"></span>void <code class="descname">fill_flux_scaled_modified_rhs</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em>, <em class="property">const</em> Eigen::VectorXd &amp;<em>modified_pixel_excesses</em>, <em class="property">const</em> Eigen::VectorXd &amp;<em>modified_rhs_offset</em>, Eigen::VectorXd &amp;<em>flux_scaled_modified_rhs</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF29fill_flux_scaled_modified_rhsERK16LinearSourceListRKN5Eigen8VectorXdERKN5Eigen8VectorXdERN5Eigen8VectorXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fills a vector with the final RHS that should be used for the linear regression of the PSF parameter expansion fit. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fit_sources</span></code>: The input list of sources. </li>
<li><code class="docutils literal"><span class="pre">modified_pixel_excesses</span></code>: See the argument with the same name in prepare_linear_regression. </li>
<li><code class="docutils literal"><span class="pre">modified_rhs_offset</span></code>: See the argument with the same name in prepare_linear_regression. </li>
<li><code class="docutils literal"><span class="pre">flux_scaled_modified_rhs</span></code>: The location to fill with the result. Should have the correct dimensions and be zero on input. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF27estimate_initial_amplitudesER16LinearSourceListd">
<span id="FitPSF::estimate_initial_amplitudes__LinearSourceListR.double"></span><span class="target" id="PiecewiseBicubic_8cpp_1a44c80c121d5cea671cf55a8e72e4cf73"></span>void <code class="descname">estimate_initial_amplitudes</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em>, double <em>gain</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF27estimate_initial_amplitudesER16LinearSourceListd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Provides initial guesses for the amplitudes of the input sources. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fit_sources</span></code>: The input list of sources. On output has the amplitudes set to their estimated values. </li>
<li><code class="docutils literal"><span class="pre">gain</span></code>: The gain of the input image. </li>
</ul>
</dd>
</dl>
</p>
<p>Amplitudes are estimated by summing up all pixel values. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF27estimate_initial_amplitudesER16LinearSourceListR16OverlapGroupListRKN3PSF19PiecewiseBicubicMapE">
<span id="FitPSF::estimate_initial_amplitudes__LinearSourceListR.OverlapGroupListR.PSF::PiecewiseBicubicMapCR"></span><span class="target" id="PiecewiseBicubic_8cpp_1a0bf42ddc644cbcc55c500d743a70faaa"></span>void <code class="descname">estimate_initial_amplitudes</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em>, <a class="reference internal" href="#_CPPv2N6FitPSF16OverlapGroupListE" title="FitPSF::OverlapGroupList">OverlapGroupList</a> &amp;<em>overlap_groups</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF19PiecewiseBicubicMapE" title="PSF::PiecewiseBicubicMap">PiecewiseBicubicMap</a> &amp;<em>psf_map</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF27estimate_initial_amplitudesER16LinearSourceListR16OverlapGroupListRKN3PSF19PiecewiseBicubicMapE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Use the given PSF map to estimate initial fluxes for the sources. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF27estimate_initial_amplitudesER16LinearSourceListRKN4Core11SubPixelMapERKN4Core5ImageIdEEdd">
<span id="FitPSF::estimate_initial_amplitudes__LinearSourceListR.Core::SubPixelMapCR.Core::Image:double:CR.double.double"></span><span class="target" id="PiecewiseBicubic_8cpp_1ab26ca7c00c482959b0ab90aff2754349"></span>void <code class="descname">estimate_initial_amplitudes</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> &amp;<em>subpix_map</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5ImageE" title="Core::Image">Image</a>&lt;double&gt; &amp;<em>observed_image</em>, double <em>gain</em>, double <em>aperture</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF27estimate_initial_amplitudesER16LinearSourceListRKN4Core11SubPixelMapERKN4Core5ImageIdEEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Provides initial guesses for the amplitudes of the input sources. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fit_sources</span></code>: The input list of sources. On output has the amplitudes set to their estimated values. </li>
<li><code class="docutils literal"><span class="pre">subpix_map</span></code>: The sub-pixel sensitivity map. </li>
<li><code class="docutils literal"><span class="pre">observed_image</span></code>: The image on which PSF fitting is performed. </li>
<li><code class="docutils literal"><span class="pre">gain</span></code>: The gain of the input image. </li>
<li><code class="docutils literal"><span class="pre">aperture</span></code>: The aperture to use. </li>
</ul>
</dd>
</dl>
</p>
<p>Amplitudes are estimated by aperture photometry with a flat PSF but the actual sub-pixel map. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13update_fluxesER16LinearSourceListR16OverlapGroupListRKN5Eigen8VectorXdE">
<span id="FitPSF::update_fluxes__LinearSourceListR.OverlapGroupListR.Eigen::VectorXdCR"></span><span class="target" id="PiecewiseBicubic_8cpp_1af1b981e70ab8623bff27f8fff1b482be"></span>double <code class="descname">update_fluxes</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em>, <a class="reference internal" href="#_CPPv2N6FitPSF16OverlapGroupListE" title="FitPSF::OverlapGroupList">OverlapGroupList</a> &amp;<em>overlap_groups</em>, <em class="property">const</em> Eigen::VectorXd &amp;<em>best_fit</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13update_fluxesER16LinearSourceListR16OverlapGroupListRKN5Eigen8VectorXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF30fit_piecewise_bicubic_psf_stepER16LinearSourceListR16OverlapGroupListRKN5Eigen8MatrixXdERKN5Eigen8MatrixXdERKN5Eigen8VectorXdERKN5Eigen8VectorXdERK28PiecewiseBicubicPSFSmoothingRN5Eigen8VectorXdE">
<span id="FitPSF::fit_piecewise_bicubic_psf_step__LinearSourceListR.OverlapGroupListR.Eigen::MatrixXdCR.Eigen::MatrixXdCR.Eigen::VectorXdCR.Eigen::VectorXdCR.PiecewiseBicubicPSFSmoothingCR.Eigen::VectorXdR"></span><span class="target" id="PiecewiseBicubic_8cpp_1a89390a0e2ecfbbe9438a8d182c6fca4d"></span>double <code class="descname">fit_piecewise_bicubic_psf_step</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em>, <a class="reference internal" href="#_CPPv2N6FitPSF16OverlapGroupListE" title="FitPSF::OverlapGroupList">OverlapGroupList</a> &amp;<em>overlap_groups</em>, <em class="property">const</em> Eigen::MatrixXd &amp;<em>symmetrized_pix_integral_matrix</em>, <em class="property">const</em> Eigen::MatrixXd &amp;<em>poly_coef_matrix</em>, <em class="property">const</em> Eigen::VectorXd &amp;<em>modified_pixel_excesses</em>, <em class="property">const</em> Eigen::VectorXd &amp;<em>modified_rhs_offset</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothingE" title="FitPSF::PiecewiseBicubicPSFSmoothing">PiecewiseBicubicPSFSmoothing</a> &amp;<em>smoothing</em>, Eigen::VectorXd &amp;<em>best_fit</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF30fit_piecewise_bicubic_psf_stepER16LinearSourceListR16OverlapGroupListRKN5Eigen8MatrixXdERKN5Eigen8MatrixXdERKN5Eigen8VectorXdERKN5Eigen8VectorXdERK28PiecewiseBicubicPSFSmoothingRN5Eigen8VectorXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF12count_pixelsERK16LinearSourceListP6size_t">
<span id="FitPSF::count_pixels__LinearSourceListCR.sP"></span><span class="target" id="PiecewiseBicubic_8cpp_1ade93587646af23179d63e6f96dc463d2"></span>size_t <code class="descname">count_pixels</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em>, size_t *<em>max_source_pixels</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF12count_pixelsERK16LinearSourceListP6size_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Counts the total number of shape fitting pixels in all the given sources. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fit_sources</span></code>: The list of sources whose pixel counts should be summed up. </li>
<li><code class="docutils literal"><span class="pre">max_source_pixels</span></code>: If non-NULL the location pointed to by this argument is set to the number of shape fit pixels in the source with the largest number of such. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF22discard_outlier_pixelsER16LinearSourceListRKN5Eigen8MatrixXdERKN5Eigen8VectorXdERKN5Eigen8VectorXdEdRKN5Eigen8VectorXdE">
<span id="FitPSF::discard_outlier_pixels__LinearSourceListR.Eigen::MatrixXdCR.Eigen::VectorXdCR.Eigen::VectorXdCR.double.Eigen::VectorXdCR"></span><span class="target" id="PiecewiseBicubic_8cpp_1ad9b8be19532f89b97362b0ff8cc1ce96"></span>unsigned <code class="descname">discard_outlier_pixels</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em>, <em class="property">const</em> Eigen::MatrixXd &amp;<em>pixel_integral_matrix</em>, <em class="property">const</em> Eigen::VectorXd &amp;<em>pixel_excesses</em>, <em class="property">const</em> Eigen::VectorXd &amp;<em>rhs_offset</em>, double <em>max_residual</em>, <em class="property">const</em> Eigen::VectorXd &amp;<em>best_fit</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF22discard_outlier_pixelsER16LinearSourceListRKN5Eigen8MatrixXdERKN5Eigen8VectorXdERKN5Eigen8VectorXdEdRKN5Eigen8VectorXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Discards pixels with too large residuals after the last PSF fit. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fit_sources</span></code>: The sources participating in the fit. </li>
<li><code class="docutils literal"><span class="pre">pixel_integral_matrix</span></code>: See prepare_linear_regression </li>
<li><code class="docutils literal"><span class="pre">pixel_excesses</span></code>: See fill_fit_pixel_excesses. </li>
<li><code class="docutils literal"><span class="pre">rhs_offset</span></code>: See prepare_linear_regression. </li>
<li><code class="docutils literal"><span class="pre">max_residual</span></code>: If source pixels with residuals larger than this are found, they are discarded from the fit. </li>
<li><code class="docutils literal"><span class="pre">best_fit</span></code>: The current best fit polynomial expansion coefficients for the PSF parameters. </li>
</ul>
</dd>
</dl>
</p>
<p>Returns the number of pixels discarded. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF15discard_sourcesER16LinearSourceListdbR16LinearSourceList">
<span id="FitPSF::discard_sources__LinearSourceListR.double.b.LinearSourceListR"></span><span class="target" id="PiecewiseBicubic_8cpp_1a91af761d270a247a93d51ed94cbc7c38"></span>unsigned <code class="descname">discard_sources</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em>, double <em>max_chi2</em>, bool <em>discard_by_chi2</em>, <a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>dropped_sources</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF15discard_sourcesER16LinearSourceListdbR16LinearSourceList" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Discards sources unsuitable for fitting. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fit_sources</span></code>: The sources participating in the fit. </li>
<li><code class="docutils literal"><span class="pre">max_chi2</span></code>: The maximum allowed reduced chi squared before discarding. </li>
<li><code class="docutils literal"><span class="pre">discard_by_chi2</span></code>: Should sources be discarded besed on their chi squared. </li>
<li><code class="docutils literal"><span class="pre">dropped_sources</span></code>: The sources dropped from the fit. </li>
</ul>
</dd>
</dl>
</p>
<p>At least one of the following is true of the discarded sources:<ul class="simple">
<li>the flux estimate is nan or negative</li>
<li>the chi squared is too big (only if discard_by_chi2 is true).</li>
<li>less than two pixels are assigned to the source </li>
</ul>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF24discard_zero_flux_pixelsER16LinearSourceListRKN4Core11SubPixelMapERKN3PSF16PiecewiseBicubicE">
<span id="FitPSF::discard_zero_flux_pixels__LinearSourceListR.Core::SubPixelMapCR.PSF::PiecewiseBicubicCR"></span><span class="target" id="PiecewiseBicubic_8cpp_1afa849194c7af21245496723061678a40"></span>unsigned <code class="descname">discard_zero_flux_pixels</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> &amp;<em>subpix_map</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF16PiecewiseBicubicE" title="PSF::PiecewiseBicubic">PiecewiseBicubic</a> &amp;<em>psf</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF24discard_zero_flux_pixelsER16LinearSourceListRKN4Core11SubPixelMapERKN3PSF16PiecewiseBicubicE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Discards pixels whose overlap with the PSF domain has zero sub-pixel sensitivity. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fit_sources</span></code>: The sources participating in the fit. </li>
<li><code class="docutils literal"><span class="pre">subpix_map</span></code>: The sub-pixel sensitivity map. </li>
<li><code class="docutils literal"><span class="pre">psf</span></code>: A PSF with the correct grid of cells. </li>
</ul>
</dd>
</dl>
</p>
<p>Returns the number of pixels discarded. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF39transform_best_fit_to_direct_parametersERKN5Eigen8MatrixXdERN5Eigen8VectorXdE">
<span id="FitPSF::transform_best_fit_to_direct_parameters__Eigen::MatrixXdCR.Eigen::VectorXdR"></span><span class="target" id="PiecewiseBicubic_8cpp_1a878eba39338b4d82656546daf36ec835"></span>void <code class="descname">transform_best_fit_to_direct_parameters</code><span class="sig-paren">(</span><em class="property">const</em> Eigen::MatrixXd &amp;<em>basis</em>, Eigen::VectorXd &amp;<em>best_fit_poly_coef</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF39transform_best_fit_to_direct_parametersERKN5Eigen8MatrixXdERN5Eigen8VectorXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">basis</span></code>: The matrix of basis vectors used when solving </li>
<li><code class="docutils literal"><span class="pre">best_fit_poly_coef</span></code>: The best fit coefficients in the above basis. Overwritten on output! </li>
</ul>
</dd>
</dl>
</p>
<p>Transforms a set of best fit coefficients from some basis to directly expressing the spatial dependence of PSF parameters. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF19convert_flux_to_aduER16LinearSourceListd">
<span id="FitPSF::convert_flux_to_adu__LinearSourceListR.double"></span><span class="target" id="PiecewiseBicubic_8cpp_1a5141488c910279d60ad23a02ade44c76"></span>void <code class="descname">convert_flux_to_adu</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>sources</em>, double <em>gain</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF19convert_flux_to_aduER16LinearSourceListd" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF25fit_piecewise_bicubic_psfER16LinearSourceListR16OverlapGroupListR16LinearSourceListRKNSt6vectorIdEERKNSt6vectorIdEERKN4Core11SubPixelMapEdddddidRN5Eigen8VectorXdEd">
<span id="FitPSF::fit_piecewise_bicubic_psf__LinearSourceListR.OverlapGroupListR.LinearSourceListR.std::vector:double:CR.std::vector:double:CR.Core::SubPixelMapCR.double.double.double.double.double.i.double.Eigen::VectorXdR.double"></span><span class="target" id="PiecewiseBicubic_8cpp_1a6bc2dd51f12b4325651053a096fd42a1"></span>bool <code class="descname">fit_piecewise_bicubic_psf</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em>, <a class="reference internal" href="#_CPPv2N6FitPSF16OverlapGroupListE" title="FitPSF::OverlapGroupList">OverlapGroupList</a> &amp;<em>overlap_groups</em>, <a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>dropped_sources</em>, <em class="property">const</em> std::vector&lt;double&gt; &amp;<em>x_grid</em>, <em class="property">const</em> std::vector&lt;double&gt; &amp;<em>y_grid</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> &amp;<em>subpix_map</em>, double <em>max_abs_amplitude_change</em>, double <em>max_rel_amplitude_change</em>, double <em>max_chi2</em>, double <em>pixel_rejection</em>, double <em>min_convergence_rate</em>, int <em>max_iterations</em>, double <em>smoothing_penalty</em>, Eigen::VectorXd &amp;<em>best_fit_poly_coef</em>, double <em>gain</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF25fit_piecewise_bicubic_psfER16LinearSourceListR16OverlapGroupListR16LinearSourceListRKNSt6vectorIdEERKNSt6vectorIdEERKN4Core11SubPixelMapEdddddidRN5Eigen8VectorXdEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>PSF fitting, but assumed that sources have their initial amplitudes set. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF25fit_piecewise_bicubic_psfER16LinearSourceListR16LinearSourceListdRKNSt6vectorIdEERKNSt6vectorIdEERKN4Core11SubPixelMapEdddddidRN5Eigen8VectorXdE">
<span id="FitPSF::fit_piecewise_bicubic_psf__LinearSourceListR.LinearSourceListR.double.std::vector:double:CR.std::vector:double:CR.Core::SubPixelMapCR.double.double.double.double.double.i.double.Eigen::VectorXdR"></span><span class="target" id="PiecewiseBicubic_8cpp_1a80386c6208fb6689e17c476e64de149b"></span>bool <code class="descname">fit_piecewise_bicubic_psf</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em>, <a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>dropped_sources</em>, double <em>gain</em>, <em class="property">const</em> std::vector&lt;double&gt; &amp;<em>x_grid</em>, <em class="property">const</em> std::vector&lt;double&gt; &amp;<em>y_grid</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> &amp;<em>subpix_map</em>, double <em>max_abs_amplitude_change</em>, double <em>max_rel_amplitude_change</em>, double <em>max_chi2</em>, double <em>pixel_rejection</em>, double <em>min_convergence_rate</em>, int <em>max_iterations</em>, double <em>smoothing_penalty</em>, Eigen::VectorXd &amp;<em>best_fit_poly_coef</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF25fit_piecewise_bicubic_psfER16LinearSourceListR16LinearSourceListdRKNSt6vectorIdEERKNSt6vectorIdEERKN4Core11SubPixelMapEdddddidRN5Eigen8VectorXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fits for the polynomials giving the values, x, y and xy derivatives describing a piecewise bicubic PSF smoothly varying over the image. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fit_sources</span></code>: The input list of sources (need to be modified to perform the fit) and on output has the amplitudes set correctly for the best fit. </li>
<li><code class="docutils literal"><span class="pre">dropped_sources</span></code>: The list of sources dropped from the fit (need to be modified to set the amplitudes correctly for the best fit). </li>
<li><code class="docutils literal"><span class="pre">gain</span></code>: The gain of the input image. </li>
<li><code class="docutils literal"><span class="pre">x_grid</span></code>: The vertical grid boundaries defining the PSF cells. </li>
<li><code class="docutils literal"><span class="pre">y_grid</span></code>: The horizontal grid boundaries defining the PSF cells. </li>
<li><code class="docutils literal"><span class="pre">subpix_map</span></code>: The sub-pixel sensitivity map. </li>
<li><code class="docutils literal"><span class="pre">max_abs_amplitude_change</span></code>: The maximum sum squared of amplitude changes allowed after a PSF/Amplitude fit iteration in order to consider the solution converged. </li>
<li><code class="docutils literal"><span class="pre">max_rel_amplitude_change</span></code>: The maximum fraction the sum squared of the amplitude changes can be of the length of the vector of amplitudes after a PSF/Amplitude fit iteration in order to consider the solution converged. </li>
<li><code class="docutils literal"><span class="pre">max_chi2</span></code>: Sources with reduced <span class="math">\(\chi^2\)</span> bigger than this are removed from the fit. </li>
<li><code class="docutils literal"><span class="pre">pixel_rejection</span></code>: Pixels whose residuals after fitting is too large are not included in the fit. This parameter determines how large the residual cut-off is. See the help of pix-rej command line option for details. </li>
<li><code class="docutils literal"><span class="pre">min_convergence_rate</span></code>: The minimum rate of convergence to require before giving up. </li>
<li><code class="docutils literal"><span class="pre">max_iterations</span></code>: The maximum number of iterations before giving up (use a negative value to disable this limit). </li>
<li><code class="docutils literal"><span class="pre">smoothing_penalty</span></code>: Smoothing penalty (see help for details). </li>
<li><code class="docutils literal"><span class="pre">best_fit_poly_coef</span></code>: On output contains the best fit polynomial coefficients. Resized as necessary. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF25fit_piecewise_bicubic_psfER16LinearSourceListR16LinearSourceListRKN3PSF19PiecewiseBicubicMapERKNSt6vectorIdEERKNSt6vectorIdEERKN4Core11SubPixelMapEdddddidRN5Eigen8VectorXdEd">
<span id="FitPSF::fit_piecewise_bicubic_psf__LinearSourceListR.LinearSourceListR.PSF::PiecewiseBicubicMapCR.std::vector:double:CR.std::vector:double:CR.Core::SubPixelMapCR.double.double.double.double.double.i.double.Eigen::VectorXdR.double"></span><span class="target" id="PiecewiseBicubic_8cpp_1a4bffe0728b8eb594355a17304537aeb2"></span>bool <code class="descname">fit_piecewise_bicubic_psf</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em>, <a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>dropped_sources</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF19PiecewiseBicubicMapE" title="PSF::PiecewiseBicubicMap">PiecewiseBicubicMap</a> &amp;<em>psf_map</em>, <em class="property">const</em> std::vector&lt;double&gt; &amp;<em>x_grid</em>, <em class="property">const</em> std::vector&lt;double&gt; &amp;<em>y_grid</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> &amp;<em>subpix_map</em>, double <em>max_abs_amplitude_change</em>, double <em>max_rel_amplitude_change</em>, double <em>max_chi2</em>, double <em>pixel_rejection</em>, double <em>min_convergence_rate</em>, int <em>max_iterations</em>, double <em>smoothing_penalty</em>, Eigen::VectorXd &amp;<em>best_fit_poly_coef</em>, double <em>gain</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF25fit_piecewise_bicubic_psfER16LinearSourceListR16LinearSourceListRKN3PSF19PiecewiseBicubicMapERKNSt6vectorIdEERKNSt6vectorIdEERKN4Core11SubPixelMapEdddddidRN5Eigen8VectorXdEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Same as above, but uses an initial PSF map to derive initial flux estimates. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fit_sources</span></code>: The input list of sources (need to be modified to perform the fit) and on output has the amplitudes set correctly for the best fit. </li>
<li><code class="docutils literal"><span class="pre">dropped_sources</span></code>: The list of sources dropped from the fit (need to be modified to set the amplitudes correctly for the best fit). </li>
<li><code class="docutils literal"><span class="pre">psf_map</span></code>: The PSF map to use in order to derive initial flux estimates. </li>
<li><code class="docutils literal"><span class="pre">x_grid</span></code>: The vertical grid boundaries defining the PSF cells. </li>
<li><code class="docutils literal"><span class="pre">y_grid</span></code>: The horizontal grid boundaries defining the PSF cells. </li>
<li><code class="docutils literal"><span class="pre">subpix_map</span></code>: The sub-pixel sensitivity map. </li>
<li><code class="docutils literal"><span class="pre">max_abs_amplitude_change</span></code>: The maximum sum squared of amplitude changes allowed after a PSF/Amplitude fit iteration in order to consider the solution converged. </li>
<li><code class="docutils literal"><span class="pre">max_rel_amplitude_change</span></code>: The maximum fraction the sum squared of the amplitude changes can be of the length of the vector of amplitudes after a PSF/Amplitude fit iteration in order to consider the solution converged. </li>
<li><code class="docutils literal"><span class="pre">max_chi2</span></code>: Sources with reduced <span class="math">\(\chi^2\)</span> bigger than this are removed from the fit. </li>
<li><code class="docutils literal"><span class="pre">pixel_rejection</span></code>: Pixels whose residuals after fitting is too large are not included in the fit. This parameter determines how large the residual cut-off is. See the help of pix-rej command line option for details. </li>
<li><code class="docutils literal"><span class="pre">min_convergence_rate</span></code>: The minimum rate of convergence to require before giving up. </li>
<li><code class="docutils literal"><span class="pre">max_iterations</span></code>: The maximum number of iterations before giving up (use a negative value to disable this limit). </li>
<li><code class="docutils literal"><span class="pre">smoothing_penalty</span></code>: Smoothing penalty (see help for details). </li>
<li><code class="docutils literal"><span class="pre">best_fit_poly_coef</span></code>: On output contains the best fit polynomial coefficients. Resized as necessary. </li>
<li><code class="docutils literal"><span class="pre">gain</span></code>: The gain of the input image. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF19fit_dropped_sourcesER16LinearSourceListRKN5Eigen8VectorXdE">
<span id="FitPSF::fit_dropped_sources__LinearSourceListR.Eigen::VectorXdCR"></span><span class="target" id="PiecewiseBicubic_8cpp_1ab58ffc356a93512a98b308a302951291"></span>void <code class="descname">fit_dropped_sources</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>dropped_sources</em>, <em class="property">const</em> Eigen::VectorXd &amp;<em>best_fit_poly_coef</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF19fit_dropped_sourcesER16LinearSourceListRKN5Eigen8VectorXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fits for the amplitudes of sources initially dropped from PSF fitting. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">dropped_sources</span></code>: The list of dropped sources. </li>
<li><code class="docutils literal"><span class="pre">best_fit_poly_coef</span></code>: the best fit polynomial coefficients produced by fit_piecewise_bicubic_psf() </li>
</ul>
</dd>
</dl>
</p>
<p>Fills in the flux, its error estimate and <span class="math">\(\chi^2\)</span>. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF19output_best_fit_psfERKN5Eigen8VectorXdERKNSt6vectorIdEERKNSt6vectorIdEERKNSt6stringE">
<span id="FitPSF::output_best_fit_psf__Eigen::VectorXdCR.std::vector:double:CR.std::vector:double:CR.ssCR"></span><span class="target" id="PiecewiseBicubic_8cpp_1a1f7a527f846b81e44bfc7722c85e40ca"></span>void <code class="descname">output_best_fit_psf</code><span class="sig-paren">(</span><em class="property">const</em> Eigen::VectorXd &amp;<em>best_fit_poly_coef</em>, <em class="property">const</em> std::vector&lt;double&gt; &amp;<em>x_grid</em>, <em class="property">const</em> std::vector&lt;double&gt; &amp;<em>y_grid</em>, <em class="property">const</em> std::string &amp;<em>fname</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF19output_best_fit_psfERKN5Eigen8VectorXdERKNSt6vectorIdEERKNSt6vectorIdEERKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Generates a file containing all the information necessary in order to reproduce the best fit PSF for any image position. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">best_fit_poly_coef</span></code>: The best fit polynomial coefficients giving the expansion of all PSF parameters as a function of image position. </li>
<li><code class="docutils literal"><span class="pre">x_grid</span></code>: The vertical grid boundaries defining the PSF cells. </li>
<li><code class="docutils literal"><span class="pre">y_grid</span></code>: The horizontal grid boundaries defining the PSF cells. </li>
<li><code class="docutils literal"><span class="pre">fname</span></code>: The name to use for the file. Overwritten if already exists. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF25fill_basis_paramater_setsERKNSt6vectorINSt8valarrayIdEEEERN5Eigen8MatrixXdERNSt6vectorINSt8valarrayIdEEEE">
<span id="FitPSF::fill_basis_paramater_sets__std::vector:std::valarray:double::CR.Eigen::MatrixXdR.std::vector:std::valarray:double::R"></span><span class="target" id="FitPSF_2PiecewiseBicubic_8h_1a5d34489edbac7dedfcb5254149160f4d"></span>void <code class="descname">fill_basis_paramater_sets</code><span class="sig-paren">(</span><em class="property">const</em> std::vector&lt;std::valarray&lt;double&gt;&gt; &amp;<em>parameter_sets</em>, Eigen::MatrixXd &amp;<em>basis</em>, std::vector&lt;std::valarray&lt;double&gt;&gt; &amp;<em>basis_parameter_sets</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF25fill_basis_paramater_setsERKNSt6vectorINSt8valarrayIdEEEERN5Eigen8MatrixXdERNSt6vectorINSt8valarrayIdEEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Generates parameter sets which correspond to the basis vectors (and full PSF integral vector) instead of to single parameters. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">parameter_sets</span></code>: The sets of parameters returned by fill_parameter_sets(). </li>
<li><code class="docutils literal"><span class="pre">basis</span></code>: The matrix of basis vectors filled by select_basis_vectors. </li>
<li><code class="docutils literal"><span class="pre">basis_parameter_sets</span></code>: The destination to fill with the new parameter sets. Should have the correct size on input, but the individual entries are automatically resized. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF25prepare_linear_regressionER16LinearSourceListRKNSt6vectorINSt8valarrayIdEEEERKN5Eigen8VectorXdERN5Eigen8MatrixXdERN5Eigen8VectorXdERN5Eigen8MatrixXdERN5Eigen8VectorXdERN5Eigen8VectorXdE">
<span id="FitPSF::prepare_linear_regression__LinearSourceListR.std::vector:std::valarray:double::CR.Eigen::VectorXdCR.Eigen::MatrixXdR.Eigen::VectorXdR.Eigen::MatrixXdR.Eigen::VectorXdR.Eigen::VectorXdR"></span><span class="target" id="FitPSF_2PiecewiseBicubic_8h_1ada17fb6f9984283c7450a04e9d4aefb2"></span>void <code class="descname">prepare_linear_regression</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em>, <em class="property">const</em> std::vector&lt;std::valarray&lt;double&gt;&gt; &amp;<em>parameter_sets</em>, <em class="property">const</em> Eigen::VectorXd &amp;<em>pixel_excesses</em>, Eigen::MatrixXd &amp;<em>pixel_integral_matrix</em>, Eigen::VectorXd &amp;<em>rhs_offset</em>, Eigen::MatrixXd &amp;<em>symmetrized_pix_integral_matrix</em>, Eigen::VectorXd &amp;<em>modified_pixel_excesses</em>, Eigen::VectorXd &amp;<em>modified_rhs_offset</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF25prepare_linear_regressionER16LinearSourceListRKNSt6vectorINSt8valarrayIdEEEERKN5Eigen8VectorXdERN5Eigen8MatrixXdERN5Eigen8VectorXdERN5Eigen8MatrixXdERN5Eigen8VectorXdERN5Eigen8VectorXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fills in the 3 output matrices and the output vector as appropriate. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fit_sources</span></code>: The input list of sources. Modified because of pixel iterations. </li>
<li><code class="docutils literal"><span class="pre">parameter_sets</span></code>: The sets of parameters returned by fill_parameter_sets(). </li>
<li><code class="docutils literal"><span class="pre">pixel_excesses</span></code>: The vector of background excess values of the source pixels. </li>
<li><code class="docutils literal"><span class="pre">pixel_integral_matrix</span></code>: A stack of matrices, one for each source, with each row consisting of the integrals over the same source pixel but with only one basis vector contributing ( <span class="math">\(\mathbf{\tilde{M}^i}\)</span> in the documentation). Should have the correct dimensions on input. </li>
<li><code class="docutils literal"><span class="pre">rhs_offset</span></code>: <span class="math">\(\mathbf{\Delta}\)</span> in the documentation. Should already have </li>
<li><code class="docutils literal"><span class="pre">symmetrized_pix_integral_matrix</span></code>: A stack of <span class="math">\((\mathbf{\tilde{M}^i})^T\mathbf{\tilde{M}^i}\)</span> ( <span class="math">\(\mathbf{\tilde{\Lambda}}\)</span> in the documentation). Should have </li>
<li><code class="docutils literal"><span class="pre">modified_pixel_excesses</span></code>: Derived from pixel_excesses by applying <span class="math">\(\left(\mathbf{\tilde{M}^i}\right)^T\)</span> on each source&#8217;s pixels. Should have the correct dimensions on input. </li>
<li><code class="docutils literal"><span class="pre">modified_rhs_offset</span></code>: <span class="math">\(\mathbf{\tilde{\Delta}}\)</span> in the documentation. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF19fill_pixel_excessesER16LinearSourceListRN5Eigen8VectorXdEb">
<span id="FitPSF::fill_pixel_excesses__LinearSourceListR.Eigen::VectorXdR.b"></span><span class="target" id="FitPSF_2PiecewiseBicubic_8h_1aad2fc9ef9b6d40a0952034122c04cb88"></span>void <code class="descname">fill_pixel_excesses</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em>, Eigen::VectorXd &amp;<em>rhs</em>, bool <em>single_source</em> = false<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF19fill_pixel_excessesER16LinearSourceListRN5Eigen8VectorXdEb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Creates the RHS vector for the PSF fitting from the pixel values of the fit sources. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fit_sources</span></code>: The input list of sources. Modified due to pixel iterations. </li>
<li><code class="docutils literal"><span class="pre">rhs</span></code>: The vector to fill. Should already have the correct size. </li>
<li><code class="docutils literal"><span class="pre">single_source</span></code>: If passed, only the first source in the list is used. This is useful when defining the RHS for groups of overlapping sources, which all share a common set of image pixels </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13update_fluxesER16LinearSourceListRKN5Eigen8VectorXdE">
<span id="FitPSF::update_fluxes__LinearSourceListR.Eigen::VectorXdCR"></span><span class="target" id="FitPSF_2PiecewiseBicubic_8h_1a4a9b91a3bea25086cbd9995fadb3ec6b"></span>double <code class="descname">update_fluxes</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em>, <em class="property">const</em> Eigen::VectorXd &amp;<em>best_fit</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13update_fluxesER16LinearSourceListRKN5Eigen8VectorXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Updates the fluxes of the fit sources with new best estimates derived by fitting each source&#8217;s background excesses. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fit_sources</span></code>: The list of sources for which to update the flux. </li>
<li><code class="docutils literal"><span class="pre">best_fit</span></code>: The current best fit polynomial expansion coefficients for the PSF parameters. </li>
</ul>
</dd>
</dl>
</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>the root sum square change of the fluxes. </dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF30fit_piecewise_bicubic_psf_stepER16LinearSourceListRKN5Eigen8MatrixXdERKN5Eigen8MatrixXdERKN5Eigen8MatrixXdERKN5Eigen8VectorXdERKN5Eigen8VectorXdERKN5Eigen8VectorXdERKN5Eigen8VectorXdERK28PiecewiseBicubicPSFSmoothingRN5Eigen8VectorXdE">
<span id="FitPSF::fit_piecewise_bicubic_psf_step__LinearSourceListR.Eigen::MatrixXdCR.Eigen::MatrixXdCR.Eigen::MatrixXdCR.Eigen::VectorXdCR.Eigen::VectorXdCR.Eigen::VectorXdCR.Eigen::VectorXdCR.PiecewiseBicubicPSFSmoothingCR.Eigen::VectorXdR"></span><span class="target" id="FitPSF_2PiecewiseBicubic_8h_1ac91ac750539747a8dca73b658b39d657"></span>double <code class="descname">fit_piecewise_bicubic_psf_step</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em>, <em class="property">const</em> Eigen::MatrixXd &amp;<em>symmetrized_pix_integral_matrix</em>, <em class="property">const</em> Eigen::MatrixXd &amp;<em>poly_coef_matrix</em>, <em class="property">const</em> Eigen::MatrixXd &amp;<em>pixel_integral_matrix</em>, <em class="property">const</em> Eigen::VectorXd &amp;<em>pixel_excesses</em>, <em class="property">const</em> Eigen::VectorXd &amp;<em>rhs_offset</em>, <em class="property">const</em> Eigen::VectorXd &amp;<em>modified_pixel_excesses</em>, <em class="property">const</em> Eigen::VectorXd &amp;<em>modified_rhs_offset</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothingE" title="FitPSF::PiecewiseBicubicPSFSmoothing">PiecewiseBicubicPSFSmoothing</a> &amp;<em>smoothing</em>, Eigen::VectorXd &amp;<em>best_fit</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF30fit_piecewise_bicubic_psf_stepER16LinearSourceListRKN5Eigen8MatrixXdERKN5Eigen8MatrixXdERKN5Eigen8MatrixXdERKN5Eigen8VectorXdERKN5Eigen8VectorXdERKN5Eigen8VectorXdERKN5Eigen8VectorXdERK28PiecewiseBicubicPSFSmoothingRN5Eigen8VectorXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Performs a single PSF parameter fit, amplitude fit iteration. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fit_sources</span></code>: The list of sources to fit. On output their fluxes are updated to the new best fit value. </li>
<li><code class="docutils literal"><span class="pre">symmetrized_pix_integral_matrix</span></code>: See prepare_linear_regression. </li>
<li><code class="docutils literal"><span class="pre">poly_coef_matrix</span></code>: See fill_poly_coef_matrix. </li>
<li><code class="docutils literal"><span class="pre">pixel_integral_matrix</span></code>: See prepare_linear_regression. </li>
<li><code class="docutils literal"><span class="pre">pixel_excesses</span></code>: See prepare_linear_regression. </li>
<li><code class="docutils literal"><span class="pre">rhs_offset</span></code>: See prepare_linear_regression. </li>
<li><code class="docutils literal"><span class="pre">modified_pixel_excesses</span></code>: See prepare_linear_regression. </li>
<li><code class="docutils literal"><span class="pre">modified_rhs_offset</span></code>: See prepare_linear_regression. </li>
<li><code class="docutils literal"><span class="pre">smoothing</span></code>: Correction to the final matrix enforcing smoothing. </li>
<li><code class="docutils literal"><span class="pre">best_fit</span></code>: Updated to a new estimate of the polynomial expansion coefficients for the PSF parameters. Should have the correct dimensions on input. </li>
</ul>
</dd>
</dl>
</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>the sum root square change of the source fluxes. </dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF9fit_groupER12OverlapGroupI12LinearSourceN3PSF16PiecewiseBicubicEERKN4Core11SubPixelMapERKN3PSF19PiecewiseBicubicMapE">
<span id="FitPSF::fit_group__OverlapGroup:LinearSource.PSF::PiecewiseBicubic:R.Core::SubPixelMapCR.PSF::PiecewiseBicubicMapCR"></span><span class="target" id="FitPSF_2PiecewiseBicubic_8h_1a216e02e75d2663e4fd89b41c8a182f92"></span>void <code class="descname">fit_group</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF12OverlapGroupE" title="FitPSF::OverlapGroup">OverlapGroup</a>&lt;<a class="reference internal" href="#_CPPv2N6FitPSF12LinearSourceE" title="FitPSF::LinearSource">LinearSource</a>, <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF16PiecewiseBicubicE" title="PSF::PiecewiseBicubic">PiecewiseBicubic</a>&gt; &amp;<em>group</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> &amp;<em>subpix_map</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF19PiecewiseBicubicMapE" title="PSF::PiecewiseBicubicMap">PiecewiseBicubicMap</a> &amp;<em>psf_map</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF9fit_groupER12OverlapGroupI12LinearSourceN3PSF16PiecewiseBicubicEERKN4Core11SubPixelMapERKN3PSF19PiecewiseBicubicMapE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Performs the combined amplitude fitting for a group of sources. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">group</span></code>: The group to fit. </li>
<li><code class="docutils literal"><span class="pre">subpix_map</span></code>: The sub-pixel sensitivity map. </li>
<li><code class="docutils literal"><span class="pre">psf_map</span></code>: The best fit PSF map. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF17background_excessEdddd">
<span id="FitPSF::background_excess__double.double.double.double"></span><span class="target" id="Pixel_8cpp_1a0cb519e4e5466fb7f63ab85a37bd8724"></span>double <code class="descname">background_excess</code><span class="sig-paren">(</span>double <em>value</em>, double <em>variance</em>, double <em>background_value</em>, double <em>background_variance</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF17background_excessEdddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return the square of the signal to noise ratio with which a pixel sticks above a background. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">value</span></code>: The value of the pixel in electrons. </li>
<li><code class="docutils literal"><span class="pre">variance</span></code>: The variance of the pixel in electrons^2 </li>
<li><code class="docutils literal"><span class="pre">background_value</span></code>: The background flux to assume in electrons. </li>
<li><code class="docutils literal"><span class="pre">background_variance</span></code>: The variance to assume for the background in electrons^2. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF17background_excessEddRKN10Background6SourceEd">
<span id="FitPSF::background_excess__double.double.Background::SourceCR.double"></span><span class="target" id="Pixel_8cpp_1af4b1acfa66b936f4e240073db43570b7"></span>double <code class="descname">background_excess</code><span class="sig-paren">(</span>double <em>value</em>, double <em>variance</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> &amp;<em>background_adu</em>, double <em>gain</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF17background_excessEddRKN10Background6SourceEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See background_excess(double, double, double, double) </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">value</span></code>: The value of the pixel in electrons. </li>
<li><code class="docutils literal"><span class="pre">variance</span></code>: The variance of the pixel in electrons^2 </li>
<li><code class="docutils literal"><span class="pre">background_adu</span></code>: The background flux to assume in ADU. </li>
<li><code class="docutils literal"><span class="pre">gain</span></code>: The gain to use when converting the background value from ADU to electrons. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF17background_excessERK5PixelI11SOURCE_TYPEEdd">
<span id="FitPSF::background_excess__Pixel:SOURCE_TYPE:CR.double.double"></span><em class="property">template </em>&lt;<em class="property">class</em> SOURCE_TYPE&gt;<br /><span class="target" id="Pixel_8h_1a27053c460716537f17f695d9ddcea75c"></span>double <code class="descname">background_excess</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF5PixelE" title="FitPSF::Pixel">Pixel</a>&lt;SOURCE_TYPE&gt; &amp;<em>pixel</em>, double <em>background_value</em>, double <em>background_variance</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF17background_excessERK5PixelI11SOURCE_TYPEEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See background_excess(double, double, dobule, double). </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">pixel</span></code>: The pixel for which to calculate the background excess. </li>
<li><code class="docutils literal"><span class="pre">background_value</span></code>: The background flux to assume in electrons. </li>
<li><code class="docutils literal"><span class="pre">background_variance</span></code>: The variance to assume for the background in electrons^2. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF17background_excessERK5PixelI11SOURCE_TYPEERKN10Background6SourceEd">
<span id="FitPSF::background_excess__Pixel:SOURCE_TYPE:CR.Background::SourceCR.double"></span><em class="property">template </em>&lt;<em class="property">class</em> SOURCE_TYPE&gt;<br /><span class="target" id="Pixel_8h_1a90d8894eaa153ebbde3d3b48fad282d0"></span>double <code class="descname">background_excess</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF5PixelE" title="FitPSF::Pixel">Pixel</a>&lt;SOURCE_TYPE&gt; &amp;<em>pixel</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> &amp;<em>background</em>, double <em>gain</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF17background_excessERK5PixelI11SOURCE_TYPEERKN10Background6SourceEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See background_excess(double, double, double, double). </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">pixel</span></code>: The pixel for which to calculate the background excess. </li>
<li><code class="docutils literal"><span class="pre">background</span></code>: The background flux in electrons to assume. </li>
<li><code class="docutils literal"><span class="pre">gain</span></code>: The gain to use when converting the background value from ADU to electrons. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF18split_second_derivEN3PSF13SDKDerivativeERN3PSF13SDKDerivativeERN3PSF13SDKDerivativeE">
<span id="FitPSF::split_second_deriv__PSF::SDKDerivative.PSF::SDKDerivativeR.PSF::SDKDerivativeR"></span><span class="target" id="SDKSourceBase_8cpp_1a1ade9bac2b156b8c523cb0d9d13ff80f"></span>void <code class="descname">split_second_deriv</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF13SDKDerivativeE" title="PSF::SDKDerivative">SDKDerivative</a> <em>second</em>, <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF13SDKDerivativeE" title="PSF::SDKDerivative">SDKDerivative</a> &amp;<em>deriv1</em>, <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF13SDKDerivativeE" title="PSF::SDKDerivative">SDKDerivative</a> &amp;<em>deriv2</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF18split_second_derivEN3PSF13SDKDerivativeERN3PSF13SDKDerivativeERN3PSF13SDKDerivativeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Takes a second derivative and returns the two first order derivatives which it is composed of (e.g. PSF::SS_DERIV -&gt; PSF::S_DERIV, PSF::S_DERIV). If deriv is not a second derivative, the behaviour is undefined. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF14calculate_chi2E15SOURCE_ITERATOR15SOURCE_ITERATORd">
<span id="FitPSF::calculate_chi2__SOURCE_ITERATOR.SOURCE_ITERATOR.double"></span><em class="property">template </em>&lt;<em class="property">class</em> SOURCE_ITERATOR&gt;<br /><span class="target" id="SDKUtil_8cpp_1a0d29bbb4ca74d2eead6f8f467cbdc004"></span>double <code class="descname">calculate_chi2</code><span class="sig-paren">(</span>SOURCE_ITERATOR <em>first_source</em>, SOURCE_ITERATOR <em>past_last_source</em>, double <em>max_source_chi2</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF14calculate_chi2E15SOURCE_ITERATOR15SOURCE_ITERATORd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The <span class="math">\(\chi^2\)</span> that corresponds to a sequence of sources. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">first_source</span></code>: A source iterator pointing to the first source in the sequence. </li>
<li><code class="docutils literal"><span class="pre">past_last_source</span></code>: A source iterator pointing to immediately past the last source in the sequence. </li>
<li><code class="docutils literal"><span class="pre">max_source_chi2</span></code>: If <span class="math">\(\chi^2\)</span> exceeds this value, the source is considered non-point. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF25gsl_minimization_functionEPK10gsl_vectorPv">
<span id="FitPSF::gsl_minimization_function__gsl_vectorCP.voidP"></span><span class="target" id="SDKUtil_8cpp_1a96adf1649b49921286d322a27b7b7503"></span>double <code class="descname">gsl_minimization_function</code><span class="sig-paren">(</span><em class="property">const</em> gsl_vector *<em>poly_coef</em>, void *<em>params</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF25gsl_minimization_functionEPK10gsl_vectorPv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The function to pass to the GSL simplex minimizer, forced to assume SOURCE_ITERATOR = GSLSourceIteratorType and SUBPIX_TYPE = GSLSubPixType. </p>
<p>See GSL documentation for description of the parameters. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF27gsl_s_minimization_functionEdPv">
<span id="FitPSF::gsl_s_minimization_function__double.voidP"></span><span class="target" id="SDKUtil_8cpp_1a3f59bbe1dfe643f0483a3cb9398215de"></span>double <code class="descname">gsl_s_minimization_function</code><span class="sig-paren">(</span>double <em>s</em>, void *<em>params</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF27gsl_s_minimization_functionEdPv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The function to pass to the GSL brent minimizer for finding an initial frame S. </p>
<p>See GSL documentation for description of the parameters. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Variables</p>
<dl class="member">
<dt id="_CPPv2N6FitPSF6ulong1E">
<span id="FitPSF::ulong1__unsigned-lC"></span><span class="target" id="Common_8h_1a9307bb97f4f61a3f308f01b7467e9a12"></span><em class="property">const</em> unsigned long <code class="descname">ulong1</code> = 1<a class="headerlink" href="#_CPPv2N6FitPSF6ulong1E" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Value of 1 for which we can treate a reference/pointer. </p>
</dd></dl>

</div>
<dl class="class">
<dt id="_CPPv2N6FitPSF23AmplitudeSaturatedPixelE">
<span id="FitPSF::AmplitudeSaturatedPixel"></span><span class="target" id="classFitPSF_1_1AmplitudeSaturatedPixel"></span><em class="property">class </em><code class="descname">AmplitudeSaturatedPixel</code><a class="headerlink" href="#_CPPv2N6FitPSF23AmplitudeSaturatedPixelE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;AmplitudeSaturatedPixel.h&gt;</em><p>A structure to hold the information about saturated pixels. </p>
<p>Required when fitting for the amplitude of a source </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF23AmplitudeSaturatedPixel23AmplitudeSaturatedPixelEddNSt8valarrayIdEE">
<span id="FitPSF::AmplitudeSaturatedPixel::AmplitudeSaturatedPixel__double.double.std::valarray:double:"></span><span class="target" id="classFitPSF_1_1AmplitudeSaturatedPixel_1af6b652868f6e5c7afdb19c87a68f27dc"></span><code class="descname">AmplitudeSaturatedPixel</code><span class="sig-paren">(</span>double <em>measured</em>, double <em>variance</em>, std::valarray&lt;double&gt; <em>psf_integral</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF23AmplitudeSaturatedPixel23AmplitudeSaturatedPixelEddNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a saturated pixel object. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">measured</span></code>: The measured value of the pixel. </li>
<li><code class="docutils literal"><span class="pre">variance</span></code>: The estimated variance of the pixel. </li>
<li><code class="docutils literal"><span class="pre">psf_integral</span></code>: the PSF integral (and its derivatives) over the pixel. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF23AmplitudeSaturatedPixel8measuredEv">
<span id="FitPSF::AmplitudeSaturatedPixel::measuredC"></span><span class="target" id="classFitPSF_1_1AmplitudeSaturatedPixel_1a179e54a7e4e770c5b941b65d8ed16a75"></span>double <code class="descname">measured</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF23AmplitudeSaturatedPixel8measuredEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The measured value of the saturated pixel. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF23AmplitudeSaturatedPixel8varianceEv">
<span id="FitPSF::AmplitudeSaturatedPixel::varianceC"></span><span class="target" id="classFitPSF_1_1AmplitudeSaturatedPixel_1a71a0ef5c8c33b44a79d8916c1453db7b"></span>double <code class="descname">variance</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF23AmplitudeSaturatedPixel8varianceEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The estimated variance of the saturated pixel. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF23AmplitudeSaturatedPixel12psf_integralEv">
<span id="FitPSF::AmplitudeSaturatedPixel::psf_integralC"></span><span class="target" id="classFitPSF_1_1AmplitudeSaturatedPixel_1aafc3ec4fd81bbc751a3207adca724273"></span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<code class="descname">psf_integral</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF23AmplitudeSaturatedPixel12psf_integralEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The integral of the PSF over the saturated pixel and all of its derivatives. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF23AmplitudeSaturatedPixel12psf_integralEN3PSF13SDKDerivativeE">
<span id="FitPSF::AmplitudeSaturatedPixel::psf_integral__PSF::SDKDerivativeC"></span><span class="target" id="classFitPSF_1_1AmplitudeSaturatedPixel_1a379b389a07c481ebe2a22ee0663ed088"></span>double <code class="descname">psf_integral</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF13SDKDerivativeE" title="PSF::SDKDerivative">SDKDerivative</a> <em>deriv</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF23AmplitudeSaturatedPixel12psf_integralEN3PSF13SDKDerivativeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The integral of the PSF over the saturated pixel or one of its derivatives. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">deriv</span></code>: The derivate to return. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF23AmplitudeSaturatedPixel18critical_amplitudeEv">
<span id="FitPSF::AmplitudeSaturatedPixel::critical_amplitudeC"></span><span class="target" id="classFitPSF_1_1AmplitudeSaturatedPixel_1aada0dbc06644bbf374d235ffe8ed354d"></span>double <code class="descname">critical_amplitude</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF23AmplitudeSaturatedPixel18critical_amplitudeEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The amplitude below which this pixel should not be saturated. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF23AmplitudeSaturatedPixelltERK23AmplitudeSaturatedPixel">
<span id="FitPSF::AmplitudeSaturatedPixel::lt-operator__AmplitudeSaturatedPixelCRC"></span><span class="target" id="classFitPSF_1_1AmplitudeSaturatedPixel_1a5a53f170a1971a6ff66ee3b11a7dd2d9"></span>bool <code class="descname">operator&lt;</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF23AmplitudeSaturatedPixelE" title="FitPSF::AmplitudeSaturatedPixel">AmplitudeSaturatedPixel</a> &amp;<em>rhs</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF23AmplitudeSaturatedPixelltERK23AmplitudeSaturatedPixel" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Comparison of saturated pixels based on the amplitude below which they should not be saturated. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">rhs</span></code>: The saturated pixel to compare to. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N6FitPSF23AmplitudeSaturatedPixel10__measuredE">
<span id="FitPSF::AmplitudeSaturatedPixel::__measured__double"></span><span class="target" id="classFitPSF_1_1AmplitudeSaturatedPixel_1a84dc135ef749f6d3a3c2a2866b382534"></span>double <code class="descname">__measured</code><a class="headerlink" href="#_CPPv2N6FitPSF23AmplitudeSaturatedPixel10__measuredE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The measured value of the saturated pixel. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF23AmplitudeSaturatedPixel10__varianceE">
<span id="FitPSF::AmplitudeSaturatedPixel::__variance__double"></span><span class="target" id="classFitPSF_1_1AmplitudeSaturatedPixel_1a799a7bdab01e13320e72f87e89fdd443"></span>double <code class="descname">__variance</code><a class="headerlink" href="#_CPPv2N6FitPSF23AmplitudeSaturatedPixel10__varianceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The estimated variance of the saturated pixel. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF23AmplitudeSaturatedPixel14__psf_integralE">
<span id="FitPSF::AmplitudeSaturatedPixel::__psf_integral__std::valarray:double:"></span><span class="target" id="classFitPSF_1_1AmplitudeSaturatedPixel_1a87026313b4ca58321817dfe0f3770066"></span>std::valarray&lt;double&gt; <code class="descname">__psf_integral</code><a class="headerlink" href="#_CPPv2N6FitPSF23AmplitudeSaturatedPixel14__psf_integralE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The integral of the PSF over the saturated pixel and its derivatives (if requested). </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N6FitPSF6ConfigE">
<span id="FitPSF::Config"></span><span class="target" id="classFitPSF_1_1Config"></span><em class="property">class </em><code class="descname">Config</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO17CommandLineConfigE" title="IO::CommandLineConfig">CommandLineConfig</a><a class="headerlink" href="#_CPPv2N6FitPSF6ConfigE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;Config.h&gt;</em><p>Default configuration from file but overwritten by command line options. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF6Config18check_and_finalizeEv">
<span id="FitPSF::Config::check_and_finalize"></span><span class="target" id="classFitPSF_1_1Config_1afe835ca60ff1a28444aa0a13586b0e0f"></span>void <code class="descname">check_and_finalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF6Config18check_and_finalizeEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Checks for consistency between the command line options and perform some finalizing configuration. </p>
<p>Throws an exception if some inconsistency is detected. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF6Config6ConfigEiPPc">
<span id="FitPSF::Config::Config__i.cPP"></span><span class="target" id="classFitPSF_1_1Config_1a7656dca83d28a6681b4516cd213e2045"></span><code class="descname">Config</code><span class="sig-paren">(</span>int <em>argc</em>, char **<em>argv</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF6Config6ConfigEiPPc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Parse the command line. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">argc</span></code>: The number of arguments on the command line (+1 for the executable) </li>
<li><code class="docutils literal"><span class="pre">argv</span></code>: A C style array of the actual command line arguments. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF6Config16describe_optionsEv">
<span id="FitPSF::Config::describe_options"></span><span class="target" id="classFitPSF_1_1Config_1afc728a4c77073e049a58d7d49d403c44"></span>void <code class="descname">describe_options</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF6Config16describe_optionsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Describes the available command line options. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF6Config10usage_helpERKNSt6stringE">
<span id="FitPSF::Config::usage_help__ssCRC"></span><span class="target" id="classFitPSF_1_1Config_1a931286f8e9c7aa7609c468051b0ed021"></span>std::string <code class="descname">usage_help</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>prog_name</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF6Config10usage_helpERKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The part of the help describing the usage and purpose (no options). </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">prog_name</span></code>: The name of the executable invoked. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N6FitPSF5ImageE">
<span id="FitPSF::Image"></span><span class="target" id="classFitPSF_1_1Image"></span><em class="property">template </em>&lt;class <em>SOURCE_TYPE</em>&gt;<br /><em class="property">class </em><code class="descname">Image</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO9FitsImageE" title="IO::FitsImage">FitsImage</a>&lt;double&gt;<a class="headerlink" href="#_CPPv2N6FitPSF5ImageE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;Image.h&gt;</em><p>A class for managing the selection of pixels for PSF/PRF fitting. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF5Image5ImageERKNSt6stringEjd">
<span id="FitPSF::Image::Image__ssCR.unsigned.double"></span><span class="target" id="classFitPSF_1_1Image_1a9b71bb4204426ebbaf2e7e018b28308f"></span><code class="descname">Image</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>filename</em> = &quot;&quot;, unsigned <em>hdu_number</em> = 0, double <em>gain</em> = 1.0<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF5Image5ImageERKNSt6stringEjd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a fit pixel manager for the given image. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">filename</span></code>: The filename of the image to fit. </li>
<li><code class="docutils literal"><span class="pre">hdu_number</span></code>: The HDU number to containing the required image. If, zero, the first non-trivial image HDU is used. </li>
<li><code class="docutils literal"><span class="pre">gain</span></code>: The gain to assume for the image. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF5Image5ImageERKNSt6stringEjj">
<span id="FitPSF::Image::Image__ssCR.unsigned.unsigned"></span><span class="target" id="classFitPSF_1_1Image_1ad7567189c8af6e611996b23e2f962f69"></span><code class="descname">Image</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>filename</em>, unsigned <em>values_hdu</em>, unsigned <em>errors_hdu</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF5Image5ImageERKNSt6stringEjj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a fit pixel manager for the given image. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">filename</span></code>: The filename of the image to fit. </li>
<li><code class="docutils literal"><span class="pre">values_hdu</span></code>: The HDU number to containing the image of pixel values. If, zero, the first non-trivial image HDU is used. </li>
<li><code class="docutils literal"><span class="pre">errors_hdu</span></code>: The HDU containing the estimated standard deviation of each pixel. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF5Image5ImageERN4Core5ImageIdEEd">
<span id="FitPSF::Image::Image__Core::Image:double:R.double"></span><span class="target" id="classFitPSF_1_1Image_1accf464ce9d38b1091729322630af3207"></span><code class="descname">Image</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5ImageE" title="Core::Image">Image</a>&lt;double&gt; &amp;<em>observed_image</em>, double <em>gain</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF5Image5ImageERN4Core5ImageIdEEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a fit pixel manager for the given image. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">observed_image</span></code>: The image whose pixels will participate in PSF fitting. </li>
<li><code class="docutils literal"><span class="pre">gain</span></code>: The gain to assume for the image. </li>
</ul>
</dd>
</dl>
</p>
<p>The newly constructed objects holds an alias of the image data, so the input image should not be destructed before this one. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF5Image16assign_to_sourceEjjP11SOURCE_TYPE">
<span id="FitPSF::Image::assign_to_source__unsigned.unsigned.SOURCE_TYPEP"></span><span class="target" id="classFitPSF_1_1Image_1aa7ded3ac273bcda4dabd6b25be85cc6b"></span><a class="reference internal" href="#_CPPv2N6FitPSF5PixelE" title="FitPSF::Pixel">Pixel</a>&lt;SOURCE_TYPE&gt; *<code class="descname">assign_to_source</code><span class="sig-paren">(</span>unsigned <em>x</em>, unsigned <em>y</em>, SOURCE_TYPE *<em>source</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF5Image16assign_to_sourceEjjP11SOURCE_TYPE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Add the pixel at the given coordinates to the given source and return a pointer to the pixel. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x</span></code>: The x-coordinate of the pixel to assign to the source. </li>
<li><code class="docutils literal"><span class="pre">y</span></code>: The y-coordinate of the pixel to assign to the source. </li>
<li><code class="docutils literal"><span class="pre">source</span></code>: The source to assign this pixel to. </li>
</ul>
</dd>
</dl>
</p>
<p>This is the only method that creates <a class="reference internal" href="#classFitPSF_1_1Pixel"><span class="std std-ref">Pixel</span></a> instances. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF5ImageclEjj">
<span id="FitPSF::Image::call-operator__unsigned.unsignedC"></span><span class="target" id="classFitPSF_1_1Image_1a906bd5358c1687d56128ca5697b90710"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF5PixelE" title="FitPSF::Pixel">Pixel</a>&lt;SOURCE_TYPE&gt; *<code class="descname">operator()</code><span class="sig-paren">(</span>unsigned <em>x</em>, unsigned <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF5ImageclEjj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return the pixel at the given location. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF5Image17background_excessEjjRKN10Background6SourceE">
<span id="FitPSF::Image::background_excess__unsigned.unsigned.Background::SourceCRC"></span><span class="target" id="classFitPSF_1_1Image_1a4e5d8befd8386f6b6e62dac2b2279e12"></span>double <code class="descname">background_excess</code><span class="sig-paren">(</span>unsigned <em>x</em>, unsigned <em>y</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> &amp;<em>background</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF5Image17background_excessEjjRKN10Background6SourceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return the signal to noise ratio with which a pixel sticks above a background. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x</span></code>: The x-coordinate of the pixel to return the signal to noise of. </li>
<li><code class="docutils literal"><span class="pre">y</span></code>: The y-coordinate of the pixel to return the signal to noise of. </li>
<li><code class="docutils literal"><span class="pre">background</span></code>: The background to assume under the pixel (in ADU) </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF5Image17background_excessEjjdd">
<span id="FitPSF::Image::background_excess__unsigned.unsigned.double.doubleC"></span><span class="target" id="classFitPSF_1_1Image_1a863b429aad4fac74957252f43823d5e7"></span>double <code class="descname">background_excess</code><span class="sig-paren">(</span>unsigned <em>x</em>, unsigned <em>y</em>, double <em>background_electrons</em>, double <em>background_electrons_variance</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF5Image17background_excessEjjdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return the signal to noise ratio with which a pixel sticks above a background. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x</span></code>: The x-coordinate of the pixel to return the signal to noise of. </li>
<li><code class="docutils literal"><span class="pre">y</span></code>: The y-coordinate of the pixel to return the signal to noise of. </li>
<li><code class="docutils literal"><span class="pre">background_electrons</span></code>: The background value to assume under the pixel in electrons. </li>
<li><code class="docutils literal"><span class="pre">background_electrons_variance</span></code>: The background variance to assume untder the source in electrons^2. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF5Image4openEdRKNSt6stringEjb">
<span id="FitPSF::Image::open__double.ssCR.unsigned.b"></span><span class="target" id="classFitPSF_1_1Image_1a5d9b1b90ba789273a6700f7172e6c31e"></span>void <code class="descname">open</code><span class="sig-paren">(</span>double <em>gain</em>, <em class="property">const</em> std::string &amp;<em>filename</em>, unsigned <em>hdu_number</em> = 1, bool <em>allow_rounding</em> = false<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF5Image4openEdRKNSt6stringEjb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classIO_1_1FitsImage_1a5581363eef56d2c7df21dbffa2e0689e"><span class="std std-ref">IO::FitsImage::open()</span></a>. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">gain</span></code>: The gain to assume for the image. </li>
<li><code class="docutils literal"><span class="pre">filename</span></code>: See <a class="reference internal" href="#classIO_1_1FitsImage_1a5581363eef56d2c7df21dbffa2e0689e"><span class="std std-ref">IO::FitsImage::open()</span></a>. </li>
<li><code class="docutils literal"><span class="pre">hdu_number</span></code>: See <a class="reference internal" href="#classIO_1_1FitsImage_1a5581363eef56d2c7df21dbffa2e0689e"><span class="std std-ref">IO::FitsImage::open()</span></a>. </li>
<li><code class="docutils literal"><span class="pre">allow_rounding</span></code>: See <a class="reference internal" href="#classIO_1_1FitsImage_1a5581363eef56d2c7df21dbffa2e0689e"><span class="std std-ref">IO::FitsImage::open()</span></a>. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF5Image4wrapEPdPcmmPd">
<span id="FitPSF::Image::wrap__doubleP.cP.unsigned-l.unsigned-l.doubleP"></span><span class="target" id="classFitPSF_1_1Image_1a62b56ae38f5169af40f99ae5c517fee8"></span><em class="property">virtual</em> void <code class="descname">wrap</code><span class="sig-paren">(</span>double *<em>values</em>, char *<em>mask</em>, unsigned long <em>x_resolution</em>, unsigned long <em>y_resolution</em>, double *<em>errors</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF5Image4wrapEPdPcmmPd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Wrap the given data in an image. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">values</span></code>: The image values of the image to wrap. </li>
<li><code class="docutils literal"><span class="pre">mask</span></code>: The pixel quality mask of the image to wrap. </li>
<li><code class="docutils literal"><span class="pre">x_resolution</span></code>: The x resolution of the image. </li>
<li><code class="docutils literal"><span class="pre">y_resolution</span></code>: The y resolution of the image. </li>
<li><code class="docutils literal"><span class="pre">errors</span></code>: Estimated errors of the image pixel values. </li>
</ul>
</dd>
</dl>
</p>
<p>See <a class="reference internal" href="#classCore_1_1Image_1ab64230c162fcfa9e6aa79e83d78743a3"><span class="std std-ref">Core::Image::wrap()</span></a> for description of the arguments. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF5Image4wrapERN4Core5ImageIdEE">
<span id="FitPSF::Image::wrap__Core::Image:double:R"></span><span class="target" id="classFitPSF_1_1Image_1a4ff010016b3752dc8f54dabf181c6a78"></span><em class="property">virtual</em> void <code class="descname">wrap</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5ImageE" title="Core::Image">Image</a>&lt;double&gt; &amp;<em>image</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF5Image4wrapERN4Core5ImageIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Wrap the given image. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF5Image4gainEv">
<span id="FitPSF::Image::gainC"></span><span class="target" id="classFitPSF_1_1Image_1a38a6d3c3ce6db4b3c1263a1d331ed067"></span>double <code class="descname">gain</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF5Image4gainEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The gain of the image set at construction. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF5ImageD0Ev">
<span id="FitPSF::Image::~Image"></span><span class="target" id="classFitPSF_1_1Image_1a347ebc291c6a2b751a909e61b39104c7"></span><em class="property">virtual</em> <code class="descname">~Image</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF5ImageD0Ev" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Delete any pixels allocated through assign_to_source. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Types</p>
<dl class="type">
<dt id="_CPPv2N6FitPSF5Image11PixelVectorE">
<span id="FitPSF::Image::PixelVector"></span><span class="target" id="classFitPSF_1_1Image_1ad53d27e91c63ce6453cd8571d8d5361e"></span><em class="property">typedef </em>std::vector&lt;<a class="reference internal" href="#_CPPv2N6FitPSF5PixelE" title="FitPSF::Pixel">Pixel</a>&lt;SOURCE_TYPE&gt; *&gt; <code class="descname">PixelVector</code><a class="headerlink" href="#_CPPv2N6FitPSF5Image11PixelVectorE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2NK6FitPSF5Image14value_varianceEjj">
<span id="FitPSF::Image::value_variance__unsigned.unsignedC"></span><span class="target" id="classFitPSF_1_1Image_1af7c4eda1bee8b43a851b5e79462339d4"></span>std::pair&lt;double, double&gt; <code class="descname">value_variance</code><span class="sig-paren">(</span>unsigned <em>x</em>, unsigned <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF5Image14value_varianceEjj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The value and variance in electrons and electrons^2 respectively of a pixel. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x</span></code>: The x-coordinate of the pixel in the image. </li>
<li><code class="docutils literal"><span class="pre">y</span></code>: The y-coordinate of the pixel in the image. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF5Image23delete_allocated_pixelsEv">
<span id="FitPSF::Image::delete_allocated_pixels"></span><span class="target" id="classFitPSF_1_1Image_1a3028ef34e0d84eb57bd5700c81d8975a"></span>void <code class="descname">delete_allocated_pixels</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF5Image23delete_allocated_pixelsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Delete any pixels allocated by <a class="reference internal" href="#classFitPSF_1_1Image_1aa7ded3ac273bcda4dabd6b25be85cc6b"><span class="std std-ref">assign_to_source()</span></a> </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N6FitPSF5Image12__fit_pixelsE">
<span id="FitPSF::Image::__fit_pixels__PixelVector"></span><span class="target" id="classFitPSF_1_1Image_1aa1eb7ae46a4ae0416a5f0ade71e46b12"></span><a class="reference internal" href="#_CPPv2N6FitPSF5Image11PixelVectorE" title="FitPSF::Image::PixelVector">PixelVector</a> <code class="descname">__fit_pixels</code><a class="headerlink" href="#_CPPv2N6FitPSF5Image12__fit_pixelsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><a class="reference internal" href="#classFitPSF_1_1Image"><span class="std std-ref">Image</span></a> of pointers to Pixels for tracking all pixels created for PSF fitting. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF5Image6__gainE">
<span id="FitPSF::Image::__gain__double"></span><span class="target" id="classFitPSF_1_1Image_1aafbc992aa45bb7cbec9f261b113524e1"></span>double <code class="descname">__gain</code><a class="headerlink" href="#_CPPv2N6FitPSF5Image6__gainE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The gain to assume for the observed image. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N6FitPSF9IOSourcesE">
<span id="FitPSF::IOSources"></span><span class="target" id="classFitPSF_1_1IOSources"></span><em class="property">class </em><code class="descname">IOSources</code><a class="headerlink" href="#_CPPv2N6FitPSF9IOSourcesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;IOSources.h&gt;</em><p>Parser for a single section of FitPSF input source lists. </p>
<p>The input file should consist of sections formatted like: [&lt;FITS filename&gt; &lt;output filename&gt;] colvalue1 colvalue2 ...</p>
<p>At least three columns must be included: ID, x and y.</p>
<p>White space is ignored (and hence not allowed in filenames). </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF9IOSources9IOSourcesERNSt7istreamERKNSt4listINSt6stringEEE">
<span id="FitPSF::IOSources::IOSources__isR.std::list:ss:CR"></span><span class="target" id="classFitPSF_1_1IOSources_1aa1167cd6ecf2d68c925efae3b455a92d"></span><code class="descname">IOSources</code><span class="sig-paren">(</span>std::istream &amp;<em>input_stream</em>, <em class="property">const</em> std::list&lt;std::string&gt; &amp;<em>column_names</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF9IOSources9IOSourcesERNSt7istreamERKNSt4listINSt6stringEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Read into self a single section (one FITS frames&#8217;s sources) from the given stream. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">input_stream</span></code>: The stream to read from. </li>
<li><code class="docutils literal"><span class="pre">column_names</span></code>: The names of the columns in each section. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF9IOSources9IOSourcesEPKcPPcPKdPPcmm">
<span id="FitPSF::IOSources::IOSources__cCP.cPP.doubleCP.cPP.unsigned-l.unsigned-l"></span><span class="target" id="classFitPSF_1_1IOSources_1aac9f8cd073fe5c5a3f3de4715fd2b9bf"></span><code class="descname">IOSources</code><span class="sig-paren">(</span><em class="property">const</em> char *<em>fits_fname</em>, char **<em>source_ids</em>, <em class="property">const</em> double *<em>column_data</em>, char **<em>column_names</em>, unsigned long <em>num_sources</em>, unsigned long <em>num_columns</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF9IOSources9IOSourcesEPKcPPcPKdPPcmm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Construct from an array of sources. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fits_fname</span></code>: The FITS filename these sources are contained in. </li>
<li><code class="docutils literal"><span class="pre">source_ids</span></code>: The IDs to assign to these sources. </li>
<li><code class="docutils literal"><span class="pre">column_data</span></code>: The information about the sources organized in equal sized columns. The meaning and the order of the columns is specified by column_names. The first num_sources entries are the values of first column, followed by the second column etc. </li>
<li><code class="docutils literal"><span class="pre">column_names</span></code>: The names of the columns. </li>
<li><code class="docutils literal"><span class="pre">num_sources</span></code>: How many sources are in column_data. </li>
<li><code class="docutils literal"><span class="pre">num_columns</span></code>: How many columns. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF9IOSources9locationsEv">
<span id="FitPSF::IOSources::locationsC"></span><span class="target" id="classFitPSF_1_1IOSources_1a6620d44f1f32085bdac82af62d73df18"></span><em class="property">const</em> std::list&lt;<a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core14SourceLocationE" title="Core::SourceLocation">SourceLocation</a>&gt; &amp;<code class="descname">locations</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF9IOSources9locationsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The locations of the sources for PSF fitting. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF9IOSources7columnsEv">
<span id="FitPSF::IOSources::columnsC"></span><span class="target" id="classFitPSF_1_1IOSources_1aa37b51d69eafc7c7bdfa27f54ef102ab"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF14MapVarListTypeE" title="PSF::MapVarListType">MapVarListType</a> &amp;<code class="descname">columns</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF9IOSources7columnsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>All non source-ID columns in the same order as the sources. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF9IOSources10fits_fnameEv">
<span id="FitPSF::IOSources::fits_fnameC"></span><span class="target" id="classFitPSF_1_1IOSources_1ab6b1c83827010c9c9349ed65681585a2"></span><em class="property">const</em> std::string &amp;<code class="descname">fits_fname</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF9IOSources10fits_fnameEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The FITS filename to use for PSF fitting. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF9IOSources12output_fnameEv">
<span id="FitPSF::IOSources::output_fnameC"></span><span class="target" id="classFitPSF_1_1IOSources_1a4ed2d87575136c00e45900ecb786cc34"></span><em class="property">const</em> std::string &amp;<code class="descname">output_fname</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF9IOSources12output_fnameEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The output filename to save the PSF fitting results in. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF9IOSources23source_assignment_fnameEv">
<span id="FitPSF::IOSources::source_assignment_fnameC"></span><span class="target" id="classFitPSF_1_1IOSources_1aa3dc470aea60d63d779e646b1c45bef0"></span><em class="property">const</em> std::string &amp;<code class="descname">source_assignment_fname</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF9IOSources23source_assignment_fnameEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The name of the file to save source assignemnt info to. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF9IOSources4lastEv">
<span id="FitPSF::IOSources::lastC"></span><span class="target" id="classFitPSF_1_1IOSources_1a3ac6329119ea0eee64dd852847c28d92"></span>bool <code class="descname">last</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF9IOSources4lastEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Was this the last section in the input stream? </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF9IOSources14read_filenamesERNSt7istreamE">
<span id="FitPSF::IOSources::read_filenames__isR"></span><span class="target" id="classFitPSF_1_1IOSources_1a36970cb77c2cb2dc24857caa33617afa"></span>void <code class="descname">read_filenames</code><span class="sig-paren">(</span>std::istream &amp;<em>input_stream</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF9IOSources14read_filenamesERNSt7istreamE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check for correct format and read FITS and output filenames. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">input_stream</span></code>: The stream to read from. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF9IOSources16read_column_dataERNSt7istreamERKNSt4listINSt6stringEEERNSt6vectorINSt4listIdEEEE">
<span id="FitPSF::IOSources::read_column_data__isR.std::list:ss:CR.std::vector:std::list:double::R"></span><span class="target" id="classFitPSF_1_1IOSources_1aa2a64a29ca9138387b105170abd6c9bc"></span>void <code class="descname">read_column_data</code><span class="sig-paren">(</span>std::istream &amp;<em>input_stream</em>, <em class="property">const</em> std::list&lt;std::string&gt; &amp;<em>column_names</em>, std::vector&lt;std::list&lt;double&gt;&gt; &amp;<em>column_data</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF9IOSources16read_column_dataERNSt7istreamERKNSt4listINSt6stringEEERNSt6vectorINSt4listIdEEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Read the column data, initializing __locations along the way. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">input_stream</span></code>: The stream to read from. </li>
<li><code class="docutils literal"><span class="pre">column_names</span></code>: The names of the input columns. </li>
<li><code class="docutils literal"><span class="pre">column_data</span></code>: The location to fill with the data (each list contains the values for a column).<ul>
<li>Should contain the correct number of columns on input.</li>
<li>Data is appended to the end of the columns so they should probably be empty.</li>
<li>The ID column should not have an entry. </li>
</ul>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF9IOSources22set_source_coordinatesEv">
<span id="FitPSF::IOSources::set_source_coordinates"></span><span class="target" id="classFitPSF_1_1IOSources_1ab4aa53fba98922599d2795c610fc3ca2"></span>void <code class="descname">set_source_coordinates</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF9IOSources22set_source_coordinatesEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Use the contents of __columns to set the (x, y) coordinates of __locations. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N6FitPSF9IOSources11__locationsE">
<span id="FitPSF::IOSources::__locations__std::list:Core::SourceLocation:"></span><span class="target" id="classFitPSF_1_1IOSources_1abd4ac1074c55cb76ba77fd93b5bfd1bc"></span>std::list&lt;<a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core14SourceLocationE" title="Core::SourceLocation">SourceLocation</a>&gt; <code class="descname">__locations</code><a class="headerlink" href="#_CPPv2N6FitPSF9IOSources11__locationsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The locations of the sources for PSF fitting. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF9IOSources9__columnsE">
<span id="FitPSF::IOSources::__columns__PSF::MapVarListType"></span><span class="target" id="classFitPSF_1_1IOSources_1a5708062d649f8e0d4b7811ddf854b14a"></span><a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF14MapVarListTypeE" title="PSF::MapVarListType">MapVarListType</a> <code class="descname">__columns</code><a class="headerlink" href="#_CPPv2N6FitPSF9IOSources9__columnsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>All non source-ID columns in the same order as the sources. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF9IOSources12__fits_fnameE">
<span id="FitPSF::IOSources::__fits_fname__ss"></span><span class="target" id="classFitPSF_1_1IOSources_1a2dfb07e6c998667d2fef7336926fbcd6"></span>std::string <code class="descname">__fits_fname</code><a class="headerlink" href="#_CPPv2N6FitPSF9IOSources12__fits_fnameE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The FITS filename to use for PSF fitting. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF9IOSources14__output_fnameE">
<span id="FitPSF::IOSources::__output_fname__ss"></span><span class="target" id="classFitPSF_1_1IOSources_1ae76847c5c3ceb88c8b421b173718e43b"></span>std::string <code class="descname">__output_fname</code><a class="headerlink" href="#_CPPv2N6FitPSF9IOSources14__output_fnameE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The name of the output file to use for the given sources. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF9IOSources25__source_assignment_fnameE">
<span id="FitPSF::IOSources::__source_assignment_fname__ss"></span><span class="target" id="classFitPSF_1_1IOSources_1a0f11b6adbd8d03c3e06083e9474ece3f"></span>std::string <code class="descname">__source_assignment_fname</code><a class="headerlink" href="#_CPPv2N6FitPSF9IOSources25__source_assignment_fnameE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The name of the file to save source assignemnt info to. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF9IOSources6__lastE">
<span id="FitPSF::IOSources::__last__b"></span><span class="target" id="classFitPSF_1_1IOSources_1a54998f94012e5281ecec4efca4bb323d"></span>bool <code class="descname">__last</code><a class="headerlink" href="#_CPPv2N6FitPSF9IOSources6__lastE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Is this the last section. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N6FitPSF12LinearSourceE">
<span id="FitPSF::LinearSource"></span><span class="target" id="classFitPSF_1_1LinearSource"></span><em class="property">class </em><code class="descname">LinearSource</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv26FitPSF" title="FitPSF">FitPSF</a>::<a class="reference internal" href="#_CPPv2N6FitPSF13OverlapSourceE" title="FitPSF::OverlapSource">OverlapSource</a>&lt;<a class="reference internal" href="#_CPPv2N6FitPSF12LinearSourceE" title="FitPSF::LinearSource">LinearSource</a>, <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF16PiecewiseBicubicE" title="PSF::PiecewiseBicubic">PiecewiseBicubic</a>&gt;<a class="headerlink" href="#_CPPv2N6FitPSF12LinearSourceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;LinearSource.h&gt;</em><p>A class for PSF fitting sources whose flux distribution depends linearly on the PSF paramaters (for a fixed amplitude). </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF12LinearSource12LinearSourceERKN3PSF16PiecewiseBicubicERKN4Core8SourceIDEddRKN10Background6SourceER5ImageI12LinearSourceEdiPKN4Core11SubPixelMapEdRKNSt6stringE">
<span id="FitPSF::LinearSource::LinearSource__PSF::PiecewiseBicubicCR.Core::SourceIDCR.double.double.Background::SourceCR.Image:LinearSource:R.double.i.Core::SubPixelMapCP.double.ssCR"></span><span class="target" id="classFitPSF_1_1LinearSource_1ae438256b8949f3e16f26e0a4fc7f0c74"></span><code class="descname">LinearSource</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF16PiecewiseBicubicE" title="PSF::PiecewiseBicubic">PiecewiseBicubic</a> &amp;<em>psf</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> &amp;<em>id</em>, double <em>x0</em>, double <em>y0</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> &amp;<em>background</em>, <a class="reference internal" href="#_CPPv2N6FitPSF5ImageE" title="FitPSF::Image">Image</a>&lt;<a class="reference internal" href="#_CPPv2N6FitPSF12LinearSource12LinearSourceERKN3PSF16PiecewiseBicubicERKN4Core8SourceIDEddRKN10Background6SourceER5ImageI12LinearSourceEdiPKN4Core11SubPixelMapEdRKNSt6stringE" title="FitPSF::LinearSource::LinearSource">LinearSource</a>&gt; &amp;<em>psffit_image</em>, double <em>alpha</em>, int <em>source_assignment_id</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> *<em>subpix_map</em>, double <em>max_circular_aperture</em>, <em class="property">const</em> std::string &amp;<em>output_fname</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF12LinearSource12LinearSourceERKN3PSF16PiecewiseBicubicERKN4Core8SourceIDEddRKN10Background6SourceER5ImageI12LinearSourceEdiPKN4Core11SubPixelMapEdRKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classFitPSF_1_1Source"><span class="std std-ref">Source</span></a> constructor with matching arguments (except the first two). </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">psf</span></code>: A properly constructed PSF for this source. The exact shape parameters set are irrelevant. Must not be destroyed while this object is in use. </li>
<li><code class="docutils literal"><span class="pre">id</span></code>: See <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"><span class="std std-ref">OverlapSource::OverlapSource()</span></a> </li>
<li><code class="docutils literal"><span class="pre">x0</span></code>: See <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"><span class="std std-ref">OverlapSource::OverlapSource()</span></a> </li>
<li><code class="docutils literal"><span class="pre">y0</span></code>: See <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"><span class="std std-ref">OverlapSource::OverlapSource()</span></a> </li>
<li><code class="docutils literal"><span class="pre">background</span></code>: See <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"><span class="std std-ref">OverlapSource::OverlapSource()</span></a> </li>
<li><code class="docutils literal"><span class="pre">psffit_image</span></code>: See <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"><span class="std std-ref">OverlapSource::OverlapSource()</span></a> </li>
<li><code class="docutils literal"><span class="pre">alpha</span></code>: See <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"><span class="std std-ref">OverlapSource::OverlapSource()</span></a> </li>
<li><code class="docutils literal"><span class="pre">source_assignment_id</span></code>: See <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"><span class="std std-ref">OverlapSource::OverlapSource()</span></a> </li>
<li><code class="docutils literal"><span class="pre">subpix_map</span></code>: See <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"><span class="std std-ref">OverlapSource::OverlapSource()</span></a> </li>
<li><code class="docutils literal"><span class="pre">max_circular_aperture</span></code>: See <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"><span class="std std-ref">OverlapSource::OverlapSource()</span></a> </li>
<li><code class="docutils literal"><span class="pre">output_fname</span></code>: See <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"><span class="std std-ref">OverlapSource::OverlapSource()</span></a> </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF12LinearSource12LinearSourceERKN3PSF16PiecewiseBicubicERKN4Core8SourceIDEddRKN10Background6SourceER5ImageI12LinearSourceEiPKN4Core11SubPixelMapEddddRKNSt6stringE">
<span id="FitPSF::LinearSource::LinearSource__PSF::PiecewiseBicubicCR.Core::SourceIDCR.double.double.Background::SourceCR.Image:LinearSource:R.i.Core::SubPixelMapCP.double.double.double.double.ssCR"></span><span class="target" id="classFitPSF_1_1LinearSource_1ab4a64d29bd02cbb476f061daec550818"></span><code class="descname">LinearSource</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF16PiecewiseBicubicE" title="PSF::PiecewiseBicubic">PiecewiseBicubic</a> &amp;<em>psf</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> &amp;<em>id</em>, double <em>x0</em>, double <em>y0</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> &amp;<em>background</em>, <a class="reference internal" href="#_CPPv2N6FitPSF5ImageE" title="FitPSF::Image">Image</a>&lt;<a class="reference internal" href="#_CPPv2N6FitPSF12LinearSource12LinearSourceERKN3PSF16PiecewiseBicubicERKN4Core8SourceIDEddRKN10Background6SourceER5ImageI12LinearSourceEdiPKN4Core11SubPixelMapEdRKNSt6stringE" title="FitPSF::LinearSource::LinearSource">LinearSource</a>&gt; &amp;<em>psffit_image</em>, int <em>source_assignment_id</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> *<em>subpix_map</em>, double <em>left</em>, double <em>right</em>, double <em>bottom</em>, double <em>top</em>, <em class="property">const</em> std::string &amp;<em>output_fname</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF12LinearSource12LinearSourceERKN3PSF16PiecewiseBicubicERKN4Core8SourceIDEddRKN10Background6SourceER5ImageI12LinearSourceEiPKN4Core11SubPixelMapEddddRKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classFitPSF_1_1Source"><span class="std std-ref">Source</span></a> constructor with matching arguments (except the first one). </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">psf</span></code>: A properly constructed PSF for this source. The exact shape parameters set are irrelevant. Must not be destroyed while this object is in use. </li>
<li><code class="docutils literal"><span class="pre">id</span></code>: See <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"><span class="std std-ref">OverlapSource::OverlapSource()</span></a> </li>
<li><code class="docutils literal"><span class="pre">x0</span></code>: See <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"><span class="std std-ref">OverlapSource::OverlapSource()</span></a> </li>
<li><code class="docutils literal"><span class="pre">y0</span></code>: See <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"><span class="std std-ref">OverlapSource::OverlapSource()</span></a> </li>
<li><code class="docutils literal"><span class="pre">background</span></code>: See <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"><span class="std std-ref">OverlapSource::OverlapSource()</span></a> </li>
<li><code class="docutils literal"><span class="pre">psffit_image</span></code>: See <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"><span class="std std-ref">OverlapSource::OverlapSource()</span></a> </li>
<li><code class="docutils literal"><span class="pre">source_assignment_id</span></code>: See <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"><span class="std std-ref">OverlapSource::OverlapSource()</span></a> </li>
<li><code class="docutils literal"><span class="pre">subpix_map</span></code>: See <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"><span class="std std-ref">OverlapSource::OverlapSource()</span></a> </li>
<li><code class="docutils literal"><span class="pre">left</span></code>: See <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"><span class="std std-ref">OverlapSource::OverlapSource()</span></a> </li>
<li><code class="docutils literal"><span class="pre">right</span></code>: See <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"><span class="std std-ref">OverlapSource::OverlapSource()</span></a> </li>
<li><code class="docutils literal"><span class="pre">bottom</span></code>: See <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"><span class="std std-ref">OverlapSource::OverlapSource()</span></a> </li>
<li><code class="docutils literal"><span class="pre">top</span></code>: See <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"><span class="std std-ref">OverlapSource::OverlapSource()</span></a> </li>
<li><code class="docutils literal"><span class="pre">output_fname</span></code>: See <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"><span class="std std-ref">OverlapSource::OverlapSource()</span></a> </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF12LinearSource19prepare_for_fittingERKNSt6vectorINSt8valarrayIdEEEEN5Eigen5BlockIN5Eigen8MatrixXdEEEN5Eigen11VectorBlockIN5Eigen8VectorXdEEEN5Eigen11VectorBlockIN5Eigen8VectorXdEEE">
<span id="FitPSF::LinearSource::prepare_for_fitting__std::vector:std::valarray:double::CR.Eigen::Block:Eigen::MatrixXd:.Eigen::VectorBlock:Eigen::VectorXd:.Eigen::VectorBlock:Eigen::VectorXd:"></span><span class="target" id="classFitPSF_1_1LinearSource_1ab36d0b0b3027c659c90ac78906b01d85"></span>void <code class="descname">prepare_for_fitting</code><span class="sig-paren">(</span><em class="property">const</em> std::vector&lt;std::valarray&lt;double&gt;&gt; &amp;<em>basis_parameter_sets</em>, Eigen::Block&lt;Eigen::MatrixXd&gt; <em>shape_fit_integral_matrix</em>, Eigen::VectorBlock&lt;Eigen::VectorXd&gt; <em>shape_fit_offset</em>, Eigen::VectorBlock&lt;Eigen::VectorXd&gt; <em>shape_fit_background_excess</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF12LinearSource19prepare_for_fittingERKNSt6vectorINSt8valarrayIdEEEEN5Eigen5BlockIN5Eigen8MatrixXdEEEN5Eigen11VectorBlockIN5Eigen8VectorXdEEEN5Eigen11VectorBlockIN5Eigen8VectorXdEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A post-processing step to prepare the source for fitting, which must be called after all sources are constructed. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">basis_parameter_sets</span></code>: The collection of PSF parameter basis vectors for which to calculate the predicted pixel response. The first set should correspond to the overall integral being projected out of the basis. </li>
<li><code class="docutils literal"><span class="pre">shape_fit_integral_matrix</span></code>: A matrix piece filled by this method giving the integrals over the shape fitting source pixels but with only one basis vector contributing ( <span class="math">\(\mathbf{\tilde{M}^i}\)</span> in the documentation). Must already have the correct size. The order of the rows is the same as the order of source pixels, but with non shape-fitting pixels skipped. </li>
<li><code class="docutils literal"><span class="pre">shape_fit_offset</span></code>: A vector piece filled by this method, giving the offset to apply during the fitting due to the basis vectors selected to have zero overall PSF integral. </li>
<li><code class="docutils literal"><span class="pre">shape_fit_background_excess</span></code>: The vector to fill with the background excess values for shape fitting pixels. </li>
</ul>
</dd>
</dl>
</p>
<p>In addition to setting up the source it also fills pieces of the matrices needed for fitting. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF12LinearSource12ready_to_fitEv">
<span id="FitPSF::LinearSource::ready_to_fitC"></span><span class="target" id="classFitPSF_1_1LinearSource_1a8e32224c32ebeaf6576d6fd042bff200"></span>bool <code class="descname">ready_to_fit</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF12LinearSource12ready_to_fitEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Is this source ready for PSF fitting? </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF12LinearSource19fill_fluxfit_columnERKN5Eigen8VectorXdE21SHAPE_FIT_OUTPUT_TYPE20FLUX_FIT_OUTPUT_TYPEbb">
<span id="FitPSF::LinearSource::fill_fluxfit_column__Eigen::VectorXdCR.SHAPE_FIT_OUTPUT_TYPE.FLUX_FIT_OUTPUT_TYPE.b.b"></span><em class="property">template </em>&lt;<em class="property">class</em> SHAPE_FIT_OUTPUT_TYPE, <em class="property">class</em> FLUX_FIT_OUTPUT_TYPE&gt;<br /><span class="target" id="classFitPSF_1_1LinearSource_1aeb738df71a81cd99f455691a90d66058"></span>void <code class="descname">fill_fluxfit_column</code><span class="sig-paren">(</span><em class="property">const</em> Eigen::VectorXd &amp;<em>psf_expansion_coef</em>, SHAPE_FIT_OUTPUT_TYPE <em>shape_fit_output</em>, FLUX_FIT_OUTPUT_TYPE <em>flux_fit_output</em>, bool <em>sequential_shape_fit_pixels</em> = true, bool <em>sequential_flux_fit_pixels</em> = true<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF12LinearSource19fill_fluxfit_columnERKN5Eigen8VectorXdE21SHAPE_FIT_OUTPUT_TYPE20FLUX_FIT_OUTPUT_TYPEbb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Sets the entries in the flux fitting matrix corresponding to this source. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">psf_expansion_coef</span></code>: A vector with the PSF expansion coefficients to assume. </li>
<li><code class="docutils literal"><span class="pre">shape_fit_output</span></code>: The location to fill with the predicted pixel responses for the given PSF parameters for shape fitting pixels. The order follows the order of source pixels. Must already have the correct size. </li>
<li><code class="docutils literal"><span class="pre">flux_fit_output</span></code>: The location to fill with the predicted pixel responses for the given PSF parameters for flux but not shape fitting pixels. Which entry gets filled is determined by each pixel&#8217;s flux_fit_index, so pass the entire vector rather than just the segment for this source. Must already have the correct size. </li>
<li><code class="docutils literal"><span class="pre">sequential_shape_fit_pixels</span></code>: Is it safe to assume that shape fitting pixels are sequentially ordered in shape_fit_output? </li>
<li><code class="docutils literal"><span class="pre">sequential_flux_fit_pixels</span></code>: Is it safe to assume that flux fitting only pixels are sequentially ordered in shape_fit_output? </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF12LinearSource9pixel_psfEN3PSF13SDKDerivativeE">
<span id="FitPSF::LinearSource::pixel_psf__PSF::SDKDerivativeC"></span><span class="target" id="classFitPSF_1_1LinearSource_1a9722eeb5acf2248105e23dfc5166837d"></span>double <code class="descname">pixel_psf</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF13SDKDerivativeE" title="PSF::SDKDerivative">SDKDerivative</a> = PSF::NO_DERIV<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF12LinearSource9pixel_psfEN3PSF13SDKDerivativeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The integral of the normalized PSF over the current pixel and its derivatives. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF12LinearSource8fit_fluxERKN5Eigen8VectorXdE">
<span id="FitPSF::LinearSource::fit_flux__Eigen::VectorXdCR"></span><span class="target" id="classFitPSF_1_1LinearSource_1a77c85b9c3c8ad1e3a723b9bba3401254"></span>double <code class="descname">fit_flux</code><span class="sig-paren">(</span><em class="property">const</em> Eigen::VectorXd &amp;<em>psf_expansion_coef</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF12LinearSource8fit_fluxERKN5Eigen8VectorXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fit for the flux of the source assuming the given PSF shape parameters and return the change from its previous value. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">psf_expansion_coef</span></code>: A vector with the expansion coefficients of the PSF parameters to assume. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF12LinearSource15signal_to_noiseEv">
<span id="FitPSF::LinearSource::signal_to_noiseC"></span><span class="target" id="classFitPSF_1_1LinearSource_1a4dc186d68fd86aeb8f88646285f723ff"></span>double <code class="descname">signal_to_noise</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF12LinearSource15signal_to_noiseEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The signal to noise ratio. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF12LinearSourceD0Ev">
<span id="FitPSF::LinearSource::~LinearSource"></span><span class="target" id="classFitPSF_1_1LinearSource_1a0f6d9fdab329c23bbd9b97046004e040"></span><code class="descname">~LinearSource</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF12LinearSourceD0Ev" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Clean-up allocated fitting matrices. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Protected Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF12LinearSource23pixel_excess_reductionsERKN5Eigen8VectorXdERdRd">
<span id="FitPSF::LinearSource::pixel_excess_reductions__Eigen::VectorXdCR.doubleR.doubleR"></span><span class="target" id="classFitPSF_1_1LinearSource_1ad2200ab6548aad154ec0dd1735239839"></span>void <code class="descname">pixel_excess_reductions</code><span class="sig-paren">(</span><em class="property">const</em> Eigen::VectorXd &amp;<em>to_dot_with</em>, double &amp;<em>dot_product</em>, double &amp;<em>excess_sum_squares</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF12LinearSource23pixel_excess_reductionsERKN5Eigen8VectorXdERdRd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate the dot of pixel excesses with the given quantity as well as with itself. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">to_dot_with</span></code>: A vector of values to dot with the pixel excess values. </li>
<li><code class="docutils literal"><span class="pre">dot_product</span></code>: On exit this variable is set to the dot product of to_dot_with and the pixel excesses. </li>
<li><code class="docutils literal"><span class="pre">excess_sum_squares</span></code>: On exit this variable is set to the sum of the squares of the pixel excesses. </li>
</ul>
</dd>
</dl>
</p>
<p>Having this function virtual allows optimizing the calculation in some cases (e.g. when fitting for PSF which linearly depends on its parameters). </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Types</p>
<dl class="type">
<dt id="_CPPv2N6FitPSF12LinearSource14ConstPixelIterE">
<span id="FitPSF::LinearSource::ConstPixelIter"></span><span class="target" id="classFitPSF_1_1LinearSource_1affdcd6823591ed83ca30042d2e5a8fdf"></span><em class="property">typedef </em>std::list&lt;<a class="reference internal" href="#_CPPv2N6FitPSF5PixelE" title="FitPSF::Pixel">Pixel</a>&lt;<a class="reference internal" href="#_CPPv2N6FitPSF12LinearSourceE" title="FitPSF::LinearSource">LinearSource</a>&gt; *&gt;::const_iterator <code class="descname">ConstPixelIter</code><a class="headerlink" href="#_CPPv2N6FitPSF12LinearSource14ConstPixelIterE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Convenience alias for unmutable iterators to source pixels. </p>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N6FitPSF12LinearSource9PixelIterE">
<span id="FitPSF::LinearSource::PixelIter"></span><span class="target" id="classFitPSF_1_1LinearSource_1a2671c43c10029098811a56ede11427a6"></span><em class="property">typedef </em>std::list&lt;<a class="reference internal" href="#_CPPv2N6FitPSF5PixelE" title="FitPSF::Pixel">Pixel</a>&lt;<a class="reference internal" href="#_CPPv2N6FitPSF12LinearSourceE" title="FitPSF::LinearSource">LinearSource</a>&gt; *&gt;::const_iterator <code class="descname">PixelIter</code><a class="headerlink" href="#_CPPv2N6FitPSF12LinearSource9PixelIterE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Convenience alias for mutable iterators to source pixels. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF12LinearSource32calculate_predicted_pixel_valuesEddRKNSt6vectorINSt8valarrayIdEEEERNSt8valarrayIdEE">
<span id="FitPSF::LinearSource::calculate_predicted_pixel_values__double.double.std::vector:std::valarray:double::CR.std::valarray:double:R"></span><span class="target" id="classFitPSF_1_1LinearSource_1aebb24e1232a3bb34c6c4228b5337748b"></span>void <code class="descname">calculate_predicted_pixel_values</code><span class="sig-paren">(</span>double <em>pixel_left</em>, double <em>pixel_bottom</em>, <em class="property">const</em> std::vector&lt;std::valarray&lt;double&gt;&gt; &amp;<em>parameter_sets</em>, std::valarray&lt;double&gt; &amp;<em>pixel_integrals</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF12LinearSource32calculate_predicted_pixel_valuesEddRKNSt6vectorINSt8valarrayIdEEEERNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate the integral of PSF * sub-pixel map over the given pixel for a set of PSF paramaters. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">pixel_left</span></code>: The left boundary of the pixel </li>
<li><code class="docutils literal"><span class="pre">pixel_bottom</span></code>: The bottom bounary of the pixel </li>
<li><code class="docutils literal"><span class="pre">parameter_sets</span></code>: The collection of PSF parameters for which to calculate the predicted pixel response. </li>
<li><code class="docutils literal"><span class="pre">pixel_integrals</span></code>: The array to fill with the final result. Must already have the correct size. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF12LinearSource26fill_pixel_integral_matrixERKNSt6vectorINSt8valarrayIdEEEERN5Eigen5BlockIN5Eigen8MatrixXdEEERN5Eigen11VectorBlockIN5Eigen8VectorXdEEE">
<span id="FitPSF::LinearSource::fill_pixel_integral_matrix__std::vector:std::valarray:double::CR.Eigen::Block:Eigen::MatrixXd:R.Eigen::VectorBlock:Eigen::VectorXd:R"></span><span class="target" id="classFitPSF_1_1LinearSource_1a38d669a11dab6e67eb339f012ff0e010"></span>void <code class="descname">fill_pixel_integral_matrix</code><span class="sig-paren">(</span><em class="property">const</em> std::vector&lt;std::valarray&lt;double&gt;&gt; &amp;<em>basis_parameter_sets</em>, Eigen::Block&lt;Eigen::MatrixXd&gt; &amp;<em>shape_fit_integral_matrix</em>, Eigen::VectorBlock&lt;Eigen::VectorXd&gt; &amp;<em>shape_fit_offset</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF12LinearSource26fill_pixel_integral_matrixERKNSt6vectorINSt8valarrayIdEEEERN5Eigen5BlockIN5Eigen8MatrixXdEEERN5Eigen11VectorBlockIN5Eigen8VectorXdEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Prepare matrices giving PSF integrals over the source pixels. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">basis_parameter_sets</span></code>: See same name argument of prepare_for_fitting. </li>
<li><code class="docutils literal"><span class="pre">shape_fit_integral_matrix</span></code>: See same name argument of prepare_for_fitting. </li>
<li><code class="docutils literal"><span class="pre">shape_fit_offset</span></code>: See same name argument of prepare_for_fitting. </li>
</ul>
</dd>
</dl>
</p>
<p>The result is split between two matrices: the output argument to this method, with entries for shape fitting pixels only and an internally stored matrix for flux-only fitting pixels. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF12LinearSource22fill_background_excessERN5Eigen11VectorBlockIN5Eigen8VectorXdEEE">
<span id="FitPSF::LinearSource::fill_background_excess__Eigen::VectorBlock:Eigen::VectorXd:R"></span><span class="target" id="classFitPSF_1_1LinearSource_1ae30080c88e28ea35fd18a082df58625c"></span>void <code class="descname">fill_background_excess</code><span class="sig-paren">(</span>Eigen::VectorBlock&lt;Eigen::VectorXd&gt; &amp;<em>shape_fit_background_excess</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF12LinearSource22fill_background_excessERN5Eigen11VectorBlockIN5Eigen8VectorXdEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fill vectors with the background excess values of the source pixels used for fitting. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">shape_fit_background_excess</span></code>: See same name argument of prepare_for_fitting. </li>
</ul>
</dd>
</dl>
</p>
<p>Just as <a class="reference internal" href="#classFitPSF_1_1LinearSource_1a38d669a11dab6e67eb339f012ff0e010"><span class="std std-ref">fill_pixel_integral_matrix()</span></a>, the result is split into two pieces: the output argument to this method, with entries for shape fitting pixels only and an internally stored matrix for flux-only fitting pixels. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF12LinearSource23reorder_flux_fit_columnERKN5Eigen8VectorXdEbR11OUTPUT_TYPE">
<span id="FitPSF::LinearSource::reorder_flux_fit_column__Eigen::VectorXdCR.b.OUTPUT_TYPER"></span><em class="property">template </em>&lt;<em class="property">class</em> OUTPUT_TYPE&gt;<br /><span class="target" id="classFitPSF_1_1LinearSource_1a7358c4bcf29ea15c34e10bbf20be1547"></span>void <code class="descname">reorder_flux_fit_column</code><span class="sig-paren">(</span><em class="property">const</em> Eigen::VectorXd &amp;<em>input</em>, bool <em>shape_fit</em>, OUTPUT_TYPE &amp;<em>output</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF12LinearSource23reorder_flux_fit_columnERKN5Eigen8VectorXdEbR11OUTPUT_TYPE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Re-orders a flux fitting column from the order matching the list of source pixels to the order specified by the flux_fit_index() <a class="reference internal" href="#classFitPSF_1_1Pixel"><span class="std std-ref">Pixel</span></a> method. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">input</span></code>: The input vector to re-order. The entries should be in the same order as the sub-set of source pixels (shape vs flux fit) for which this vector applies. </li>
<li><code class="docutils literal"><span class="pre">shape_fit</span></code>: Are the pixels being re-ordered shape fitting (vs flux fitting only)? </li>
<li><code class="docutils literal"><span class="pre">output</span></code>: The output vector to fill. Entries are according to the flux_fit_index() of the pixels. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N6FitPSF12LinearSource5__psfE">
<span id="FitPSF::LinearSource::__psf__PSF::PiecewiseBicubicCR"></span><span class="target" id="classFitPSF_1_1LinearSource_1af70f034a15e7915101a824bd892361b9"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF16PiecewiseBicubicE" title="PSF::PiecewiseBicubic">PiecewiseBicubic</a> &amp;<code class="descname">__psf</code><a class="headerlink" href="#_CPPv2N6FitPSF12LinearSource5__psfE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See psf argument of the constructors. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF12LinearSource27__shape_fit_integral_matrixE">
<span id="FitPSF::LinearSource::__shape_fit_integral_matrix__Eigen::Block:Eigen::MatrixXd:CP"></span><span class="target" id="classFitPSF_1_1LinearSource_1a773fffe45887bb8595e695bbef5566ae"></span><em class="property">const</em> Eigen::Block&lt;Eigen::MatrixXd&gt; *<code class="descname">__shape_fit_integral_matrix</code><a class="headerlink" href="#_CPPv2N6FitPSF12LinearSource27__shape_fit_integral_matrixE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A (piece of a) matrix which after applying to the PSF fitting coefficients and scaling by the amplitude gives the integral of the PSF over the source pixels selected for shape fitting. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF12LinearSource18__shape_fit_offsetE">
<span id="FitPSF::LinearSource::__shape_fit_offset__Eigen::VectorBlock:Eigen::VectorXd:CP"></span><span class="target" id="classFitPSF_1_1LinearSource_1a3e00e7b35d1fc778a808bf9ed5b6bb3c"></span><em class="property">const</em> Eigen::VectorBlock&lt;Eigen::VectorXd&gt; *<code class="descname">__shape_fit_offset</code><a class="headerlink" href="#_CPPv2N6FitPSF12LinearSource18__shape_fit_offsetE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A (piece of a) vector which after scaling by the amplitude gives the integral of a PSF with only the overall integral parameters for the source pixels selected for shape fitting. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF12LinearSource21__shape_fit_bg_excessE">
<span id="FitPSF::LinearSource::__shape_fit_bg_excess__Eigen::VectorBlock:Eigen::VectorXd:CP"></span><span class="target" id="classFitPSF_1_1LinearSource_1afcd52edb366d1ba5800e3076ef1c8042"></span><em class="property">const</em> Eigen::VectorBlock&lt;Eigen::VectorXd&gt; *<code class="descname">__shape_fit_bg_excess</code><a class="headerlink" href="#_CPPv2N6FitPSF12LinearSource21__shape_fit_bg_excessE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A (piece of a) vector of the background excess values of the source pixels used in shape fitting. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF12LinearSource26__flux_fit_integral_matrixE">
<span id="FitPSF::LinearSource::__flux_fit_integral_matrix__Eigen::MatrixXd"></span><span class="target" id="classFitPSF_1_1LinearSource_1ac3988a0ebda71fbc3a5c69e98b10fff1"></span>Eigen::MatrixXd <code class="descname">__flux_fit_integral_matrix</code><a class="headerlink" href="#_CPPv2N6FitPSF12LinearSource26__flux_fit_integral_matrixE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The same as __shape_fit_integral_matrix, but for pixels participating in flux fitting only (excluded from shape fitting). </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF12LinearSource17__flux_fit_offsetE">
<span id="FitPSF::LinearSource::__flux_fit_offset__Eigen::VectorXd"></span><span class="target" id="classFitPSF_1_1LinearSource_1a2fe78b6c2f0892a30adfcf5812a8d68c"></span>Eigen::VectorXd <code class="descname">__flux_fit_offset</code><a class="headerlink" href="#_CPPv2N6FitPSF12LinearSource17__flux_fit_offsetE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The same as __shape_fit_offset, but for pixels participating in flux fitting only (excluded from shape fitting). </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF12LinearSource20__flux_fit_bg_excessE">
<span id="FitPSF::LinearSource::__flux_fit_bg_excess__Eigen::VectorXd"></span><span class="target" id="classFitPSF_1_1LinearSource_1aaf50f12217df23fb1fb1c46086b4c79e"></span>Eigen::VectorXd <code class="descname">__flux_fit_bg_excess</code><a class="headerlink" href="#_CPPv2N6FitPSF12LinearSource20__flux_fit_bg_excessE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The same as __shape_fit_bg_excess, but for pixels participating in flux fitting only (excluded from shape fitting). </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF12LinearSource14__ready_to_fitE">
<span id="FitPSF::LinearSource::__ready_to_fit__b"></span><span class="target" id="classFitPSF_1_1LinearSource_1a9ad185a6c8256c2542bd2170daaa2d81"></span>bool <code class="descname">__ready_to_fit</code><a class="headerlink" href="#_CPPv2N6FitPSF12LinearSource14__ready_to_fitE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Is this source ready for PSF fitting. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N6FitPSF12OverlapGroupE">
<span id="FitPSF::OverlapGroup"></span><span class="target" id="classFitPSF_1_1OverlapGroup"></span><em class="property">template </em>&lt;class <em>SOURCE_TYPE</em>, class <em>PSF_TYPE</em>&gt;<br /><em class="property">class </em><code class="descname">OverlapGroup</code><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroupE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;OverlapGroup.h&gt;</em><p>Class representing a group of overlapping sources. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF12OverlapGroup12OverlapGroupEP11SOURCE_TYPE">
<span id="FitPSF::OverlapGroup::OverlapGroup__SOURCE_TYPEP"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1a057b8a8b8338f8cb122c880fcbaec02b"></span><code class="descname">OverlapGroup</code><span class="sig-paren">(</span>SOURCE_TYPE *<em>first_source</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup12OverlapGroupEP11SOURCE_TYPE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a new group including the given source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF12OverlapGroup8containsERKN4Core14SourceLocationE">
<span id="FitPSF::OverlapGroup::contains__Core::SourceLocationCR"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1aea9161e9415600c9414fc15a96e085c8"></span>bool <code class="descname">contains</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core14SourceLocationE" title="Core::SourceLocation">SourceLocation</a> &amp;<em>source</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup8containsERKN4Core14SourceLocationE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Does the group include the given source (not just its ID). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF12OverlapGroup10add_sourceEP11SOURCE_TYPE">
<span id="FitPSF::OverlapGroup::add_source__SOURCE_TYPEP"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1aa4c0892f4eaba359a54412d44a55a57f"></span>void <code class="descname">add_source</code><span class="sig-paren">(</span>SOURCE_TYPE *<em>source</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup10add_sourceEP11SOURCE_TYPE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Add the given source to the group (and all its overlaps to the IDs) </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">source</span></code>: The source to add </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF12OverlapGroup7sourcesEv">
<span id="FitPSF::OverlapGroup::sources"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1aebb48a3ae3dc346b21fbcbc52f1539c6"></span><a class="reference internal" href="#_CPPv2N6FitPSF12OverlapGroup9SourceSetE" title="FitPSF::OverlapGroup::SourceSet">SourceSet</a> &amp;<code class="descname">sources</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup7sourcesEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The sources currently in the group (modifiable). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF12OverlapGroup7sourcesEv">
<span id="FitPSF::OverlapGroup::sourcesC"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1a522e051b7287a706e44f21f70a65b30f"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF12OverlapGroup9SourceSetE" title="FitPSF::OverlapGroup::SourceSet">SourceSet</a> &amp;<code class="descname">sources</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF12OverlapGroup7sourcesEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The sources currently in the group (unmodifiable). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF12OverlapGroup11pixel_countEv">
<span id="FitPSF::OverlapGroup::pixel_countC"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1a11cbb972d9b6d23902e613de697a12a5"></span>unsigned <code class="descname">pixel_count</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF12OverlapGroup11pixel_countEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of pixels that each source in the group has. </p>
<p>Only valid after <a class="reference internal" href="#classFitPSF_1_1OverlapGroup_1a8336eb50e7b219ca53c9f91f65165dae"><span class="std std-ref">prepare_fitting()</span></a> is called. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF12OverlapGroup14image_filenameEv">
<span id="FitPSF::OverlapGroup::image_filenameC"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1a703b9780cc41f04e4e64a36eb22e10ac"></span><em class="property">const</em> std::string &amp;<code class="descname">image_filename</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF12OverlapGroup14image_filenameEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The filename of the image from which this source was extracted. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF12OverlapGroup5mergeER12OverlapGroupI11SOURCE_TYPE8PSF_TYPEE">
<span id="FitPSF::OverlapGroup::merge__OverlapGroup:SOURCE_TYPE.PSF_TYPE:R"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1ac45d829df867a1696c408ebe55bb045f"></span>void <code class="descname">merge</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF12OverlapGroupE" title="FitPSF::OverlapGroup">OverlapGroup</a>&lt;SOURCE_TYPE, PSF_TYPE&gt; &amp;<em>group</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup5mergeER12OverlapGroupI11SOURCE_TYPE8PSF_TYPEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Merge with the given group (and empty it). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF12OverlapGroup22assert_self_consistentEv">
<span id="FitPSF::OverlapGroup::assert_self_consistent"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1a033075cf32c6933142811712fc904f3e"></span>void <code class="descname">assert_self_consistent</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup22assert_self_consistentEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Are the overlaps of all groups sources also in the group? </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF12OverlapGroup10fit_fluxesERK13PSF_INFO_TYPE">
<span id="FitPSF::OverlapGroup::fit_fluxes__PSF_INFO_TYPECR"></span><em class="property">template </em>&lt;<em class="property">typename</em> PSF_INFO_TYPE&gt;<br /><span class="target" id="classFitPSF_1_1OverlapGroup_1a892b10c1d94cb768d937b784bfe2e415"></span>double <code class="descname">fit_fluxes</code><span class="sig-paren">(</span><em class="property">const</em> PSF_INFO_TYPE &amp;<em>psf_info</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup10fit_fluxesERK13PSF_INFO_TYPE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fit for the fluxes of all sources in the group returning the sum square of the amplitude changes. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">psf_info</span></code>: Sufficient information to define the PSF. </li>
</ul>
</dd>
</dl>
</p>
<p>Set flux() and chi2() for all sources. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF12OverlapGroup15prepare_fittingEv">
<span id="FitPSF::OverlapGroup::prepare_fitting"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1a8336eb50e7b219ca53c9f91f65165dae"></span>void <code class="descname">prepare_fitting</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup15prepare_fittingEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get ready to fit for the fluxes of the sources in the group. </p>
<p>All sources backgrounds are set to the same value, estimated as the average over sources weighted by (number pixels)*(variance).</p>
<p>Flux fitting only pixels get their flux fit indices changed. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Types</p>
<dl class="type">
<dt id="_CPPv2N6FitPSF12OverlapGroup10SourceListE">
<span id="FitPSF::OverlapGroup::SourceList"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1ad9516f3efb268a51ab4278e36145dc67"></span><em class="property">typedef </em>std::list&lt;SOURCE_TYPE *&gt; <code class="descname">SourceList</code><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup10SourceListE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias for the type for a list of sources. </p>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N6FitPSF12OverlapGroup9SourceSetE">
<span id="FitPSF::OverlapGroup::SourceSet"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1a0f818b61e03830c65d46a5242bdd681b"></span><em class="property">typedef </em>std::set&lt;SOURCE_TYPE *&gt; <code class="descname">SourceSet</code><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup9SourceSetE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias for the type for a set of sources. </p>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N6FitPSF12OverlapGroup17SourceSetIteratorE">
<span id="FitPSF::OverlapGroup::SourceSetIterator"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1aac7382f9866ff5caa7a27bd241893df1"></span><em class="property">typedef </em><a class="reference internal" href="#_CPPv2N6FitPSF12OverlapGroup9SourceSetE" title="FitPSF::OverlapGroup::SourceSet">SourceSet</a>::iterator <code class="descname">SourceSetIterator</code><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup17SourceSetIteratorE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias for iterator type over a mutable set of sources. </p>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N6FitPSF12OverlapGroup22ConstSourceSetIteratorE">
<span id="FitPSF::OverlapGroup::ConstSourceSetIterator"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1aaaf52c581485f1c4c20d42fa2b44fe81"></span><em class="property">typedef </em><a class="reference internal" href="#_CPPv2N6FitPSF12OverlapGroup9SourceSetE" title="FitPSF::OverlapGroup::SourceSet">SourceSet</a>::const_iterator <code class="descname">ConstSourceSetIterator</code><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup22ConstSourceSetIteratorE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias for iterator type over an unmutable set of sources. </p>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N6FitPSF12OverlapGroup8PixelSetE">
<span id="FitPSF::OverlapGroup::PixelSet"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1ab3b28a7c8f1e807f3a161e3316c076ea"></span><em class="property">typedef </em>std::set&lt;<a class="reference internal" href="#_CPPv2N6FitPSF5PixelE" title="FitPSF::Pixel">Pixel</a>&lt;SOURCE_TYPE&gt; *&gt; <code class="descname">PixelSet</code><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup8PixelSetE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias for the type for a set of pixels. </p>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N6FitPSF12OverlapGroup9PixelListE">
<span id="FitPSF::OverlapGroup::PixelList"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1ab4537475bf1f34dae555df7de3047d0c"></span><em class="property">typedef </em>std::list&lt;<a class="reference internal" href="#_CPPv2N6FitPSF5PixelE" title="FitPSF::Pixel">Pixel</a>&lt;SOURCE_TYPE&gt; *&gt; <code class="descname">PixelList</code><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup9PixelListE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias for the type for a list of pixels. </p>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N6FitPSF12OverlapGroup14ConstPixelIterE">
<span id="FitPSF::OverlapGroup::ConstPixelIter"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1a2bc79730002e0d08a4280c9c68883bd0"></span><em class="property">typedef </em><a class="reference internal" href="#_CPPv2N6FitPSF12OverlapGroup9PixelListE" title="FitPSF::OverlapGroup::PixelList">PixelList</a>::const_iterator <code class="descname">ConstPixelIter</code><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup14ConstPixelIterE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias for iterator type over an unmutable set of pixels. </p>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N6FitPSF12OverlapGroup9PixelIterE">
<span id="FitPSF::OverlapGroup::PixelIter"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1a8eef380d6be8941eb9f1e24b56d05a3f"></span><em class="property">typedef </em><a class="reference internal" href="#_CPPv2N6FitPSF12OverlapGroup9PixelListE" title="FitPSF::OverlapGroup::PixelList">PixelList</a>::iterator <code class="descname">PixelIter</code><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup9PixelIterE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias for iterator type over n mutable set of pixels. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF12OverlapGroup24fill_background_excessesERK8PixelSetdd">
<span id="FitPSF::OverlapGroup::fill_background_excesses__PixelSetCR.double.double"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1a38bf549a8a29b3be8f45ee055ce6795d"></span>void <code class="descname">fill_background_excesses</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF12OverlapGroup8PixelSetE" title="FitPSF::OverlapGroup::PixelSet">PixelSet</a> &amp;<em>shared_pixels</em>, double <em>background</em>, double <em>background_variance</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup24fill_background_excessesERK8PixelSetdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fills __background_excesses once at the end of prepare_fitting. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">shared_pixels</span></code>: The pixels shared by more than one sounce (assumed to coincide with the flux fitting only pixels). </li>
<li><code class="docutils literal"><span class="pre">background</span></code>: The common background to assume under all sources. </li>
<li><code class="docutils literal"><span class="pre">background_variance</span></code>: The variance in background. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF12OverlapGroup28fill_estimated_excess_matrixERK13PSF_INFO_TYPERN5Eigen8MatrixXdE">
<span id="FitPSF::OverlapGroup::fill_estimated_excess_matrix__PSF_INFO_TYPECR.Eigen::MatrixXdR"></span><em class="property">template </em>&lt;<em class="property">typename</em> PSF_INFO_TYPE&gt;<br /><span class="target" id="classFitPSF_1_1OverlapGroup_1aa4e38c9a4b33e9f0a25f6315896a2130"></span>void <code class="descname">fill_estimated_excess_matrix</code><span class="sig-paren">(</span><em class="property">const</em> PSF_INFO_TYPE &amp;<em>psf_info</em>, Eigen::MatrixXd &amp;<em>estimated_excess_matrix</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup28fill_estimated_excess_matrixERK13PSF_INFO_TYPERN5Eigen8MatrixXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fills a matrix with the integrals of the PSFs of the group sources over the group pixels. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">psf_info</span></code>: Sufficient information to define the PSF. </li>
<li><code class="docutils literal"><span class="pre">estimated_excess_matrix</span></code>: The matrix to fill. Resized as required. </li>
</ul>
</dd>
</dl>
</p>
<p>Rows are pixels, columns are sources. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N6FitPSF12OverlapGroup16__image_filenameE">
<span id="FitPSF::OverlapGroup::__image_filename__ss"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1a0b4aa8e9b1794b79d9bc63e10ef291e6"></span>std::string <code class="descname">__image_filename</code><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup16__image_filenameE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The filename of the image this group is part of. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF12OverlapGroup9__sourcesE">
<span id="FitPSF::OverlapGroup::__sources__SourceSet"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1af0fda205121a4122278b5b707d27282f"></span><a class="reference internal" href="#_CPPv2N6FitPSF12OverlapGroup9SourceSetE" title="FitPSF::OverlapGroup::SourceSet">SourceSet</a> <code class="descname">__sources</code><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup9__sourcesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The sources that belong to this group (as found in a list of dropped sources). </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF12OverlapGroup13__pixel_countE">
<span id="FitPSF::OverlapGroup::__pixel_count__unsigned"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1a5988f7ad1df568de01e22fcc7c4a556c"></span>unsigned <code class="descname">__pixel_count</code><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup13__pixel_countE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The total number of pixels used for flux fitting in the group. </p>
<p>Only valid after <a class="reference internal" href="#classFitPSF_1_1OverlapGroup_1a8336eb50e7b219ca53c9f91f65165dae"><span class="std std-ref">prepare_fitting()</span></a> is called. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF12OverlapGroup23__shape_fit_pixel_countE">
<span id="FitPSF::OverlapGroup::__shape_fit_pixel_count__unsigned"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1a3c246f8d4876d61819ba1c4770d42f5f"></span>unsigned <code class="descname">__shape_fit_pixel_count</code><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup23__shape_fit_pixel_countE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of shape fitting pixels in the group. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF12OverlapGroup21__background_excessesE">
<span id="FitPSF::OverlapGroup::__background_excesses__Eigen::VectorXd"></span><span class="target" id="classFitPSF_1_1OverlapGroup_1ad16debc9ff3659f7a547bc54abf567e5"></span>Eigen::VectorXd <code class="descname">__background_excesses</code><a class="headerlink" href="#_CPPv2N6FitPSF12OverlapGroup21__background_excessesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The background excess values of all pixels in the group. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N6FitPSF13OverlapSourceE">
<span id="FitPSF::OverlapSource"></span><span class="target" id="classFitPSF_1_1OverlapSource"></span><em class="property">template </em>&lt;class <em>FIT_SOURCE_TYPE</em>, class <em>PSF_TYPE</em>&gt;<br /><em class="property">class </em><code class="descname">OverlapSource</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv26FitPSF" title="FitPSF">FitPSF</a>::<a class="reference internal" href="#_CPPv2N6FitPSF6SourceE" title="FitPSF::Source">Source</a>&lt;PSF_TYPE&gt;<a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSourceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;OverlapSource.h&gt;</em><p>PSF fitting source which handles overlaps with other sources. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource13OverlapSourceERKN4Core8SourceIDEddRKN10Background6SourceER5ImageI15FIT_SOURCE_TYPEEdiPKN4Core11SubPixelMapEdRKNSt6stringE">
<span id="FitPSF::OverlapSource::OverlapSource__Core::SourceIDCR.double.double.Background::SourceCR.Image:FIT_SOURCE_TYPE:R.double.i.Core::SubPixelMapCP.double.ssCR"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a1aea1fe935b269943de61d223e6bcc93"></span><code class="descname">OverlapSource</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> &amp;<em>id</em>, double <em>x0</em>, double <em>y0</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> &amp;<em>background</em>, <a class="reference internal" href="#_CPPv2N6FitPSF5ImageE" title="FitPSF::Image">Image</a>&lt;FIT_SOURCE_TYPE&gt; &amp;<em>psffit_image</em>, double <em>alpha</em>, int <em>source_assignment_id</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> *<em>subpix_map</em>, double <em>max_circular_aperture</em>, <em class="property">const</em> std::string &amp;<em>output_fname</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource13OverlapSourceERKN4Core8SourceIDEddRKN10Background6SourceER5ImageI15FIT_SOURCE_TYPEEdiPKN4Core11SubPixelMapEdRKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Creates a PSF fitting source by detecting bright pixels. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">id</span></code>: See same name argument to <a class="reference internal" href="#classFitPSF_1_1Source"><span class="std std-ref">Source</span></a> constructor. </li>
<li><code class="docutils literal"><span class="pre">x0</span></code>: See same name argument to <a class="reference internal" href="#classFitPSF_1_1Source"><span class="std std-ref">Source</span></a> constructor. </li>
<li><code class="docutils literal"><span class="pre">y0</span></code>: See same name argument to <a class="reference internal" href="#classFitPSF_1_1Source"><span class="std std-ref">Source</span></a> constructor. </li>
<li><code class="docutils literal"><span class="pre">background</span></code>: See same name argument to <a class="reference internal" href="#classFitPSF_1_1Source"><span class="std std-ref">Source</span></a> constructor. </li>
<li><code class="docutils literal"><span class="pre">psffit_image</span></code>: The image of fit pixels we are deriving the PSF/PRF map of. On exit, it is updated with the pixels belonging to the newly constructed source. </li>
<li><code class="docutils literal"><span class="pre">alpha</span></code>: How much above the background a pixel needs to be in order to be allocated to this source (the alpha parameter in the description) </li>
<li><code class="docutils literal"><span class="pre">source_assignment_id</span></code>: See same name argument to <a class="reference internal" href="#classFitPSF_1_1Source"><span class="std std-ref">Source</span></a> constructor. </li>
<li><code class="docutils literal"><span class="pre">subpix_map</span></code>: See same name argument to <a class="reference internal" href="#classFitPSF_1_1Source"><span class="std std-ref">Source</span></a> constructor. </li>
<li><code class="docutils literal"><span class="pre">max_circular_aperture</span></code>: If nonzero impose a circular aperture for the source no larger than the given value (otherwise uses only pixels inconsistent with the background at the prescribed by alpha level). The size of the circular aperture is the smallest size possible that encapsulates all pixels that pass the alpha test. </li>
<li><code class="docutils literal"><span class="pre">output_fname</span></code>: See same name argument to <a class="reference internal" href="#classFitPSF_1_1Source"><span class="std std-ref">Source</span></a> constructor. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource13OverlapSourceERKN4Core8SourceIDEddRKN10Background6SourceER5ImageI15FIT_SOURCE_TYPEEiPKN4Core11SubPixelMapEddddRKNSt6stringE">
<span id="FitPSF::OverlapSource::OverlapSource__Core::SourceIDCR.double.double.Background::SourceCR.Image:FIT_SOURCE_TYPE:R.i.Core::SubPixelMapCP.double.double.double.double.ssCR"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a1bff3aee89ddbdcb752cf9f0abfd3718"></span><code class="descname">OverlapSource</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> &amp;<em>id</em>, double <em>x0</em>, double <em>y0</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> &amp;<em>background</em>, <a class="reference internal" href="#_CPPv2N6FitPSF5ImageE" title="FitPSF::Image">Image</a>&lt;FIT_SOURCE_TYPE&gt; &amp;<em>psffit_image</em>, int <em>source_assignment_id</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> *<em>subpix_map</em>, double <em>left</em>, double <em>right</em>, double <em>bottom</em>, double <em>top</em>, <em class="property">const</em> std::string &amp;<em>output_fname</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource13OverlapSourceERKN4Core8SourceIDEddRKN10Background6SourceER5ImageI15FIT_SOURCE_TYPEEiPKN4Core11SubPixelMapEddddRKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Expose <a class="reference internal" href="#classFitPSF_1_1Source"><span class="std std-ref">Source</span></a> constructor (see for argument details). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource15finalize_pixelsEv">
<span id="FitPSF::OverlapSource::finalize_pixels"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a999ec9a2a440a5ddfb9fcbb285943b14"></span>void <code class="descname">finalize_pixels</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource15finalize_pixelsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A post-processing step to be called after constructing all sources in the same image. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13OverlapSource12ready_to_fitEv">
<span id="FitPSF::OverlapSource::ready_to_fitC"></span><span class="target" id="classFitPSF_1_1OverlapSource_1afb5c5af2a2fdfdb9cb4474cb4e9af26e"></span>bool <code class="descname">ready_to_fit</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13OverlapSource12ready_to_fitEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classFitPSF_1_1Source_1a2664fd8c361a1cf70f8a6335bb6abf01"><span class="std std-ref">Source::ready_to_fit()</span></a> </p>
<p>Is this source ready for PSF fitting? </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource12add_overlapsERK9SourceSet">
<span id="FitPSF::OverlapSource::add_overlaps__SourceSetCR"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a8224438b7b2815e822e89b31a80b4bdb"></span>void <code class="descname">add_overlaps</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF13OverlapSource9SourceSetE" title="FitPSF::OverlapSource::SourceSet">SourceSet</a> &amp;<em>extra_overlaps</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource12add_overlapsERK9SourceSet" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Adds the given set of overlaps to this sources overlaps, skipping this source if found. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13OverlapSource8overlapsEv">
<span id="FitPSF::OverlapSource::overlapsC"></span><span class="target" id="classFitPSF_1_1OverlapSource_1aebd4d66ab774a7a4981c92b3080ee623"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF13OverlapSource9SourceSetE" title="FitPSF::OverlapSource::SourceSet">SourceSet</a> &amp;<code class="descname">overlaps</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13OverlapSource8overlapsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A set of the sources which this source overlaps with on the observed image. </p>
<p>Until <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a999ec9a2a440a5ddfb9fcbb285943b14"><span class="std std-ref">finalize_pixels()</span></a> is called, this function returns an empty set! </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource19fill_fluxfit_columnERKN3PSF3PSFE21SHAPE_FIT_OUTPUT_TYPE20FLUX_FIT_OUTPUT_TYPEbb">
<span id="FitPSF::OverlapSource::fill_fluxfit_column__PSF::PSFCR.SHAPE_FIT_OUTPUT_TYPE.FLUX_FIT_OUTPUT_TYPE.b.b"></span><em class="property">template </em>&lt;<em class="property">class</em> SHAPE_FIT_OUTPUT_TYPE, <em class="property">class</em> FLUX_FIT_OUTPUT_TYPE&gt;<br /><span class="target" id="classFitPSF_1_1OverlapSource_1abe85d7a7c754ff5d3f6b6a2f40fae71e"></span>void <code class="descname">fill_fluxfit_column</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF3PSFE" title="PSF::PSF">PSF</a> &amp;<em>psf</em>, SHAPE_FIT_OUTPUT_TYPE <em>shape_fit_output</em>, FLUX_FIT_OUTPUT_TYPE <em>flux_fit_output</em>, bool <em>sequential_shape_fit_pixels</em> = true, bool <em>sequential_flux_fit_pixels</em> = true<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource19fill_fluxfit_columnERKN3PSF3PSFE21SHAPE_FIT_OUTPUT_TYPE20FLUX_FIT_OUTPUT_TYPEbb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Sets the entries in the flux fitting matrix corresponding to this source. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">psf</span></code>: A vector with the PSF parameters to assume. </li>
<li><code class="docutils literal"><span class="pre">shape_fit_output</span></code>: The location to fill with the predicted pixel responses for the given PSF parameters for shape fitting pixels. The order follows the order of source pixels. Must already have the correct size. </li>
<li><code class="docutils literal"><span class="pre">flux_fit_output</span></code>: The location to fill with the predicted pixel responses for the given PSF parameters for flux but not shape fitting pixels. Which entry gets filled is determined by each pixel&#8217;s flux_fit_index, so pass the entire vector rather than just the segment for this source. Must already have the correct size. </li>
<li><code class="docutils literal"><span class="pre">sequential_shape_fit_pixels</span></code>: Is it safe to assume that shape fitting pixels are sequentially ordered in shape_fit_output? </li>
<li><code class="docutils literal"><span class="pre">sequential_flux_fit_pixels</span></code>: Is it safe to assume that flux fitting only pixels are sequentially ordered in shape_fit_output? </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource19fill_fluxfit_columnERKN3PSF3MapE21SHAPE_FIT_OUTPUT_TYPE20FLUX_FIT_OUTPUT_TYPEbb">
<span id="FitPSF::OverlapSource::fill_fluxfit_column__PSF::MapCR.SHAPE_FIT_OUTPUT_TYPE.FLUX_FIT_OUTPUT_TYPE.b.b"></span><em class="property">template </em>&lt;<em class="property">class</em> SHAPE_FIT_OUTPUT_TYPE, <em class="property">class</em> FLUX_FIT_OUTPUT_TYPE&gt;<br /><span class="target" id="classFitPSF_1_1OverlapSource_1a5829e894ad4e06bed1817baa8378c9e5"></span>void <code class="descname">fill_fluxfit_column</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF3MapE" title="PSF::Map">Map</a> &amp;<em>psf_map</em>, SHAPE_FIT_OUTPUT_TYPE <em>shape_fit_output</em>, FLUX_FIT_OUTPUT_TYPE <em>flux_fit_output</em>, bool <em>sequential_shape_fit_pixels</em> = true, bool <em>sequential_flux_fit_pixels</em> = true<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource19fill_fluxfit_columnERKN3PSF3MapE21SHAPE_FIT_OUTPUT_TYPE20FLUX_FIT_OUTPUT_TYPEbb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Sets the entries in the flux fitting matrix corresponding to this source assuming the given PSF map. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">psf_map</span></code>: A vector with the PSF parameters to assume. </li>
<li><code class="docutils literal"><span class="pre">shape_fit_output</span></code>: The location to fill with the predicted pixel responses for the given PSF parameters for shape fitting pixels. The order follows the order of source pixels. Must already have the correct size. </li>
<li><code class="docutils literal"><span class="pre">flux_fit_output</span></code>: The location to fill with the predicted pixel responses for the given PSF parameters for flux but not shape fitting pixels. Which entry gets filled is determined by each pixel&#8217;s flux_fit_index, so pass the entire vector rather than just the segment for this source. Must already have the correct size. </li>
<li><code class="docutils literal"><span class="pre">sequential_shape_fit_pixels</span></code>: Is it safe to assume that shape fitting pixels are sequentially ordered in shape_fit_output? </li>
<li><code class="docutils literal"><span class="pre">sequential_flux_fit_pixels</span></code>: Is it safe to assume that flux fitting only pixels are sequentially ordered in shape_fit_output? </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource8fit_fluxERKN3PSF3PSFE">
<span id="FitPSF::OverlapSource::fit_flux__PSF::PSFCR"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a687b642c3202827f0b370bdf8e29ab41"></span>double <code class="descname">fit_flux</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF3PSFE" title="PSF::PSF">PSF</a> &amp;<em>psf</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource8fit_fluxERKN3PSF3PSFE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Sets the flux of the source to its PSF fitted value returning the change. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">psf</span></code>: The PSF whose amplitude we are fitting. </li>
</ul>
</dd>
</dl>
</p>
<p>This should only be used for isolated sources.</p>
<p></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13OverlapSource9pixel_psfEPK5PixelI15FIT_SOURCE_TYPEERKN3PSF3PSFE">
<span id="FitPSF::OverlapSource::pixel_psf__Pixel:FIT_SOURCE_TYPE:CP.PSF::PSFCRC"></span><span class="target" id="classFitPSF_1_1OverlapSource_1ac0bfe9bd1a518c7c6c07f497aaca0c18"></span>double <code class="descname">pixel_psf</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF5PixelE" title="FitPSF::Pixel">Pixel</a>&lt;FIT_SOURCE_TYPE&gt; *<em>pixel</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF3PSFE" title="PSF::PSF">PSF</a> &amp;<em>psf</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13OverlapSource9pixel_psfEPK5PixelI15FIT_SOURCE_TYPEERKN3PSF3PSFE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return the integral of the PSF times sub-pixel map over the given pixel. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13OverlapSource9pixel_psfERKN3PSF3PSFEN3PSF13SDKDerivativeE">
<span id="FitPSF::OverlapSource::pixel_psf__PSF::PSFCR.PSF::SDKDerivativeC"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a1ce1c677767796f95d4e6f05e432013d"></span>double <code class="descname">pixel_psf</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF3PSFE" title="PSF::PSF">PSF</a> &amp;<em>psf</em>, <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF13SDKDerivativeE" title="PSF::SDKDerivative">SDKDerivative</a> <em>deriv</em> = PSF::NO_DERIV<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13OverlapSource9pixel_psfERKN3PSF3PSFEN3PSF13SDKDerivativeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The integral of the normalized PSF over the current pixel and its derivatives. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">psf</span></code>: The PSF to integrate. </li>
<li><code class="docutils literal"><span class="pre">deriv</span></code>: The derivate order to return. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13OverlapSource6pixelsEv">
<span id="FitPSF::OverlapSource::pixelsC"></span><span class="target" id="classFitPSF_1_1OverlapSource_1af8f496a7687a8620e3cf669ed17248e8"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF13OverlapSource9PixelListE" title="FitPSF::OverlapSource::PixelList">PixelList</a> &amp;<code class="descname">pixels</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13OverlapSource6pixelsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return a const reference to the list of image pixels assigned to this source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource22shape_fit_pixels_beginEv">
<span id="FitPSF::OverlapSource::shape_fit_pixels_begin"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a7037c3fca7f8f5fdcb7dc2d71a4396a4"></span><a class="reference internal" href="#_CPPv2N6FitPSF13OverlapSource9PixelIterE" title="FitPSF::OverlapSource::PixelIter">PixelIter</a> <code class="descname">shape_fit_pixels_begin</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource22shape_fit_pixels_beginEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Iterator over only shape fitting pixels, pointing to the first pixel included in shape fitting. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13OverlapSource22shape_fit_pixels_beginEv">
<span id="FitPSF::OverlapSource::shape_fit_pixels_beginC"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a60224c684f6a2f5714a1caf61fa645af"></span><a class="reference internal" href="#_CPPv2N6FitPSF13OverlapSource14ConstPixelIterE" title="FitPSF::OverlapSource::ConstPixelIter">ConstPixelIter</a> <code class="descname">shape_fit_pixels_begin</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13OverlapSource22shape_fit_pixels_beginEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constant version of <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a7037c3fca7f8f5fdcb7dc2d71a4396a4"><span class="std std-ref">shape_fit_pixels_begin()</span></a>. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource20shape_fit_pixels_endEv">
<span id="FitPSF::OverlapSource::shape_fit_pixels_end"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a0288b1685c5f20e634975bfa312e145e"></span><a class="reference internal" href="#_CPPv2N6FitPSF13OverlapSource9PixelIterE" title="FitPSF::OverlapSource::PixelIter">PixelIter</a> <code class="descname">shape_fit_pixels_end</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource20shape_fit_pixels_endEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Iterator over only shape fitting pixels, pointing to one past the last pixel included in shape fitting. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13OverlapSource20shape_fit_pixels_endEv">
<span id="FitPSF::OverlapSource::shape_fit_pixels_endC"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a49901879f924f17e469c243b5b8dcdb7"></span><a class="reference internal" href="#_CPPv2N6FitPSF13OverlapSource14ConstPixelIterE" title="FitPSF::OverlapSource::ConstPixelIter">ConstPixelIter</a> <code class="descname">shape_fit_pixels_end</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13OverlapSource20shape_fit_pixels_endEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constant version of <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a0288b1685c5f20e634975bfa312e145e"><span class="std std-ref">shape_fit_pixels_end()</span></a>. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource21flux_fit_pixels_beginEv">
<span id="FitPSF::OverlapSource::flux_fit_pixels_begin"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a6ab8fd282647b69d38c4bac5b963321a"></span><a class="reference internal" href="#_CPPv2N6FitPSF13OverlapSource9PixelIterE" title="FitPSF::OverlapSource::PixelIter">PixelIter</a> <code class="descname">flux_fit_pixels_begin</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource21flux_fit_pixels_beginEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Iterator over flux but not shape fitting pixels, pointing to the first pixel included in flux but not shape fitting. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13OverlapSource21flux_fit_pixels_beginEv">
<span id="FitPSF::OverlapSource::flux_fit_pixels_beginC"></span><span class="target" id="classFitPSF_1_1OverlapSource_1ae3b6197f22ad04386de33800a35d1fa2"></span><a class="reference internal" href="#_CPPv2N6FitPSF13OverlapSource14ConstPixelIterE" title="FitPSF::OverlapSource::ConstPixelIter">ConstPixelIter</a> <code class="descname">flux_fit_pixels_begin</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13OverlapSource21flux_fit_pixels_beginEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constant version of <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a6ab8fd282647b69d38c4bac5b963321a"><span class="std std-ref">flux_fit_pixels_begin()</span></a>. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource19flux_fit_pixels_endEv">
<span id="FitPSF::OverlapSource::flux_fit_pixels_end"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a37e5e0e2ef1261cebeb2491f6518e8ac"></span><a class="reference internal" href="#_CPPv2N6FitPSF13OverlapSource9PixelIterE" title="FitPSF::OverlapSource::PixelIter">PixelIter</a> <code class="descname">flux_fit_pixels_end</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource19flux_fit_pixels_endEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Iterator over flux but not shape fitting pixels, pointing to one past the last pixel included in flux but not shape fitting. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13OverlapSource19flux_fit_pixels_endEv">
<span id="FitPSF::OverlapSource::flux_fit_pixels_endC"></span><span class="target" id="classFitPSF_1_1OverlapSource_1aa93709c7d8ee3f5c7b0f7432e87d8a75"></span><a class="reference internal" href="#_CPPv2N6FitPSF13OverlapSource14ConstPixelIterE" title="FitPSF::OverlapSource::ConstPixelIter">ConstPixelIter</a> <code class="descname">flux_fit_pixels_end</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13OverlapSource19flux_fit_pixels_endEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constant version of <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a37e5e0e2ef1261cebeb2491f6518e8ac"><span class="std std-ref">flux_fit_pixels_end()</span></a>. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13OverlapSource11pixel_countEv">
<span id="FitPSF::OverlapSource::pixel_countC"></span><span class="target" id="classFitPSF_1_1OverlapSource_1ae11aa2f3aeb1f8980f0067b153044cd4"></span>size_t <code class="descname">pixel_count</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13OverlapSource11pixel_countEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of pixels assigned to this source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13OverlapSource21saturated_pixel_countEv">
<span id="FitPSF::OverlapSource::saturated_pixel_countC"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a3d2837a96357efdf89f1a7e9aa8ba44e"></span>unsigned <code class="descname">saturated_pixel_count</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13OverlapSource21saturated_pixel_countEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classFitPSF_1_1Source_1ae1a4039da13f91f148a34712867f1f79"><span class="std std-ref">Source::saturated_pixel_count()</span></a> </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource23restart_pixel_iterationEv">
<span id="FitPSF::OverlapSource::restart_pixel_iteration"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a114dc6c243fa5b59769eb39dd897d045"></span><em class="property">virtual</em> void <code class="descname">restart_pixel_iteration</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource23restart_pixel_iterationEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Restarts the iteration over pixels from the beginning. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource10next_pixelEv">
<span id="FitPSF::OverlapSource::next_pixel"></span><span class="target" id="classFitPSF_1_1OverlapSource_1af635dcf216c6ebf84a6e0ba76fc46eec"></span><em class="property">virtual</em> bool <code class="descname">next_pixel</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource10next_pixelEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Advance to the next pixel of the source returning true if it is not past the last pixel. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13OverlapSource21shape_fit_pixel_countEv">
<span id="FitPSF::OverlapSource::shape_fit_pixel_countC"></span><span class="target" id="classFitPSF_1_1OverlapSource_1ac0ac3c3852af35e0bbd6c1347fcef176"></span>size_t <code class="descname">shape_fit_pixel_count</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13OverlapSource21shape_fit_pixel_countEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of pixels belonging to this source suitable for PSF shape fitting. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13OverlapSource20flux_fit_pixel_countEv">
<span id="FitPSF::OverlapSource::flux_fit_pixel_countC"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a496cdff83ca1e11fa99969a883a33114"></span>size_t <code class="descname">flux_fit_pixel_count</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13OverlapSource20flux_fit_pixel_countEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of pixels belonging to this source suitable for PSF flux fitting. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource18pixel_was_excludedEPK5PixelI15FIT_SOURCE_TYPEEbb">
<span id="FitPSF::OverlapSource::pixel_was_excluded__Pixel:FIT_SOURCE_TYPE:CP.b.b"></span><span class="target" id="classFitPSF_1_1OverlapSource_1ae1c3bd744a12307ee75fe5227a4047c0"></span>void <code class="descname">pixel_was_excluded</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF5PixelE" title="FitPSF::Pixel">Pixel</a>&lt;FIT_SOURCE_TYPE&gt; *<em>pixel</em>, bool <em>from_shape_fit</em>, bool <em>from_flux_fit</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource18pixel_was_excludedEPK5PixelI15FIT_SOURCE_TYPEEbb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Update the source to note that one of its pixels is now excluded from the fit. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">pixel</span></code>: The pixel which was excluded. Must belong to this source, otherwise the behaviour is undefined. Calling the pixel&#8217;s exclude_from_*_fit function(s) must be done before invoking this method. </li>
<li><code class="docutils literal"><span class="pre">from_shape_fit</span></code>: Was the pixel previously included in the shape fit and is now excluded? </li>
<li><code class="docutils literal"><span class="pre">from_flux_fit</span></code>: Was the pixel previously included in the flux fit and is now excluded? </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource22exclude_from_shape_fitEv">
<span id="FitPSF::OverlapSource::exclude_from_shape_fit"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a2772a1942f82279cf4f8e78f3ea4be0e"></span>void <code class="descname">exclude_from_shape_fit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource22exclude_from_shape_fitEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Let the source know it was discarded from shape fitting. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource21exclude_from_flux_fitEv">
<span id="FitPSF::OverlapSource::exclude_from_flux_fit"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a032cb8c73a48ce1aaef159c45afa2160"></span>void <code class="descname">exclude_from_flux_fit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource21exclude_from_flux_fitEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Let the source know it was discarded from flux fitting. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource14replace_pixelsE13ITERATOR_TYPE13ITERATOR_TYPE">
<span id="FitPSF::OverlapSource::replace_pixels__ITERATOR_TYPE.ITERATOR_TYPE"></span><em class="property">template </em>&lt;<em class="property">class</em> ITERATOR_TYPE&gt;<br /><span class="target" id="classFitPSF_1_1OverlapSource_1aa1be8727bb6c3cbaeadb63de7ce248d9"></span>void <code class="descname">replace_pixels</code><span class="sig-paren">(</span>ITERATOR_TYPE <em>first</em>, ITERATOR_TYPE <em>past_last</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource14replace_pixelsE13ITERATOR_TYPE13ITERATOR_TYPE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Replace the source pixels. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">first</span></code>: Should point to the first pixel to insert. </li>
<li><code class="docutils literal"><span class="pre">past_last</span></code>: Should point to one past the last pixel to insert. </li>
</ul>
</dd>
</dl>
</p>
<p>The iterators should point to elements that provide <a class="reference internal" href="#classCore_1_1Point_1a5d7884c25972cdf4abc7c1b6eb421068"><span class="std std-ref">x()</span></a>, <a class="reference internal" href="#classCore_1_1Point_1ad0c07d0f6d21b4058acaf0dafea4a3e7"><span class="std std-ref">y()</span></a>, value(), variance() and saturated(). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13OverlapSource18current_pixel_flagEv">
<span id="FitPSF::OverlapSource::current_pixel_flagC"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a81ed7ad08e1192e47805f857fe577674"></span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core14PhotometryFlagE" title="Core::PhotometryFlag">PhotometryFlag</a> <code class="descname">current_pixel_flag</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13OverlapSource18current_pixel_flagEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The quality flag for the current pixel. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource13current_pixelEv">
<span id="FitPSF::OverlapSource::current_pixel"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a23c165b70ffc265dbb63397faab7fc83"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF5PixelE" title="FitPSF::Pixel">Pixel</a>&lt;FIT_SOURCE_TYPE&gt; *<code class="descname">current_pixel</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource13current_pixelEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The current pixel. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource19calculate_mask_fluxERKN3PSF3PSFE">
<span id="FitPSF::OverlapSource::calculate_mask_flux__PSF::PSFCR"></span><span class="target" id="classFitPSF_1_1OverlapSource_1acd09e4afe10877ea7d409bd58c16e3ce"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core4FluxE" title="Core::Flux">Flux</a> &amp;<code class="descname">calculate_mask_flux</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF3PSFE" title="PSF::PSF">PSF</a> &amp;<em>psf</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource19calculate_mask_fluxERKN3PSF3PSFE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classFitPSF_1_1Source_1a0b3a38bb59b57a5fbda5d9f4ee37c2e2"><span class="std std-ref">Source::calculate_mask_flux()</span></a> </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13OverlapSource5meritEv">
<span id="FitPSF::OverlapSource::meritC"></span><span class="target" id="classFitPSF_1_1OverlapSource_1ad7330d27a67ec8a995b1f878ecf8ef55"></span>double <code class="descname">merit</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13OverlapSource5meritEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classFitPSF_1_1Source_1a69bf82e737e9630d357a79e738d4a7b6"><span class="std std-ref">Source::merit()</span></a> </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13OverlapSource12quality_flagEv">
<span id="FitPSF::OverlapSource::quality_flagC"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a962886e0989ec2e471e0f31084f6b9dc"></span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core14PhotometryFlagE" title="Core::PhotometryFlag">PhotometryFlag</a> <code class="descname">quality_flag</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13OverlapSource12quality_flagEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The worst quality flag for any pixel assigned to the source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13OverlapSource8apertureEv">
<span id="FitPSF::OverlapSource::apertureC"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a8ac407467dca807f2e5f60f908728814"></span>double <code class="descname">aperture</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13OverlapSource8apertureEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The smallest circular aperture size that if centered on the source position contains all pixels assigned to the source. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Protected Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource23pixel_excess_reductionsERKN5Eigen8VectorXdERdRd">
<span id="FitPSF::OverlapSource::pixel_excess_reductions__Eigen::VectorXdCR.doubleR.doubleR"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a4e6ecd518434b8bfc01ac519664f4d90"></span>void <code class="descname">pixel_excess_reductions</code><span class="sig-paren">(</span><em class="property">const</em> Eigen::VectorXd &amp;<em>to_dot_with</em>, double &amp;<em>dot_product</em>, double &amp;<em>excess_sum_squares</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource23pixel_excess_reductionsERKN5Eigen8VectorXdERdRd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classFitPSF_1_1Source_1a6840b9ccbbba192d2cbb617d82846a6e"><span class="std std-ref">Source::pixel_excess_reductions</span></a>. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Types</p>
<dl class="type">
<dt id="_CPPv2N6FitPSF13OverlapSource9SourceSetE">
<span id="FitPSF::OverlapSource::SourceSet"></span><span class="target" id="classFitPSF_1_1OverlapSource_1ac274c3d49c73a3f3dc1ef69a03a3ba7c"></span><em class="property">typedef </em>std::set&lt;FIT_SOURCE_TYPE *&gt; <code class="descname">SourceSet</code><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource9SourceSetE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias type for a set of sources used in PSF fitting. </p>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N6FitPSF13OverlapSource9PixelListE">
<span id="FitPSF::OverlapSource::PixelList"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a74395e6620642d3d5c0384c4352f39d6"></span><em class="property">typedef </em>std::list&lt;<a class="reference internal" href="#_CPPv2N6FitPSF5PixelE" title="FitPSF::Pixel">Pixel</a>&lt;FIT_SOURCE_TYPE&gt; *&gt; <code class="descname">PixelList</code><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource9PixelListE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias type for a list of fit source pixels. </p>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N6FitPSF13OverlapSource14ConstPixelIterE">
<span id="FitPSF::OverlapSource::ConstPixelIter"></span><span class="target" id="classFitPSF_1_1OverlapSource_1ab38010e63b52c195c965c42e3d34d957"></span><em class="property">typedef </em><a class="reference internal" href="#_CPPv2N6FitPSF13OverlapSource9PixelListE" title="FitPSF::OverlapSource::PixelList">PixelList</a>::const_iterator <code class="descname">ConstPixelIter</code><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource14ConstPixelIterE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias type for iterator to unmutable list of fit source pixels. </p>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N6FitPSF13OverlapSource9PixelIterE">
<span id="FitPSF::OverlapSource::PixelIter"></span><span class="target" id="classFitPSF_1_1OverlapSource_1ab81e200d21fe3cf94e5763aa6a5aac6d"></span><em class="property">typedef </em><a class="reference internal" href="#_CPPv2N6FitPSF13OverlapSource9PixelListE" title="FitPSF::OverlapSource::PixelList">PixelList</a>::iterator <code class="descname">PixelIter</code><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource9PixelIterE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias type for iterator to mutable list of fit source pixels. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource10take_pixelEjjR5ImageI15FIT_SOURCE_TYPEE">
<span id="FitPSF::OverlapSource::take_pixel__unsigned.unsigned.Image:FIT_SOURCE_TYPE:R"></span><span class="target" id="classFitPSF_1_1OverlapSource_1ac578df0273496ad355e760dcc3cb10a1"></span>void <code class="descname">take_pixel</code><span class="sig-paren">(</span>unsigned <em>x</em>, unsigned <em>y</em>, <a class="reference internal" href="#_CPPv2N6FitPSF5ImageE" title="FitPSF::Image">Image</a>&lt;FIT_SOURCE_TYPE&gt; &amp;<em>psffit_image</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource10take_pixelEjjR5ImageI15FIT_SOURCE_TYPEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Assigns the given pixel to this source. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x</span></code>: The x coordinate of the pixel to add </li>
<li><code class="docutils literal"><span class="pre">y</span></code>: The y coordinate of the pixel to add </li>
<li><code class="docutils literal"><span class="pre">psffit_image</span></code>: The PSF fitting image. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource20add_pixels_in_circleEdR5ImageI15FIT_SOURCE_TYPEE">
<span id="FitPSF::OverlapSource::add_pixels_in_circle__double.Image:FIT_SOURCE_TYPE:R"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a7e40f1171849068d1b7fc430d217c8f0"></span>void <code class="descname">add_pixels_in_circle</code><span class="sig-paren">(</span>double <em>aperture2</em>, <a class="reference internal" href="#_CPPv2N6FitPSF5ImageE" title="FitPSF::Image">Image</a>&lt;FIT_SOURCE_TYPE&gt; &amp;<em>psffit_image</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource20add_pixels_in_circleEdR5ImageI15FIT_SOURCE_TYPEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Adds all pixels within the given aperture to the source taking care of overlaps. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">aperture2</span></code>: The size of the circle within which pixels are added to the source. </li>
<li><code class="docutils literal"><span class="pre">psffit_image</span></code>: The image used for the PSF fit. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource23add_pixels_in_rectangleEddddR5ImageI15FIT_SOURCE_TYPEE">
<span id="FitPSF::OverlapSource::add_pixels_in_rectangle__double.double.double.double.Image:FIT_SOURCE_TYPE:R"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a4b95da743d1f1a029068721412e3f94a"></span>void <code class="descname">add_pixels_in_rectangle</code><span class="sig-paren">(</span>double <em>left</em>, double <em>right</em>, double <em>bottom</em>, double <em>top</em>, <a class="reference internal" href="#_CPPv2N6FitPSF5ImageE" title="FitPSF::Image">Image</a>&lt;FIT_SOURCE_TYPE&gt; &amp;<em>psffit_image</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource23add_pixels_in_rectangleEddddR5ImageI15FIT_SOURCE_TYPEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Adds all pixels within the given rectangle to the source taking care of overlaps. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">left</span></code>: relative to source center </li>
<li><code class="docutils literal"><span class="pre">right</span></code>: relative to source center </li>
<li><code class="docutils literal"><span class="pre">bottom</span></code>: relative to source center </li>
<li><code class="docutils literal"><span class="pre">top</span></code>: relative to source center </li>
<li><code class="docutils literal"><span class="pre">psffit_image</span></code>: The <a class="reference internal" href="#classFitPSF_1_1Image"><span class="std std-ref">Image</span></a> used for fitting. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource13process_pixelEjjR5ImageI15FIT_SOURCE_TYPEEdb">
<span id="FitPSF::OverlapSource::process_pixel__unsigned.unsigned.Image:FIT_SOURCE_TYPE:R.double.b"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a094f46e14688c3a3dd41886b5f9e29d4"></span>double <code class="descname">process_pixel</code><span class="sig-paren">(</span>unsigned <em>x</em>, unsigned <em>y</em>, <a class="reference internal" href="#_CPPv2N6FitPSF5ImageE" title="FitPSF::Image">Image</a>&lt;FIT_SOURCE_TYPE&gt; &amp;<em>psffit_image</em>, double <em>alpha</em>, bool <em>central_pixel</em> = false<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource13process_pixelEjjR5ImageI15FIT_SOURCE_TYPEEdb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Appropriately adds or not a pixel to a source. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x</span></code>: The x coordinate of the pixel to potentially add. </li>
<li><code class="docutils literal"><span class="pre">y</span></code>: The y coordinate of the pixel to potentially add. </li>
<li><code class="docutils literal"><span class="pre">psffit_image</span></code>: The PSF fitting image image. </li>
<li><code class="docutils literal"><span class="pre">alpha</span></code>: See the alpha parameter of the constructor. </li>
<li><code class="docutils literal"><span class="pre">central_pixel</span></code>: Is this the central pixel of the source. </li>
</ul>
</dd>
</dl>
</p>
<p>Checks if the given pixel is sufficiently above the background and if so checks for conflicts and if appropriate adds the pixel to this source, and calls itself on all neighboring pixels. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource22reject_pixels_from_fitEv">
<span id="FitPSF::OverlapSource::reject_pixels_from_fit"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a9d9840e3465bc319e477887a4d544547"></span>void <code class="descname">reject_pixels_from_fit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource22reject_pixels_from_fitEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Flag any pixels not suitable for fitting as excluded from shape/flux fits. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13OverlapSource15calculate_meritEv">
<span id="FitPSF::OverlapSource::calculate_merit"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a71730ec6fc60f13b4bf5b337df3a67bf"></span>void <code class="descname">calculate_merit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource15calculate_meritEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return how constraining this source is for PSF fitting. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N6FitPSF13OverlapSource8__pixelsE">
<span id="FitPSF::OverlapSource::__pixels__PixelList"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a30303a92462e637d8ad1766ba5926352"></span><a class="reference internal" href="#_CPPv2N6FitPSF13OverlapSource9PixelListE" title="FitPSF::OverlapSource::PixelList">PixelList</a> <code class="descname">__pixels</code><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource8__pixelsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The pixels assigned to this source. </p>
<p>Shape fitting pixels are first, followed by flux but not shape fitting and finally pixels excluded from both fits. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13OverlapSource15__current_pixelE">
<span id="FitPSF::OverlapSource::__current_pixel__PixelIter"></span><span class="target" id="classFitPSF_1_1OverlapSource_1acf7ce8ffa4f03ed033ae1f780de03373"></span><a class="reference internal" href="#_CPPv2N6FitPSF13OverlapSource9PixelIterE" title="FitPSF::OverlapSource::PixelIter">PixelIter</a> <code class="descname">__current_pixel</code><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource15__current_pixelE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Iterator to the currently selected pixel (see <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1a114dc6c243fa5b59769eb39dd897d045"><span class="std std-ref">restart_pixel_iteration()</span></a> and <a class="reference internal" href="#classFitPSF_1_1OverlapSource_1af635dcf216c6ebf84a6e0ba76fc46eec"><span class="std std-ref">next_pixel()</span></a>) </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13OverlapSource22__first_flux_fit_pixelE">
<span id="FitPSF::OverlapSource::__first_flux_fit_pixel__PixelIter"></span><span class="target" id="classFitPSF_1_1OverlapSource_1acd24bddbe27e6475a7c79a55df8109d7"></span><a class="reference internal" href="#_CPPv2N6FitPSF13OverlapSource9PixelIterE" title="FitPSF::OverlapSource::PixelIter">PixelIter</a> <code class="descname">__first_flux_fit_pixel</code><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource22__first_flux_fit_pixelE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Iterator to the first pixel that participates in flux fitting, but not shape fitting. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13OverlapSource22__first_excluded_pixelE">
<span id="FitPSF::OverlapSource::__first_excluded_pixel__PixelIter"></span><span class="target" id="classFitPSF_1_1OverlapSource_1ae583a66867d9fb3b36433b8928c384f4"></span><a class="reference internal" href="#_CPPv2N6FitPSF13OverlapSource9PixelIterE" title="FitPSF::OverlapSource::PixelIter">PixelIter</a> <code class="descname">__first_excluded_pixel</code><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource22__first_excluded_pixelE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Iterator to the first pixel that does not participate in either shape or flux fitting. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13OverlapSource21__const_current_pixelE">
<span id="FitPSF::OverlapSource::__const_current_pixel__ConstPixelIter"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a163fe7a9a3787a2021c8157b3f9d1939"></span><a class="reference internal" href="#_CPPv2N6FitPSF13OverlapSource14ConstPixelIterE" title="FitPSF::OverlapSource::ConstPixelIter">ConstPixelIter</a> <code class="descname">__const_current_pixel</code><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource21__const_current_pixelE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Unmutable version of __current_pixel. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13OverlapSource28__const_first_flux_fit_pixelE">
<span id="FitPSF::OverlapSource::__const_first_flux_fit_pixel__ConstPixelIter"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a28b865eb391dedd7e70f5cee61681a58"></span><a class="reference internal" href="#_CPPv2N6FitPSF13OverlapSource14ConstPixelIterE" title="FitPSF::OverlapSource::ConstPixelIter">ConstPixelIter</a> <code class="descname">__const_first_flux_fit_pixel</code><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource28__const_first_flux_fit_pixelE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Unmutable version of __first_flux_fit_pixel. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13OverlapSource28__const_first_excluded_pixelE">
<span id="FitPSF::OverlapSource::__const_first_excluded_pixel__ConstPixelIter"></span><span class="target" id="classFitPSF_1_1OverlapSource_1ae055c0c1b9b2bf6611493b3169c503a7"></span><a class="reference internal" href="#_CPPv2N6FitPSF13OverlapSource14ConstPixelIterE" title="FitPSF::OverlapSource::ConstPixelIter">ConstPixelIter</a> <code class="descname">__const_first_excluded_pixel</code><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource28__const_first_excluded_pixelE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Unmutable version of __first_excluded_pixel. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13OverlapSource10__overlapsE">
<span id="FitPSF::OverlapSource::__overlaps__SourceSet"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a62ccacd3bd0bbb232fb00b8e61dbd848"></span><a class="reference internal" href="#_CPPv2N6FitPSF13OverlapSource9SourceSetE" title="FitPSF::OverlapSource::SourceSet">SourceSet</a> <code class="descname">__overlaps</code><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource10__overlapsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Some of the sources which this source overlaps with on the observed image. </p>
<p>If a source is known to overlap, but none of the sources it overlaps with are known this set contains only the source&#8217;s own id. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13OverlapSource14__quality_flagE">
<span id="FitPSF::OverlapSource::__quality_flag__Core::PhotometryFlag"></span><span class="target" id="classFitPSF_1_1OverlapSource_1af39e2e4729fbbe60d312c90d931775ad"></span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core14PhotometryFlagE" title="Core::PhotometryFlag">PhotometryFlag</a> <code class="descname">__quality_flag</code><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource14__quality_flagE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The worst flag for any of the pixels associated with the source. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13OverlapSource7__meritE">
<span id="FitPSF::OverlapSource::__merit__double"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a492aaf7bff0cff02e2a0627c95a0ac8c"></span>double <code class="descname">__merit</code><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource7__meritE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The sum of the background excesses of all good source pixels not shared with another source. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13OverlapSource24__max_circular_aperture2E">
<span id="FitPSF::OverlapSource::__max_circular_aperture2__double"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a9da4d82c8432977510a3d84d20fe393a"></span>double <code class="descname">__max_circular_aperture2</code><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource24__max_circular_aperture2E" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>If non-zero the square of the largest allowed circular aperture for the source. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13OverlapSource11__aperture2E">
<span id="FitPSF::OverlapSource::__aperture2__double"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a0496cf4c22ea722dec016a5fd8f6ae6d"></span>double <code class="descname">__aperture2</code><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource11__aperture2E" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The actual minimal circular aperture that contains all source pixels squared. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13OverlapSource23__saturated_pixel_countE">
<span id="FitPSF::OverlapSource::__saturated_pixel_count__unsigned"></span><span class="target" id="classFitPSF_1_1OverlapSource_1ab1bd75ae3b883db5eabd2ac160dc7bf5"></span>unsigned <code class="descname">__saturated_pixel_count</code><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource23__saturated_pixel_countE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of non-good pixels assigned to this source. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13OverlapSource23__shape_fit_pixel_countE">
<span id="FitPSF::OverlapSource::__shape_fit_pixel_count__unsigned"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a4767deb59e212f3bf55a6cf4c078f1ee"></span>unsigned <code class="descname">__shape_fit_pixel_count</code><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource23__shape_fit_pixel_countE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of source pixels used in the last fit for the shape of the PSF. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13OverlapSource22__flux_fit_pixel_countE">
<span id="FitPSF::OverlapSource::__flux_fit_pixel_count__unsigned"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a4662d3393df5b311d925f4c08f7753fd"></span>unsigned <code class="descname">__flux_fit_pixel_count</code><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource22__flux_fit_pixel_countE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of pixels used in the last fit for the source flux. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13OverlapSource14__ready_to_fitE">
<span id="FitPSF::OverlapSource::__ready_to_fit__b"></span><span class="target" id="classFitPSF_1_1OverlapSource_1a06bc4c575157bb695d2eea91906f72b9"></span>bool <code class="descname">__ready_to_fit</code><a class="headerlink" href="#_CPPv2N6FitPSF13OverlapSource14__ready_to_fitE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Is this source ready for PSF fitting? </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothingE">
<span id="FitPSF::PiecewiseBicubicPSFSmoothing"></span><span class="target" id="classFitPSF_1_1PiecewiseBicubicPSFSmoothing"></span><em class="property">class </em><code class="descname">PiecewiseBicubicPSFSmoothing</code><a class="headerlink" href="#_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothingE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;PiecewiseBicubicPSFSmoothing.h&gt;</em><p>A class that applies a smoothing penalty during PSF/PRF fitting. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing28PiecewiseBicubicPSFSmoothingEv">
<span id="FitPSF::PiecewiseBicubicPSFSmoothing::PiecewiseBicubicPSFSmoothing"></span><span class="target" id="classFitPSF_1_1PiecewiseBicubicPSFSmoothing_1a5bacfbf29409d56d23b088ea32fb8e02"></span><code class="descname">PiecewiseBicubicPSFSmoothing</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing28PiecewiseBicubicPSFSmoothingEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Default constructor, must call prepare_smoothing before use. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing28PiecewiseBicubicPSFSmoothingEdRK16LinearSourceListRKNSt6vectorIdEERKNSt6vectorIdEERKNSt6vectorINSt8valarrayIdEEEE">
<span id="FitPSF::PiecewiseBicubicPSFSmoothing::PiecewiseBicubicPSFSmoothing__double.LinearSourceListCR.std::vector:double:CR.std::vector:double:CR.std::vector:std::valarray:double::CR"></span><span class="target" id="classFitPSF_1_1PiecewiseBicubicPSFSmoothing_1a9744144ba441627bb355414a55f74320"></span><code class="descname">PiecewiseBicubicPSFSmoothing</code><span class="sig-paren">(</span>double <em>smoothing_penalty</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em>, <em class="property">const</em> std::vector&lt;double&gt; &amp;<em>x_grid</em>, <em class="property">const</em> std::vector&lt;double&gt; &amp;<em>y_grid</em>, <em class="property">const</em> std::vector&lt;std::valarray&lt;double&gt;&gt; &amp;<em>basis_parameter_sets</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing28PiecewiseBicubicPSFSmoothingEdRK16LinearSourceListRKNSt6vectorIdEERKNSt6vectorIdEERKNSt6vectorINSt8valarrayIdEEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get ready for imposing smoothing penalty to bicubic PSF fits. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">smoothing_penalty</span></code>: The degree of smoothing to use. </li>
<li><code class="docutils literal"><span class="pre">fit_sources</span></code>: The sources which participate in the PSF shape fitting. </li>
<li><code class="docutils literal"><span class="pre">x_grid</span></code>: The list of vertical grid cell boundaries of the PSF. </li>
<li><code class="docutils literal"><span class="pre">y_grid</span></code>: The list of horizontal grid cell boundaries of the PSF. </li>
<li><code class="docutils literal"><span class="pre">basis_parameter_sets</span></code>: The parameter sets in the basis in which PSF fitting is performed. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing17prepare_smoothingEdRK16LinearSourceListRKNSt6vectorIdEERKNSt6vectorIdEERKNSt6vectorINSt8valarrayIdEEEE">
<span id="FitPSF::PiecewiseBicubicPSFSmoothing::prepare_smoothing__double.LinearSourceListCR.std::vector:double:CR.std::vector:double:CR.std::vector:std::valarray:double::CR"></span><span class="target" id="classFitPSF_1_1PiecewiseBicubicPSFSmoothing_1a88c9ffb971e65df288176aef7126d13c"></span>void <code class="descname">prepare_smoothing</code><span class="sig-paren">(</span>double <em>smoothing_penalty</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em>, <em class="property">const</em> std::vector&lt;double&gt; &amp;<em>x_grid</em>, <em class="property">const</em> std::vector&lt;double&gt; &amp;<em>y_grid</em>, <em class="property">const</em> std::vector&lt;std::valarray&lt;double&gt;&gt; &amp;<em>basis_parameter_sets</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing17prepare_smoothingEdRK16LinearSourceListRKNSt6vectorIdEERKNSt6vectorIdEERKNSt6vectorINSt8valarrayIdEEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See non-default constructor. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF28PiecewiseBicubicPSFSmoothing14rhs_correctionEv">
<span id="FitPSF::PiecewiseBicubicPSFSmoothing::rhs_correctionC"></span><span class="target" id="classFitPSF_1_1PiecewiseBicubicPSFSmoothing_1a5795e895d3a3316755318c7a6a67afaa"></span><em class="property">const</em> Eigen::VectorXd &amp;<code class="descname">rhs_correction</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF28PiecewiseBicubicPSFSmoothing14rhs_correctionEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The vector to add to the RHS vector to implement smoothing. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF28PiecewiseBicubicPSFSmoothing14lhs_correctionEv">
<span id="FitPSF::PiecewiseBicubicPSFSmoothing::lhs_correctionC"></span><span class="target" id="classFitPSF_1_1PiecewiseBicubicPSFSmoothing_1a482f07fc11dbbaeafc79d61560714e30"></span><em class="property">const</em> Eigen::MatrixXd &amp;<code class="descname">lhs_correction</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF28PiecewiseBicubicPSFSmoothing14lhs_correctionEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The matrix to add to the LHS matrix to implement smoothing. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF28PiecewiseBicubicPSFSmoothingcvbEv">
<span id="FitPSF::PiecewiseBicubicPSFSmoothing::castto-b-operatorC"></span><span class="target" id="classFitPSF_1_1PiecewiseBicubicPSFSmoothing_1a93cea052276ee4d4ec26de3378231f9d"></span><code class="descname">operator bool</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF28PiecewiseBicubicPSFSmoothingcvbEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Is smoothing ready. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing24fill_cell_penalty_matrixEddRN5Eigen8MatrixXdE">
<span id="FitPSF::PiecewiseBicubicPSFSmoothing::fill_cell_penalty_matrix__double.double.Eigen::MatrixXdR"></span><span class="target" id="classFitPSF_1_1PiecewiseBicubicPSFSmoothing_1afbf3bb077bf5ac24809bef1441a8d035"></span>void <code class="descname">fill_cell_penalty_matrix</code><span class="sig-paren">(</span>double <em>width</em>, double <em>height</em>, Eigen::MatrixXd &amp;<em>penalty_matrix</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing24fill_cell_penalty_matrixEddRN5Eigen8MatrixXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fill the matrix which converts cell parameters to the smoothing penalty. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">width</span></code>: The width of the cell. </li>
<li><code class="docutils literal"><span class="pre">height</span></code>: The hegiht of the cell. </li>
<li><code class="docutils literal"><span class="pre">penalty_matrix</span></code>: The matrix to fill. </li>
</ul>
</dd>
</dl>
</p>
<p>This is the <span class="math">\( \mathbf{A}_{cell} \)</span> in the documentation. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing35fill_second_derivative_coefficientsEPKdRN5Eigen8Vector4dE">
<span id="FitPSF::PiecewiseBicubicPSFSmoothing::fill_second_derivative_coefficients__doubleCP.Eigen::Vector4dR"></span><span class="target" id="classFitPSF_1_1PiecewiseBicubicPSFSmoothing_1a3128f083e18c4e8f299da47a7cc35a8b"></span>void <code class="descname">fill_second_derivative_coefficients</code><span class="sig-paren">(</span><em class="property">const</em> double *<em>first_coef</em>, Eigen::Vector4d &amp;<em>result</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing35fill_second_derivative_coefficientsEPKdRN5Eigen8Vector4dE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fills the (2,2), (2,3), (3,2), (3,3) coefficients in the bicubic function over a cell. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">first_coef</span></code>: A pointer to the first coefficient defining the bicubic over the cell. </li>
<li><code class="docutils literal"><span class="pre">result</span></code>: The vector to fill. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing23fill_spatial_dependenceERK16LinearSourceList">
<span id="FitPSF::PiecewiseBicubicPSFSmoothing::fill_spatial_dependence__LinearSourceListCR"></span><span class="target" id="classFitPSF_1_1PiecewiseBicubicPSFSmoothing_1a71ff662eedae69b049a0fbab0aec717d"></span>void <code class="descname">fill_spatial_dependence</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF16LinearSourceListE" title="FitPSF::LinearSourceList">LinearSourceList</a> &amp;<em>fit_sources</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing23fill_spatial_dependenceERK16LinearSourceList" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fill the __rhs_spatial_depedence vector. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fit_sources</span></code>: See same name argument to constructor. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing17add_smoothing_rhsERKNSt6vectorINSt8valarrayIdEEEERKN5Eigen8MatrixXdEjjRN5Eigen8VectorXdE">
<span id="FitPSF::PiecewiseBicubicPSFSmoothing::add_smoothing_rhs__std::vector:std::valarray:double::CR.Eigen::MatrixXdCR.unsigned.unsigned.Eigen::VectorXdR"></span><span class="target" id="classFitPSF_1_1PiecewiseBicubicPSFSmoothing_1a158014bb1e62fcdd603401235db42cfe"></span>void <code class="descname">add_smoothing_rhs</code><span class="sig-paren">(</span><em class="property">const</em> std::vector&lt;std::valarray&lt;double&gt;&gt; &amp;<em>basis_parameter_sets</em>, <em class="property">const</em> Eigen::MatrixXd &amp;<em>penalty_matrix</em>, unsigned <em>basis_index</em>, unsigned <em>cell_index</em>, Eigen::VectorXd &amp;<em>rhs</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing17add_smoothing_rhsERKNSt6vectorINSt8valarrayIdEEEERKN5Eigen8MatrixXdEjjRN5Eigen8VectorXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Updates RHS vector with the smoothing terms for single cell/basis vector. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">basis_parameter_sets</span></code>: The basis parameter sets returned by fill_basis_parameter_sets. </li>
<li><code class="docutils literal"><span class="pre">penalty_matrix</span></code>: The penalty matrix returned by fill_cell_penalty_matrix. </li>
<li><code class="docutils literal"><span class="pre">basis_index</span></code>: The index of the basis vector to add (zero should correspond to </li>
<li><code class="docutils literal"><span class="pre">cell_index</span></code>: The index of the cell (assuming the order in basis_parameter_sets). </li>
<li><code class="docutils literal"><span class="pre">rhs</span></code>: The RHS vector to add to. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing20add_smoothing_matrixERKNSt6vectorINSt8valarrayIdEEEERKN5Eigen8MatrixXdEjjRN5Eigen8MatrixXdE">
<span id="FitPSF::PiecewiseBicubicPSFSmoothing::add_smoothing_matrix__std::vector:std::valarray:double::CR.Eigen::MatrixXdCR.unsigned.unsigned.Eigen::MatrixXdR"></span><span class="target" id="classFitPSF_1_1PiecewiseBicubicPSFSmoothing_1ac53e627d61b094565388828129df2365"></span>void <code class="descname">add_smoothing_matrix</code><span class="sig-paren">(</span><em class="property">const</em> std::vector&lt;std::valarray&lt;double&gt;&gt; &amp;<em>basis_parameter_sets</em>, <em class="property">const</em> Eigen::MatrixXd &amp;<em>penalty_matrix</em>, unsigned <em>basis_index</em>, unsigned <em>cell_index</em>, Eigen::MatrixXd &amp;<em>matrix</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing20add_smoothing_matrixERKNSt6vectorINSt8valarrayIdEEEERKN5Eigen8MatrixXdEjjRN5Eigen8MatrixXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Updates LHS matrix with the smoothing terms for single cell/basis vector. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">basis_parameter_sets</span></code>: The basis parameter sets returned by fill_basis_parameter_sets. </li>
<li><code class="docutils literal"><span class="pre">penalty_matrix</span></code>: The penalty matrix returned by fill_cell_penalty_matrix. </li>
<li><code class="docutils literal"><span class="pre">basis_index</span></code>: The index of the basis vector to add (zero should correspond to </li>
<li><code class="docutils literal"><span class="pre">cell_index</span></code>: The index of the cell (assuming the order in basis_parameter_sets). </li>
<li><code class="docutils literal"><span class="pre">matrix</span></code>: The RHS vector to add to. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing24__lhs_spatial_dependenceE">
<span id="FitPSF::PiecewiseBicubicPSFSmoothing::__lhs_spatial_dependence__Eigen::MatrixXd"></span><span class="target" id="classFitPSF_1_1PiecewiseBicubicPSFSmoothing_1a5f38168ce26a8dbb0b347b2dbca0479c"></span>Eigen::MatrixXd <code class="descname">__lhs_spatial_dependence</code><a class="headerlink" href="#_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing24__lhs_spatial_dependenceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The average of <span class="math">\( {\kappa^s}^T \kappa^s \)</span> over all sources. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing12__lhs_matrixE">
<span id="FitPSF::PiecewiseBicubicPSFSmoothing::__lhs_matrix__Eigen::MatrixXd"></span><span class="target" id="classFitPSF_1_1PiecewiseBicubicPSFSmoothing_1a814146cde8b68799adbb7ba49eedfe69"></span>Eigen::MatrixXd <code class="descname">__lhs_matrix</code><a class="headerlink" href="#_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing12__lhs_matrixE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classFitPSF_1_1PiecewiseBicubicPSFSmoothing_1a482f07fc11dbbaeafc79d61560714e30"><span class="std std-ref">lhs_correction()</span></a>. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing24__rhs_spatial_dependenceE">
<span id="FitPSF::PiecewiseBicubicPSFSmoothing::__rhs_spatial_dependence__Eigen::VectorXd"></span><span class="target" id="classFitPSF_1_1PiecewiseBicubicPSFSmoothing_1aba7974c6a9d33edb10e48dd18e88cf87"></span>Eigen::VectorXd <code class="descname">__rhs_spatial_dependence</code><a class="headerlink" href="#_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing24__rhs_spatial_dependenceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The average of the PSF terms for all sources. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing12__rhs_vectorE">
<span id="FitPSF::PiecewiseBicubicPSFSmoothing::__rhs_vector__Eigen::VectorXd"></span><span class="target" id="classFitPSF_1_1PiecewiseBicubicPSFSmoothing_1a7928ed648d939c6c23ad9fdde2b29831"></span>Eigen::VectorXd <code class="descname">__rhs_vector</code><a class="headerlink" href="#_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing12__rhs_vectorE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classFitPSF_1_1PiecewiseBicubicPSFSmoothing_1a5795e895d3a3316755318c7a6a67afaa"><span class="std std-ref">rhs_correction()</span></a>. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing10__preparedE">
<span id="FitPSF::PiecewiseBicubicPSFSmoothing::__prepared__b"></span><span class="target" id="classFitPSF_1_1PiecewiseBicubicPSFSmoothing_1aaae6d5f3629bd508afe4a2bf60e69433"></span>bool <code class="descname">__prepared</code><a class="headerlink" href="#_CPPv2N6FitPSF28PiecewiseBicubicPSFSmoothing10__preparedE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Is this object ready for smoothing? </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N6FitPSF5PixelE">
<span id="FitPSF::Pixel"></span><span class="target" id="classFitPSF_1_1Pixel"></span><em class="property">template </em>&lt;class <em>SOURCE_TYPE</em>&gt;<br /><em class="property">class </em><code class="descname">Pixel</code><a class="headerlink" href="#_CPPv2N6FitPSF5PixelE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;Pixel.h&gt;</em><p>A class tracking all pixel level informaiton for pixels participating in PSF/PRF fitting. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF5Pixel5PixelEjjKNSt4pairIddEEN4Core14PhotometryFlagEP11SOURCE_TYPEj">
<span id="FitPSF::Pixel::Pixel__unsigned.unsigned.std::pair:double.double:C.Core::PhotometryFlag.SOURCE_TYPEP.unsigned"></span><span class="target" id="classFitPSF_1_1Pixel_1a65c78dc17be347366b11558a8319dd32"></span><code class="descname">Pixel</code><span class="sig-paren">(</span>unsigned <em>x</em>, unsigned <em>y</em>, <em class="property">const</em> std::pair&lt;double, double&gt; <em>measured_variance</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core14PhotometryFlagE" title="Core::PhotometryFlag">PhotometryFlag</a> <em>flag</em>, SOURCE_TYPE *<em>source</em>, unsigned <em>flux_fit_index</em> = 0<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF5Pixel5PixelEjjKNSt4pairIddEEN4Core14PhotometryFlagEP11SOURCE_TYPEj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Construct a new pixel belonging to a single source. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x</span></code>: The x-coordinate of the pixel within the image. </li>
<li><code class="docutils literal"><span class="pre">y</span></code>: The y-coordinate of the pixel within the image. </li>
<li><code class="docutils literal"><span class="pre">measured_variance</span></code>: The measured value of the pixel and its variance in electrons and electrons^2 respectively. </li>
<li><code class="docutils literal"><span class="pre">flag</span></code>: The quality flag for this pixel. </li>
<li><code class="docutils literal"><span class="pre">source</span></code>: The source this pixel belongs to. More sources can be added later. </li>
<li><code class="docutils literal"><span class="pre">flux_fit_index</span></code>: The index within the flux fitting vector of this pixel (can be changed later). </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF5Pixel13add_to_sourceEP11SOURCE_TYPE">
<span id="FitPSF::Pixel::add_to_source__SOURCE_TYPEP"></span><span class="target" id="classFitPSF_1_1Pixel_1a8f4f99340c0fb3aa384493b78285757a"></span>void <code class="descname">add_to_source</code><span class="sig-paren">(</span>SOURCE_TYPE *<em>source</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF5Pixel13add_to_sourceEP11SOURCE_TYPE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Add this pixel to another source. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">source</span></code>: The source to add the pixel to. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF5Pixel7sourcesEv">
<span id="FitPSF::Pixel::sourcesC"></span><span class="target" id="classFitPSF_1_1Pixel_1a6d7f7d649e1b743975bcff3ab0bc8611"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF5Pixel9SourceSetE" title="FitPSF::Pixel::SourceSet">SourceSet</a> &amp;<code class="descname">sources</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF5Pixel7sourcesEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The set of sources this pixel belongs to. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF5Pixel1xEv">
<span id="FitPSF::Pixel::xC"></span><span class="target" id="classFitPSF_1_1Pixel_1af1fdc07e2d160b2fb8836e81a6d95521"></span>unsigned <code class="descname">x</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF5Pixel1xEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The x-coordinate of the pixel within the image. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF5Pixel1yEv">
<span id="FitPSF::Pixel::yC"></span><span class="target" id="classFitPSF_1_1Pixel_1a905a5a1bb10c715bcdfae31c1a906b2f"></span>unsigned <code class="descname">y</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF5Pixel1yEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The y-coordinate of the pixel within the image. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF5Pixel8measuredEv">
<span id="FitPSF::Pixel::measuredC"></span><span class="target" id="classFitPSF_1_1Pixel_1acd019bf325fc254249866d01c5b5d7eb"></span>double <code class="descname">measured</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF5Pixel8measuredEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The measured value of the pixel in electrons. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF5Pixel8varianceEv">
<span id="FitPSF::Pixel::varianceC"></span><span class="target" id="classFitPSF_1_1Pixel_1a92eafe32c4abc8dafebb7d61bd9472f1"></span>double <code class="descname">variance</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF5Pixel8varianceEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The estimated variance of the pixel in electrons^2. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF5Pixel9shape_fitEv">
<span id="FitPSF::Pixel::shape_fitC"></span><span class="target" id="classFitPSF_1_1Pixel_1a66a539d1bfae0b7bfba946f904c32e28"></span>bool <code class="descname">shape_fit</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF5Pixel9shape_fitEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Should this pixel be included in the fit for the PSF shape? </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF5Pixel8flux_fitEv">
<span id="FitPSF::Pixel::flux_fitC"></span><span class="target" id="classFitPSF_1_1Pixel_1aae9ab797c76188b693a35761d76d04fe"></span>bool <code class="descname">flux_fit</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF5Pixel8flux_fitEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Should this pixel be included in fit for the amplitude of its sources? </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF5Pixel22exclude_from_shape_fitEv">
<span id="FitPSF::Pixel::exclude_from_shape_fit"></span><span class="target" id="classFitPSF_1_1Pixel_1a572e0f78e7dd1231bfd5a9026295b8e6"></span>void <code class="descname">exclude_from_shape_fit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF5Pixel22exclude_from_shape_fitEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Exclude this pixel from the fit for the PSF shape. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF5Pixel21exclude_from_flux_fitEv">
<span id="FitPSF::Pixel::exclude_from_flux_fit"></span><span class="target" id="classFitPSF_1_1Pixel_1a96a98e65dd2fabb7e531c6eb16cf59bc"></span>void <code class="descname">exclude_from_flux_fit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF5Pixel21exclude_from_flux_fitEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Exclude this pixel from the fit for the PSF amplitudes. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF5Pixel14flux_fit_indexEv">
<span id="FitPSF::Pixel::flux_fit_indexC"></span><span class="target" id="classFitPSF_1_1Pixel_1aab2fc378cb6bdefb55e5f660a958f1e6"></span>unsigned <code class="descname">flux_fit_index</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF5Pixel14flux_fit_indexEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The index of this pixel within the flux fitting vector. </p>
<p>Note that shape fitting pixels may have indenedent orbering from flux only fitting pixels.</p>
<p>The behavior is undefined if the pixel is excluded from flux fitting. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF5Pixel18set_flux_fit_indexEj">
<span id="FitPSF::Pixel::set_flux_fit_index__unsigned"></span><span class="target" id="classFitPSF_1_1Pixel_1a954588eef381dea1c5210d42df4378d6"></span>void <code class="descname">set_flux_fit_index</code><span class="sig-paren">(</span>unsigned <em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF5Pixel18set_flux_fit_indexEj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set the index within the flux fitting vector for this pixel. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF5Pixel4flagEv">
<span id="FitPSF::Pixel::flagC"></span><span class="target" id="classFitPSF_1_1Pixel_1a57eab96be7f5d8211da2212e3fe31fd0"></span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core14PhotometryFlagE" title="Core::PhotometryFlag">PhotometryFlag</a> <code class="descname">flag</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF5Pixel4flagEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Is the pixel saturated? </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF5Pixel6sharedEv">
<span id="FitPSF::Pixel::sharedC"></span><span class="target" id="classFitPSF_1_1Pixel_1ade748d3ca7e8f8080797a5a4647a3beb"></span>bool <code class="descname">shared</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF5Pixel6sharedEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Is the pixel shared by more than one source. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Types</p>
<dl class="type">
<dt id="_CPPv2N6FitPSF5Pixel9SourceSetE">
<span id="FitPSF::Pixel::SourceSet"></span><span class="target" id="classFitPSF_1_1Pixel_1a5b6dadc9c71dee2b00c22cda5529262f"></span><em class="property">typedef </em>std::set&lt;SOURCE_TYPE *&gt; <code class="descname">SourceSet</code><a class="headerlink" href="#_CPPv2N6FitPSF5Pixel9SourceSetE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias type for a set of sources. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF5Pixel24exclusion_notify_sourcesEbb">
<span id="FitPSF::Pixel::exclusion_notify_sources__b.b"></span><span class="target" id="classFitPSF_1_1Pixel_1a183d0d418566f06619c37c806b09d0cb"></span>void <code class="descname">exclusion_notify_sources</code><span class="sig-paren">(</span>bool <em>from_shape_fit</em>, bool <em>from_flux_fit</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF5Pixel24exclusion_notify_sourcesEbb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Tell all sources that this pixel was excluded from the fit. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">from_shape_fit</span></code>: Was the pixel previously included in the shape fit and is now excluded? </li>
<li><code class="docutils literal"><span class="pre">from_flux_fit</span></code>: Was the pixel previously included in the flux fit and is now excluded? </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N6FitPSF5Pixel3__xE">
<span id="FitPSF::Pixel::__x__unsigned-l"></span><span class="target" id="classFitPSF_1_1Pixel_1a683cba77f7d7bc9da37fdbcb6db93a18"></span>unsigned long <code class="descname">__x</code><a class="headerlink" href="#_CPPv2N6FitPSF5Pixel3__xE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The x-coordinate of the pixel within the image. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF5Pixel3__yE">
<span id="FitPSF::Pixel::__y__unsigned-l"></span><span class="target" id="classFitPSF_1_1Pixel_1a32c9d9c46e3b7ef201b05e131df99fa8"></span>unsigned long <code class="descname">__y</code><a class="headerlink" href="#_CPPv2N6FitPSF5Pixel3__yE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The y-coordinate of the pixel within the image. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF5Pixel10__measuredE">
<span id="FitPSF::Pixel::__measured__double"></span><span class="target" id="classFitPSF_1_1Pixel_1a80a562e478b8714c7f62a28df8dcbf36"></span>double <code class="descname">__measured</code><a class="headerlink" href="#_CPPv2N6FitPSF5Pixel10__measuredE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The measured value of the pixel in electrons. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF5Pixel10__varianceE">
<span id="FitPSF::Pixel::__variance__double"></span><span class="target" id="classFitPSF_1_1Pixel_1a398821f83bd1f8c83122203ee877d913"></span>double <code class="descname">__variance</code><a class="headerlink" href="#_CPPv2N6FitPSF5Pixel10__varianceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The estiamted variance of the pixel in electrons^2. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF5Pixel6__flagE">
<span id="FitPSF::Pixel::__flag__Core::PhotometryFlag"></span><span class="target" id="classFitPSF_1_1Pixel_1a0e2beaa672dd85c85523da749dfe74fc"></span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core14PhotometryFlagE" title="Core::PhotometryFlag">PhotometryFlag</a> <code class="descname">__flag</code><a class="headerlink" href="#_CPPv2N6FitPSF5Pixel6__flagE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The qualty flag for this pixel. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF5Pixel11__shape_fitE">
<span id="FitPSF::Pixel::__shape_fit__b"></span><span class="target" id="classFitPSF_1_1Pixel_1aa5dd7a5c6fa86183cf0159018b5cb748"></span>bool <code class="descname">__shape_fit</code><a class="headerlink" href="#_CPPv2N6FitPSF5Pixel11__shape_fitE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Is this pixel included in the PSF/PRF shape fitting. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF5Pixel16__flux_fit_indexE">
<span id="FitPSF::Pixel::__flux_fit_index__i"></span><span class="target" id="classFitPSF_1_1Pixel_1afa57db75c4fae27060e120c3a3ab1c47"></span>int <code class="descname">__flux_fit_index</code><a class="headerlink" href="#_CPPv2N6FitPSF5Pixel16__flux_fit_indexE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The index of this pixel within the flux fitting vector (negative if excluded). </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF5Pixel9__sourcesE">
<span id="FitPSF::Pixel::__sources__SourceSet"></span><span class="target" id="classFitPSF_1_1Pixel_1a54e8f98b4854a4716d18d0c3f4ba8af7"></span><a class="reference internal" href="#_CPPv2N6FitPSF5Pixel9SourceSetE" title="FitPSF::Pixel::SourceSet">SourceSet</a> <code class="descname">__sources</code><a class="headerlink" href="#_CPPv2N6FitPSF5Pixel9__sourcesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The set of sources this pixel belongs to. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N6FitPSF10PixelOrderE">
<span id="FitPSF::PixelOrder"></span><span class="target" id="classFitPSF_1_1PixelOrder"></span><em class="property">class </em><code class="descname">PixelOrder</code><a class="headerlink" href="#_CPPv2N6FitPSF10PixelOrderE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;PixelOrder.h&gt;</em><p><a class="reference internal" href="#classFitPSF_1_1Pixel"><span class="std std-ref">Pixel</span></a> comparison predicate. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF10PixelOrder10PixelOrderEdd">
<span id="FitPSF::PixelOrder::PixelOrder__double.double"></span><span class="target" id="classFitPSF_1_1PixelOrder_1a32c0b5a94fe38662cbe7035467586d18"></span><code class="descname">PixelOrder</code><span class="sig-paren">(</span>double <em>background_electrons</em>, double <em>background_electrons_variance</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF10PixelOrder10PixelOrderEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Construct the predicate based on a given background. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">background_electrons</span></code>: The number of electrons per pixel in the background </li>
<li><code class="docutils literal"><span class="pre">background_electrons_variance</span></code>: The estiamted variance in background_electrons. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF10PixelOrderclEPK5PixelI15FIT_SOURCE_TYPEEPK5PixelI15FIT_SOURCE_TYPEE">
<span id="FitPSF::PixelOrder::call-operator__Pixel:FIT_SOURCE_TYPE:CP.Pixel:FIT_SOURCE_TYPE:CPC"></span><em class="property">template </em>&lt;<em class="property">class</em> FIT_SOURCE_TYPE&gt;<br /><span class="target" id="classFitPSF_1_1PixelOrder_1aa13f06b9aa13f850a0b2cd71fc52d0ca"></span>bool <code class="descname">operator()</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF5PixelE" title="FitPSF::Pixel">Pixel</a>&lt;FIT_SOURCE_TYPE&gt; *<em>first</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF5PixelE" title="FitPSF::Pixel">Pixel</a>&lt;FIT_SOURCE_TYPE&gt; *<em>second</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF10PixelOrderclEPK5PixelI15FIT_SOURCE_TYPEEPK5PixelI15FIT_SOURCE_TYPEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return True iff the first pixel belongs bofore the second in the ordered list of pixels. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N6FitPSF10PixelOrder22__background_electronsE">
<span id="FitPSF::PixelOrder::__background_electrons__double"></span><span class="target" id="classFitPSF_1_1PixelOrder_1ab8c9e4be581a93297c5c74c6ca6894e2"></span>double <code class="descname">__background_electrons</code><a class="headerlink" href="#_CPPv2N6FitPSF10PixelOrder22__background_electronsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classFitPSF_1_1Source_1ab414a0a1e019d88669d9acc9d047da24"><span class="std std-ref">Source::__background_electrons</span></a>. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF10PixelOrder31__background_electrons_varianceE">
<span id="FitPSF::PixelOrder::__background_electrons_variance__double"></span><span class="target" id="classFitPSF_1_1PixelOrder_1a8b4549d6bb3498095dbde9a09bd5355f"></span>double <code class="descname">__background_electrons_variance</code><a class="headerlink" href="#_CPPv2N6FitPSF10PixelOrder31__background_electrons_varianceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classFitPSF_1_1Source_1adaa28991cbecc94fd446183b684a3284"><span class="std std-ref">Source::__background_electrons_variance</span></a>. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N6FitPSF13PolynomialSDKE">
<span id="FitPSF::PolynomialSDK"></span><span class="target" id="classFitPSF_1_1PolynomialSDK"></span><em class="property">template </em>&lt;<em class="property">class</em> SUBPIX_TYPE&gt;<br /><em class="property">class </em><code class="descname">PolynomialSDK</code><a class="headerlink" href="#_CPPv2N6FitPSF13PolynomialSDKE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;PolynomialSDK.h&gt;</em><p>A class that assumes the PSF on an image is described by an elliptical Gaussian, specified via the S, D, K parameters, and that those parameters are low order polynomials of the image position and fits for the coefficients of the polynomials. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF13PolynomialSDK13PolynomialSDKEdddd">
<span id="FitPSF::PolynomialSDK::PolynomialSDK__double.double.double.double"></span><span class="target" id="classFitPSF_1_1PolynomialSDK_1a7c07605b5aad90c00247216be9c0d5bc"></span><code class="descname">PolynomialSDK</code><span class="sig-paren">(</span>double <em>minS</em>, double <em>maxS</em>, double <em>fit_tolerance</em> = 1e-2, double <em>max_source_chi2</em> = 10.0<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13PolynomialSDK13PolynomialSDKEdddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">minS</span></code>: The lower end of the range of S values to consider for this image. </li>
<li><code class="docutils literal"><span class="pre">maxS</span></code>: The upper end of the range of S values to consider for this image. </li>
<li><code class="docutils literal"><span class="pre">fit_tolerance</span></code>: The maximum allowed uncertainty in the best fit values of S, D and K </li>
<li><code class="docutils literal"><span class="pre">max_source_chi2</span></code>: Sources for which the reduced chi2 is larger than this value are dropped from the fit on the grounds that they are probably not point sources. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13PolynomialSDK7gsl_fitE15SOURCE_ITERATOR15SOURCE_ITERATORRK11SUBPIX_TYPERKNSt4listIdEE">
<span id="FitPSF::PolynomialSDK::gsl_fit__SOURCE_ITERATOR.SOURCE_ITERATOR.SUBPIX_TYPECR.std::list:double:CR"></span><em class="property">template </em>&lt;<em class="property">class</em> SOURCE_ITERATOR&gt;<br /><span class="target" id="classFitPSF_1_1PolynomialSDK_1afe86be3b812bd7d7c4a87b7b27b56419"></span>void <code class="descname">gsl_fit</code><span class="sig-paren">(</span>SOURCE_ITERATOR <em>first_source</em>, SOURCE_ITERATOR <em>past_last_source</em>, <em class="property">const</em> SUBPIX_TYPE &amp;<em>subpix_map</em>, <em class="property">const</em> std::list&lt;double&gt; &amp;<em>guess_poly_coef</em> = std::list&lt; double &gt;()<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13PolynomialSDK7gsl_fitE15SOURCE_ITERATOR15SOURCE_ITERATORRK11SUBPIX_TYPERKNSt4listIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Performs the fit for the PSF dependence based on the given list of sources and returns a list of SDK sources with properly set S,D,K, amplitude and background. Uses GSL simplex method for the fit. </p>
<p>Performs the fit for the PSF dependence based on the given list of sources and returns a list of SDK sources with properly set S,D,K, amplitude and background. Uses GSL simplex method for the fit. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13PolynomialSDK12chi2_grad_d2E15SOURCE_ITERATOR15SOURCE_ITERATORRKN5Eigen8VectorXdERK11SUBPIX_TYPERdRN5Eigen8VectorXdERN5Eigen8MatrixXdE">
<span id="FitPSF::PolynomialSDK::chi2_grad_d2__SOURCE_ITERATOR.SOURCE_ITERATOR.Eigen::VectorXdCR.SUBPIX_TYPECR.doubleR.Eigen::VectorXdR.Eigen::MatrixXdR"></span><em class="property">template </em>&lt;<em class="property">class</em> SOURCE_ITERATOR&gt;<br /><span class="target" id="classFitPSF_1_1PolynomialSDK_1a396cca2d8ebd4c2fc8f606f0b4b4f8b3"></span>void <code class="descname">chi2_grad_d2</code><span class="sig-paren">(</span>SOURCE_ITERATOR <em>first_source</em>, SOURCE_ITERATOR <em>past_last_source</em>, <em class="property">const</em> Eigen::VectorXd &amp;<em>poly_coef</em>, <em class="property">const</em> SUBPIX_TYPE &amp;<em>subpix_map</em>, double &amp;<em>chi2</em>, Eigen::VectorXd &amp;<em>grad</em>, Eigen::MatrixXd &amp;<em>d2</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13PolynomialSDK12chi2_grad_d2E15SOURCE_ITERATOR15SOURCE_ITERATORRKN5Eigen8VectorXdERK11SUBPIX_TYPERdRN5Eigen8VectorXdERN5Eigen8MatrixXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fills grad with the gradient vector and d2 with the second derivative matrix of chi squared for the given sources and S, D, K expansion of the given order. The gradient (second order derivative) is only defined if the given sources have first (second) order derivatives enabled. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13PolynomialSDK6nr_fitE15SOURCE_ITERATOR15SOURCE_ITERATORRK11SUBPIX_TYPERKNSt4listIdEE">
<span id="FitPSF::PolynomialSDK::nr_fit__SOURCE_ITERATOR.SOURCE_ITERATOR.SUBPIX_TYPECR.std::list:double:CR"></span><em class="property">template </em>&lt;<em class="property">class</em> SOURCE_ITERATOR&gt;<br /><span class="target" id="classFitPSF_1_1PolynomialSDK_1ada471d41ad81dd12d0bb7747471674f7"></span>void <code class="descname">nr_fit</code><span class="sig-paren">(</span>SOURCE_ITERATOR <em>first_source</em>, SOURCE_ITERATOR <em>past_last_source</em>, <em class="property">const</em> SUBPIX_TYPE &amp;<em>subpix_map</em>, <em class="property">const</em> std::list&lt;double&gt; &amp;<em>guess_poly_coef</em> = std::list&lt; double &gt;()<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13PolynomialSDK6nr_fitE15SOURCE_ITERATOR15SOURCE_ITERATORRK11SUBPIX_TYPERKNSt4listIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The same as gsl_fit, but uses Newton-Raphon method to solve for a zero of the gradient of chi squared. </p>
<p>The same as gsl_fit, but uses Newton-Raphon method to solve for a zero of the gradient of chi squared. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13PolynomialSDK16best_fit_sourcesE15SOURCE_ITERATOR15SOURCE_ITERATORRK11SUBPIX_TYPEd">
<span id="FitPSF::PolynomialSDK::best_fit_sources__SOURCE_ITERATOR.SOURCE_ITERATOR.SUBPIX_TYPECR.double"></span><em class="property">template </em>&lt;<em class="property">class</em> SOURCE_ITERATOR&gt;<br /><span class="target" id="classFitPSF_1_1PolynomialSDK_1ab972550d1a627a1fe46a165ea10ae8c2"></span>std::list&lt;<a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO15OutputSDKSourceE" title="IO::OutputSDKSource">OutputSDKSource</a>&gt; <code class="descname">best_fit_sources</code><span class="sig-paren">(</span>SOURCE_ITERATOR <em>first_source</em>, SOURCE_ITERATOR <em>past_last_source</em>, <em class="property">const</em> SUBPIX_TYPE &amp;<em>subpix_map</em>, double <em>gain</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13PolynomialSDK16best_fit_sourcesE15SOURCE_ITERATOR15SOURCE_ITERATORRK11SUBPIX_TYPEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Prepares a list of <a class="reference internal" href="#classFitPSF_1_1SDKSource"><span class="std std-ref">SDKSource</span></a> objects properly initialized with S, D, K, amplitude and background according to the latest best fit polynomial coefficients. </p>
<p>Prepares a list of <a class="reference internal" href="#classFitPSF_1_1SDKSource"><span class="std std-ref">SDKSource</span></a> objects properly initialized with S, D, K, amplitude and background according to the latest best fit polynomial coefficients. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13PolynomialSDKclERKN3PSF9MapSourceERK9COEF_TYPE">
<span id="FitPSF::PolynomialSDK::call-operator__PSF::MapSourceCR.COEF_TYPECR"></span><em class="property">template </em>&lt;<em class="property">class</em> COEF_TYPE&gt;<br /><span class="target" id="classFitPSF_1_1PolynomialSDK_1a0145dfd9af8c4a6b46f075ff6129172c"></span><a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF18EllipticalGaussianE" title="PSF::EllipticalGaussian">EllipticalGaussian</a> <code class="descname">operator()</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF9MapSourceE" title="PSF::MapSource">MapSource</a> &amp;<em>source</em>, <em class="property">const</em> COEF_TYPE &amp;<em>poly_coef</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13PolynomialSDKclERKN3PSF9MapSourceERK9COEF_TYPE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Make PolynomialSDK::operator() available. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13PolynomialSDKclERKN3PSF9MapSourceE">
<span id="FitPSF::PolynomialSDK::call-operator__PSF::MapSourceCR"></span><span class="target" id="classFitPSF_1_1PolynomialSDK_1ac7d92321dccdca303f48e3365ac7210c"></span><a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF18EllipticalGaussianE" title="PSF::EllipticalGaussian">EllipticalGaussian</a> <code class="descname">operator()</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF9MapSourceE" title="PSF::MapSource">MapSource</a> &amp;<em>source</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13PolynomialSDKclERKN3PSF9MapSourceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Evaluates the most recently derived fit (or the polynomial defined by the given coefficients) at the given position, returning a PSF that would be appropriate for a source centered there. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13PolynomialSDK16get_coefficientsEv">
<span id="FitPSF::PolynomialSDK::get_coefficientsC"></span><span class="target" id="classFitPSF_1_1PolynomialSDK_1aed4c7b61554a95b5247a35a9c1808f2b"></span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<code class="descname">get_coefficients</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13PolynomialSDK16get_coefficientsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the best fit polynomial coefficients. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF13PolynomialSDK12initial_polyEP10gsl_vector">
<span id="FitPSF::PolynomialSDK::initial_poly__gsl_vectorP"></span><span class="target" id="classFitPSF_1_1PolynomialSDK_1ab4ebf861e8c71a34e2aec539b5da3b13"></span>gsl_vector *<code class="descname">initial_poly</code><span class="sig-paren">(</span>gsl_vector *<em>lower_order_coef</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13PolynomialSDK12initial_polyEP10gsl_vector" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns initial guesses for the S, D and K polynomials in a newly allocated GSL vector generated from the coefficients of a fit with one less term. </p>
<p>Returns initial guesses for the S, D and K polynomials in a newly allocated GSL vector generated from the coefficients of a fit one smaller order. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13PolynomialSDK10find_mid_SERdRdPv">
<span id="FitPSF::PolynomialSDK::find_mid_S__doubleR.doubleR.voidP"></span><span class="target" id="classFitPSF_1_1PolynomialSDK_1aed34dabcb4f312cc0b4156c1f489c1bb"></span>double <code class="descname">find_mid_S</code><span class="sig-paren">(</span>double &amp;<em>min_S</em>, double &amp;<em>max_S</em>, void *<em>param_array</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13PolynomialSDK10find_mid_SERdRdPv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Finds a point between min_S and max_S that has a chi squared value less than at both min_S and max_S. Also possibly updates min_S and max_S to a narrower internal. </p>
<p>Finds a point between min_S and max_S that has a chi squared value less than at both min_S and max_S. Also possibly updates min_S and max_S to a narrower internal. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13PolynomialSDK13fit_initial_SE15SOURCE_ITERATOR15SOURCE_ITERATORRK11SUBPIX_TYPEdd">
<span id="FitPSF::PolynomialSDK::fit_initial_S__SOURCE_ITERATOR.SOURCE_ITERATOR.SUBPIX_TYPECR.double.double"></span><em class="property">template </em>&lt;<em class="property">class</em> SOURCE_ITERATOR&gt;<br /><span class="target" id="classFitPSF_1_1PolynomialSDK_1ac87c2947d5a02515f87d87481cf4b6a1"></span>double <code class="descname">fit_initial_S</code><span class="sig-paren">(</span>SOURCE_ITERATOR <em>first_source</em>, SOURCE_ITERATOR <em>past_last_source</em>, <em class="property">const</em> SUBPIX_TYPE &amp;<em>subpix_map</em>, double <em>min_S</em>, double <em>max_S</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13PolynomialSDK13fit_initial_SE15SOURCE_ITERATOR15SOURCE_ITERATORRK11SUBPIX_TYPEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Performs a sigle dimensional fit for an approximate S value of the image. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13PolynomialSDK18restricted_gsl_fitEP10gsl_vectorPvd">
<span id="FitPSF::PolynomialSDK::restricted_gsl_fit__gsl_vectorP.voidP.double"></span><span class="target" id="classFitPSF_1_1PolynomialSDK_1a49d090b95832c05fe05025d09ce57f76"></span>void <code class="descname">restricted_gsl_fit</code><span class="sig-paren">(</span>gsl_vector *<em>poly_coef</em>, void *<em>gsl_params</em>, double <em>initial_step_size</em> = 0.5<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13PolynomialSDK18restricted_gsl_fitEP10gsl_vectorPvd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Performs a fit for the PSF dependence restricted to terms of up to the given order starting with the given initial coefficients (overwritten on exit). Assumes that gsl_params variable is already properly initialized as required by gsl_minimization_function. </p>
<p>Performs a fit for the PSF dependence restricted to terms of up to the given order starting with the given initial coefficients. Assumes that gsl_params variable is already properly initialized as required by gsl_minimization_function. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13PolynomialSDK7nr_stepE15SOURCE_ITERATOR15SOURCE_ITERATORRK11SUBPIX_TYPERKN5Eigen8VectorXdEdRN5Eigen8VectorXdERdRN5Eigen8VectorXdERN5Eigen8MatrixXdE">
<span id="FitPSF::PolynomialSDK::nr_step__SOURCE_ITERATOR.SOURCE_ITERATOR.SUBPIX_TYPECR.Eigen::VectorXdCR.double.Eigen::VectorXdR.doubleR.Eigen::VectorXdR.Eigen::MatrixXdR"></span><em class="property">template </em>&lt;<em class="property">class</em> SOURCE_ITERATOR&gt;<br /><span class="target" id="classFitPSF_1_1PolynomialSDK_1aff9fd2191f9ae0ab9d139ede1ee8f329"></span>bool <code class="descname">nr_step</code><span class="sig-paren">(</span>SOURCE_ITERATOR <em>first_source</em>, SOURCE_ITERATOR <em>past_last_source</em>, <em class="property">const</em> SUBPIX_TYPE &amp;<em>subpix_map</em>, <em class="property">const</em> Eigen::VectorXd &amp;<em>coef_change</em>, double <em>max_SDK_change</em>, Eigen::VectorXd &amp;<em>poly_coef</em>, double &amp;<em>chi2</em>, Eigen::VectorXd &amp;<em>grad</em>, Eigen::MatrixXd &amp;<em>d2</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13PolynomialSDK7nr_stepE15SOURCE_ITERATOR15SOURCE_ITERATORRK11SUBPIX_TYPERKN5Eigen8VectorXdEdRN5Eigen8VectorXdERdRN5Eigen8VectorXdERN5Eigen8MatrixXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Performs a single nr step (updating poly_coef and chi2) such that at the end chi squared is smaller than at the beginning. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13PolynomialSDK19single_order_nr_fitE15SOURCE_ITERATOR15SOURCE_ITERATORRK11SUBPIX_TYPERN5Eigen8VectorXdE">
<span id="FitPSF::PolynomialSDK::single_order_nr_fit__SOURCE_ITERATOR.SOURCE_ITERATOR.SUBPIX_TYPECR.Eigen::VectorXdR"></span><em class="property">template </em>&lt;<em class="property">class</em> SOURCE_ITERATOR&gt;<br /><span class="target" id="classFitPSF_1_1PolynomialSDK_1a6471b01941391f2c2be7f4b0ed95a71f"></span>void <code class="descname">single_order_nr_fit</code><span class="sig-paren">(</span>SOURCE_ITERATOR <em>first_source</em>, SOURCE_ITERATOR <em>past_last_source</em>, <em class="property">const</em> SUBPIX_TYPE &amp;<em>subpix_map</em>, Eigen::VectorXd &amp;<em>poly_coef</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13PolynomialSDK19single_order_nr_fitE15SOURCE_ITERATOR15SOURCE_ITERATORRK11SUBPIX_TYPERN5Eigen8VectorXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Performs a Newton-Raphson fit for a single order. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13PolynomialSDK24find_max_expansion_termsE15SOURCE_ITERATOR15SOURCE_ITERATOR">
<span id="FitPSF::PolynomialSDK::find_max_expansion_terms__SOURCE_ITERATOR.SOURCE_ITERATOR"></span><em class="property">template </em>&lt;<em class="property">class</em> SOURCE_ITERATOR&gt;<br /><span class="target" id="classFitPSF_1_1PolynomialSDK_1a4db1d543076912756972f9c0198376c7"></span>void <code class="descname">find_max_expansion_terms</code><span class="sig-paren">(</span>SOURCE_ITERATOR <em>first_source</em>, SOURCE_ITERATOR <em>past_last_source</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13PolynomialSDK24find_max_expansion_termsE15SOURCE_ITERATOR15SOURCE_ITERATOR" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fills in __max_abs_expansion_terms. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N6FitPSF13PolynomialSDK6__minSE">
<span id="FitPSF::PolynomialSDK::__minS__double"></span><span class="target" id="classFitPSF_1_1PolynomialSDK_1ac3ed52bde3c4d52041e83a079cb0af26"></span>double <code class="descname">__minS</code><a class="headerlink" href="#_CPPv2N6FitPSF13PolynomialSDK6__minSE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Lower limit for the initial search of PSF scale. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13PolynomialSDK6__maxSE">
<span id="FitPSF::PolynomialSDK::__maxS__double"></span><span class="target" id="classFitPSF_1_1PolynomialSDK_1aee795155b2f065e72ca559808027263b"></span>double <code class="descname">__maxS</code><a class="headerlink" href="#_CPPv2N6FitPSF13PolynomialSDK6__maxSE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Upper limit for the initial search of PSF scale. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13PolynomialSDK15__fit_toleranceE">
<span id="FitPSF::PolynomialSDK::__fit_tolerance__double"></span><span class="target" id="classFitPSF_1_1PolynomialSDK_1a2bef0dc2ccf2ec3a376be034c9838b68"></span>double <code class="descname">__fit_tolerance</code><a class="headerlink" href="#_CPPv2N6FitPSF13PolynomialSDK15__fit_toleranceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The tolerance to which to determine fit values. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13PolynomialSDK17__max_source_chi2E">
<span id="FitPSF::PolynomialSDK::__max_source_chi2__double"></span><span class="target" id="classFitPSF_1_1PolynomialSDK_1abf0e686c8f849470ccd8e65dd2a9853e"></span>double <code class="descname">__max_source_chi2</code><a class="headerlink" href="#_CPPv2N6FitPSF13PolynomialSDK17__max_source_chi2E" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The maximum reduced chi squared allowed before a source is dropped from the fit. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13PolynomialSDK11__poly_coefE">
<span id="FitPSF::PolynomialSDK::__poly_coef__std::valarray:double:"></span><span class="target" id="classFitPSF_1_1PolynomialSDK_1a05a2188c4f1e261cc0af1d603b1c6bbc"></span>std::valarray&lt;double&gt; <code class="descname">__poly_coef</code><a class="headerlink" href="#_CPPv2N6FitPSF13PolynomialSDK11__poly_coefE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The polynomial coefficients of S (first), D (second), K (third) in the order of the PSFMap terms. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13PolynomialSDK25__max_abs_expansion_termsE">
<span id="FitPSF::PolynomialSDK::__max_abs_expansion_terms__Eigen::VectorXd"></span><span class="target" id="classFitPSF_1_1PolynomialSDK_1ae1293f1efd07b32c4c870f2fd009d5ec"></span>Eigen::VectorXd <code class="descname">__max_abs_expansion_terms</code><a class="headerlink" href="#_CPPv2N6FitPSF13PolynomialSDK25__max_abs_expansion_termsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The largest absolute value of each PSF term over all sources. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N6FitPSF9SDKSourceE">
<span id="FitPSF::SDKSource"></span><span class="target" id="classFitPSF_1_1SDKSource"></span><em class="property">template </em>&lt;<em class="property">class</em> SUBPIX_TYPE&gt;<br /><em class="property">class </em><code class="descname">SDKSource</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv26FitPSF" title="FitPSF">FitPSF</a>::<a class="reference internal" href="#_CPPv2N6FitPSF13SDKSourceBaseE" title="FitPSF::SDKSourceBase">SDKSourceBase</a><a class="headerlink" href="#_CPPv2N6FitPSF9SDKSourceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;SDKSource.h&gt;</em><p>A PSF fitting source class based on a LocalPolynomialPSF. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF9SDKSource9SDKSourceERKN4Core8SourceIDEddRKN10Background6SourceERKN4Core5ImageIdEERKNSt6stringER12EIGEN_MATRIXddidbb">
<span id="FitPSF::SDKSource::SDKSource__Core::SourceIDCR.double.double.Background::SourceCR.Core::Image:double:CR.ssCR.EIGEN_MATRIXR.double.double.i.double.b.b"></span><em class="property">template </em>&lt;<em class="property">class</em> EIGEN_MATRIX&gt;<br /><span class="target" id="classFitPSF_1_1SDKSource_1a5980b6132dd8e9327e1d0a80f7152c75"></span><code class="descname">SDKSource</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> &amp;<em>id</em>, double <em>x</em>, double <em>y</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> &amp;<em>background</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5ImageE" title="Core::Image">Image</a>&lt;double&gt; &amp;<em>observed_image</em>, <em class="property">const</em> std::string &amp;<em>output_fname</em>, EIGEN_MATRIX &amp;<em>source_assignment</em>, double <em>gain</em>, double <em>alpha</em>, int <em>source_id</em>, double <em>max_circular_aperture</em> = 0, bool <em>calculate_first_deriv</em> = false, bool <em>calculate_second_deriv</em> = false<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF9SDKSource9SDKSourceERKN4Core8SourceIDEddRKN10Background6SourceERKN4Core5ImageIdEERKNSt6stringER12EIGEN_MATRIXddidbb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Identify the pixels which belong to a source. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">id</span></code>: The I.D. of the source for which to identify pixels. </li>
<li><code class="docutils literal"><span class="pre">x</span></code>: The abscissa coordinate of the source center. </li>
<li><code class="docutils literal"><span class="pre">y</span></code>: The oordinate coordinate of the source center. </li>
<li><code class="docutils literal"><span class="pre">background</span></code>: The background under the pixel (in ADU) </li>
<li><code class="docutils literal"><span class="pre">observed_image</span></code>: The actual image we are deriving a PSF map for </li>
<li><code class="docutils literal"><span class="pre">output_fname</span></code>: See <a class="reference internal" href="#classFitPSF_1_1Source"><span class="std std-ref">Source</span></a> constructor. </li>
<li><code class="docutils literal"><span class="pre">source_assignment</span></code>: A two dimensional array which keeps track of what pixels of the input image are assigned to what source. On exit it is updated with the pixels belonging to the newly constructed source. </li>
<li><code class="docutils literal"><span class="pre">gain</span></code>: The gain (electrons per ADU) in the observed image </li>
<li><code class="docutils literal"><span class="pre">alpha</span></code>: How much above the background a pixel needs to be in order to be allocated to this source (the alpha parameter in the description) </li>
<li><code class="docutils literal"><span class="pre">source_id</span></code>: The id to assign to this source in the source_assignment array </li>
<li><code class="docutils literal"><span class="pre">max_circular_aperture</span></code>: If nonzero impose a circular aperture for the source no larger than the given value (otherwise uses only pixels inconsistent with the background at the prescribed by alpha level). The size of the circular aperture is the smallest size possible that encapsulates all pixels that pass the alpha test. </li>
<li><code class="docutils literal"><span class="pre">calculate_first_deriv</span></code>: Should first order derivatives of the integral of the PSF over a pixel be calculated. </li>
<li><code class="docutils literal"><span class="pre">calculate_second_deriv</span></code>: Should second order derivatives of the integral of the PSF over a pixel be calculated. </li>
</ul>
</dd>
</dl>
</p>
<p>Identify the pixels which belong to the source centered at (x,y). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF9SDKSource9pixel_psfEN3PSF13SDKDerivativeE">
<span id="FitPSF::SDKSource::pixel_psf__PSF::SDKDerivativeC"></span><span class="target" id="classFitPSF_1_1SDKSource_1a2c70ee1942bf72f1b3ec5a3f3b12c0fa"></span>double <code class="descname">pixel_psf</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF13SDKDerivativeE" title="PSF::SDKDerivative">SDKDerivative</a> <em>deriv</em> = PSF::NO_DERIV<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF9SDKSource9pixel_psfEN3PSF13SDKDerivativeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The integral of the normalized PSF over the current pixel and its derivatives. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF9SDKSource7set_PSFERKN3PSF18EllipticalGaussianERK11SUBPIX_TYPE">
<span id="FitPSF::SDKSource::set_PSF__PSF::EllipticalGaussianCR.SUBPIX_TYPECR"></span><span class="target" id="classFitPSF_1_1SDKSource_1a7887ddefe473c506458ee74394fb3c8d"></span>void <code class="descname">set_PSF</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF18EllipticalGaussianE" title="PSF::EllipticalGaussian">EllipticalGaussian</a> &amp;<em>psf</em>, <em class="property">const</em> SUBPIX_TYPE &amp;<em>subpix_map</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF9SDKSource7set_PSFERKN3PSF18EllipticalGaussianERK11SUBPIX_TYPE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Recalculates the integrals of the PSF over the source pixels using the given PSF and sub-pixel map. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF9SDKSource10next_pixelEv">
<span id="FitPSF::SDKSource::next_pixel"></span><span class="target" id="classFitPSF_1_1SDKSource_1ac7500f60802b90cca347f2b782391915"></span><em class="property">virtual</em> bool <code class="descname">next_pixel</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF9SDKSource10next_pixelEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Advance to the next pixel of the source returning true if it is not past the last pixel. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF9SDKSource23restart_pixel_iterationEv">
<span id="FitPSF::SDKSource::restart_pixel_iteration"></span><span class="target" id="classFitPSF_1_1SDKSource_1af017d030364929ad145fcd855e4b6371"></span><em class="property">virtual</em> void <code class="descname">restart_pixel_iteration</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF9SDKSource23restart_pixel_iterationEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Restarts the iteration over pixels from the beginning. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF9SDKSource12psf_integralEddRKN3PSF18EllipticalGaussianERK11SUBPIX_TYPEd">
<span id="FitPSF::SDKSource::psf_integral__double.double.PSF::EllipticalGaussianCR.SUBPIX_TYPECR.double"></span><span class="target" id="classFitPSF_1_1SDKSource_1a5f6f8dcce0130857401c1739ea06f475"></span>std::valarray&lt;double&gt; <code class="descname">psf_integral</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF18EllipticalGaussianE" title="PSF::EllipticalGaussian">EllipticalGaussian</a> &amp;<em>psf</em>, <em class="property">const</em> SUBPIX_TYPE &amp;<em>subpix_map</em>, double <em>precision</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF9SDKSource12psf_integralEddRKN3PSF18EllipticalGaussianERK11SUBPIX_TYPEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculates the sub-pixel weighted integral of the given PSF over a pixel. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x</span></code>: The left edge of the pixel relative to the source. </li>
<li><code class="docutils literal"><span class="pre">y</span></code>: The lower edge of the pixel relative to the source. </li>
<li><code class="docutils literal"><span class="pre">psf</span></code>: The point spread function or pixel response function of the source (which is assumed depends in subpix_map). </li>
<li><code class="docutils literal"><span class="pre">subpix_map</span></code>: The sub-pixel sensitivity map. If the map resolution is 0x0 the psf argument is assumed to be the PRF. </li>
<li><code class="docutils literal"><span class="pre">precision</span></code>: The relative precision to which the integra should be calculated. </li>
</ul>
</dd>
</dl>
</p>
<p>Calculates the sub-pixel weighted integral of the given PSF over the pixel with lower left corner at (x, y) relative to the source center. The presicion specified is relative. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N6FitPSF9SDKSource12__psf_pixelsE">
<span id="FitPSF::SDKSource::__psf_pixels__std::list:std::valarray:double::"></span><span class="target" id="classFitPSF_1_1SDKSource_1a0d911d3af7809b91608162fdaf7cb62f"></span>std::list&lt;std::valarray&lt;double&gt;&gt; <code class="descname">__psf_pixels</code><a class="headerlink" href="#_CPPv2N6FitPSF9SDKSource12__psf_pixelsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The integral of the normalized PSF over all pixels belonging to the source. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF9SDKSource14__psf_int_iterE">
<span id="FitPSF::SDKSource::__psf_int_iter__std::list:std::valarray:double::::const_iterator"></span><span class="target" id="classFitPSF_1_1SDKSource_1a2d30dbd04bd3615cb6cda835fa5c00d8"></span>std::list&lt;std::valarray&lt;double&gt;&gt;::const_iterator <code class="descname">__psf_int_iter</code><a class="headerlink" href="#_CPPv2N6FitPSF9SDKSource14__psf_int_iterE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>An iterator over the PSF integrals and their derivatives over pixels. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N6FitPSF13SDKSourceBaseE">
<span id="FitPSF::SDKSourceBase"></span><span class="target" id="classFitPSF_1_1SDKSourceBase"></span><em class="property">class </em><code class="descname">SDKSourceBase</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv26FitPSF" title="FitPSF">FitPSF</a>::<a class="reference internal" href="#_CPPv2N6FitPSF6SourceE" title="FitPSF::Source">Source</a>&lt;<a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF18EllipticalGaussianE" title="PSF::EllipticalGaussian">EllipticalGaussian</a>&gt;<a class="headerlink" href="#_CPPv2N6FitPSF13SDKSourceBaseE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;SDKSourceBase.h&gt;</em><p>An abstract class that defines the minimum requirements of a source to participate in the fitting for an elliptical gaussian PSF model. </p>
<p>Subclassed by <a class="reference internal" href="#classFitPSF_1_1SDKSource"><span class="std std-ref">FitPSF::SDKSource&lt; SUBPIX_TYPE &gt;</span></a></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF13SDKSourceBase13SDKSourceBaseERKN4Core8SourceIDEddRKN10Background6SourceERKN4Core5ImageIdEER12EIGEN_MATRIXddiRKNSt6stringEbbd">
<span id="FitPSF::SDKSourceBase::SDKSourceBase__Core::SourceIDCR.double.double.Background::SourceCR.Core::Image:double:CR.EIGEN_MATRIXR.double.double.i.ssCR.b.b.double"></span><em class="property">template </em>&lt;<em class="property">class</em> EIGEN_MATRIX&gt;<br /><span class="target" id="classFitPSF_1_1SDKSourceBase_1af9dcccaf5743ff449b6f593c5a1a037d"></span><code class="descname">SDKSourceBase</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> &amp;<em>id</em>, double <em>x0</em>, double <em>y0</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> &amp;<em>background</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5ImageE" title="Core::Image">Image</a>&lt;double&gt; &amp;<em>observed_image</em>, EIGEN_MATRIX &amp;<em>source_assignment</em>, double <em>gain</em>, double <em>alpha</em>, int <em>source_id</em>, <em class="property">const</em> std::string &amp;<em>output_fname</em>, bool <em>calculate_first_deriv</em> = false, bool <em>calculate_second_deriv</em> = false, double <em>max_circular_aperture</em> = 0<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13SDKSourceBase13SDKSourceBaseERKN4Core8SourceIDEddRKN10Background6SourceERKN4Core5ImageIdEER12EIGEN_MATRIXddiRKNSt6stringEbbd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a source for fitting an elliptical gaussian PSF model. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">id</span></code>: See <a class="reference internal" href="#classFitPSF_1_1Source_1a31a794b3cf276fafba3ca97f213b6dbe"><span class="std std-ref">Source::Source()</span></a> </li>
<li><code class="docutils literal"><span class="pre">x0</span></code>: See <a class="reference internal" href="#classFitPSF_1_1Source_1a31a794b3cf276fafba3ca97f213b6dbe"><span class="std std-ref">Source::Source()</span></a> </li>
<li><code class="docutils literal"><span class="pre">y0</span></code>: See <a class="reference internal" href="#classFitPSF_1_1Source_1a31a794b3cf276fafba3ca97f213b6dbe"><span class="std std-ref">Source::Source()</span></a> </li>
<li><code class="docutils literal"><span class="pre">background</span></code>: The background under the pixel (in ADU) </li>
<li><code class="docutils literal"><span class="pre">observed_image</span></code>: The actual image we are deriving a PSF map for </li>
<li><code class="docutils literal"><span class="pre">source_assignment</span></code>: A two dimensional array which keeps track of what pixels of the input image are assigned to what source. On exit it is updated with the pixels belonging to the newly constructed source. </li>
<li><code class="docutils literal"><span class="pre">gain</span></code>: The gain (electrons per ADU) in the observed image </li>
<li><code class="docutils literal"><span class="pre">alpha</span></code>: How much above the background a pixel needs to be in order to be allocated to this source (the alpha parameter in the description) </li>
<li><code class="docutils literal"><span class="pre">source_id</span></code>: The id to assign to this source in the source_assignment array </li>
<li><code class="docutils literal"><span class="pre">output_fname</span></code>: See <a class="reference internal" href="#classFitPSF_1_1Source"><span class="std std-ref">Source</span></a> constructor. </li>
<li><code class="docutils literal"><span class="pre">calculate_first_deriv</span></code>: Should first order derivatives with respect to S, D and K be calculated </li>
<li><code class="docutils literal"><span class="pre">calculate_second_deriv</span></code>: Should second order derivatives with respect to S, D and K be calculated </li>
<li><code class="docutils literal"><span class="pre">max_circular_aperture</span></code>: If nonzero impose a circular aperture for the source no larger than the given value (otherwise uses only pixels inconsistent with the background at the prescribed by alpha level). The size of the circular aperture is the smallest size possible that encapsulates all pixels that pass the alpha test. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13SDKSourceBase18enable_first_derivEv">
<span id="FitPSF::SDKSourceBase::enable_first_deriv"></span><span class="target" id="classFitPSF_1_1SDKSourceBase_1a82d58a04f19e0f9fee5dcbbf9a052e9a"></span>void <code class="descname">enable_first_deriv</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13SDKSourceBase18enable_first_derivEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Enables the calculation of the first order derivatives of the amplitude and <span class="math">\(\chi^2\)</span>. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13SDKSourceBase19disable_first_derivEv">
<span id="FitPSF::SDKSourceBase::disable_first_deriv"></span><span class="target" id="classFitPSF_1_1SDKSourceBase_1abbbd5dbb7295534fbaac2e721e52e2de"></span>void <code class="descname">disable_first_deriv</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13SDKSourceBase19disable_first_derivEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Disables the calculation of the first order derivatives of the amplitude and <span class="math">\(\chi^2\)</span>. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13SDKSourceBase19enable_second_derivEv">
<span id="FitPSF::SDKSourceBase::enable_second_deriv"></span><span class="target" id="classFitPSF_1_1SDKSourceBase_1a0bd226180543d1c331bccf0ebf3af419"></span>void <code class="descname">enable_second_deriv</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13SDKSourceBase19enable_second_derivEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Enables the calculation of the second order derivatives of the amplitude and <span class="math">\(\chi^2\)</span>. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13SDKSourceBase20disable_second_derivEv">
<span id="FitPSF::SDKSourceBase::disable_second_deriv"></span><span class="target" id="classFitPSF_1_1SDKSourceBase_1a1ecc6f20a45c9b4862a8599a8e3df73f"></span>void <code class="descname">disable_second_deriv</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13SDKSourceBase20disable_second_derivEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Disables the calculation of the second order derivatives of the amplitude and <span class="math">\(\chi^2\)</span>. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13SDKSourceBase21calculate_first_derivEv">
<span id="FitPSF::SDKSourceBase::calculate_first_derivC"></span><span class="target" id="classFitPSF_1_1SDKSourceBase_1a4f4cab6c27e6f5a881a110d7f18eb7ac"></span>bool <code class="descname">calculate_first_deriv</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13SDKSourceBase21calculate_first_derivEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Should first order derivatives of the amplited and <span class="math">\(\chi^2\)</span> be calculated. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13SDKSourceBase22calculate_second_derivEv">
<span id="FitPSF::SDKSourceBase::calculate_second_derivC"></span><span class="target" id="classFitPSF_1_1SDKSourceBase_1a7a8d41941c294d83bb449ebf798bc10b"></span>bool <code class="descname">calculate_second_deriv</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13SDKSourceBase22calculate_second_derivEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Should second order derivatives of the amplited and <span class="math">\(\chi^2\)</span> be calculated. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13SDKSourceBase9amplitudeEN3PSF13SDKDerivativeE">
<span id="FitPSF::SDKSourceBase::amplitude__PSF::SDKDerivative"></span><span class="target" id="classFitPSF_1_1SDKSourceBase_1ada6c4d93ab4e19b702550941e6b36fdb"></span>double <code class="descname">amplitude</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF13SDKDerivativeE" title="PSF::SDKDerivative">SDKDerivative</a> <em>deriv</em> = PSF::NO_DERIV<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13SDKSourceBase9amplitudeEN3PSF13SDKDerivativeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the amplitude of the last scaling fit. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13SDKSourceBase4chi2EN3PSF13SDKDerivativeE">
<span id="FitPSF::SDKSourceBase::chi2__PSF::SDKDerivativeC"></span><span class="target" id="classFitPSF_1_1SDKSourceBase_1a5a2e225e7db0b25080ef281e5ab14163"></span>double <code class="descname">chi2</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF13SDKDerivativeE" title="PSF::SDKDerivative">SDKDerivative</a> <em>deriv</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13SDKSourceBase4chi2EN3PSF13SDKDerivativeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the <span class="math">\(\chi^2\)</span> of the last scaling fit or any derivative. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13SDKSourceBase4chi2Ev">
<span id="FitPSF::SDKSourceBase::chi2C"></span><span class="target" id="classFitPSF_1_1SDKSourceBase_1a3a70bd3e44e2ac5eebc9562d961e699f"></span>double <code class="descname">chi2</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13SDKSourceBase4chi2Ev" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the <span class="math">\(\chi^2\)</span> of the last scaling fit. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF13SDKSourceBase14chi2_all_derivEv">
<span id="FitPSF::SDKSourceBase::chi2_all_derivC"></span><span class="target" id="classFitPSF_1_1SDKSourceBase_1a89d29eabdbae4709ea3952fc23906520"></span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<code class="descname">chi2_all_deriv</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF13SDKSourceBase14chi2_all_derivEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the <span class="math">\(\chi^2\)</span> of the last scaling fit and its up to second order derivatives. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF13SDKSourceBase11fit_scalingERKN3PSF18EllipticalGaussianE">
<span id="FitPSF::SDKSourceBase::fit_scaling__PSF::EllipticalGaussianCR"></span><span class="target" id="classFitPSF_1_1SDKSourceBase_1a80a70e5883c2323f083f51f606f3278e"></span>void <code class="descname">fit_scaling</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF18EllipticalGaussianE" title="PSF::EllipticalGaussian">EllipticalGaussian</a> &amp;<em>psf</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13SDKSourceBase11fit_scalingERKN3PSF18EllipticalGaussianE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fits for the best scaling between the PSF integrals over pixels and the measured pixel values. </p>
<p>Initializes the __amplitude member with the best fit scaling and the __chi2 member with the reduced <span class="math">\(\chi^2\)</span> of the best fit scaling.</p>
<p></p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Protected Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF13SDKSourceBase11fit_scalingEdRKNSt8valarrayIdEERKNSt8valarrayIdEE">
<span id="FitPSF::SDKSourceBase::fit_scaling__double.std::valarray:double:CR.std::valarray:double:CR"></span><span class="target" id="classFitPSF_1_1SDKSourceBase_1a2b9150251cd9ab2f1f2a2dc4ab68845b"></span>void <code class="descname">fit_scaling</code><span class="sig-paren">(</span>double <em>measured2_term</em>, <em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>numerator</em>, <em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>denominator</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13SDKSourceBase11fit_scalingEdRKNSt8valarrayIdEERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculates the values and, if requested, derivatives of <span class="math">\(\chi^2\)</span> and the amplitude from the given quantities. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF13SDKSourceBase24add_pixel_to_scaling_fitERKN3PSF18EllipticalGaussianERNSt8valarrayIdEERNSt8valarrayIdEERdRKNSt4listI23AmplitudeSaturatedPixelE22const_reverse_iteratorE">
<span id="FitPSF::SDKSourceBase::add_pixel_to_scaling_fit__PSF::EllipticalGaussianCR.std::valarray:double:R.std::valarray:double:R.doubleR.std::list:AmplitudeSaturatedPixel:::const_reverse_iteratorCR"></span><span class="target" id="classFitPSF_1_1SDKSourceBase_1a95938dc569000a158863f3aaa0c5d528"></span>void <code class="descname">add_pixel_to_scaling_fit</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF18EllipticalGaussianE" title="PSF::EllipticalGaussian">EllipticalGaussian</a> &amp;<em>psf</em>, std::valarray&lt;double&gt; &amp;<em>numerator</em>, std::valarray&lt;double&gt; &amp;<em>denominator</em>, double &amp;<em>measured2_term</em>, <em class="property">const</em> std::list&lt;<a class="reference internal" href="#_CPPv2N6FitPSF23AmplitudeSaturatedPixelE" title="FitPSF::AmplitudeSaturatedPixel">AmplitudeSaturatedPixel</a>&gt;::const_reverse_iterator &amp;<em>saturated_iter</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF13SDKSourceBase24add_pixel_to_scaling_fitERKN3PSF18EllipticalGaussianERNSt8valarrayIdEERNSt8valarrayIdEERdRKNSt4listI23AmplitudeSaturatedPixelE22const_reverse_iteratorE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Adds a pixel to the source. </p>
<p>Adds to the numerator and denominator appropriate quantities calculated from either the current pixel (if sat_iter is __saturated.rend()), or the given saturated entry if it is. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N6FitPSF13SDKSourceBase13__first_derivE">
<span id="FitPSF::SDKSourceBase::__first_deriv__b"></span><span class="target" id="classFitPSF_1_1SDKSourceBase_1aaed95f009e84231a452bb71e7436535e"></span>bool <code class="descname">__first_deriv</code><a class="headerlink" href="#_CPPv2N6FitPSF13SDKSourceBase13__first_derivE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Should first order S,D,K derivatives of the amplitude and <span class="math">\(\chi^2\)</span> be calculated. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13SDKSourceBase14__second_derivE">
<span id="FitPSF::SDKSourceBase::__second_deriv__b"></span><span class="target" id="classFitPSF_1_1SDKSourceBase_1a073198e6573bc54c5f9b09d9a2ecd200"></span>bool <code class="descname">__second_deriv</code><a class="headerlink" href="#_CPPv2N6FitPSF13SDKSourceBase14__second_derivE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Should second order S,D,K derivatives of the amplitude and <span class="math">\(\chi^2\)</span> be calculated. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13SDKSourceBase11__amplitudeE">
<span id="FitPSF::SDKSourceBase::__amplitude__std::valarray:double:"></span><span class="target" id="classFitPSF_1_1SDKSourceBase_1a6c135850c8b03eef959d6e6fcc59b6cd"></span>std::valarray&lt;double&gt; <code class="descname">__amplitude</code><a class="headerlink" href="#_CPPv2N6FitPSF13SDKSourceBase11__amplitudeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The best fit amplitude (and derivatives) for the source PSF. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF13SDKSourceBase6__chi2E">
<span id="FitPSF::SDKSourceBase::__chi2__std::valarray:double:"></span><span class="target" id="classFitPSF_1_1SDKSourceBase_1a765eccee24b52831d542a177b6edc70d"></span>std::valarray&lt;double&gt; <code class="descname">__chi2</code><a class="headerlink" href="#_CPPv2N6FitPSF13SDKSourceBase6__chi2E" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The <span class="math">\(\chi^2\)</span> residual of the best amplitude fit and its derivatives. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N6FitPSF6SourceE">
<span id="FitPSF::Source"></span><span class="target" id="classFitPSF_1_1Source"></span><em class="property">template </em>&lt;class <em>PSF_TYPE</em>&gt;<br /><em class="property">class </em><code class="descname">Source</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF9MapSourceE" title="PSF::MapSource">MapSource</a><a class="headerlink" href="#_CPPv2N6FitPSF6SourceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;Source.h&gt;</em><p>An abstract base class for sources which participate in PSF fitting. </p>
<p>Subclassed by <a class="reference internal" href="#classFitPSF_1_1OverlapSource"><span class="std std-ref">FitPSF::OverlapSource&lt; FIT_SOURCE_TYPE, PSF_TYPE &gt;</span></a></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF6Source6SourceERKN4Core8SourceIDEdddRKN10Background6SourceEiPKN4Core11SubPixelMapERKNSt6stringERKNSt6stringE">
<span id="FitPSF::Source::Source__Core::SourceIDCR.double.double.double.Background::SourceCR.i.Core::SubPixelMapCP.ssCR.ssCR"></span><span class="target" id="classFitPSF_1_1Source_1a31a794b3cf276fafba3ca97f213b6dbe"></span><code class="descname">Source</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> &amp;<em>id</em>, double <em>x0</em>, double <em>y0</em>, double <em>gain</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> &amp;<em>background</em>, int <em>source_assignment_id</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> *<em>subpix_map</em>, <em class="property">const</em> std::string &amp;<em>image_fname</em>, <em class="property">const</em> std::string &amp;<em>output_fname</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF6Source6SourceERKN4Core8SourceIDEdddRKN10Background6SourceEiPKN4Core11SubPixelMapERKNSt6stringERKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Creates a PSF fitting source. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">id</span></code>: The ID of the source. </li>
<li><code class="docutils literal"><span class="pre">x0</span></code>: The x coordinate of the source center. </li>
<li><code class="docutils literal"><span class="pre">y0</span></code>: The y coordinate of the source center. </li>
<li><code class="docutils literal"><span class="pre">gain</span></code>: The gain to assume for the backcground measurement. </li>
<li><code class="docutils literal"><span class="pre">background</span></code>: The background under the source (in ADU) </li>
<li><code class="docutils literal"><span class="pre">source_assignment_id</span></code>: The id to assign to this source in the source_assignment array </li>
<li><code class="docutils literal"><span class="pre">subpix_map</span></code>: The sub-pixel sensitivity map to assume. Must not be destroyed while this object is in use. </li>
<li><code class="docutils literal"><span class="pre">image_fname</span></code>: The file name of the image from which this source was extracted. </li>
<li><code class="docutils literal"><span class="pre">output_fname</span></code>: The name of the file where this source should be saved after the fit. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF6Source12ready_to_fitEv">
<span id="FitPSF::Source::ready_to_fitC"></span><span class="target" id="classFitPSF_1_1Source_1a2664fd8c361a1cf70f8a6335bb6abf01"></span><em class="property">virtual</em> bool <code class="descname">ready_to_fit</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF6Source12ready_to_fitEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Is this source ready for fitting? </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF6Source20background_electronsEv">
<span id="FitPSF::Source::background_electronsC"></span><span class="target" id="classFitPSF_1_1Source_1aa6cf3448d102924a5660aaf9cc88652d"></span>double <code class="descname">background_electrons</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF6Source20background_electronsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The background under the source in electrons. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF6Source24set_background_electronsEd">
<span id="FitPSF::Source::set_background_electrons__double"></span><span class="target" id="classFitPSF_1_1Source_1a33653767e3a9ac908dcfcfbb505e3b2a"></span>void <code class="descname">set_background_electrons</code><span class="sig-paren">(</span>double <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF6Source24set_background_electronsEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set the background under the source in electrons. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF6Source29background_electrons_varianceEv">
<span id="FitPSF::Source::background_electrons_varianceC"></span><span class="target" id="classFitPSF_1_1Source_1acc9cca860c2b90153e2cf2ed9585fb1e"></span>double <code class="descname">background_electrons_variance</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF6Source29background_electrons_varianceEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The variance of the background under the source in electrons squared. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF6Source33set_background_electrons_varianceEd">
<span id="FitPSF::Source::set_background_electrons_variance__double"></span><span class="target" id="classFitPSF_1_1Source_1a99ae6e12f5f92f528b22eae9b4e8714b"></span>void <code class="descname">set_background_electrons_variance</code><span class="sig-paren">(</span>double <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF6Source33set_background_electrons_varianceEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A reference to the variance of the background under the source in electrons squared. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF6Source17background_pixelsEv">
<span id="FitPSF::Source::background_pixelsC"></span><span class="target" id="classFitPSF_1_1Source_1a7beee8e68345f47412c51d50ec3ec4d8"></span>unsigned <code class="descname">background_pixels</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF6Source17background_pixelsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of pixels used when measuring the source background. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF6Source17background_pixelsEv">
<span id="FitPSF::Source::background_pixels"></span><span class="target" id="classFitPSF_1_1Source_1a897f5db8b602546167bb308aaf9c5fb7"></span>unsigned &amp;<code class="descname">background_pixels</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF6Source17background_pixelsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A reference to the number of pixels used when measuring the source background. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF6Source19calculate_mask_fluxERKN3PSF3PSFE">
<span id="FitPSF::Source::calculate_mask_flux__PSF::PSFCR"></span><span class="target" id="classFitPSF_1_1Source_1a0b3a38bb59b57a5fbda5d9f4ee37c2e2"></span><em class="property">virtual</em> <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core4FluxE" title="Core::Flux">Flux</a> &amp;<code class="descname">calculate_mask_flux</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF3PSFE" title="PSF::PSF">PSF</a> &amp;<em>psf</em><span class="sig-paren">)</span> = 0<a class="headerlink" href="#_CPPv2N6FitPSF6Source19calculate_mask_fluxERKN3PSF3PSFE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate and return the __mask_flux using the given PSF/PRF. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF6Source9mask_fluxEv">
<span id="FitPSF::Source::mask_fluxC"></span><span class="target" id="classFitPSF_1_1Source_1ad60d9a0c17897940b5526b5ad099340f"></span><em class="property">virtual</em> <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core4FluxE" title="Core::Flux">Flux</a> &amp;<code class="descname">mask_flux</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF6Source9mask_fluxEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See __mask_flux (filled in while fitting). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF6Source9mask_fluxEv">
<span id="FitPSF::Source::mask_flux"></span><span class="target" id="classFitPSF_1_1Source_1ab1698dcf0ab31a7549f6e123706611df"></span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core4FluxE" title="Core::Flux">Flux</a> &amp;<code class="descname">mask_flux</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF6Source9mask_fluxEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See __mask_flux (filled in while fitting). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF6Source4chi2Ev">
<span id="FitPSF::Source::chi2"></span><span class="target" id="classFitPSF_1_1Source_1a408773f2626607a233caa4fc4cda7942"></span><em class="property">virtual</em> double &amp;<code class="descname">chi2</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF6Source4chi2Ev" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The <span class="math">\(\chi^2\)</span> of the last scaling fit. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF6Source12reduced_chi2Ev">
<span id="FitPSF::Source::reduced_chi2C"></span><span class="target" id="classFitPSF_1_1Source_1adaa46284cad0a1870070fa2281bac17e"></span>double <code class="descname">reduced_chi2</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF6Source12reduced_chi2Ev" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The reduced <span class="math">\(\chi^2\)</span> of the last scaling fit. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF6Source4chi2Ev">
<span id="FitPSF::Source::chi2C"></span><span class="target" id="classFitPSF_1_1Source_1a886027c8a3a905cbc0bd43999fafd620"></span><em class="property">virtual</em> double <code class="descname">chi2</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF6Source4chi2Ev" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Read-only <span class="math">\(\chi^2\)</span> of the last scaling fit. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF6Source21saturated_pixel_countEv">
<span id="FitPSF::Source::saturated_pixel_countC"></span><span class="target" id="classFitPSF_1_1Source_1ae1a4039da13f91f148a34712867f1f79"></span><em class="property">virtual</em> unsigned <code class="descname">saturated_pixel_count</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em> = 0<a class="headerlink" href="#_CPPv2NK6FitPSF6Source21saturated_pixel_countEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of saturated pixels assigned to this source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF6Source5meritEv">
<span id="FitPSF::Source::meritC"></span><span class="target" id="classFitPSF_1_1Source_1a69bf82e737e9630d357a79e738d4a7b6"></span><em class="property">virtual</em> double <code class="descname">merit</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em> = 0<a class="headerlink" href="#_CPPv2NK6FitPSF6Source5meritEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>the sum of (background excess)/(pixel variance+background variance) of the individual non-saturated pixels assigned to this source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF6Source12quality_flagEv">
<span id="FitPSF::Source::quality_flagC"></span><span class="target" id="classFitPSF_1_1Source_1a0d92fee231a89bb5f920e3af435379fe"></span><em class="property">virtual</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core14PhotometryFlagE" title="Core::PhotometryFlag">PhotometryFlag</a> <code class="descname">quality_flag</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em> = 0<a class="headerlink" href="#_CPPv2NK6FitPSF6Source12quality_flagEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The worst quality flag for any pixel assigned to the source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF6Source20source_assignment_idEv">
<span id="FitPSF::Source::source_assignment_idC"></span><span class="target" id="classFitPSF_1_1Source_1a9b29e6e32ba6b73dc0de5a5fdf1e821c"></span>unsigned <code class="descname">source_assignment_id</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF6Source20source_assignment_idEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The id the source was assigned in the source_assignment array. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF6Source10subpix_mapEv">
<span id="FitPSF::Source::subpix_mapC"></span><span class="target" id="classFitPSF_1_1Source_1a738bc386a047ddee7a955335936cfccb"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> &amp;<code class="descname">subpix_map</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF6Source10subpix_mapEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Teh sub-pixel map supplied on input. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF6SourceltERK6SourceI8PSF_TYPEE">
<span id="FitPSF::Source::lt-operator__Source:PSF_TYPE:CRC"></span><span class="target" id="classFitPSF_1_1Source_1a3589e616b5b2adf24fadf8355efe294b"></span>bool <code class="descname">operator&lt;</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF6SourceE" title="FitPSF::Source">Source</a>&lt;PSF_TYPE&gt; &amp;<em>rhs</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF6SourceltERK6SourceI8PSF_TYPEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Order sources by their merit function. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF6SourcegtERK6SourceI8PSF_TYPEE">
<span id="FitPSF::Source::gt-operator__Source:PSF_TYPE:CRC"></span><span class="target" id="classFitPSF_1_1Source_1a3af2ac448039f0bc8de87edbb4bac740"></span>bool <code class="descname">operator&gt;</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N6FitPSF6SourceE" title="FitPSF::Source">Source</a>&lt;PSF_TYPE&gt; &amp;<em>rhs</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF6SourcegtERK6SourceI8PSF_TYPEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Order sources by their merit function. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF6Source12set_nonpointEv">
<span id="FitPSF::Source::set_nonpoint"></span><span class="target" id="classFitPSF_1_1Source_1a126796ab71dffb5f62d62b4d1c45d913"></span>void <code class="descname">set_nonpoint</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF6Source12set_nonpointEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reject the source as non-point. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF6Source11is_nonpointEv">
<span id="FitPSF::Source::is_nonpointC"></span><span class="target" id="classFitPSF_1_1Source_1a0be256095c8232d602dd7f1917985e09"></span>bool <code class="descname">is_nonpoint</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF6Source11is_nonpointEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Was the source previously rejected as non-point. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF6Source11drop_reasonEv">
<span id="FitPSF::Source::drop_reasonC"></span><span class="target" id="classFitPSF_1_1Source_1a3041384943122eff6eddf392baf5dc84"></span><a class="reference internal" href="#_CPPv2N6FitPSF16SourceDropReasonE" title="FitPSF::SourceDropReason">SourceDropReason</a> <code class="descname">drop_reason</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF6Source11drop_reasonEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The reason the source was dropped, if it was. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF6Source4dropE16SourceDropReason">
<span id="FitPSF::Source::drop__SourceDropReason"></span><span class="target" id="classFitPSF_1_1Source_1a9e3d2abe12b66a4e6b60a29c1e898885"></span>void <code class="descname">drop</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N6FitPSF16SourceDropReasonE" title="FitPSF::SourceDropReason">SourceDropReason</a> <em>reason</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF6Source4dropE16SourceDropReason" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Drop this source for the given reason. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF6Source14image_filenameEv">
<span id="FitPSF::Source::image_filenameC"></span><span class="target" id="classFitPSF_1_1Source_1a42bf775710af673511d3bd2df9f889fd"></span><em class="property">const</em> std::string &amp;<code class="descname">image_filename</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF6Source14image_filenameEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The filename of the image from which this source was extracted. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF6Source15output_filenameEv">
<span id="FitPSF::Source::output_filenameC"></span><span class="target" id="classFitPSF_1_1Source_1a7e59d1880b15c07d0b22e8b0ebaf8607"></span><em class="property">const</em> std::string &amp;<code class="descname">output_filename</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF6Source15output_filenameEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The output filename where this source should be saved. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF6Source13psf_amplitudeEv">
<span id="FitPSF::Source::psf_amplitudeC"></span><span class="target" id="classFitPSF_1_1Source_1a128dac055b4f5f702925396ced178127"></span>double <code class="descname">psf_amplitude</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF6Source13psf_amplitudeEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The amplitude of the PSF. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF6Source17set_psf_amplitudeEd">
<span id="FitPSF::Source::set_psf_amplitude__double"></span><span class="target" id="classFitPSF_1_1Source_1aa5681699a6b758f1911a3c56eb70bd7d"></span>void <code class="descname">set_psf_amplitude</code><span class="sig-paren">(</span>double <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF6Source17set_psf_amplitudeEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Sets the amplitude of the PSF to the given value. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF6Source20set_sources_in_groupEj">
<span id="FitPSF::Source::set_sources_in_group__unsigned"></span><span class="target" id="classFitPSF_1_1Source_1adb38807b603ea3e25994e7688ff890da"></span>void <code class="descname">set_sources_in_group</code><span class="sig-paren">(</span>unsigned <em>source_count</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF6Source20set_sources_in_groupEj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set how many sources were in the same group as this one when amplitude was fit. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF6Source15expansion_termsEv">
<span id="FitPSF::Source::expansion_terms"></span><span class="target" id="classFitPSF_1_1Source_1a8172c1afdac11dc12f3ed692a8a4e35f"></span>Eigen::VectorXd &amp;<code class="descname">expansion_terms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF6Source15expansion_termsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reference to the values of the expanion terms the PSF of the source depends on. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK6FitPSF6Source15expansion_termsEv">
<span id="FitPSF::Source::expansion_termsC"></span><span class="target" id="classFitPSF_1_1Source_1a3725080f1471c3b8688f6960ab40b54e"></span><em class="property">const</em> Eigen::VectorXd &amp;<code class="descname">expansion_terms</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK6FitPSF6Source15expansion_termsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The values of the expanion terms the PSF of the source depends on. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF6Source15fill_psf_paramsERKN5Eigen8VectorXdERN5Eigen8VectorXdE">
<span id="FitPSF::Source::fill_psf_params__Eigen::VectorXdCR.Eigen::VectorXdR"></span><span class="target" id="classFitPSF_1_1Source_1a236006261bc946dce216c3296a5d6fc1"></span>void <code class="descname">fill_psf_params</code><span class="sig-paren">(</span><em class="property">const</em> Eigen::VectorXd &amp;<em>expansion_coef</em>, Eigen::VectorXd &amp;<em>psf_params</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF6Source15fill_psf_paramsERKN5Eigen8VectorXdERN5Eigen8VectorXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fill a vector with the PSF parameters for this source given a set of polynomial expansion coefficients. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">expansion_coef</span></code>: The polynomial expansion coefficients for all PSF terms. </li>
<li><code class="docutils literal"><span class="pre">psf_params</span></code>: The vector to fill with the PSF terms for this source. Resized as necessary. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Protected Functions</p>
<dl class="function">
<dt id="_CPPv2N6FitPSF6Source23pixel_excess_reductionsERKN5Eigen8VectorXdERdRd">
<span id="FitPSF::Source::pixel_excess_reductions__Eigen::VectorXdCR.doubleR.doubleR"></span><span class="target" id="classFitPSF_1_1Source_1a6840b9ccbbba192d2cbb617d82846a6e"></span><em class="property">virtual</em> void <code class="descname">pixel_excess_reductions</code><span class="sig-paren">(</span><em class="property">const</em> Eigen::VectorXd &amp;<em>to_dot_with</em>, double &amp;<em>dot_product</em>, double &amp;<em>excess_sum_squares</em><span class="sig-paren">)</span> = 0<a class="headerlink" href="#_CPPv2N6FitPSF6Source23pixel_excess_reductionsERKN5Eigen8VectorXdERdRd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate the dot of pixel excesses with the given quantity as well as with itself. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">to_dot_with</span></code>: A vector of values to dot with the pixel excess values. </li>
<li><code class="docutils literal"><span class="pre">dot_product</span></code>: On exit this variable is set to the dot product of to_dot_with and the pixel excesses. </li>
<li><code class="docutils literal"><span class="pre">excess_sum_squares</span></code>: On exit this variable is set to the sum of the squares of the pixel excesses. </li>
</ul>
</dd>
</dl>
</p>
<p>Having this function virtual allows optimizing the calculation in some cases (e.g. when fitting for PSF which linearly depends on its parameters). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N6FitPSF6Source8fit_fluxERKN5Eigen8VectorXdE">
<span id="FitPSF::Source::fit_flux__Eigen::VectorXdCR"></span><span class="target" id="classFitPSF_1_1Source_1a493c3c39cc78ef30bd199d5f66f65478"></span>double <code class="descname">fit_flux</code><span class="sig-paren">(</span><em class="property">const</em> Eigen::VectorXd &amp;<em>estimated_excesses</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N6FitPSF6Source8fit_fluxERKN5Eigen8VectorXdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fit for the flux of the source and return the change from its previous value. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">estimated_excesses</span></code>: The integrals of the PSF x sub-pixel map over the source pixels used for flux fitting divided by the variance. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Protected Attributes</p>
<dl class="member">
<dt id="_CPPv2N6FitPSF6Source17_saturated_pixelsE">
<span id="FitPSF::Source::_saturated_pixels__std::list:AmplitudeSaturatedPixel:"></span><span class="target" id="classFitPSF_1_1Source_1a0a782e0369f7cddf89e2ff5ed7f57e59"></span>std::list&lt;<a class="reference internal" href="#_CPPv2N6FitPSF23AmplitudeSaturatedPixelE" title="FitPSF::AmplitudeSaturatedPixel">AmplitudeSaturatedPixel</a>&gt; <code class="descname">_saturated_pixels</code><a class="headerlink" href="#_CPPv2N6FitPSF6Source17_saturated_pixelsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A structure holding all necessary information about saturated pixels. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N6FitPSF6Source22__background_electronsE">
<span id="FitPSF::Source::__background_electrons__double"></span><span class="target" id="classFitPSF_1_1Source_1ab414a0a1e019d88669d9acc9d047da24"></span>double <code class="descname">__background_electrons</code><a class="headerlink" href="#_CPPv2N6FitPSF6Source22__background_electronsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The background under the source in electrons. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF6Source31__background_electrons_varianceE">
<span id="FitPSF::Source::__background_electrons_variance__double"></span><span class="target" id="classFitPSF_1_1Source_1adaa28991cbecc94fd446183b684a3284"></span>double <code class="descname">__background_electrons_variance</code><a class="headerlink" href="#_CPPv2N6FitPSF6Source31__background_electrons_varianceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The variance of the background under the source. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF6Source6__gainE">
<span id="FitPSF::Source::__gain__double"></span><span class="target" id="classFitPSF_1_1Source_1a76963a2f6f18cb3e08062279423be0b9"></span>double <code class="descname">__gain</code><a class="headerlink" href="#_CPPv2N6FitPSF6Source6__gainE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The gain to assume for image pixels. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF6Source11__amplitudeE">
<span id="FitPSF::Source::__amplitude__double"></span><span class="target" id="classFitPSF_1_1Source_1a10cf889d2efd92993dd4a69a9d58332a"></span>double <code class="descname">__amplitude</code><a class="headerlink" href="#_CPPv2N6FitPSF6Source11__amplitudeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The best fit amplitude of this source. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF6Source22__source_assignment_idE">
<span id="FitPSF::Source::__source_assignment_id__unsigned"></span><span class="target" id="classFitPSF_1_1Source_1ae54cd2283a3ed3cbd0feff5dea84b88d"></span>unsigned <code class="descname">__source_assignment_id</code><a class="headerlink" href="#_CPPv2N6FitPSF6Source22__source_assignment_idE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The id of the source in the source_assignment array. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF6Source15__group_sourcesE">
<span id="FitPSF::Source::__group_sources__unsigned"></span><span class="target" id="classFitPSF_1_1Source_1ac16d5238a8941acf6ac08d5a72d6aff1"></span>unsigned <code class="descname">__group_sources</code><a class="headerlink" href="#_CPPv2N6FitPSF6Source15__group_sourcesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of sources which were combined with this source when fitting for the amplitude. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF6Source12__subpix_mapE">
<span id="FitPSF::Source::__subpix_map__Core::SubPixelMapCP"></span><span class="target" id="classFitPSF_1_1Source_1a2ce8bb96afd08f88588c8ef73a17d997"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> *<code class="descname">__subpix_map</code><a class="headerlink" href="#_CPPv2N6FitPSF6Source12__subpix_mapE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See subpix_map argument of the constructors. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF6Source10__nonpointE">
<span id="FitPSF::Source::__nonpoint__b"></span><span class="target" id="classFitPSF_1_1Source_1af05da06f44904ad2261b84dd3c8f1fdc"></span>bool <code class="descname">__nonpoint</code><a class="headerlink" href="#_CPPv2N6FitPSF6Source10__nonpointE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Is this source rejcted as non-point source. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF6Source11__mask_fluxE">
<span id="FitPSF::Source::__mask_flux__Core::Flux"></span><span class="target" id="classFitPSF_1_1Source_1a7501841822136c9dd930e6e19f60092f"></span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core4FluxE" title="Core::Flux">Flux</a> <code class="descname">__mask_flux</code><a class="headerlink" href="#_CPPv2N6FitPSF6Source11__mask_fluxE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><a class="reference internal" href="#classFitPSF_1_1Source"><span class="std std-ref">Source</span></a> flux estimated by scaling for flux not in the source pixels. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF6Source16__image_filenameE">
<span id="FitPSF::Source::__image_filename__ss"></span><span class="target" id="classFitPSF_1_1Source_1adb2bd9208c5f0666fb4f3dac1afab306"></span>std::string <code class="descname">__image_filename</code><a class="headerlink" href="#_CPPv2N6FitPSF6Source16__image_filenameE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classFitPSF_1_1Source_1a42bf775710af673511d3bd2df9f889fd"><span class="std std-ref">image_filename()</span></a>. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF6Source17__output_filenameE">
<span id="FitPSF::Source::__output_filename__ss"></span><span class="target" id="classFitPSF_1_1Source_1a656afcb70e067235edd72c5c397701c7"></span>std::string <code class="descname">__output_filename</code><a class="headerlink" href="#_CPPv2N6FitPSF6Source17__output_filenameE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classFitPSF_1_1Source_1a7e59d1880b15c07d0b22e8b0ebaf8607"><span class="std std-ref">output_filename()</span></a>. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF6Source17__expansion_termsE">
<span id="FitPSF::Source::__expansion_terms__Eigen::VectorXd"></span><span class="target" id="classFitPSF_1_1Source_1a0dbeea14dc670ee1524785f8fbd57d6d"></span>Eigen::VectorXd <code class="descname">__expansion_terms</code><a class="headerlink" href="#_CPPv2N6FitPSF6Source17__expansion_termsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The terms participating in the expansion of each of the PSF parameters. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF6Source6__chi2E">
<span id="FitPSF::Source::__chi2__double"></span><span class="target" id="classFitPSF_1_1Source_1a68acc2953902636bc143561bc6bd7b77"></span>double <code class="descname">__chi2</code><a class="headerlink" href="#_CPPv2N6FitPSF6Source6__chi2E" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classFitPSF_1_1Source_1a408773f2626607a233caa4fc4cda7942"><span class="std std-ref">chi2()</span></a> method. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6FitPSF6Source13__drop_reasonE">
<span id="FitPSF::Source::__drop_reason__SourceDropReason"></span><span class="target" id="classFitPSF_1_1Source_1a37b885de7c9944e61aa4040976d807da"></span><a class="reference internal" href="#_CPPv2N6FitPSF16SourceDropReasonE" title="FitPSF::SourceDropReason">SourceDropReason</a> <code class="descname">__drop_reason</code><a class="headerlink" href="#_CPPv2N6FitPSF6Source13__drop_reasonE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The reason the source was dropped if it was. </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="subpixphot">
<h2>SubPixPhot<a class="headerlink" href="#subpixphot" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="_CPPv210SubPixPhot">
<span id="SubPixPhot"></span><span class="target" id="namespaceSubPixPhot"></span><em class="property">namespace </em><code class="descname">SubPixPhot</code><a class="headerlink" href="#_CPPv210SubPixPhot" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Functions</p>
<dl class="function">
<dt id="_CPPv2N10SubPixPhot21add_flux_measurementsERKN3PSF3MapER13FLUX_MEASURERdRN2IO12H5IODataTreeE">
<span id="SubPixPhot::add_flux_measurements__PSF::MapCR.FLUX_MEASURERR.double.IO::H5IODataTreeR"></span><em class="property">template </em>&lt;<em class="property">class</em> FLUX_MEASURER&gt;<br /><span class="target" id="subpixphot_8cpp_1ab1224ed10590922af08b91f62b1c259d"></span>void <code class="descname">add_flux_measurements</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF3MapE" title="PSF::Map">Map</a> &amp;<em>psf_map</em>, FLUX_MEASURER &amp;<em>measure_flux</em>, double <em>mag_1adu</em>, <a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data_tree</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot21add_flux_measurementsERKN3PSF3MapER13FLUX_MEASURERdRN2IO12H5IODataTreeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Measures the fluxes of the sources using aperture photometry. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">psf_map</span></code>: The SPF map to use. </li>
<li><code class="docutils literal"><span class="pre">measure_flux</span></code>: The object that will measure the fluxes. </li>
<li><code class="docutils literal"><span class="pre">mag_1adu</span></code>: The magnitude that corresponds to a flux of 1ADU </li>
<li><code class="docutils literal"><span class="pre">data_tree</span></code>: The data tree to add the fluxes to. It must contain the source positions and backgrounds on input. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot27add_background_measurementsERKN10Background7AnnulusERN2IO9FitsImageIdEERN2IO12H5IODataTreeE">
<span id="SubPixPhot::add_background_measurements__Background::AnnulusCR.IO::FitsImage:double:R.IO::H5IODataTreeR"></span><span class="target" id="subpixphot_8cpp_1a155d31304df55dc7409fff9f4ea17fef"></span>void <code class="descname">add_background_measurements</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background7AnnulusE" title="Background::Annulus">Annulus</a> &amp;<em>annulus</em>, <a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO9FitsImageE" title="IO::FitsImage">FitsImage</a>&lt;double&gt; &amp;<em>image</em>, <a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data_tree</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot27add_background_measurementsERKN10Background7AnnulusERN2IO9FitsImageIdEERN2IO12H5IODataTreeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Measures the background of all input sources and adds it to an I/O tree. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">annulus</span></code>: The annulus to use for measuring the background. </li>
<li><code class="docutils literal"><span class="pre">image</span></code>: The image to process </li>
<li><code class="docutils literal"><span class="pre">data_tree</span></code>: The I/O tree which must contain the source positions and which will be updated with the background values, errors etc. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot11get_psf_mapERKNSt6stringEdRN2IO12H5IODataTreeE">
<span id="SubPixPhot::get_psf_map__ssCR.double.IO::H5IODataTreeR"></span><span class="target" id="subpixphot_8cpp_1abada4a4beb645c59a51f132f4f2cf972"></span><a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF3MapE" title="PSF::Map">Map</a> *<code class="descname">get_psf_map</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>psfmap_filename</em>, double <em>max_aperture</em>, <a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>psf_data</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot11get_psf_mapERKNSt6stringEdRN2IO12H5IODataTreeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns a newly allocated PSF map to use. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">psfmap_filename</span></code>: The name of the file to read the PSF map from. </li>
<li><code class="docutils literal"><span class="pre">max_aperture</span></code>: The largest aperture that will be used. </li>
<li><code class="docutils literal"><span class="pre">psf_data</span></code>: The data tree to fill with extra quantities </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot20print_data_tree_keysERKN5boost13property_tree11basic_ptreeINSt12basic_stringIcEEN5boost3anyEEERKNSt6stringE">
<span id="SubPixPhot::print_data_tree_keys__boost::property_tree::basic_ptree:std::basic_string:c:.boost::any:CR.ssCR"></span><span class="target" id="subpixphot_8cpp_1a22caf4c6debad836eafa12a0412ddca4"></span>void <code class="descname">print_data_tree_keys</code><span class="sig-paren">(</span><em class="property">const</em> boost::property_tree::basic_ptree&lt;std::basic_string&lt;char&gt;, boost::any&gt; &amp;<em>data_tree</em>, <em class="property">const</em> std::string &amp;<em>indent</em> = &quot;&quot;<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot20print_data_tree_keysERKN5boost13property_tree11basic_ptreeINSt12basic_stringIcEEN5boost3anyEEERKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>List all the keys in the given data tree to stdout. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot18read_input_sourcesERKNSt6stringERN2IO12H5IODataTreeE">
<span id="SubPixPhot::read_input_sources__ssCR.IO::H5IODataTreeR"></span><span class="target" id="subpixphot_8cpp_1a87f570f8391763620e76ed2b15841fee"></span>void <code class="descname">read_input_sources</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>source_filename</em>, <a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data_tree</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot18read_input_sourcesERKNSt6stringERN2IO12H5IODataTreeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reads the positions and background (if available) of the source to photometer. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">source_filename</span></code>: The name of the HDF5 file to read the sources from. </li>
<li><code class="docutils literal"><span class="pre">data_tree</span></code>: The data tree to fill. </li>
</ul>
</dd>
</dl>
</p>
<p>If backgrounds are not available in the input file they are measured. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot13output_doubleEdRNSt7ostreamEii">
<span id="SubPixPhot::output_double__double.osR.i.i"></span><span class="target" id="SubPixPhotIO_8cpp_1a78b5278c8b2d1c0c292a1f489c86fb8f"></span><em class="property">static</em> void <code class="descname">output_double</code><span class="sig-paren">(</span>double <em>value</em>, std::ostream &amp;<em>os</em>, int <em>precision</em> = 3, int <em>width</em> = 10<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot13output_doubleEdRNSt7ostreamEii" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot10output_intEiRNSt7ostreamEi">
<span id="SubPixPhot::output_int__i.osR.i"></span><span class="target" id="SubPixPhotIO_8cpp_1a31b28f46679b0c920f3e8ad8263b1baf"></span><em class="property">static</em> void <code class="descname">output_int</code><span class="sig-paren">(</span>int <em>value</em>, std::ostream &amp;<em>os</em>, int <em>width</em> = 5<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot10output_intEiRNSt7ostreamEi" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot16output_to_stdoutERKNSt4listIN2IO15OutputSDKSourceEEERKNSt4listIN4Phot7ColumnsEEEddRNSt7ostreamE">
<span id="SubPixPhot::output_to_stdout__std::list:IO::OutputSDKSource:CR.std::list:Phot::Columns:CR.double.double.osR"></span><span class="target" id="SubPixPhotIO_8cpp_1a266b2e5b1c4195c0c3b905744a942822"></span>void <code class="descname">output_to_stdout</code><span class="sig-paren">(</span><em class="property">const</em> std::list&lt;<a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO15OutputSDKSourceE" title="IO::OutputSDKSource">OutputSDKSource</a>&gt; &amp;<em>sources</em>, <em class="property">const</em> std::list&lt;Phot::Columns&gt; &amp;<em>columns</em>, double <em>mag_1ADU</em>, double <em>gain</em>, std::ostream &amp;<em>os</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot16output_to_stdoutERKNSt4listIN2IO15OutputSDKSourceEEERKNSt4listIN4Phot7ColumnsEEEddRNSt7ostreamE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Outputs the sources to stdout. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">sources</span></code>: The sources to output. </li>
<li><code class="docutils literal"><span class="pre">columns</span></code>: The columns to output. </li>
<li><code class="docutils literal"><span class="pre">mag_1ADU</span></code>: The magnitude that corresponds to a flux of 1ADU </li>
<li><code class="docutils literal"><span class="pre">gain</span></code>: The gain with which the image was taken. </li>
<li><code class="docutils literal"><span class="pre">os</span></code>: The stream to write the output to. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot12write_headerERNSt7ostreamEiPPcRKNSt6stringE">
<span id="SubPixPhot::write_header__osR.i.cPP.ssCR"></span><span class="target" id="SubPixPhotIO_8cpp_1ae1ec1b63fe1b59fe946e6ae057ef1b91"></span>void <code class="descname">write_header</code><span class="sig-paren">(</span>std::ostream &amp;<em>os</em>, int <em>argc</em> = 0, char **<em>argv</em> = NULL, <em class="property">const</em> std::string &amp;<em>version_string</em> = &quot;&quot;<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot12write_headerERNSt7ostreamEiPPcRKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Output a header to the given stream with version and command line information. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">os</span></code>: The stream to output the header to. </li>
<li><code class="docutils literal"><span class="pre">argc</span></code>: The number of command line arguments used. </li>
<li><code class="docutils literal"><span class="pre">argv</span></code>: The actual command line arguments. </li>
<li><code class="docutils literal"><span class="pre">version_string</span></code>: A string which identifies the version of the tool. </li>
</ul>
</dd>
</dl>
</p>
<p>Includes the version of HATpipe if HATP_SVN is defined, the version of SubPixPhot if the version_string argument is not an empty string, and the command line with which the command was invoked if argc is non-zero, in which case argc and argv should be the same arguments that main() received. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot13read_sdk_coefERKNSt6stringE">
<span id="SubPixPhot::read_sdk_coef__ssCR"></span><span class="target" id="SubPixPhotIO_8cpp_1addd32fa3ceab18162cc4c59f0b146883"></span>std::list&lt;double&gt; <code class="descname">read_sdk_coef</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>fname</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot13read_sdk_coefERKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reads in polynomial expansion coefficients of S,D, K from a file. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fname</span></code>: The name of the file to read from. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot24checked_read_last_sourceER11SourceInputRNSt4listI11SOURCE_TYPEEE">
<span id="SubPixPhot::checked_read_last_source__SourceInputR.std::list:SOURCE_TYPE:R"></span><em class="property">template </em>&lt;<em class="property">class</em> SOURCE_TYPE&gt;<br /><span class="target" id="SubPixPhotIO_8h_1aea3440d9077a23173801075681daeea6"></span><em class="property">static</em> void <code class="descname">checked_read_last_source</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N10SubPixPhot11SourceInputE" title="SubPixPhot::SourceInput">SourceInput</a> &amp;<em>source_input</em>, std::list&lt;SOURCE_TYPE&gt; &amp;<em>sources</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot24checked_read_last_sourceER11SourceInputRNSt4listI11SOURCE_TYPEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reads the next source from source_input into the last element of sources performing all necessary checks. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot12read_sourcesER11SourceInputRNSt4listI11SOURCE_TYPEEEj">
<span id="SubPixPhot::read_sources__SourceInputR.std::list:SOURCE_TYPE:R.unsigned"></span><em class="property">template </em>&lt;<em class="property">class</em> SOURCE_TYPE&gt;<br /><span class="target" id="SubPixPhotIO_8h_1a728db76f26cd4daddc34696ecea6557c"></span>void <code class="descname">read_sources</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N10SubPixPhot11SourceInputE" title="SubPixPhot::SourceInput">SourceInput</a> &amp;<em>source_input</em>, std::list&lt;SOURCE_TYPE&gt; &amp;<em>sources</em>, unsigned <em>num_apertures</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot12read_sourcesER11SourceInputRNSt4listI11SOURCE_TYPEEEj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fills the source list with the sources contained in the given stream initialized suitably for photometry with the given number of apertures. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot12read_sourcesER11SourceInputRNSt4listI11SOURCE_TYPEEE">
<span id="SubPixPhot::read_sources__SourceInputR.std::list:SOURCE_TYPE:R"></span><em class="property">template </em>&lt;<em class="property">class</em> SOURCE_TYPE&gt;<br /><span class="target" id="SubPixPhotIO_8h_1affa5265394b35f8e3fe09a8a1aa7d9b2"></span>void <code class="descname">read_sources</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N10SubPixPhot11SourceInputE" title="SubPixPhot::SourceInput">SourceInput</a> &amp;<em>source_input</em>, std::list&lt;SOURCE_TYPE&gt; &amp;<em>sources</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot12read_sourcesER11SourceInputRNSt4listI11SOURCE_TYPEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fills the source list with the sources contained in the given stream, SOURCE_TYPE must have a default constructor. </p>
</dd></dl>

</div>
<dl class="class">
<dt id="_CPPv2N10SubPixPhot18BinarySourceOutputE">
<span id="SubPixPhot::BinarySourceOutput"></span><span class="target" id="classSubPixPhot_1_1BinarySourceOutput"></span><em class="property">class </em><code class="descname">BinarySourceOutput</code><a class="headerlink" href="#_CPPv2N10SubPixPhot18BinarySourceOutputE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;BinarySourceOutput.h&gt;</em><p>A class that behaves as output stream for sources resulting in binary photometry file. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N10SubPixPhot18BinarySourceOutput18BinarySourceOutputERN2IO10binostreamEdRKNSt4listIN4Phot7ColumnsEEE">
<span id="SubPixPhot::BinarySourceOutput::BinarySourceOutput__IO::binostreamR.double.std::list:Phot::Columns:CR"></span><span class="target" id="classSubPixPhot_1_1BinarySourceOutput_1af766812dd5efa4ec0c5b40879ce7b531"></span><code class="descname">BinarySourceOutput</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO10binostreamE" title="IO::binostream">binostream</a> &amp;<em>outstream</em>, double <em>mag_1ADU</em>, <em class="property">const</em> std::list&lt;Phot::Columns&gt; &amp;<em>output_columns</em> = std::list&lt;  Phot::Columns  &gt;()<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot18BinarySourceOutput18BinarySourceOutputERN2IO10binostreamEdRKNSt4listIN4Phot7ColumnsEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Use the given stream for output. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot18BinarySourceOutput11set_columnsERKNSt4listIN4Phot7ColumnsEEE">
<span id="SubPixPhot::BinarySourceOutput::set_columns__std::list:Phot::Columns:CR"></span><span class="target" id="classSubPixPhot_1_1BinarySourceOutput_1a13dc61e18e56baf8303fcfe9db3c073f"></span>void <code class="descname">set_columns</code><span class="sig-paren">(</span><em class="property">const</em> std::list&lt;Phot::Columns&gt; &amp;<em>output_columns</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot18BinarySourceOutput11set_columnsERKNSt4listIN4Phot7ColumnsEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Sets the columns (including order) which to output. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot18BinarySourceOutputclERKNSt4listIN2IO15OutputSDKSourceEEE">
<span id="SubPixPhot::BinarySourceOutput::call-operator__std::list:IO::OutputSDKSource:CR"></span><span class="target" id="classSubPixPhot_1_1BinarySourceOutput_1a8c6609db24a87d7e3f8bdaabb6f50c18"></span>void <code class="descname">operator()</code><span class="sig-paren">(</span><em class="property">const</em> std::list&lt;<a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO15OutputSDKSourceE" title="IO::OutputSDKSource">OutputSDKSource</a>&gt; &amp;<em>sources</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot18BinarySourceOutputclERKNSt4listIN2IO15OutputSDKSourceEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Outputs the given list of sources to the given stream in packed binary format. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK10SubPixPhot18BinarySourceOutput9precisionEN4Phot7ColumnsE">
<span id="SubPixPhot::BinarySourceOutput::precision__Phot::ColumnsC"></span><span class="target" id="classSubPixPhot_1_1BinarySourceOutput_1ae9b08c2a70662c9be9bb3b2a26c6899b"></span>double <code class="descname">precision</code><span class="sig-paren">(</span>Phot::Columns <em>column</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK10SubPixPhot18BinarySourceOutput9precisionEN4Phot7ColumnsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The precision with which the given column will be output. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot18BinarySourceOutput9precisionEN4Phot7ColumnsE">
<span id="SubPixPhot::BinarySourceOutput::precision__Phot::Columns"></span><span class="target" id="classSubPixPhot_1_1BinarySourceOutput_1aaebb305e29eccd55baab29d293b5e4ea"></span>double &amp;<code class="descname">precision</code><span class="sig-paren">(</span>Phot::Columns <em>column</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot18BinarySourceOutput9precisionEN4Phot7ColumnsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The precision with which the given column will be output. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N10SubPixPhot18BinarySourceOutput20set_required_columnsEv">
<span id="SubPixPhot::BinarySourceOutput::set_required_columns"></span><span class="target" id="classSubPixPhot_1_1BinarySourceOutput_1a92c79bdc08ec5a28b38e58038f17468e"></span>void <code class="descname">set_required_columns</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot18BinarySourceOutput20set_required_columnsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fills in the __required array according to the content of __columns. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot18BinarySourceOutput21aperture_indep_formatEv">
<span id="SubPixPhot::BinarySourceOutput::aperture_indep_format"></span><span class="target" id="classSubPixPhot_1_1BinarySourceOutput_1a6e6ad99401907f9cbb1fcf1022be42c5"></span>std::string <code class="descname">aperture_indep_format</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot18BinarySourceOutput21aperture_indep_formatEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the format string that encodes what non-photometry columns are in the file. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot18BinarySourceOutput19aperture_dep_formatEv">
<span id="SubPixPhot::BinarySourceOutput::aperture_dep_format"></span><span class="target" id="classSubPixPhot_1_1BinarySourceOutput_1ac86c15743e7364af75be0606c55d43cd"></span>std::string <code class="descname">aperture_dep_format</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot18BinarySourceOutput19aperture_dep_formatEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Retruns the format string that encodes what photometry columns are in the file. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N10SubPixPhot18BinarySourceOutput11__outstreamE">
<span id="SubPixPhot::BinarySourceOutput::__outstream__IO::binostreamP"></span><span class="target" id="classSubPixPhot_1_1BinarySourceOutput_1a7ce67b7dcb6d895de769874b428120a4"></span><a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO10binostreamE" title="IO::binostream">binostream</a> *<code class="descname">__outstream</code><a class="headerlink" href="#_CPPv2N10SubPixPhot18BinarySourceOutput11__outstreamE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The stream where output will be written. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10SubPixPhot18BinarySourceOutput9__columnsE">
<span id="SubPixPhot::BinarySourceOutput::__columns__std::list:Phot::Columns:CP"></span><span class="target" id="classSubPixPhot_1_1BinarySourceOutput_1a95f1f37fe2398a9318555c1b87adb65e"></span><em class="property">const</em> std::list&lt;Phot::Columns&gt; *<code class="descname">__columns</code><a class="headerlink" href="#_CPPv2N10SubPixPhot18BinarySourceOutput9__columnsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The columns to output in the order in which they should be output. </p>
<p>Aperture specific columns may appear as many times as there are apertures. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10SubPixPhot18BinarySourceOutput10__requiredE">
<span id="SubPixPhot::BinarySourceOutput::__required__std::valarray:b:"></span><span class="target" id="classSubPixPhot_1_1BinarySourceOutput_1a2f6a0c541e20ee617d4ea0170bd81e6c"></span>std::valarray&lt;bool&gt; <code class="descname">__required</code><a class="headerlink" href="#_CPPv2N10SubPixPhot18BinarySourceOutput10__requiredE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Indexed by the value of Phot::Columns corresponding to the given column, this array specifies which columns are necessary on output. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10SubPixPhot18BinarySourceOutput11__precisionE">
<span id="SubPixPhot::BinarySourceOutput::__precision__std::valarray:double:"></span><span class="target" id="classSubPixPhot_1_1BinarySourceOutput_1a06e7643414147b185c51c35773aa4756"></span>std::valarray&lt;double&gt; <code class="descname">__precision</code><a class="headerlink" href="#_CPPv2N10SubPixPhot18BinarySourceOutput11__precisionE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The presicion with which to output each column (indexed by the value of Phot::Columns). Entries corresponding to integer columns are ignored. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10SubPixPhot18BinarySourceOutput15__num_aperturesE">
<span id="SubPixPhot::BinarySourceOutput::__num_apertures__unsigned"></span><span class="target" id="classSubPixPhot_1_1BinarySourceOutput_1a4571d41e546d5125fff1a8e16fc7378c"></span>unsigned <code class="descname">__num_apertures</code><a class="headerlink" href="#_CPPv2N10SubPixPhot18BinarySourceOutput15__num_aperturesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>How many apertures are requried by the output columns. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10SubPixPhot18BinarySourceOutput10__mag_1ADUE">
<span id="SubPixPhot::BinarySourceOutput::__mag_1ADU__double"></span><span class="target" id="classSubPixPhot_1_1BinarySourceOutput_1a912810d34a26aac3b21e14d3dee00bf5"></span>double <code class="descname">__mag_1ADU</code><a class="headerlink" href="#_CPPv2N10SubPixPhot18BinarySourceOutput10__mag_1ADUE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>What magnitude corresponds to a flux of 1ADU. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N10SubPixPhot6ConfigE">
<span id="SubPixPhot::Config"></span><span class="target" id="classSubPixPhot_1_1Config"></span><em class="property">class </em><code class="descname">Config</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO17CommandLineConfigE" title="IO::CommandLineConfig">CommandLineConfig</a><a class="headerlink" href="#_CPPv2N10SubPixPhot6ConfigE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;Config.h&gt;</em><p>Default configuration from file but overwritten by command line options. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N10SubPixPhot6Config6ConfigEiPPc">
<span id="SubPixPhot::Config::Config__i.cPP"></span><span class="target" id="classSubPixPhot_1_1Config_1a92f14c8fcc5bd66b80c386207da39af7"></span><code class="descname">Config</code><span class="sig-paren">(</span>int <em>argc</em>, char **<em>argv</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot6Config6ConfigEiPPc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Parse the command line. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">argc</span></code>: The number of arguments on the command line (+1 for the executable) </li>
<li><code class="docutils literal"><span class="pre">argv</span></code>: A C style array of the actual command line arguments. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N10SubPixPhot6Config16describe_optionsEv">
<span id="SubPixPhot::Config::describe_options"></span><span class="target" id="classSubPixPhot_1_1Config_1a3f3123db6180327105d184da513412a6"></span>void <code class="descname">describe_options</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot6Config16describe_optionsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Describes the available command line options. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK10SubPixPhot6Config10usage_helpERKNSt6stringE">
<span id="SubPixPhot::Config::usage_help__ssCRC"></span><span class="target" id="classSubPixPhot_1_1Config_1aa7ed5f7c41d1172c471abdfead764fa1"></span>std::string <code class="descname">usage_help</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>prog_name</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK10SubPixPhot6Config10usage_helpERKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The part of the help describing the usage and purpose (no options). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot6Config15apply_fallbacksEv">
<span id="SubPixPhot::Config::apply_fallbacks"></span><span class="target" id="classSubPixPhot_1_1Config_1a8e948e2584ce8ae242fe9536cbb9d7a6"></span>void <code class="descname">apply_fallbacks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot6Config15apply_fallbacksEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Uses io.sources instead of io.psfmap or io.output, if not specified. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot6Config17check_consistencyEv">
<span id="SubPixPhot::Config::check_consistency"></span><span class="target" id="classSubPixPhot_1_1Config_1a16f42b85839c07e567734bf13ce708a7"></span>void <code class="descname">check_consistency</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot6Config17check_consistencyEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Checks for consistency between the command line options. </p>
<p>Throws an exception if some inconsistency is detected. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N10SubPixPhot11SourceInputE">
<span id="SubPixPhot::SourceInput"></span><span class="target" id="classSubPixPhot_1_1SourceInput"></span><em class="property">class </em><code class="descname">SourceInput</code><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInputE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;SourceInput.h&gt;</em><p>A class that behaves as an input stream for sources. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N10SubPixPhot11SourceInput11SourceInputERKNSt4listIN4Phot7ColumnsEEEd">
<span id="SubPixPhot::SourceInput::SourceInput__std::list:Phot::Columns:CR.double"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1a2924b424e6ce6e423687bd6a7075f82b"></span><code class="descname">SourceInput</code><span class="sig-paren">(</span><em class="property">const</em> std::list&lt;Phot::Columns&gt; &amp;<em>columns</em>, double <em>max_exp_coef</em> = 1<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInput11SourceInputERKNSt4listIN4Phot7ColumnsEEEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Construct an input stream that expects the input to contain the given columns in the specified order. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot11SourceInput11SourceInputERKNSt4listIN4Phot7ColumnsEEERNSt7istreamEd">
<span id="SubPixPhot::SourceInput::SourceInput__std::list:Phot::Columns:CR.isR.double"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1a29de47196ec2e400b9300e6a87cea225"></span><code class="descname">SourceInput</code><span class="sig-paren">(</span><em class="property">const</em> std::list&lt;Phot::Columns&gt; &amp;<em>columns</em>, std::istream &amp;<em>instream</em>, double <em>max_exp_coef</em> = 1<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInput11SourceInputERKNSt4listIN4Phot7ColumnsEEERNSt7istreamEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a source input tied to the given stream. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot11SourceInput16attach_to_streamERNSt7istreamE">
<span id="SubPixPhot::SourceInput::attach_to_stream__isR"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1a89e2fe684e14a290fe14de9f44d5fb74"></span>void <code class="descname">attach_to_stream</code><span class="sig-paren">(</span>std::istream &amp;<em>instream</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInput16attach_to_streamERNSt7istreamE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Read sources from the given stream. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot11SourceInputrsERN4Core9SDKSourceE">
<span id="SubPixPhot::SourceInput::rshift-operator__Core::SDKSourceR"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1abfe1bd383cea6d996e7f106667a2536c"></span><a class="reference internal" href="#_CPPv2N10SubPixPhot11SourceInputE" title="SubPixPhot::SourceInput">SourceInput</a> &amp;<code class="descname">operator&gt;&gt;</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core9SDKSourceE" title="Core::SDKSource">SDKSource</a> &amp;<em>source</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInputrsERN4Core9SDKSourceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Read a source with an Elliptical Gaussian PSF. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot11SourceInputrsERN4Core14SourceLocationE">
<span id="SubPixPhot::SourceInput::rshift-operator__Core::SourceLocationR"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1a25fe307badd9eccefac0fd1f3007b0d9"></span><a class="reference internal" href="#_CPPv2N10SubPixPhot11SourceInputE" title="SubPixPhot::SourceInput">SourceInput</a> &amp;<code class="descname">operator&gt;&gt;</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core14SourceLocationE" title="Core::SourceLocation">SourceLocation</a> &amp;<em>source</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInputrsERN4Core14SourceLocationE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Read a source with an unspecified PSF. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot11SourceInputrsERN2IO15OutputSDKSourceE">
<span id="SubPixPhot::SourceInput::rshift-operator__IO::OutputSDKSourceR"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1a1d1f3226f9c3633dd86e2c5ea1ee6a2d"></span><a class="reference internal" href="#_CPPv2N10SubPixPhot11SourceInputE" title="SubPixPhot::SourceInput">SourceInput</a> &amp;<code class="descname">operator&gt;&gt;</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO15OutputSDKSourceE" title="IO::OutputSDKSource">OutputSDKSource</a> &amp;<em>source</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInputrsERN2IO15OutputSDKSourceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Read a source with an Elliptical Gaussian PSF that can be enabled/disabled according to a column in the input file. </p>
<p>Read a source with an Elliptical Gaussian PSF that can be enabled/disabled according to a column in the input file </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK10SubPixPhot11SourceInputntEv">
<span id="SubPixPhot::SourceInput::not-operatorC"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1aa5eaa815deccc9c08942bff95042e05a"></span>bool <code class="descname">operator!</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK10SubPixPhot11SourceInputntEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Is the state of the source reader bad (i.e. last operation failed or we reached the end of input. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK10SubPixPhot11SourceInput4failEv">
<span id="SubPixPhot::SourceInput::failC"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1a137d05a30a73cdf4e19428f937ca47c1"></span>bool <code class="descname">fail</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK10SubPixPhot11SourceInput4failEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Did the last operation complete successfully. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK10SubPixPhot11SourceInputcvbEv">
<span id="SubPixPhot::SourceInput::castto-b-operatorC"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1a36792ada7b24804966da062a924b3c83"></span><code class="descname">operator bool</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK10SubPixPhot11SourceInputcvbEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Is the state of the source reader good (i.e. last operation succeeded and no EOF yet. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK10SubPixPhot11SourceInput3eofEv">
<span id="SubPixPhot::SourceInput::eofC"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1af54e0eb440f9d81602636d450e483acd"></span>bool <code class="descname">eof</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK10SubPixPhot11SourceInput3eofEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Did we reach the end of input. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N10SubPixPhot11SourceInput11set_columnsERKNSt4listIN4Phot7ColumnsEEE">
<span id="SubPixPhot::SourceInput::set_columns__std::list:Phot::Columns:CR"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1a00df4323506543424fe593561de3e72f"></span>void <code class="descname">set_columns</code><span class="sig-paren">(</span><em class="property">const</em> std::list&lt;Phot::Columns&gt; &amp;<em>columns</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInput11set_columnsERKNSt4listIN4Phot7ColumnsEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set the values of the __*_col members according to the contents of the argument. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10SubPixPhot11SourceInput11read_sourceER11SOURCE_TYPERdRdRdRdRd">
<span id="SubPixPhot::SourceInput::read_source__SOURCE_TYPER.doubleR.doubleR.doubleR.doubleR.doubleR"></span><em class="property">template </em>&lt;<em class="property">class</em> SOURCE_TYPE&gt;<br /><span class="target" id="classSubPixPhot_1_1SourceInput_1a59c329552bf754762619395afd69fb77"></span>bool <code class="descname">read_source</code><span class="sig-paren">(</span>SOURCE_TYPE &amp;<em>source</em>, double &amp;<em>s</em>, double &amp;<em>d</em>, double &amp;<em>k</em>, double &amp;<em>amp</em>, double &amp;<em>bg</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInput11read_sourceER11SOURCE_TYPERdRdRdRdRd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Read a source from the input stream to source and return its enabled/disabled status if such a column was specified (the result is undefined if it was not). </p>
<p>Reads a source from the input stream to src. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N10SubPixPhot11SourceInput10__instreamE">
<span id="SubPixPhot::SourceInput::__instream__isP"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1a776593ef19f3829b1c6eba9a68be1e03"></span>std::istream *<code class="descname">__instream</code><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInput10__instreamE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The stream from which input will be done. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10SubPixPhot11SourceInput8__id_colE">
<span id="SubPixPhot::SourceInput::__id_col__i"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1a8d0a507750f58d063d70f56a7257f4be"></span>int <code class="descname">__id_col</code><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInput8__id_colE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The column number of the source id. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10SubPixPhot11SourceInput7__x_colE">
<span id="SubPixPhot::SourceInput::__x_col__i"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1a3e6eed2a9893ac8e85a8c4a49e52bd2f"></span>int <code class="descname">__x_col</code><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInput7__x_colE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The column number of the source x position. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10SubPixPhot11SourceInput7__y_colE">
<span id="SubPixPhot::SourceInput::__y_col__i"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1ac503fa5ebe55a83893c377e5be3846a1"></span>int <code class="descname">__y_col</code><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInput7__y_colE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The column number of the source y position. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10SubPixPhot11SourceInput7__s_colE">
<span id="SubPixPhot::SourceInput::__s_col__i"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1ab6f8804eb27fd32c9ee173d3f47e1b21"></span>int <code class="descname">__s_col</code><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInput7__s_colE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The column number of the source S parameter. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10SubPixPhot11SourceInput7__d_colE">
<span id="SubPixPhot::SourceInput::__d_col__i"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1ad52ff5a71622baf787aac791d9aa09d3"></span>int <code class="descname">__d_col</code><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInput7__d_colE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The column number of the source D position. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10SubPixPhot11SourceInput7__k_colE">
<span id="SubPixPhot::SourceInput::__k_col__i"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1a92629296ecd8b5d9e77729d6db28369e"></span>int <code class="descname">__k_col</code><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInput7__k_colE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The column number of the source K position. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10SubPixPhot11SourceInput9__amp_colE">
<span id="SubPixPhot::SourceInput::__amp_col__i"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1a6ef6e9c86b3b52f78647367d765c628c"></span>int <code class="descname">__amp_col</code><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInput9__amp_colE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The column number of the source amplitude. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10SubPixPhot11SourceInput8__bg_colE">
<span id="SubPixPhot::SourceInput::__bg_col__i"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1a79850bb9ca564eb1dd24a572dcf95899"></span>int <code class="descname">__bg_col</code><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInput8__bg_colE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The column number of the source background. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10SubPixPhot11SourceInput8__on_colE">
<span id="SubPixPhot::SourceInput::__on_col__i"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1a56ac8ebe5c0cb55e68444575620d2e42"></span>int <code class="descname">__on_col</code><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInput8__on_colE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The column number which specifies if the source is enabled (for OutputSDKSource input only). </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10SubPixPhot11SourceInput9__col_numE">
<span id="SubPixPhot::SourceInput::__col_num__i"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1a3e0ecd87042430f40589f99b895f4b88"></span>int <code class="descname">__col_num</code><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInput9__col_numE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of columns in an input line. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10SubPixPhot11SourceInput14__max_exp_coefE">
<span id="SubPixPhot::SourceInput::__max_exp_coef__double"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1af202a246e7bee438e9b643f3a2b85373"></span>double <code class="descname">__max_exp_coef</code><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInput14__max_exp_coefE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The minimum subdivision size to allow the read sources when they calculate intergrals of their PSFs. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10SubPixPhot11SourceInput6__goodE">
<span id="SubPixPhot::SourceInput::__good__b"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1a84bb343dbc6e4be6981d5c8de6b11c78"></span>bool <code class="descname">__good</code><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInput6__goodE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Did the last operation complete successfully. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10SubPixPhot11SourceInput5__eofE">
<span id="SubPixPhot::SourceInput::__eof__b"></span><span class="target" id="classSubPixPhot_1_1SourceInput_1a39a5201eec5b702ff178f038e92159e0"></span>bool <code class="descname">__eof</code><a class="headerlink" href="#_CPPv2N10SubPixPhot11SourceInput5__eofE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Did we reach the end of input. </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="psf">
<h2>PSF<a class="headerlink" href="#psf" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="_CPPv23PSF">
<span id="PSF"></span><span class="target" id="namespacePSF"></span><em class="property">namespace </em><code class="descname">PSF</code><a class="headerlink" href="#_CPPv23PSF" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Typedefs</p>
<dl class="type">
<dt id="_CPPv2N3PSF11RowMajorMapE">
<span id="PSF::RowMajorMap"></span><span class="target" id="PiecewiseBicubicMap_8h_1a77dd421690e3de79efcb2a360708ca03"></span><em class="property">typedef </em>Eigen::Map&lt;<em class="property">const</em> Eigen::Matrix&lt;double, Eigen::Dynamic, Eigen::Dynamic, Eigen::RowMajor&gt;&gt; <code class="descname">RowMajorMap</code><a class="headerlink" href="#_CPPv2N3PSF11RowMajorMapE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Simplify statements requiring this type. </p>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N3PSF15MapVariableTypeE">
<span id="PSF::MapVariableType"></span><span class="target" id="PSF_2Typedefs_8h_1a4cf8ad1ad277855714bba317be63623d"></span><em class="property">typedef </em>std::pair&lt;std::string, std::valarray&lt;double&gt;&gt; <code class="descname">MapVariableType</code><a class="headerlink" href="#_CPPv2N3PSF15MapVariableTypeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The type to use for PSF map variables (quantities PSF depends on). </p>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N3PSF14MapVarListTypeE">
<span id="PSF::MapVarListType"></span><span class="target" id="PSF_2Typedefs_8h_1a9dcb49578f93114480ecabc8ea96de80"></span><em class="property">typedef </em>std::list&lt;<a class="reference internal" href="#_CPPv2N3PSF15MapVariableTypeE" title="PSF::MapVariableType">MapVariableType</a>&gt; <code class="descname">MapVarListType</code><a class="headerlink" href="#_CPPv2N3PSF14MapVarListTypeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>List of PSF map variables. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Enums</p>
<dl class="type">
<dt id="_CPPv2N3PSF13SDKDerivativeE">
<span id="PSF::SDKDerivative"></span><span class="target" id="EllipticalGaussianIntegralByOrder_8h_1a9779b56088bafa3895c2f587f5e39a7f"></span><em class="property">enum </em><code class="descname">SDKDerivative</code><a class="headerlink" href="#_CPPv2N3PSF13SDKDerivativeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Tags for derivatives of integrals of EllipticalGaussianPSF with respect to the shape parameters. </p>
<p><em>Values:</em></p>
<dl class="enumerator">
<dt id="_CPPv2N3PSF8NO_DERIVE">
<span class="target" id="EllipticalGaussianIntegralByOrder_8h_1a9779b56088bafa3895c2f587f5e39a7fafb0091a04d093987bff606d6a8381e05"></span><code class="descname">NO_DERIV</code><a class="headerlink" href="#_CPPv2N3PSF8NO_DERIVE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The value of the integral. </p>
</dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N3PSF7S_DERIVE">
<span class="target" id="EllipticalGaussianIntegralByOrder_8h_1a9779b56088bafa3895c2f587f5e39a7fae38aaa43b96c6b2707054f7216190b96"></span><code class="descname">S_DERIV</code><a class="headerlink" href="#_CPPv2N3PSF7S_DERIVE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>First derivative with respect to S. </p>
</dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N3PSF7D_DERIVE">
<span class="target" id="EllipticalGaussianIntegralByOrder_8h_1a9779b56088bafa3895c2f587f5e39a7fa725916cc5281d8d0cf8a2843d746b704"></span><code class="descname">D_DERIV</code><a class="headerlink" href="#_CPPv2N3PSF7D_DERIVE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>First derivative with respect to D. </p>
</dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N3PSF7K_DERIVE">
<span class="target" id="EllipticalGaussianIntegralByOrder_8h_1a9779b56088bafa3895c2f587f5e39a7fa1605913366e45c52a7923f4aeeddcfc8"></span><code class="descname">K_DERIV</code><a class="headerlink" href="#_CPPv2N3PSF7K_DERIVE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>First derivative with respect to K. </p>
</dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N3PSF8SS_DERIVE">
<span class="target" id="EllipticalGaussianIntegralByOrder_8h_1a9779b56088bafa3895c2f587f5e39a7fa97d9e876136679f06e19062885694d47"></span><code class="descname">SS_DERIV</code><a class="headerlink" href="#_CPPv2N3PSF8SS_DERIVE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Second derivative with respect to S. </p>
</dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N3PSF8SD_DERIVE">
<span class="target" id="EllipticalGaussianIntegralByOrder_8h_1a9779b56088bafa3895c2f587f5e39a7fa3a592e08bf452e022533b3c16d3ee210"></span><code class="descname">SD_DERIV</code><a class="headerlink" href="#_CPPv2N3PSF8SD_DERIVE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Derivative wrt to D(S) of the S(D) derivative. </p>
</dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N3PSF8SK_DERIVE">
<span class="target" id="EllipticalGaussianIntegralByOrder_8h_1a9779b56088bafa3895c2f587f5e39a7fab257c02439d8abce242b4e9c04f43346"></span><code class="descname">SK_DERIV</code><a class="headerlink" href="#_CPPv2N3PSF8SK_DERIVE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Derivative wrt to K(S) of the S(K) derivative. </p>
</dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N3PSF8DD_DERIVE">
<span class="target" id="EllipticalGaussianIntegralByOrder_8h_1a9779b56088bafa3895c2f587f5e39a7fa8e186d0e698586a0f61b8304dbd7810f"></span><code class="descname">DD_DERIV</code><a class="headerlink" href="#_CPPv2N3PSF8DD_DERIVE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Second derivative with respect to D. </p>
</dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N3PSF8DK_DERIVE">
<span class="target" id="EllipticalGaussianIntegralByOrder_8h_1a9779b56088bafa3895c2f587f5e39a7fa4aee4af0917fbd7a11e7f43a4b2a154e"></span><code class="descname">DK_DERIV</code><a class="headerlink" href="#_CPPv2N3PSF8DK_DERIVE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Derivative wrt to K(D) of the D(K) derivative. </p>
</dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N3PSF8KK_DERIVE">
<span class="target" id="EllipticalGaussianIntegralByOrder_8h_1a9779b56088bafa3895c2f587f5e39a7fab014729d33189ebc520a9af39a83860e"></span><code class="descname">KK_DERIV</code><a class="headerlink" href="#_CPPv2N3PSF8KK_DERIVE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Second derivative with respect to K. </p>
</dd></dl>

</dd></dl>

<dl class="type">
<dt id="_CPPv2N3PSF9ModelTypeE">
<span id="PSF::ModelType"></span><span class="target" id="PSF_2Typedefs_8h_1a247acbecf7c185bfc272363061b470e5"></span><em class="property">enum </em><code class="descname">ModelType</code><a class="headerlink" href="#_CPPv2N3PSF9ModelTypeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The allowed PSF/PRF models. </p>
<p><em>Values:</em></p>
<dl class="enumerator">
<dt id="_CPPv2N3PSF3SDKE">
<span class="target" id="PSF_2Typedefs_8h_1a247acbecf7c185bfc272363061b470e5ad33cf5c472f3cf388bc780f2ac760f70"></span><code class="descname">SDK</code><a class="headerlink" href="#_CPPv2N3PSF3SDKE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N3PSF7BICUBICE">
<span class="target" id="PSF_2Typedefs_8h_1a247acbecf7c185bfc272363061b470e5ada7a206f2a7f94f0c0f590cbcc1aa2fc"></span><code class="descname">BICUBIC</code><a class="headerlink" href="#_CPPv2N3PSF7BICUBICE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N3PSF4ZEROE">
<span class="target" id="PSF_2Typedefs_8h_1a247acbecf7c185bfc272363061b470e5a68bc94396406d0292e14c8014f3b7255"></span><code class="descname">ZERO</code><a class="headerlink" href="#_CPPv2N3PSF4ZEROE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF3PSF8validateERN5boost3anyERKNSt6vectorINSt6stringEEEP4Gridi">
<span id="PSF::PSF::validate__boost::anyR.std::vector:ss:CR.GridP.i"></span><span class="target" id="PSF_2CommandLineUtil_8cpp_1a1f343c09344ddf85473fe781d720f38f"></span>void <code class="descname">validate</code><span class="sig-paren">(</span>boost::any &amp;<em>value</em>, <em class="property">const</em> std::vector&lt;std::string&gt; &amp;<em>option_strings</em>, <a class="reference internal" href="#_CPPv2N3PSF4GridE" title="PSF::Grid">Grid</a> *, int<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF3PSF8validateERN5boost3anyERKNSt6vectorINSt6stringEEEP4Gridi" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Parse a string defining a grid over which piecewise PSFs are defined. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">value</span></code>: The value to parse into. </li>
<li><code class="docutils literal"><span class="pre">option_strings</span></code>: The strings passed to this option on the command line. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF3PSF8validateERN5boost3anyERKNSt6vectorINSt6stringEEEP9ModelTypei">
<span id="PSF::PSF::validate__boost::anyR.std::vector:ss:CR.ModelTypeP.i"></span><span class="target" id="PSF_2CommandLineUtil_8cpp_1a5c8dd7b44de373f9a18107f731ca0513"></span>void <code class="descname">validate</code><span class="sig-paren">(</span>boost::any &amp;<em>value</em>, <em class="property">const</em> std::vector&lt;std::string&gt; &amp;<em>option_strings</em>, <a class="reference internal" href="#_CPPv2N3PSF9ModelTypeE" title="PSF::ModelType">ModelType</a> *, int<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF3PSF8validateERN5boost3anyERKNSt6vectorINSt6stringEEEP9ModelTypei" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Parse a string identifying a PSF model to use. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">value</span></code>: The value to parse into. </li>
<li><code class="docutils literal"><span class="pre">option_strings</span></code>: The strings passed to this option on the command line. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF3PSF15fill_psf_fluxesERN2IO12H5IODataTreeE">
<span id="PSF::PSF::fill_psf_fluxes__IO::H5IODataTreeR"></span><span class="target" id="DataTreeCalculations_8cpp_1a6d1cbeb35e7ab468424450d968ebdb18"></span>void <code class="descname">fill_psf_fluxes</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF3PSF15fill_psf_fluxesERN2IO12H5IODataTreeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fill the PSF fluxes in a data tree (computed if necessary). </p>
<p>If the fluxes are not directly available, magnitudes and magnitude zero points must be. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF3PSF19fill_psf_amplitudesERN2IO12H5IODataTreeE">
<span id="PSF::PSF::fill_psf_amplitudes__IO::H5IODataTreeR"></span><span class="target" id="DataTreeCalculations_8cpp_1a0846d9e41d41711e21d4cd6152d61092"></span>void <code class="descname">fill_psf_amplitudes</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF3PSF19fill_psf_amplitudesERN2IO12H5IODataTreeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fill The PSF amplitudes in a data tree (computed if necessary). </p>
<p>If the amplitudes are not already available, both the PSF shape information should be and some form of flux information: fluxes or magnitudes + magnitude zero point. If fluxes are not available (as well as amplitudes) they will also be filled. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF9factorialEj">
<span id="PSF::factorial__unsigned"></span><span class="target" id="EllipticalGaussian_8cpp_1ae4d0a60abb46ed1de3bc28ce54529bbb"></span>double <code class="descname">factorial</code><span class="sig-paren">(</span>unsigned <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF9factorialEj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculates n! </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF3PSF11fill_powersERNSt6vectorIdEEN4Core16vector_size_typeE">
<span id="PSF::PSF::fill_powers__std::vector:double:R.Core::vector_size_type"></span><span class="target" id="IntegralUtil_8cpp_1a6ba3b20f499a3c897794795f00fecfee"></span>void <code class="descname">fill_powers</code><span class="sig-paren">(</span>std::vector&lt;double&gt; &amp;<em>powers</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>max_pow</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF3PSF11fill_powersERNSt6vectorIdEEN4Core16vector_size_typeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Extend a vector with powers x^n up to max_pow, assuming it already contains some. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">powers</span></code>: The vector to extend. Must already contain at lesat two entries: 1 and x. </li>
<li><code class="docutils literal"><span class="pre">max_pow</span></code>: The largest power to include in the vector. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF3PSF17initialize_powersERNSt6vectorIdEEdN4Core16vector_size_typeEN4Core16vector_size_typeE">
<span id="PSF::PSF::initialize_powers__std::vector:double:R.double.Core::vector_size_type.Core::vector_size_type"></span><span class="target" id="IntegralUtil_8cpp_1a752daaa2bf411bc02fbbe9968b1528d9"></span>void <code class="descname">initialize_powers</code><span class="sig-paren">(</span>std::vector&lt;double&gt; &amp;<em>powers</em>, double <em>x</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>max_pow</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>initial_storage</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF3PSF17initialize_powersERNSt6vectorIdEEdN4Core16vector_size_typeEN4Core16vector_size_typeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Initializes a vector of powers. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">powers</span></code>: The vector to initialize. </li>
<li><code class="docutils literal"><span class="pre">x</span></code>: The value whose powers are to be stored. </li>
<li><code class="docutils literal"><span class="pre">max_pow</span></code>: Pre-fill powers up to at least this value. </li>
<li><code class="docutils literal"><span class="pre">initial_storage</span></code>: Make sure the vector can hold at least this many values before it needs to expand its storage. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF3PSF32combine_required_tree_quantitiesENSt3setINSt6stringEE14const_iteratorENSt3setINSt6stringEE14const_iteratorEPKNSt6stringEPKNSt6stringE">
<span id="PSF::PSF::combine_required_tree_quantities__std::set:ss:::const_iterator.std::set:ss:::const_iterator.ssCP.ssCP"></span><span class="target" id="Map_8cpp_1a9d188d78996c84a83bb1d502070a2b00"></span>std::set&lt;std::string&gt; <code class="descname">combine_required_tree_quantities</code><span class="sig-paren">(</span>std::set&lt;std::string&gt;::const_iterator <em>v1_start</em>, std::set&lt;std::string&gt;::const_iterator <em>v1_end</em>, <em class="property">const</em> std::string *<em>v2_start</em>, <em class="property">const</em> std::string *<em>v2_end</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF3PSF32combine_required_tree_quantitiesENSt3setINSt6stringEE14const_iteratorENSt3setINSt6stringEE14const_iteratorEPKNSt6stringEPKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Combine two collections of required data tree quantities into a set. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">v1_start</span></code>: The first iterator from the first set to include. </li>
<li><code class="docutils literal"><span class="pre">v1_end</span></code>: One past the last iterator from the first set to include. </li>
<li><code class="docutils literal"><span class="pre">v2_start</span></code>: The first iterator from the second set to include. </li>
<li><code class="docutils literal"><span class="pre">v2_end</span></code>: One past the last iterator from the second set to include. </li>
</ul>
</dd>
</dl>
</p>
<p>Used by inheriting PSF maps to add their required quantities. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF3PSF32combine_required_tree_quantitiesEPKNSt6stringEPKNSt6stringE">
<span id="PSF::PSF::combine_required_tree_quantities__ssCP.ssCP"></span><span class="target" id="Map_8cpp_1a81fabc206ef1aea33eecc5e7c921a5ad"></span>std::set&lt;std::string&gt; <code class="descname">combine_required_tree_quantities</code><span class="sig-paren">(</span><em class="property">const</em> std::string *<em>extra_start</em>, <em class="property">const</em> std::string *<em>extra_end</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF3PSF32combine_required_tree_quantitiesEPKNSt6stringEPKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A simpler version of <a class="reference internal" href="#Map_8cpp_1a9d188d78996c84a83bb1d502070a2b00"><span class="std std-ref">combine_required_tree_quantities()</span></a>. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF14calc_cell_coefE20RandomAccessIterator20RandomAccessIterator20RandomAccessIterator20RandomAccessIteratorN4Core16vector_size_typeEddRNSt8valarrayIdEE6size_t">
<span id="PSF::calc_cell_coef__RandomAccessIterator.RandomAccessIterator.RandomAccessIterator.RandomAccessIterator.Core::vector_size_type.double.double.std::valarray:double:R.s"></span><em class="property">template </em>&lt;<em class="property">class</em> RandomAccessIterator&gt;<br /><span class="target" id="PSF_2PiecewiseBicubic_8h_1a2187cf918751cdf13276fed8db3d1cf1"></span>void <code class="descname">calc_cell_coef</code><span class="sig-paren">(</span>RandomAccessIterator <em>value</em>, RandomAccessIterator <em>x_deriv</em>, RandomAccessIterator <em>y_deriv</em>, RandomAccessIterator <em>xy_deriv</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>psf_x_resolution</em>, double <em>width</em>, double <em>height</em>, std::valarray&lt;double&gt; &amp;<em>cell_coef</em>, size_t <em>cell_coef_offset</em> = 0<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14calc_cell_coefE20RandomAccessIterator20RandomAccessIterator20RandomAccessIterator20RandomAccessIteratorN4Core16vector_size_typeEddRNSt8valarrayIdEE6size_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculates the coefficients of the bicubic polynomial for a cell. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">value</span></code>: The PSF value at the bottom left of the grid cell. </li>
<li><code class="docutils literal"><span class="pre">x_deriv</span></code>: The x derivative at the bottom left of the grid cell. </li>
<li><code class="docutils literal"><span class="pre">y_deriv</span></code>: The y derivative at the bottom left of the grid cell. </li>
<li><code class="docutils literal"><span class="pre">xy_deriv</span></code>: The xy cross-derivative at the bottom left of the grid cell. </li>
<li><code class="docutils literal"><span class="pre">psf_x_resolution</span></code>: The number of PSF cells in a single row. </li>
<li><code class="docutils literal"><span class="pre">width</span></code>: The width of the cell. </li>
<li><code class="docutils literal"><span class="pre">height</span></code>: The height of the cell. </li>
<li><code class="docutils literal"><span class="pre">cell_coef</span></code>: On return, filled with the calculated coefficients. </li>
<li><code class="docutils literal"><span class="pre">cell_coef_offset</span></code>: The cell_coef array is filled from offset to offset+16. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF14evaluate_termsE12TermIterator12TermIterator11VarIterator11VarIteratorR10ResultType">
<span id="PSF::evaluate_terms__TermIterator.TermIterator.VarIterator.VarIterator.ResultTypeR"></span><em class="property">template </em>&lt;<em class="property">class</em> TermIterator, <em class="property">class</em> VarIterator, <em class="property">class</em> ResultType&gt;<br /><span class="target" id="TermCalculator_8h_1a74ba73992e4380b2a8526fd39e076d6e"></span>void <code class="descname">evaluate_terms</code><span class="sig-paren">(</span>TermIterator <em>start_term</em>, TermIterator <em>end_term</em>, VarIterator <em>start_var</em>, VarIterator <em>end_var</em>, ResultType &amp;<em>result</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14evaluate_termsE12TermIterator12TermIterator11VarIterator11VarIteratorR10ResultType" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fill result with the value of each term for each source. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">start_term</span></code>: Iterator to the first term to evaluate. Each term is a string expression involving variables defined by start_var/end_var. </li>
<li><code class="docutils literal"><span class="pre">end_term</span></code>: One past the last term to evaluate. </li>
<li><code class="docutils literal"><span class="pre">start_var</span></code>: See same name argument to evaluate_term_expression. </li>
<li><code class="docutils literal"><span class="pre">end_var</span></code>: See same name argument to evaluate_term_expression. </li>
<li><code class="docutils literal"><span class="pre">result</span></code>: See same name argument to evaluate_term_expression. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF24evaluate_term_expressionERKNSt6stringE11VarIterator11VarIteratorR10ResultType">
<span id="PSF::evaluate_term_expression__ssCR.VarIterator.VarIterator.ResultTypeR"></span><em class="property">template </em>&lt;<em class="property">class</em> VarIterator, <em class="property">class</em> ResultType&gt;<br /><span class="target" id="TermCalculator_8h_1a177fd33b7e1b0ff61ffe8a3af3bee422"></span>void <code class="descname">evaluate_term_expression</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>term_expression</em>, VarIterator <em>start_var</em>, VarIterator <em>end_var</em>, ResultType &amp;<em>result</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF24evaluate_term_expressionERKNSt6stringE11VarIterator11VarIteratorR10ResultType" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fill result with all terms the PSF depends on per term_expression. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">term_expression</span></code>: The expression defining the terms to include in PSF fitting (see Grammar for syntax). </li>
<li><code class="docutils literal"><span class="pre">start_var</span></code>: Iterator to the first varuable that participates in the expression. Entries should be pairs of &lt;variable name&gt;, &lt;array of values for each source&gt; </li>
<li><code class="docutils literal"><span class="pre">end_var</span></code>: Iterator to one past the last variable that participates in the expression. </li>
<li><code class="docutils literal"><span class="pre">result</span></code>: The location to fill with the PSF map terms. Resized as necessary to fit the result. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<dl class="class">
<dt id="_CPPv2N3PSF19CirclePieceIntegralE">
<span id="PSF::CirclePieceIntegral"></span><span class="target" id="classPSF_1_1CirclePieceIntegral"></span><em class="property">class </em><code class="descname">CirclePieceIntegral</code><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegralE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;CirclePieceIntegral.h&gt;</em><p>Implements integral of <span class="math">\(x^my^n\)</span> over a horizontal circlre piece in the first quadrant. </p>
<p>The wedge is defined by the following diagram:</p>
<p><img alt="_images/hcircle_piece_diagram.png" src="_images/hcircle_piece_diagram.png" /></p>
<p>The is solution described here. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF19CirclePieceIntegral19CirclePieceIntegralEddddddN4Core16vector_size_typeE">
<span id="PSF::CirclePieceIntegral::CirclePieceIntegral__double.double.double.double.double.double.Core::vector_size_type"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1a9bb6387a42c8ef2f58223ea12a5171b8"></span><code class="descname">CirclePieceIntegral</code><span class="sig-paren">(</span>double <em>xmin</em>, double <em>ymin</em>, double <em>ymax</em>, double <em>xc</em>, double <em>yc</em>, double <em>r</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>initial_storage</em> = 3<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral19CirclePieceIntegralEddddddN4Core16vector_size_typeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create an integral over the area with the given parameters. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">xmin</span></code>: The straight vertical boundary ( <span class="math">\(x_{min}\)</span>) </li>
<li><code class="docutils literal"><span class="pre">ymin</span></code>: The lower horizontal boundary ( <span class="math">\(y_{min}\)</span>) </li>
<li><code class="docutils literal"><span class="pre">ymax</span></code>: The upper horizontal boundary ( <span class="math">\(y_{max}\)</span>) </li>
<li><code class="docutils literal"><span class="pre">xc</span></code>: The x coordinate of the circle center ( <span class="math">\(x_c\)</span>) </li>
<li><code class="docutils literal"><span class="pre">yc</span></code>: The y coordinate of the circle center ( <span class="math">\(y_c\)</span>) </li>
<li><code class="docutils literal"><span class="pre">r</span></code>: The radius of the circle </li>
<li><code class="docutils literal"><span class="pre">initial_storage</span></code>: The integral will be initiall prepared to compute values for up to this combined x and y power. Calculating values for larger powers still works, but may result in moving data around. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF19CirclePieceIntegralclEjj">
<span id="PSF::CirclePieceIntegral::call-operator__unsigned.unsigned"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1acaf24eb368e852029c9107a00cfb88c6"></span>double <code class="descname">operator()</code><span class="sig-paren">(</span>unsigned <em>m</em>, unsigned <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegralclEjj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the integral of x^m y^n over the circle piece. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF19CirclePieceIntegral6fill_REN4Core16vector_size_typeERNSt6vectorIdEERNSt6vectorIdEE">
<span id="PSF::CirclePieceIntegral::fill_R__Core::vector_size_type.std::vector:double:R.std::vector:double:R"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1a0ca8bee72109a79a26b2893471e69a71"></span>void <code class="descname">fill_R</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>max_n</em>, std::vector&lt;double&gt; &amp;<em>y_pow</em>, std::vector&lt;double&gt; &amp;<em>Rn</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral6fill_REN4Core16vector_size_typeERNSt6vectorIdEERNSt6vectorIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fills <span class="math">\(R_n(y)\)</span>. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">max_n</span></code>: The index (n) up to which to compute <span class="math">\(R_n(y)\)</span> values. </li>
<li><code class="docutils literal"><span class="pre">y_pow</span></code>: The array of powers of the y argument. </li>
<li><code class="docutils literal"><span class="pre">Rn</span></code>: The vector to fill with the computed values, it must contain at least the <span class="math">\(R_0(y)\)</span> entry. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF19CirclePieceIntegral10fill_R_maxEN4Core16vector_size_typeE">
<span id="PSF::CirclePieceIntegral::fill_R_max__Core::vector_size_type"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1a44f2aeb3ada882c02418cf0341359dd9"></span>void <code class="descname">fill_R_max</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>max_n</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral10fill_R_maxEN4Core16vector_size_typeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Computes all <span class="math">\(R_n(y_{max})\)</span> values for n&lt;=max_n and stores them in __R_max. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF19CirclePieceIntegral11fill_p_evenEN4Core16vector_size_typeE">
<span id="PSF::CirclePieceIntegral::fill_p_even__Core::vector_size_type"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1a9dd228c1ebf6550aee2c0499f72df235"></span>void <code class="descname">fill_p_even</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>max_n</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral11fill_p_evenEN4Core16vector_size_typeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Computes all <span class="math">\(P^{even}_n\)</span> for n&lt;max_n and stores them in __q[0]. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF19CirclePieceIntegral10fill_p_oddEN4Core16vector_size_typeE">
<span id="PSF::CirclePieceIntegral::fill_p_odd__Core::vector_size_type"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1a9c9cd29824c76e7aee6fa5670ac1636e"></span>void <code class="descname">fill_p_odd</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>max_n</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral10fill_p_oddEN4Core16vector_size_typeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Computes all <span class="math">\(P^{odd}_n\)</span> for n&lt;max_n and stores tham in __q[1]. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF19CirclePieceIntegral15fill_q_diagonalEN4Core16vector_size_typeEN4Core16vector_size_typeE">
<span id="PSF::CirclePieceIntegral::fill_q_diagonal__Core::vector_size_type.Core::vector_size_type"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1a3191ab82c76c2f410bd2960fcfd9f65e"></span>void <code class="descname">fill_q_diagonal</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>m</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral15fill_q_diagonalEN4Core16vector_size_typeEN4Core16vector_size_typeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fills in a diagonal of __q with indices that sum up to (m+n) and the first of which has the same parity as m, up to (m, n), assuming all earlier diagonals are filled. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF19CirclePieceIntegral11calculate_qEN4Core16vector_size_typeEN4Core16vector_size_typeE">
<span id="PSF::CirclePieceIntegral::calculate_q__Core::vector_size_type.Core::vector_size_type"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1a98ececf14e6be180b6d9546d8bfb76d5"></span>void <code class="descname">calculate_q</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>m</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral11calculate_qEN4Core16vector_size_typeEN4Core16vector_size_typeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fills in __q[m][n] and possibly other entries of __q if they are calculated along the way. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N3PSF19CirclePieceIntegral4__ycE">
<span id="PSF::CirclePieceIntegral::__yc__double"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1a9e6ccf5faf6dfe5fbb76e2110d7dabee"></span>double <code class="descname">__yc</code><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral4__ycE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Circle center y coordinate ( <span class="math">\(y_c^2\)</span>) (see diagram). </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19CirclePieceIntegral4__r2E">
<span id="PSF::CirclePieceIntegral::__r2__double"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1aaf86b43967208ce31b1c995d279f50aa"></span>double <code class="descname">__r2</code><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral4__r2E" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Square of the circle radius. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19CirclePieceIntegral5__yc2E">
<span id="PSF::CirclePieceIntegral::__yc2__double"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1a8954aa08c9f9fd2c8ad642a6072921ca"></span>double <code class="descname">__yc2</code><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral5__yc2E" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Square of the circle center y coordinate ( <span class="math">\(y_c^2\)</span>) (see diagram) </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19CirclePieceIntegral10__r2_m_yc2E">
<span id="PSF::CirclePieceIntegral::__r2_m_yc2__double"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1ae61fffd65fafb672a80635e74576ed64"></span>double <code class="descname">__r2_m_yc2</code><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral10__r2_m_yc2E" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><span class="math">\(r^2-y_c^2\)</span> </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19CirclePieceIntegral11__ymin_m_ycE">
<span id="PSF::CirclePieceIntegral::__ymin_m_yc__double"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1adfbc1b4c5b5232b389a8fc39eb99a8e7"></span>double <code class="descname">__ymin_m_yc</code><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral11__ymin_m_ycE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><span class="math">\(y_{min}-y_c\)</span> </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19CirclePieceIntegral11__ymax_m_ycE">
<span id="PSF::CirclePieceIntegral::__ymax_m_yc__double"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1a18352d3d3569f205d8eb47007ed4089b"></span>double <code class="descname">__ymax_m_yc</code><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral11__ymax_m_ycE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><span class="math">\(y_{max}-y_c\)</span> </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19CirclePieceIntegral11__root_yminE">
<span id="PSF::CirclePieceIntegral::__root_ymin__double"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1aa6a99831c7829fecfb2d79190c963880"></span>double <code class="descname">__root_ymin</code><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral11__root_yminE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><span class="math">\(\sqrt{r^2-(y_c-y_{min})^2}\)</span> </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19CirclePieceIntegral11__root_ymaxE">
<span id="PSF::CirclePieceIntegral::__root_ymax__double"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1a8920a3e26d99376a859ce1a796e466dd"></span>double <code class="descname">__root_ymax</code><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral11__root_ymaxE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><span class="math">\(\sqrt{r^2-(y_c-y_{max})^2}\)</span> </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19CirclePieceIntegral10__ymin_powE">
<span id="PSF::CirclePieceIntegral::__ymin_pow__std::vector:double:"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1a0d738ed82df1397e55e902609ed6aa8f"></span>std::vector&lt;double&gt; <code class="descname">__ymin_pow</code><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral10__ymin_powE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Various powers of <span class="math">\(y_{min}\)</span>. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19CirclePieceIntegral10__ymax_powE">
<span id="PSF::CirclePieceIntegral::__ymax_pow__std::vector:double:"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1a50ea82277b78ee2f9d7cfcc6301eedc3"></span>std::vector&lt;double&gt; <code class="descname">__ymax_pow</code><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral10__ymax_powE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Various powers of <span class="math">\(y_{max}\)</span>. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19CirclePieceIntegral8__xc_powE">
<span id="PSF::CirclePieceIntegral::__xc_pow__std::vector:double:"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1a2fc5dd018bbca57769d808d0fc3d9ecd"></span>std::vector&lt;double&gt; <code class="descname">__xc_pow</code><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral8__xc_powE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Various powers of <span class="math">\(x_c\)</span>. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19CirclePieceIntegral10__xmin_powE">
<span id="PSF::CirclePieceIntegral::__xmin_pow__std::vector:double:"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1af1481070a1a3ac8f6f737a2ebfa93b6c"></span>std::vector&lt;double&gt; <code class="descname">__xmin_pow</code><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral10__xmin_powE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Various powers of <span class="math">\(x_{min}\)</span>. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19CirclePieceIntegral8__R_yminE">
<span id="PSF::CirclePieceIntegral::__R_ymin__std::vector:double:"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1ac460f51f350a968dd8ab446aaf876233"></span>std::vector&lt;double&gt; <code class="descname">__R_ymin</code><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral8__R_yminE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><span class="math">\(R_{n+1}(y_{min})\)</span> </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19CirclePieceIntegral8__R_ymaxE">
<span id="PSF::CirclePieceIntegral::__R_ymax__std::vector:double:"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1ab7e47d0ceb3a22a00aa2df0449a72272"></span>std::vector&lt;double&gt; <code class="descname">__R_ymax</code><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral8__R_ymaxE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><span class="math">\(R_{n+1}(y_{max})\)</span> </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19CirclePieceIntegral8__valuesE">
<span id="PSF::CirclePieceIntegral::__values__std::vector:std::vector:double::"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1a8070070c147d465803340bbbc61b0e48"></span>std::vector&lt;std::vector&lt;double&gt;&gt; <code class="descname">__values</code><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral8__valuesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>All previously computed values of the integral. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19CirclePieceIntegral3__qE">
<span id="PSF::CirclePieceIntegral::__q__std::vector:std::vector:double::"></span><span class="target" id="classPSF_1_1CirclePieceIntegral_1aa2b7b9a8a9d642d4706ab19ee67fc68c"></span>std::vector&lt;std::vector&lt;double&gt;&gt; <code class="descname">__q</code><a class="headerlink" href="#_CPPv2N3PSF19CirclePieceIntegral3__qE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>All previously computed <span class="math">\(Q_{m,n}\)</span> values. </p>
<p>The first (outer) index is m and the second (inner) is n. This way __q[0] is <span class="math">\(P^{even}\)</span> and __q[1] is <span class="math">\(P^{odd}\)</span>. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N3PSF18EllipticalGaussianE">
<span id="PSF::EllipticalGaussian"></span><span class="target" id="classPSF_1_1EllipticalGaussian"></span><em class="property">class </em><code class="descname">EllipticalGaussian</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF3PSFE" title="PSF::PSF">PSF</a><a class="headerlink" href="#_CPPv2N3PSF18EllipticalGaussianE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;EllipticalGaussian.h&gt;</em><p>An ellptical Gaussian <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> with peak flux above the background normalized to 1. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF18EllipticalGaussian18EllipticalGaussianEddddddd">
<span id="PSF::EllipticalGaussian::EllipticalGaussian__double.double.double.double.double.double.double"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a525ce70f1b3a2038c4cf78b83427ac19"></span><code class="descname">EllipticalGaussian</code><span class="sig-paren">(</span>double <em>s</em>, double <em>d</em>, double <em>k</em>, double <em>background</em> = 0, double <em>relative_precision</em> = __default_rel_precision, double <em>absolute_precision</em> = __default_abs_precision, double <em>max_exp_coef</em> = __default_max_exp_coef<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF18EllipticalGaussian18EllipticalGaussianEddddddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Construct an elliptical Gaussian <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> with the given parameters. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">s</span></code>: The coefficient in front of <span class="math">\((x^2+y^2)/2\)</span> in the exponent </li>
<li><code class="docutils literal"><span class="pre">d</span></code>: The coefficient in front of <span class="math">\((x^2-y^2)/2\)</span> in the exponent </li>
<li><code class="docutils literal"><span class="pre">k</span></code>: The coefficient in front of <span class="math">\(xy\)</span> in the exponent. </li>
<li><code class="docutils literal"><span class="pre">background</span></code>: Background to add under the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a>. </li>
<li><code class="docutils literal"><span class="pre">relative_precision</span></code>: The relative precision to impose on integrals. </li>
<li><code class="docutils literal"><span class="pre">absolute_precision</span></code>: The absolute precision to impose on integrals. </li>
<li><code class="docutils literal"><span class="pre">max_exp_coef</span></code>: The maximum value to allow for any term appearing in the exponent when evaluating integrals. Larger values result in faster code, but very large values lead to severe numerical roundoff errors. Values of order unity work well. </li>
</ul>
</dd>
</dl>
</p>
<p>Integrals are calculated to the less stringent of the absolute or relative precisions given. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF18EllipticalGaussian13set_precisionEdd">
<span id="PSF::EllipticalGaussian::set_precision__double.doubleC"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a8b18b172cf0f4a9aa27356ebd3848dcb"></span>void <code class="descname">set_precision</code><span class="sig-paren">(</span>double <em>relative</em>, double <em>absolute</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF18EllipticalGaussian13set_precisionEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Change the precision requirements from what was set at construction. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF18EllipticalGaussianclEdd">
<span id="PSF::EllipticalGaussian::call-operator__double.doubleC"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a7b0df2cccd7fd07d0a4de683f64d35aa"></span>double <code class="descname">operator()</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF18EllipticalGaussianclEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Evaluates the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> at the given position. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF18EllipticalGaussian8evaluateEdd8ITERABLEbb">
<span id="PSF::EllipticalGaussian::evaluate__double.double.ITERABLE.b.bC"></span><em class="property">template </em>&lt;<em class="property">class</em> ITERABLE&gt;<br /><span class="target" id="classPSF_1_1EllipticalGaussian_1af9e2e20aaba0be82643387d6718475b9"></span>void <code class="descname">evaluate</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em>, ITERABLE <em>result</em>, bool <em>calculate_first_deriv</em> = false, bool <em>calculate_second_deriv</em> = false<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF18EllipticalGaussian8evaluateEdd8ITERABLEbb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculates the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> and its derivatives at the given position. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x</span></code>: The x coordinate where to evaluate the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> (and derivatives). </li>
<li><code class="docutils literal"><span class="pre">y</span></code>: The y coordinate where to evaluate the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> (and derivatives). </li>
<li><code class="docutils literal"><span class="pre">result</span></code>: An array to place the result in. </li>
<li><code class="docutils literal"><span class="pre">calculate_first_deriv</span></code>: Should first order derivatives w.r.t S, D, K be calculated. </li>
<li><code class="docutils literal"><span class="pre">calculate_second_deriv</span></code>: Should secord order derivatives w.r.t. S, D, K be calculated </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF18EllipticalGaussian9poly_coefEddjj">
<span id="PSF::EllipticalGaussian::poly_coef__double.double.unsigned.unsignedC"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1abbb2e4730a35b910ab2543701186c68f"></span>double <code class="descname">poly_coef</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em>, unsigned <em>x_power</em>, unsigned <em>y_power</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF18EllipticalGaussian9poly_coefEddjj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The polynomial coefficients of the taylor expansion around x, y. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF18EllipticalGaussian14set_backgroundEd">
<span id="PSF::EllipticalGaussian::set_background__double"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1ae295ec2aca542a8297db487f154a5cc5"></span>void <code class="descname">set_background</code><span class="sig-paren">(</span>double <em>background</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF18EllipticalGaussian14set_backgroundEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Sets the background for this <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> to the given value. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF18EllipticalGaussian9integrateEddddd">
<span id="PSF::EllipticalGaussian::integrate__double.double.double.double.doubleC"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1ac49cefb6d279b4dd0da16d5326d41a06"></span>double <code class="descname">integrate</code><span class="sig-paren">(</span>double <em>center_x</em>, double <em>center_y</em>, double <em>dx</em>, double <em>dy</em>, double <em>circle_radius</em> = 0<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF18EllipticalGaussian9integrateEddddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculates the integral of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> over a rectangle (or its overlap with a circle). </p>
<p>Uses the local polynomial approximation around the center of the rectangle. Subdiving into smaller rectangles if necessary in order to achive the desired precision.</p>
<p>The rectangle is defined by center_x - dx/2 &lt; x &lt; center_x + dx/2 and center_y - dy/2 &lt; y &lt; center_y + dy/2. The circle is always centered on (0, 0) and has the given radius. If the circle radius is zero, the integral over the full rectangle is calculated. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF18EllipticalGaussian9integrateEdddddbb">
<span id="PSF::EllipticalGaussian::integrate__double.double.double.double.double.b.bC"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1af0bd8952a497b0a10fd89a2ed98cbc3d"></span>double <code class="descname">integrate</code><span class="sig-paren">(</span>double <em>center_x</em>, double <em>center_y</em>, double <em>dx</em>, double <em>dy</em>, double <em>circle_radius</em>, bool <em>calculate_first_deriv</em>, bool <em>calculate_second_deriv</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF18EllipticalGaussian9integrateEdddddbb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculates the integral of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> over a rectangle (or its overlap with a circle) with optional derivatives. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF18EllipticalGaussian15last_integratedE13SDKDerivative">
<span id="PSF::EllipticalGaussian::last_integrated__SDKDerivativeC"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a7f10688092431b1c57a929e12969a77e"></span>double <code class="descname">last_integrated</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N3PSF13SDKDerivativeE" title="PSF::SDKDerivative">SDKDerivative</a> <em>deriv</em> = NO_DERIV<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF18EllipticalGaussian15last_integratedE13SDKDerivative" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF18EllipticalGaussian1sEv">
<span id="PSF::EllipticalGaussian::sC"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a3de072a88bfde8efac1597fc5fd18f4e"></span>double <code class="descname">s</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF18EllipticalGaussian1sEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the value of S. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF18EllipticalGaussian1dEv">
<span id="PSF::EllipticalGaussian::dC"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a84b8ef44f37045f6839445087b3272ee"></span>double <code class="descname">d</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF18EllipticalGaussian1dEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the value of D. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF18EllipticalGaussian1kEv">
<span id="PSF::EllipticalGaussian::kC"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1adf62cc3fd50df390265c2aae70c0398c"></span>double <code class="descname">k</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF18EllipticalGaussian1kEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the value of K. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF18EllipticalGaussian5min_xEv">
<span id="PSF::EllipticalGaussian::min_xC"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a5b56e09814351a4315c7c7f423636025"></span>double <code class="descname">min_x</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF18EllipticalGaussian5min_xEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>How far left does the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> extend. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF18EllipticalGaussian5max_xEv">
<span id="PSF::EllipticalGaussian::max_xC"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a42ebac30e004148e5fe91e5dfd3084a1"></span>double <code class="descname">max_x</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF18EllipticalGaussian5max_xEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>How far right does the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> extend. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF18EllipticalGaussian5min_yEv">
<span id="PSF::EllipticalGaussian::min_yC"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a27159ebc355443af70af64f20a19da9d"></span>double <code class="descname">min_y</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF18EllipticalGaussian5min_yEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>How far down does the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> extend. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF18EllipticalGaussian5max_yEv">
<span id="PSF::EllipticalGaussian::max_yC"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a9412f4bb89f6e31be4e79903c023854d"></span>double <code class="descname">max_y</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF18EllipticalGaussian5max_yEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>How far up does the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> extend. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF18EllipticalGaussianD0Ev">
<span id="PSF::EllipticalGaussian::~EllipticalGaussian"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a948691d5508a2f9697253a5f64d059c0"></span><em class="property">virtual</em> <code class="descname">~EllipticalGaussian</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF18EllipticalGaussianD0Ev" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Virtual destructor since virtual functions present. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Static Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF18EllipticalGaussian21set_default_precisionEdd">
<span id="PSF::EllipticalGaussian::set_default_precision__double.double"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1aaca72d8a259b80af5777c4bb36d5a950"></span><em class="property">static</em> void <code class="descname">set_default_precision</code><span class="sig-paren">(</span>double <em>relative</em>, double <em>absolute</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF18EllipticalGaussian21set_default_precisionEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Change the default precision requirements. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF18EllipticalGaussian24set_default_max_exp_coefEd">
<span id="PSF::EllipticalGaussian::set_default_max_exp_coef__double"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a85d038edab6198405fffc49adc83c290"></span><em class="property">static</em> void <code class="descname">set_default_max_exp_coef</code><span class="sig-paren">(</span>double <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF18EllipticalGaussian24set_default_max_exp_coefEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Change the default max exponent arguments allowed during calculations. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Protected Functions</p>
<dl class="function">
<dt id="_CPPv2NK3PSF18EllipticalGaussian19integrate_rectangleEdddd">
<span id="PSF::EllipticalGaussian::integrate_rectangle__double.double.double.doubleC"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a17d72fd1402db4f1ede1464095c1e798"></span>double <code class="descname">integrate_rectangle</code><span class="sig-paren">(</span>double <em>center_x</em>, double <em>center_y</em>, double <em>dx</em>, double <em>dy</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF18EllipticalGaussian19integrate_rectangleEdddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculates the integral of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> over a rectangle. </p>
<p>Using the local polynomial approximation around the center of the rectangle. The value of the integral is refined by icreasing the expansion order. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF18EllipticalGaussian15integrate_wedgeEdddbb">
<span id="PSF::EllipticalGaussian::integrate_wedge__double.double.double.b.bC"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1abfed5d0522cd3aaf0b7f96bb9727e95b"></span>double <code class="descname">integrate_wedge</code><span class="sig-paren">(</span>double <em>x_min</em>, double <em>y_min</em>, double <em>radius</em>, bool <em>left</em> = false, bool <em>bottom</em> = false<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF18EllipticalGaussian15integrate_wedgeEdddbb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Integrates the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> over a circle wedge.</p>
<p>The wedge is defined by the following boundaries:<ul class="simple">
<li>the line x=x</li>
<li>the line y=y</li>
<li>the circle centered at (0, 0) with a radius=radius If x is 0 the the left vs right wedge is chosen according to left Same for y0 and bottom.</li>
</ul>
</p>
<p>The value of the integral is refined by increasing the expansion order, rather than by subdivisions. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2NK3PSF18EllipticalGaussian12exp_argumentEdd">
<span id="PSF::EllipticalGaussian::exp_argument__double.doubleC"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a85203631651d86b24dcdb1931a1f4fa8"></span>double <code class="descname">exp_argument</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF18EllipticalGaussian12exp_argumentEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the argument inside the exponent of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a>. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF18EllipticalGaussian13update_valuesEv">
<span id="PSF::EllipticalGaussian::update_valuesC"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1ad6091b04b5075ff237ab6bbe84193a6a"></span>void <code class="descname">update_values</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF18EllipticalGaussian13update_valuesEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Updates __integral_values and __integral_error according to the latest state of __pieces. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF18EllipticalGaussian6refineEv">
<span id="PSF::EllipticalGaussian::refineC"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a20c4f3fd5fcc986b6b5a5ecbe6816603"></span>void <code class="descname">refine</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF18EllipticalGaussian6refineEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Increments one of I,J,K,L,M (see <a class="reference external" href="SubPixPhot.pdf">description</a>) by 1 for a single integration piece. </p>
<p>Updates the approximations (of the integral and its derivatives) and errors. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF18EllipticalGaussian8find_maxEdddd">
<span id="PSF::EllipticalGaussian::find_max__double.double.double.doubleC"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1aa2f8db8325ce04bfd71ff4ffaec3fcd3"></span>double <code class="descname">find_max</code><span class="sig-paren">(</span>double <em>x1</em>, double <em>y1</em>, double <em>x2</em>, double <em>y2</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF18EllipticalGaussian8find_maxEdddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the maximum value the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> minus background takes over a rectangle. </p>
<p>The rectangle is between x1 and x2 in the horizontal direction and between y1 and y2 in the vertical. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF18EllipticalGaussian8find_minEdddd">
<span id="PSF::EllipticalGaussian::find_min__double.double.double.doubleC"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a6ce7e326ff2d3e8191a2d97e41dd51eb"></span>double <code class="descname">find_min</code><span class="sig-paren">(</span>double <em>x1</em>, double <em>y1</em>, double <em>x2</em>, double <em>y2</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF18EllipticalGaussian8find_minEdddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the minimum value the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> minus background takes over a rectangle. </p>
<p>The rectangle is between x1 and x2 in the horizontal direction and between y1 and y2 in the vertical. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N3PSF18EllipticalGaussian5__spdE">
<span id="PSF::EllipticalGaussian::__spd__double"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1ab949b70956726fe5bb5daa5b2350ca3c"></span>double <code class="descname">__spd</code><a class="headerlink" href="#_CPPv2N3PSF18EllipticalGaussian5__spdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>S+D. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF18EllipticalGaussian5__smdE">
<span id="PSF::EllipticalGaussian::__smd__double"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a380d6d6e470642d507f2b6b95a47d355"></span>double <code class="descname">__smd</code><a class="headerlink" href="#_CPPv2N3PSF18EllipticalGaussian5__smdE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>S-D. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF18EllipticalGaussian3__kE">
<span id="PSF::EllipticalGaussian::__k__double"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1ad45cee5211e8cc76a33e9a4585fe2e84"></span>double <code class="descname">__k</code><a class="headerlink" href="#_CPPv2N3PSF18EllipticalGaussian3__kE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>K. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF18EllipticalGaussian4__bgE">
<span id="PSF::EllipticalGaussian::__bg__double"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a2826f108ccc86c3c52004c4c1617a3d0"></span>double <code class="descname">__bg</code><a class="headerlink" href="#_CPPv2N3PSF18EllipticalGaussian4__bgE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>background (divided by the actual amplitude). </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF18EllipticalGaussian14__max_exp_coefE">
<span id="PSF::EllipticalGaussian::__max_exp_coef__double"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1ab139a7a3baebeb590524c841508c2604"></span>double <code class="descname">__max_exp_coef</code><a class="headerlink" href="#_CPPv2N3PSF18EllipticalGaussian14__max_exp_coefE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The maximum value individual exponent arguments are allowed to take. </p>
<p>Higher values result in faster calculation of integrals, but worse precision. Should always be of order unity. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF18EllipticalGaussian15__abs_precisionE">
<span id="PSF::EllipticalGaussian::__abs_precision__double"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1aee368ec193489d1f1b77404e25b54f0a"></span>double <code class="descname">__abs_precision</code><a class="headerlink" href="#_CPPv2N3PSF18EllipticalGaussian15__abs_precisionE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The absolute precision required. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF18EllipticalGaussian15__rel_precisionE">
<span id="PSF::EllipticalGaussian::__rel_precision__double"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a52eb5cd0b8d07c2a128ac167bec7a6eb"></span>double <code class="descname">__rel_precision</code><a class="headerlink" href="#_CPPv2N3PSF18EllipticalGaussian15__rel_precisionE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The relative precision required. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF18EllipticalGaussian16__integral_errorE">
<span id="PSF::EllipticalGaussian::__integral_error__double"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1ac149abb091765e32797cf8edcf097ffd"></span>double <code class="descname">__integral_error</code><a class="headerlink" href="#_CPPv2N3PSF18EllipticalGaussian16__integral_errorE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The tightest upper limit to the error in the integral estimation. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF18EllipticalGaussian8__piecesE">
<span id="PSF::EllipticalGaussian::__pieces__std::vector:EllipticalGaussianIntegralByOrderP:"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1acda6c643c63e3ff5bf15f45ac1bb4f52"></span>std::vector&lt;<a class="reference internal" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrderE" title="PSF::EllipticalGaussianIntegralByOrder">EllipticalGaussianIntegralByOrder</a> *&gt; <code class="descname">__pieces</code><a class="headerlink" href="#_CPPv2N3PSF18EllipticalGaussian8__piecesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The integrals over individiual pieces of the integration area. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF18EllipticalGaussian17__integral_valuesE">
<span id="PSF::EllipticalGaussian::__integral_values__std::valarray:double:"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1abb2a2c612f4f19a4f3023bb6d9313d7d"></span>std::valarray&lt;double&gt; <code class="descname">__integral_values</code><a class="headerlink" href="#_CPPv2N3PSF18EllipticalGaussian17__integral_valuesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The current best estimate for the integral and its S,D,K derivatives. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF18EllipticalGaussian13__first_derivE">
<span id="PSF::EllipticalGaussian::__first_deriv__b"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a64b6d794a3c090350d921ddf9951b2d6"></span>bool <code class="descname">__first_deriv</code><a class="headerlink" href="#_CPPv2N3PSF18EllipticalGaussian13__first_derivE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Whether to calculate first order derivatives of integrals. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF18EllipticalGaussian14__second_derivE">
<span id="PSF::EllipticalGaussian::__second_deriv__b"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a042a3112118ce660fff2a4b52dbad884"></span>bool <code class="descname">__second_deriv</code><a class="headerlink" href="#_CPPv2N3PSF18EllipticalGaussian14__second_derivE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Whether to calculate second order derivatives of integrals. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Static Attributes</p>
<dl class="member">
<dt id="_CPPv2N3PSF18EllipticalGaussian23__default_abs_precisionE">
<span id="PSF::EllipticalGaussian::__default_abs_precision__double"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a6e99dceb2b5d56ef230ff6b3340eff06"></span>double <code class="descname">__default_abs_precision</code> =0<a class="headerlink" href="#_CPPv2N3PSF18EllipticalGaussian23__default_abs_precisionE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Default for __abs_precision. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF18EllipticalGaussian23__default_rel_precisionE">
<span id="PSF::EllipticalGaussian::__default_rel_precision__double"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a17256e93afd4f931415b1db1f4198517"></span>double <code class="descname">__default_rel_precision</code> =1e-5<a class="headerlink" href="#_CPPv2N3PSF18EllipticalGaussian23__default_rel_precisionE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Default for __rel_precision. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF18EllipticalGaussian22__default_max_exp_coefE">
<span id="PSF::EllipticalGaussian::__default_max_exp_coef__double"></span><span class="target" id="classPSF_1_1EllipticalGaussian_1a6f480425736ad6d84c7bce710e3db4fa"></span>double <code class="descname">__default_max_exp_coef</code> =1<a class="headerlink" href="#_CPPv2N3PSF18EllipticalGaussian22__default_max_exp_coefE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Default for __max_exp_coef. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrderE">
<span id="PSF::EllipticalGaussianIntegralByOrder"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder"></span><em class="property">class </em><code class="descname">EllipticalGaussianIntegralByOrder</code><a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrderE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;EllipticalGaussianIntegralByOrder.h&gt;</em><p>Elliptical gaussian integrals refined by incrementing the expansion order. </p>
<p>The area over which integrals are being calculated is assumed to be small enough for the error bounds in the a href=&#8221;SubPixPhot.pdf&#8221;&gt;description to apply. </p>
<p>Subclassed by <a class="reference internal" href="#classPSF_1_1EllipticalGaussianIntegralRectangle"><span class="std std-ref">PSF::EllipticalGaussianIntegralRectangle</span></a>, <a class="reference internal" href="#classPSF_1_1EllipticalGaussianIntegralWedge"><span class="std std-ref">PSF::EllipticalGaussianIntegralWedge</span></a></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrder33EllipticalGaussianIntegralByOrderEbb">
<span id="PSF::EllipticalGaussianIntegralByOrder::EllipticalGaussianIntegralByOrder__b.b"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1a82ef359a1049b58df483d4c51e1aa351"></span><code class="descname">EllipticalGaussianIntegralByOrder</code><span class="sig-paren">(</span>bool <em>calculate_first_deriv</em> = false, bool <em>calculate_second_deriv</em> = false<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrder33EllipticalGaussianIntegralByOrderEbb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Default constructor, set_parameters must be called before first use. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrder14set_parametersEdddddddd">
<span id="PSF::EllipticalGaussianIntegralByOrder::set_parameters__double.double.double.double.double.double.double.double"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1adfb40782e1021cce7fe482e7e22b0a09"></span>void <code class="descname">set_parameters</code><span class="sig-paren">(</span>double <em>spd</em>, double <em>smd</em>, double <em>k</em>, double <em>x0</em>, double <em>y0</em>, double <em>dx</em>, double <em>dy</em>, double <em>bg_area</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrder14set_parametersEdddddddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Sets the parameters of the integral to calculate. </p>
<p>The protected member __psf_area must already conain the value of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> at the point arounf which the expansion is performed times the area being integrated. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrder6refineEv">
<span id="PSF::EllipticalGaussianIntegralByOrder::refine"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1a078d64abe7348cc7a0f374d42b6c9f88"></span>double <code class="descname">refine</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrder6refineEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Increments one of I,J,K,L,M (see <a class="reference external" href="SubPixPhot.pdf">description</a>) by 1. </p>
<p>Updates the approximations (of the integral and its derivatives) and errors, returning the new best estimate value of the integral. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF33EllipticalGaussianIntegralByOrder5valueE13SDKDerivative">
<span id="PSF::EllipticalGaussianIntegralByOrder::value__SDKDerivativeC"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1a622e7a0e6edfb9a81cd5c1eaf340a332"></span>double <code class="descname">value</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N3PSF13SDKDerivativeE" title="PSF::SDKDerivative">SDKDerivative</a> <em>deriv</em> = NO_DERIV<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF33EllipticalGaussianIntegralByOrder5valueE13SDKDerivative" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the best estimate for the value of the integral or a derivative. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF33EllipticalGaussianIntegralByOrder9max_errorEv">
<span id="PSF::EllipticalGaussianIntegralByOrder::max_errorC"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1ab4b388acb4c8ec2de12f3882c8ea59a4"></span>double <code class="descname">max_error</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF33EllipticalGaussianIntegralByOrder9max_errorEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns a strict upper limit to the error in the integral (or a derivative). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF33EllipticalGaussianIntegralByOrder6ordersEv">
<span id="PSF::EllipticalGaussianIntegralByOrder::ordersC"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1a4ec2e6767918af755ced2af88d53a618"></span><em class="property">const</em> std::valarray&lt;unsigned&gt; &amp;<code class="descname">orders</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF33EllipticalGaussianIntegralByOrder6ordersEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the orders to which the various sums have been approximated. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrderD0Ev">
<span id="PSF::EllipticalGaussianIntegralByOrder::~EllipticalGaussianIntegralByOrder"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1a79ce5d2e2ddfa581a3792ba36499a9c9"></span><em class="property">virtual</em> <code class="descname">~EllipticalGaussianIntegralByOrder</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrderD0Ev" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Protected Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrder14fill_new_termsEKdjjjjjRNSt8valarrayIdEE">
<span id="PSF::EllipticalGaussianIntegralByOrder::fill_new_terms__doubleC.unsigned.unsigned.unsigned.unsigned.unsigned.std::valarray:double:R"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1abecfd9659bec9db962c945d80f5169bf"></span>void <code class="descname">fill_new_terms</code><span class="sig-paren">(</span><em class="property">const</em> double <em>to_add</em>, unsigned <em>i</em>, unsigned <em>j</em>, unsigned <em>k</em>, unsigned <em>l</em>, unsigned <em>m</em>, std::valarray&lt;double&gt; &amp;<em>new_terms</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrder14fill_new_termsEKdjjjjjRNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Adds what needs to be added to the integral and derivatives if to_add is being added to the integral. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">to_add</span></code>: The value being added to the estimate of the integral. </li>
<li><code class="docutils literal"><span class="pre">i</span></code>: The (2,0) index of the new term being added. </li>
<li><code class="docutils literal"><span class="pre">j</span></code>: The (1,1) index of the new term being added. </li>
<li><code class="docutils literal"><span class="pre">k</span></code>: The (0,2) index of the new term being added. </li>
<li><code class="docutils literal"><span class="pre">l</span></code>: The (1,0) index of the new term being added. </li>
<li><code class="docutils literal"><span class="pre">m</span></code>: The (0,1) index of the new term being added. </li>
<li><code class="docutils literal"><span class="pre">new_terms</span></code>: The updates to the values of the integral and derivatives, indexed by SDKDerivative. </li>
</ul>
</dd>
</dl>
</p>
<p>Regardless of the region being integrated, updates to the derivatives depend only on the update to the value of the integral. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrder15calculate_errorEv">
<span id="PSF::EllipticalGaussianIntegralByOrder::calculate_error"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1aec295d973192d88f65df6e395b59fb10"></span>double <code class="descname">calculate_error</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrder15calculate_errorEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>An upper limit to the error in the current integral estimate. </p>
<p>Assumes that all members are consistently initialized, sets the value of __error and returns the tightest error bound. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrder16update_estimatesEj">
<span id="PSF::EllipticalGaussianIntegralByOrder::update_estimates__unsigned"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1a3d4ad2d49f7316dbe37abcd50148df25"></span><em class="property">virtual</em> void <code class="descname">update_estimates</code><span class="sig-paren">(</span>unsigned <em>index</em><span class="sig-paren">)</span> = 0<a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrder16update_estimatesEj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Use one order higher in the given index estimates of the integral and any derivatives. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrder12refine_indexEv">
<span id="PSF::EllipticalGaussianIntegralByOrder::refine_index"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1ac87e13639db535bb3b896f6b790bc054"></span>unsigned <code class="descname">refine_index</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrder12refine_indexEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the index of the best term to refine. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrder10next_orderEj">
<span id="PSF::EllipticalGaussianIntegralByOrder::next_order__unsigned"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1a30c7fbd111b154d70f2ab5391773934c"></span>void <code class="descname">next_order</code><span class="sig-paren">(</span>unsigned <em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrder10next_orderEj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Increment the order of the index-th term by 1 updating all members. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Protected Attributes</p>
<dl class="member">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrder10__psf_areaE">
<span id="PSF::EllipticalGaussianIntegralByOrder::__psf_area__double"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1a4c33caade90843a5e8d184f38b14efc3"></span>double <code class="descname">__psf_area</code><a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrder10__psf_areaE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The PSF at the center of the rectangle times the area of the rectangle. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrder4__x0E">
<span id="PSF::EllipticalGaussianIntegralByOrder::__x0__double"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1af9b8ecc301949d496f1e61f19419d300"></span>double <code class="descname">__x0</code><a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrder4__x0E" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The x offset of the point around which the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> is. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrder4__y0E">
<span id="PSF::EllipticalGaussianIntegralByOrder::__y0__double"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1ade8981af1dcfe24d5b85a69fc8c5b01f"></span>double <code class="descname">__y0</code><a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrder4__y0E" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The y offset of the point around which the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> is. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrder7__valueE">
<span id="PSF::EllipticalGaussianIntegralByOrder::__value__std::valarray:double:"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1a85a41710a94eb4a16624ff11cd51a06a"></span>std::valarray&lt;double&gt; <code class="descname">__value</code><a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrder7__valueE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The values of the integral and its up to second S, D, K derivatives. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrder8__ordersE">
<span id="PSF::EllipticalGaussianIntegralByOrder::__orders__std::valarray:unsigned:"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1ab6bc5d168e7b5814cdd03ffa04cb8b62"></span>std::valarray&lt;unsigned&gt; <code class="descname">__orders</code><a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrder8__ordersE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The orders up to which the terms of equations (59)-(63) are estiamted. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrder13__first_derivE">
<span id="PSF::EllipticalGaussianIntegralByOrder::__first_deriv__b"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1a06d5a409739aa2d205792dae0e324591"></span>bool <code class="descname">__first_deriv</code><a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrder13__first_derivE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate first order S,D,K derivatives? </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrder14__second_derivE">
<span id="PSF::EllipticalGaussianIntegralByOrder::__second_deriv__b"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1a95455bdbd64654dca612105fb4413666"></span>bool <code class="descname">__second_deriv</code><a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrder14__second_derivE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate 2nd order S,D,K derivatives? </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrder6__coefE">
<span id="PSF::EllipticalGaussianIntegralByOrder::__coef__std::valarray:double:"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1a8f6739fa41d18cc07cc3eef4f8e8c38b"></span>std::valarray&lt;double&gt; <code class="descname">__coef</code><a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrder6__coefE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><span class="math">\( C_{20}/2 \)</span>, <span class="math">\( C_{11}/2 \)</span>, <span class="math">\( C_{02}/2 \)</span>, <span class="math">\( C_{10}/2 \)</span>, <span class="math">\( C_{01}/2 \)</span> </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrder9__factorsE">
<span id="PSF::EllipticalGaussianIntegralByOrder::__factors__std::valarray:double:"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1aad48afd0ea1f6a73784f4dc22868f8bb"></span>std::valarray&lt;double&gt; <code class="descname">__factors</code><a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrder9__factorsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The argument of the exponent of each term of eq 45. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrder11__last_termE">
<span id="PSF::EllipticalGaussianIntegralByOrder::__last_term__std::valarray:double:"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1ae0944288fa55a7f8650b3b966c7c9ddc"></span>std::valarray&lt;double&gt; <code class="descname">__last_term</code><a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrder11__last_termE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The last term of each sum. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrder7__errorE">
<span id="PSF::EllipticalGaussianIntegralByOrder::__error__double"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1a59b642bd9bbaf318bc38963a4e1338b8"></span>double <code class="descname">__error</code><a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrder7__errorE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The tightest upper limit to the error in the integral estimate. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrder5__sumE">
<span id="PSF::EllipticalGaussianIntegralByOrder::__sum__std::valarray:double:"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1a31abe99ff5bb15b5467c856f85417b8c"></span>std::valarray&lt;double&gt; <code class="descname">__sum</code><a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrder5__sumE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The current S values from the description. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF33EllipticalGaussianIntegralByOrder7__deltaE">
<span id="PSF::EllipticalGaussianIntegralByOrder::__delta__std::valarray:double:"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralByOrder_1a3b44c25231ac85433f579e7da0f8dce4"></span>std::valarray&lt;double&gt; <code class="descname">__delta</code><a class="headerlink" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrder7__deltaE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The current upper limits on the values of the delta quantities. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N3PSF35EllipticalGaussianIntegralRectangleE">
<span id="PSF::EllipticalGaussianIntegralRectangle"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralRectangle"></span><em class="property">class </em><code class="descname">EllipticalGaussianIntegralRectangle</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrderE" title="PSF::EllipticalGaussianIntegralByOrder">EllipticalGaussianIntegralByOrder</a><a class="headerlink" href="#_CPPv2N3PSF35EllipticalGaussianIntegralRectangleE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;EllipticalGaussianIntegralRectangle.h&gt;</em><p>Calculates integrals of an elliptical gaussion over a rectangle. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF35EllipticalGaussianIntegralRectangle35EllipticalGaussianIntegralRectangleEdddddddbbd">
<span id="PSF::EllipticalGaussianIntegralRectangle::EllipticalGaussianIntegralRectangle__double.double.double.double.double.double.double.b.b.double"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralRectangle_1a0a21c76809bb486517c2a08a0f6bccc6"></span><code class="descname">EllipticalGaussianIntegralRectangle</code><span class="sig-paren">(</span>double <em>spd</em>, double <em>smd</em>, double <em>k</em>, double <em>x0</em>, double <em>y0</em>, double <em>dx</em>, double <em>dy</em>, bool <em>calculate_first_deriv</em> = false, bool <em>calculate_second_deriv</em> = false, double <em>background</em> = 0<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF35EllipticalGaussianIntegralRectangle35EllipticalGaussianIntegralRectangleEdddddddbbd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create an integral with the given S+D, S-D and K over a rectangle. </p>
<p>The rectangle to integrate over is given by x0-dx &lt; x &lt; x0+dx, y0-dy &lt; y &lt; y0+dy. Optionally the first (if calculate_first_deriv is true) and second (if calculate_second_deriv is true) derivatives of the integral are also calculated. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Protected Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF35EllipticalGaussianIntegralRectangle16update_estimatesEj">
<span id="PSF::EllipticalGaussianIntegralRectangle::update_estimates__unsigned"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralRectangle_1a381e619fddb14b2ef4a62c8fd4f30f07"></span>void <code class="descname">update_estimates</code><span class="sig-paren">(</span>unsigned <em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF35EllipticalGaussianIntegralRectangle16update_estimatesEj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Use one order higher in the given index estimates of the integral and any derivatives. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N3PSF31EllipticalGaussianIntegralWedgeE">
<span id="PSF::EllipticalGaussianIntegralWedge"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralWedge"></span><em class="property">class </em><code class="descname">EllipticalGaussianIntegralWedge</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF33EllipticalGaussianIntegralByOrderE" title="PSF::EllipticalGaussianIntegralByOrder">EllipticalGaussianIntegralByOrder</a><a class="headerlink" href="#_CPPv2N3PSF31EllipticalGaussianIntegralWedgeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;EllipticalGaussianIntegralWedge.h&gt;</em><p>Calculates integrals of an elliptical gaussion over a wedge of a circle. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF31EllipticalGaussianIntegralWedge31EllipticalGaussianIntegralWedgeEddddddbbd">
<span id="PSF::EllipticalGaussianIntegralWedge::EllipticalGaussianIntegralWedge__double.double.double.double.double.double.b.b.double"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralWedge_1a9ffd58117420cae5b754879e4143df5b"></span><code class="descname">EllipticalGaussianIntegralWedge</code><span class="sig-paren">(</span>double <em>spd</em>, double <em>smd</em>, double <em>k</em>, double <em>x0</em>, double <em>y0</em>, double <em>r</em>, bool <em>calculate_first_deriv</em> = false, bool <em>calculate_second_deriv</em> = false, double <em>background</em> = 0<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF31EllipticalGaussianIntegralWedge31EllipticalGaussianIntegralWedgeEddddddbbd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Construct a wedge integral for a <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> with the given parameters. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">spd</span></code>: S+D </li>
<li><code class="docutils literal"><span class="pre">smd</span></code>: S-D </li>
<li><code class="docutils literal"><span class="pre">k</span></code>: K </li>
<li><code class="docutils literal"><span class="pre">x0</span></code>: The x coordinate of the midpoint of the wedge chord relative to the circle center. </li>
<li><code class="docutils literal"><span class="pre">y0</span></code>: The y coordinate of the midpoint of the wedge chord relative to the circle center. </li>
<li><code class="docutils literal"><span class="pre">r</span></code>: Radius of the circle </li>
<li><code class="docutils literal"><span class="pre">calculate_first_deriv</span></code>: Should first order derivatives be calculated? </li>
<li><code class="docutils literal"><span class="pre">calculate_second_deriv</span></code>: Should second order derivatives be calculated? </li>
<li><code class="docutils literal"><span class="pre">background</span></code>: The background under the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a>. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Protected Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF31EllipticalGaussianIntegralWedge16update_estimatesEj">
<span id="PSF::EllipticalGaussianIntegralWedge::update_estimates__unsigned"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralWedge_1ac812ce3954a39ba01143ee0e8593bb6a"></span>void <code class="descname">update_estimates</code><span class="sig-paren">(</span>unsigned <em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF31EllipticalGaussianIntegralWedge16update_estimatesEj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Use one order higher in the given index estimates of the integral and any derivatives. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N3PSF31EllipticalGaussianIntegralWedge15__center_psf_r2E">
<span id="PSF::EllipticalGaussianIntegralWedge::__center_psf_r2__double"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralWedge_1aca0201eaa647b17448fa2ee5683b3227"></span>double <code class="descname">__center_psf_r2</code><a class="headerlink" href="#_CPPv2N3PSF31EllipticalGaussianIntegralWedge15__center_psf_r2E" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The value of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> at the midpoint of the wedge chord. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF31EllipticalGaussianIntegralWedge12__wedge_coefE">
<span id="PSF::EllipticalGaussianIntegralWedge::__wedge_coef__std::valarray:double:"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralWedge_1a1e897f9afbe9a0b3b0412d0d09b040cc"></span>std::valarray&lt;double&gt; <code class="descname">__wedge_coef</code><a class="headerlink" href="#_CPPv2N3PSF31EllipticalGaussianIntegralWedge12__wedge_coefE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><span class="math">\( C_{20}r^2/2 \)</span>, <span class="math">\( C_{11}r^2/2 \)</span>, <span class="math">\( C_{02}r^2/2 \)</span>, <span class="math">\( C_{10}r/2 \)</span>, <span class="math">\( C_{01}r/2 \)</span> </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF31EllipticalGaussianIntegralWedge10__integralE">
<span id="PSF::EllipticalGaussianIntegralWedge::__integral__WedgeIntegral"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralWedge_1a513a863277cab1a2f499962106656d83"></span><a class="reference internal" href="#_CPPv2N3PSF13WedgeIntegralE" title="PSF::WedgeIntegral">WedgeIntegral</a> <code class="descname">__integral</code><a class="headerlink" href="#_CPPv2N3PSF31EllipticalGaussianIntegralWedge10__integralE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The integral being refined until the desired precision is achieved. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF31EllipticalGaussianIntegralWedge13__multipliersE">
<span id="PSF::EllipticalGaussianIntegralWedge::__multipliers__std::vector:std::vector:double::"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralWedge_1a0480d3c659f362e943594673db078f80"></span>std::vector&lt;std::vector&lt;double&gt;&gt; <code class="descname">__multipliers</code><a class="headerlink" href="#_CPPv2N3PSF31EllipticalGaussianIntegralWedge13__multipliersE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The i,j-th element is (-__coef[i])^j/j! </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Static Attributes</p>
<dl class="member">
<dt id="_CPPv2N3PSF31EllipticalGaussianIntegralWedge17__initial_storageE">
<span id="PSF::EllipticalGaussianIntegralWedge::__initial_storage__Core::vector_size_typeC"></span><span class="target" id="classPSF_1_1EllipticalGaussianIntegralWedge_1a7afc41977e9f1c93a99ac8a175a7c1af"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <code class="descname">__initial_storage</code> =100<a class="headerlink" href="#_CPPv2N3PSF31EllipticalGaussianIntegralWedge17__initial_storageE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Initial storage to reserve for storing quantities required multiple times. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N3PSF21EllipticalGaussianMapE">
<span id="PSF::EllipticalGaussianMap"></span><span class="target" id="classPSF_1_1EllipticalGaussianMap"></span><em class="property">class </em><code class="descname">EllipticalGaussianMap</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF3MapE" title="PSF::Map">Map</a><a class="headerlink" href="#_CPPv2N3PSF21EllipticalGaussianMapE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;EllipticalGaussianMap.h&gt;</em><p>Smoothly varying over the image elliptical Gaussian <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a>. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF21EllipticalGaussianMap21EllipticalGaussianMapERKN2IO12H5IODataTreeE">
<span id="PSF::EllipticalGaussianMap::EllipticalGaussianMap__IO::H5IODataTreeCR"></span><span class="target" id="classPSF_1_1EllipticalGaussianMap_1a5f47ffdcf0e2c751aac16a5edf9a2886"></span><code class="descname">EllipticalGaussianMap</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF21EllipticalGaussianMap21EllipticalGaussianMapERKN2IO12H5IODataTreeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Construct a map from the given data tree. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">data</span></code>: The I/O data tree to construct the map from. It should contain at least the quantities identified by <a class="reference internal" href="#classPSF_1_1EllipticalGaussianMap_1aad07aeb314393f38fbf75ca680c6b814"><span class="std std-ref">EllipticalGaussianMap::required_data_tree_quantities()</span></a>. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF21EllipticalGaussianMap7get_psfERKN5Eigen8VectorXdEd">
<span id="PSF::EllipticalGaussianMap::get_psf__Eigen::VectorXdCR.doubleC"></span><span class="target" id="classPSF_1_1EllipticalGaussianMap_1abf2f3a06dd5d75bedb86bede80aef380"></span><a class="reference internal" href="#_CPPv2N3PSF18EllipticalGaussianE" title="PSF::EllipticalGaussian">EllipticalGaussian</a> *<code class="descname">get_psf</code><span class="sig-paren">(</span><em class="property">const</em> Eigen::VectorXd &amp;<em>terms</em>, double <em>background</em> = 0<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF21EllipticalGaussianMap7get_psfERKN5Eigen8VectorXdEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">terms</span></code>: The values of the terms on which the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> map depends. </li>
<li><code class="docutils literal"><span class="pre">background</span></code>: Background to add to the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> (assumed constant) normalized in the same way as the backgroundless PSFs produced by the map. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF21EllipticalGaussianMapclERKN5Eigen8VectorXdEd">
<span id="PSF::EllipticalGaussianMap::call-operator__Eigen::VectorXdCR.doubleC"></span><span class="target" id="classPSF_1_1EllipticalGaussianMap_1a8598560fe6135d20678858ab8198d0d9"></span><a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a> *<code class="descname">operator()</code><span class="sig-paren">(</span><em class="property">const</em> Eigen::VectorXd &amp;<em>terms</em>, double <em>background</em> = 0<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF21EllipticalGaussianMapclERKN5Eigen8VectorXdEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A reference to a dynamically allocated <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a>. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">terms</span></code>: The values of the terms on which the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> map depends. </li>
<li><code class="docutils literal"><span class="pre">background</span></code>: Background to add to the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> (assumed constant) normalized in the same way as the backgroundless PSFs produced by the map. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Static Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF21EllipticalGaussianMap29required_data_tree_quantitiesEv">
<span id="PSF::EllipticalGaussianMap::required_data_tree_quantities"></span><span class="target" id="classPSF_1_1EllipticalGaussianMap_1aad07aeb314393f38fbf75ca680c6b814"></span><em class="property">const</em> std::set&lt;std::string&gt; &amp;<code class="descname">required_data_tree_quantities</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF21EllipticalGaussianMap29required_data_tree_quantitiesEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>All quantities needed to construct the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> map from an I/O data tree. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Types</p>
<dl class="type">
<dt id="_CPPv2N3PSF21EllipticalGaussianMap11RowMajorMapE">
<span id="PSF::EllipticalGaussianMap::RowMajorMap"></span><span class="target" id="classPSF_1_1EllipticalGaussianMap_1a310e651cd3407764cc199b7f8ec16ec1"></span><em class="property">typedef </em>Eigen::Map&lt;<em class="property">const</em> Eigen::Matrix&lt;double, Eigen::Dynamic, Eigen::Dynamic, Eigen::RowMajor&gt;&gt; <code class="descname">RowMajorMap</code><a class="headerlink" href="#_CPPv2N3PSF21EllipticalGaussianMap11RowMajorMapE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Simplify statements requiring this type. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N3PSF21EllipticalGaussianMap15__sdk_expansionE">
<span id="PSF::EllipticalGaussianMap::__sdk_expansion__Eigen::MatrixXd"></span><span class="target" id="classPSF_1_1EllipticalGaussianMap_1a5c7b072a17a2e9740a398c9597e9d5ce"></span>Eigen::MatrixXd <code class="descname">__sdk_expansion</code><a class="headerlink" href="#_CPPv2N3PSF21EllipticalGaussianMap15__sdk_expansionE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Apply to a vector of polynomial terms to get the values of the S, D and K parameters, in that order. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N3PSF4GridE">
<span id="PSF::Grid"></span><span class="target" id="classPSF_1_1Grid"></span><em class="property">class </em><code class="descname">Grid</code><a class="headerlink" href="#_CPPv2N3PSF4GridE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;Grid.h&gt;</em><p>The cell grid over which the PSF/PRF is defined. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF4Grid4GridEv">
<span id="PSF::Grid::Grid"></span><span class="target" id="classPSF_1_1Grid_1a906181524ce7ffcfd85f7c0e80cc08ac"></span><code class="descname">Grid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF4Grid4GridEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Default constructor (grid with no cells). </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="member">
<dt id="_CPPv2N3PSF4Grid6x_gridE">
<span id="PSF::Grid::x_grid__std::vector:double:"></span><span class="target" id="classPSF_1_1Grid_1ad7744e97989413fdae3f1fd5e774cd92"></span>std::vector&lt;double&gt; <code class="descname">x_grid</code><a class="headerlink" href="#_CPPv2N3PSF4Grid6x_gridE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The x boundaries between grid cells. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF4Grid6y_gridE">
<span id="PSF::Grid::y_grid__std::vector:double:"></span><span class="target" id="classPSF_1_1Grid_1a61c8336587514678daffc595e2224c30"></span>std::vector&lt;double&gt; <code class="descname">y_grid</code><a class="headerlink" href="#_CPPv2N3PSF4Grid6y_gridE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The y boundaries between grid cells. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N3PSF15LocalPolynomialE">
<span id="PSF::LocalPolynomial"></span><span class="target" id="classPSF_1_1LocalPolynomial"></span><em class="property">class </em><code class="descname">LocalPolynomial</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF3PSFE" title="PSF::PSF">PSF</a><a class="headerlink" href="#_CPPv2N3PSF15LocalPolynomialE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;LocalPolynomial.h&gt;</em><p>A base class for <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> models which are locally approximated by a polynomial of up to some degree defined at construction. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF15LocalPolynomial15LocalPolynomialEjj">
<span id="PSF::LocalPolynomial::LocalPolynomial__unsigned.unsigned"></span><span class="target" id="classPSF_1_1LocalPolynomial_1ad69256cd0b84cbd7c2a964d638702d77"></span><code class="descname">LocalPolynomial</code><span class="sig-paren">(</span>unsigned <em>max_poly_degree</em>, unsigned <em>min_poly_degree</em> = 0<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF15LocalPolynomial15LocalPolynomialEjj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a polynomial approximated <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> of up to the given degree. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF15LocalPolynomial9poly_coefEddjj">
<span id="PSF::LocalPolynomial::poly_coef__double.double.unsigned.unsignedC"></span><span class="target" id="classPSF_1_1LocalPolynomial_1a248c52a301363e02fda4efc2db9c6090"></span><em class="property">virtual</em> double <code class="descname">poly_coef</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em>, unsigned <em>x_power</em>, unsigned <em>y_power</em><span class="sig-paren">)</span> <em class="property">const</em> = 0<a class="headerlink" href="#_CPPv2NK3PSF15LocalPolynomial9poly_coefEddjj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The coefficient of the term in front of the x^x_power*y^y_power term in the local polynomial approximation of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> valid arount x, y </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF15LocalPolynomial16set_degree_rangeEjj">
<span id="PSF::LocalPolynomial::set_degree_range__unsigned.unsigned"></span><span class="target" id="classPSF_1_1LocalPolynomial_1a3d70d14fdd467ed7abc2c4e781f13076"></span><em class="property">virtual</em> void <code class="descname">set_degree_range</code><span class="sig-paren">(</span>unsigned <em>max_poly_degree</em>, unsigned <em>min_poly_degree</em> = 0<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF15LocalPolynomial16set_degree_rangeEjj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Changes the maximum degree of polynomial terms to the given value. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Protected Functions</p>
<dl class="function">
<dt id="_CPPv2NK3PSF15LocalPolynomial19integrate_rectangleEdddd">
<span id="PSF::LocalPolynomial::integrate_rectangle__double.double.double.doubleC"></span><span class="target" id="classPSF_1_1LocalPolynomial_1ab4c8d49c5c06027f28bf5a85c39b9f73"></span>double <code class="descname">integrate_rectangle</code><span class="sig-paren">(</span>double <em>center_x</em>, double <em>center_y</em>, double <em>dx</em>, double <em>dy</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF15LocalPolynomial19integrate_rectangleEdddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculates the integral of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> over a rectangle. </p>
<p>Using the local polynomial approximation around the center of the rectangle. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF15LocalPolynomial15integrate_wedgeEdddbb">
<span id="PSF::LocalPolynomial::integrate_wedge__double.double.double.b.bC"></span><span class="target" id="classPSF_1_1LocalPolynomial_1af2539182384bedadc2149165032e843f"></span>double <code class="descname">integrate_wedge</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em>, double <em>radius</em>, bool <em>left</em> = false, bool <em>bottom</em> = false<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF15LocalPolynomial15integrate_wedgeEdddbb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Integrates the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> a wedge of a circle. </p>
<p>The wedge is defined by the following boundaries:<ul class="simple">
<li>the line x=x</li>
<li>the line y=y</li>
<li>the circle centered at (0, 0) with a radius=radius If x is 0 the the left vs right wedge is chosen according to left Same for y0 and bottom. </li>
</ul>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N3PSF15LocalPolynomial17__min_poly_degreeE">
<span id="PSF::LocalPolynomial::__min_poly_degree__unsigned"></span><span class="target" id="classPSF_1_1LocalPolynomial_1abc3e956ca360bded2a265beac52dad25"></span>unsigned <code class="descname">__min_poly_degree</code><a class="headerlink" href="#_CPPv2N3PSF15LocalPolynomial17__min_poly_degreeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The minimum order of polynomial coefficients to consider. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF15LocalPolynomial17__max_poly_degreeE">
<span id="PSF::LocalPolynomial::__max_poly_degree__unsigned"></span><span class="target" id="classPSF_1_1LocalPolynomial_1a1ca228ec620ca404c8d22a2bdfe96cac"></span>unsigned <code class="descname">__max_poly_degree</code><a class="headerlink" href="#_CPPv2N3PSF15LocalPolynomial17__max_poly_degreeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The maximum order of polynomial coefficients to consider. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N3PSF3MapE">
<span id="PSF::Map"></span><span class="target" id="classPSF_1_1Map"></span><em class="property">class </em><code class="descname">Map</code><a class="headerlink" href="#_CPPv2N3PSF3MapE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;Map.h&gt;</em><p>Interface for working with smooth dependenc of PSF/PRF on source parameters. </p>
<p>Subclassed by <a class="reference internal" href="#classPSF_1_1EllipticalGaussianMap"><span class="std std-ref">PSF::EllipticalGaussianMap</span></a>, <a class="reference internal" href="#classPSF_1_1PiecewiseBicubicMap"><span class="std std-ref">PSF::PiecewiseBicubicMap</span></a></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF3Map3MapEj">
<span id="PSF::Map::Map__unsigned"></span><span class="target" id="classPSF_1_1Map_1a938749dcb6ff5b2bd58c7f9eaf02bdf1"></span><code class="descname">Map</code><span class="sig-paren">(</span>unsigned <em>num_terms</em> = 0<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF3Map3MapEj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a map with the given number of terms. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF3MapD0Ev">
<span id="PSF::Map::~Map"></span><span class="target" id="classPSF_1_1Map_1a4abc766db9f5b0299530e09cf05ed6d7"></span><em class="property">virtual</em> <code class="descname">~Map</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF3MapD0Ev" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF3Map9num_termsEv">
<span id="PSF::Map::num_termsC"></span><span class="target" id="classPSF_1_1Map_1a207401cf3d28dd48e2969145f77be00c"></span><em class="property">virtual</em> unsigned <code class="descname">num_terms</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF3Map9num_termsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of terms that the map depends on. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF3Map13set_num_termsEj">
<span id="PSF::Map::set_num_terms__unsigned"></span><span class="target" id="classPSF_1_1Map_1ae81b0e961bd893c98525f925e20e6458"></span><em class="property">virtual</em> void <code class="descname">set_num_terms</code><span class="sig-paren">(</span>unsigned <em>nterms</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF3Map13set_num_termsEj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set the number of terms that the map depends on. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF3MapclERKN5Eigen8VectorXdEd">
<span id="PSF::Map::call-operator__Eigen::VectorXdCR.doubleC"></span><span class="target" id="classPSF_1_1Map_1a1d44fa5f78fbb55a93e66f69efb43077"></span><em class="property">virtual</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a> *<code class="descname">operator()</code><span class="sig-paren">(</span><em class="property">const</em> Eigen::VectorXd &amp;<em>terms</em>, double <em>background</em> = 0<span class="sig-paren">)</span> <em class="property">const</em> = 0<a class="headerlink" href="#_CPPv2NK3PSF3MapclERKN5Eigen8VectorXdEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A reference to a dynamically allocated <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a>. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">terms</span></code>: The values of the terms on which the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> map depends. </li>
<li><code class="docutils literal"><span class="pre">background</span></code>: Background to add to the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> (assumed constant). </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF3MapclERK9MapSourced">
<span id="PSF::Map::call-operator__MapSourceCR.doubleC"></span><span class="target" id="classPSF_1_1Map_1afb3b99185cc7f198bb481cfca35b40f8"></span><a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a> *<code class="descname">operator()</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N3PSF9MapSourceE" title="PSF::MapSource">MapSource</a> &amp;<em>source</em>, double <em>background</em> = 0<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF3MapclERK9MapSourced" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A reference to a dynamically allocated <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a>. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">source</span></code>: The source whose <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> we want. </li>
<li><code class="docutils literal"><span class="pre">background</span></code>: Background to add to the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> (assumed constant) normalized in the same way as the backgroundless PSFs produced by the map. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Static Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF3Map29required_data_tree_quantitiesEv">
<span id="PSF::Map::required_data_tree_quantities"></span><span class="target" id="classPSF_1_1Map_1a79360d359d9bf8fa22a7efe3130de179"></span><em class="property">const</em> std::set&lt;std::string&gt; &amp;<code class="descname">required_data_tree_quantities</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF3Map29required_data_tree_quantitiesEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>All quantities needed to construct the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> map from an I/O data tree. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N3PSF3Map11__num_termsE">
<span id="PSF::Map::__num_terms__unsigned"></span><span class="target" id="classPSF_1_1Map_1a309a2f621dba9ed19bb45a32458c510d"></span>unsigned <code class="descname">__num_terms</code><a class="headerlink" href="#_CPPv2N3PSF3Map11__num_termsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of terms that the map depends on. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N3PSF9MapSourceE">
<span id="PSF::MapSource"></span><span class="target" id="classPSF_1_1MapSource"></span><em class="property">class </em><code class="descname">MapSource</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core6SourceE" title="Core::Source">Source</a><a class="headerlink" href="#_CPPv2N3PSF9MapSourceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;MapSource.h&gt;</em><p>Class for evaluating a collection of smooth dependencies for a collection of sources. </p>
<p>Subclassed by <a class="reference internal" href="#classFitPSF_1_1Source"><span class="std std-ref">FitPSF::Source&lt; PSF_TYPE &gt;</span></a>, <a class="reference internal" href="#classFitPSF_1_1Source"><span class="std std-ref">FitPSF::Source&lt; PSF::EllipticalGaussian &gt;</span></a>, <a class="reference internal" href="#classFitPSF_1_1Source"><span class="std std-ref">FitPSF::Source&lt; PSF::PiecewiseBicubic &gt;</span></a></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF9MapSource9MapSourceERKN4Core8SourceIDEjddRKN10Background6SourceE">
<span id="PSF::MapSource::MapSource__Core::SourceIDCR.unsigned.double.double.Background::SourceCR"></span><span class="target" id="classPSF_1_1MapSource_1a6e9e77111915500cc7883acfe7c81489"></span><code class="descname">MapSource</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> &amp;<em>id</em>, unsigned <em>num_apertures</em>, double <em>x0</em>, double <em>y0</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> &amp;<em>background</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF9MapSource9MapSourceERKN4Core8SourceIDEjddRKN10Background6SourceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create the source with the given properties. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">id</span></code>: See Source::Source </li>
<li><code class="docutils literal"><span class="pre">num_apertures</span></code>: See Source::Source </li>
<li><code class="docutils literal"><span class="pre">x0</span></code>: See Source::Source </li>
<li><code class="docutils literal"><span class="pre">y0</span></code>: See Source::Source </li>
<li><code class="docutils literal"><span class="pre">background</span></code>: See Source::Source </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF9MapSource15expansion_termsEv">
<span id="PSF::MapSource::expansion_terms"></span><span class="target" id="classPSF_1_1MapSource_1aefb1847f93eb789d5bde3a5c64c9c352"></span>Eigen::VectorXd &amp;<code class="descname">expansion_terms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF9MapSource15expansion_termsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Modifiable reference to the terms <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> is a function of. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9MapSource15expansion_termsEv">
<span id="PSF::MapSource::expansion_termsC"></span><span class="target" id="classPSF_1_1MapSource_1a56e15794b186ac1d9bbb260cc039d581"></span><em class="property">const</em> Eigen::VectorXd &amp;<code class="descname">expansion_terms</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9MapSource15expansion_termsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constant reference to the terms <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> is a function of. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N3PSF9MapSource17__expansion_termsE">
<span id="PSF::MapSource::__expansion_terms__Eigen::VectorXd"></span><span class="target" id="classPSF_1_1MapSource_1abd5ae96b99d6580dc8bfe550c9c9e7da"></span>Eigen::VectorXd <code class="descname">__expansion_terms</code><a class="headerlink" href="#_CPPv2N3PSF9MapSource17__expansion_termsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The values of the terms participating in the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> map. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N3PSF18MapSourceContainerE">
<span id="PSF::MapSourceContainer"></span><span class="target" id="classPSF_1_1MapSourceContainer"></span><em class="property">class </em><code class="descname">MapSourceContainer</code> : <em class="property">public</em> std::vector&lt;<a class="reference internal" href="#_CPPv2N3PSF9MapSourceE" title="PSF::MapSource">MapSource</a>&gt;<a class="headerlink" href="#_CPPv2N3PSF18MapSourceContainerE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;MapSourceContainer.h&gt;</em><p>A container full of <a class="reference internal" href="#classPSF_1_1MapSource"><span class="std std-ref">MapSource</span></a> objects. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF18MapSourceContainer18MapSourceContainerEv">
<span id="PSF::MapSourceContainer::MapSourceContainer"></span><span class="target" id="classPSF_1_1MapSourceContainer_1a9c882e9dcf39c41d19cf1ef3e5175d2c"></span><code class="descname">MapSourceContainer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF18MapSourceContainer18MapSourceContainerEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create an empty container. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF18MapSourceContainer18MapSourceContainerERKN2IO12H5IODataTreeEj">
<span id="PSF::MapSourceContainer::MapSourceContainer__IO::H5IODataTreeCR.unsigned"></span><span class="target" id="classPSF_1_1MapSourceContainer_1acd9cfdb7b0ed18c99c1117ea9908a1c8"></span><code class="descname">MapSourceContainer</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data_tree</em>, unsigned <em>num_apertures</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF18MapSourceContainer18MapSourceContainerERKN2IO12H5IODataTreeEj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Initialize the container from an H5IODataTree. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Static Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF18MapSourceContainer29required_data_tree_quantitiesEv">
<span id="PSF::MapSourceContainer::required_data_tree_quantities"></span><span class="target" id="classPSF_1_1MapSourceContainer_1a2dbeba4bd0ea6bde0325430a48463ef5"></span><em class="property">const</em> std::set&lt;std::string&gt; &amp;<code class="descname">required_data_tree_quantities</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF18MapSourceContainer29required_data_tree_quantitiesEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>All quantities needed to construct the source list from an I/O data tree. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N3PSF9PiecewiseE">
<span id="PSF::Piecewise"></span><span class="target" id="classPSF_1_1Piecewise"></span><em class="property">class </em><code class="descname">Piecewise</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF3PSFE" title="PSF::PSF">PSF</a><a class="headerlink" href="#_CPPv2N3PSF9PiecewiseE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;Piecewise.h&gt;</em><p>A <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> model consisting of a grid of rectangles each with a separate intensity function. </p>
<p>Subclassed by <a class="reference internal" href="#classPSF_1_1PiecewiseBicubic"><span class="std std-ref">PSF::PiecewiseBicubic</span></a></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF9Piecewise9PiecewiseE20RandomAccessIterator20RandomAccessIterator20RandomAccessIterator20RandomAccessIterator">
<span id="PSF::Piecewise::Piecewise__RandomAccessIterator.RandomAccessIterator.RandomAccessIterator.RandomAccessIterator"></span><em class="property">template </em>&lt;<em class="property">class</em> RandomAccessIterator&gt;<br /><span class="target" id="classPSF_1_1Piecewise_1aa3be68d72c6a1882248201c4cd1fb0e3"></span><code class="descname">Piecewise</code><span class="sig-paren">(</span>RandomAccessIterator <em>first_x</em>, RandomAccessIterator <em>last_x</em>, RandomAccessIterator <em>first_y</em>, RandomAccessIterator <em>last_y</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF9Piecewise9PiecewiseE20RandomAccessIterator20RandomAccessIterator20RandomAccessIterator20RandomAccessIterator" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> model on a specified grid with invalid cells. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">first_x</span></code>: The first horizonatal boundary. </li>
<li><code class="docutils literal"><span class="pre">last_x</span></code>: One past the last horizontal boundary. </li>
<li><code class="docutils literal"><span class="pre">first_y</span></code>: The first vertical boundary. </li>
<li><code class="docutils literal"><span class="pre">last_y</span></code>: One past the last vertical boundary. </li>
</ul>
</dd>
</dl>
</p>
<p>Use set_cell or set_all_cells to specify the cells. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF9Piecewise8set_cellEPK13PiecewiseCellRKN4Core16vector_size_typeERKN4Core16vector_size_typeEb">
<span id="PSF::Piecewise::set_cell__PiecewiseCellCP.Core::vector_size_typeCR.Core::vector_size_typeCR.b"></span><span class="target" id="classPSF_1_1Piecewise_1acb6bb0761038b369ba32bb4f2f46431f"></span>void <code class="descname">set_cell</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N3PSF13PiecewiseCellE" title="PSF::PiecewiseCell">PiecewiseCell</a> *<em>cell</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> &amp;<em>x_index</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> &amp;<em>y_index</em>, bool <em>clone</em> = false<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF9Piecewise8set_cellEPK13PiecewiseCellRKN4Core16vector_size_typeERKN4Core16vector_size_typeEb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set one of the cells comprising the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a>. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">cell</span></code>: The new cell to store. </li>
<li><code class="docutils literal"><span class="pre">x_index</span></code>: The horizontal index of the grid cell to set. </li>
<li><code class="docutils literal"><span class="pre">y_index</span></code>: The vertical index of the grid cell to set. </li>
<li><code class="docutils literal"><span class="pre">clone</span></code>: Wether to store the cell directly or to clone it. The clones are destroyed by the destructor. </li>
</ul>
</dd>
</dl>
</p>
<p>Unless the clone argument is true, the cell must not be deallocated until the Picewise object is. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF9Piecewise13set_all_cellsE17ConstCellIteratorb">
<span id="PSF::Piecewise::set_all_cells__ConstCellIterator.b"></span><em class="property">template </em>&lt;<em class="property">class</em> ConstCellIterator&gt;<br /><span class="target" id="classPSF_1_1Piecewise_1a08362ad7e5bb978c4a68dcf30ed6b17c"></span>void <code class="descname">set_all_cells</code><span class="sig-paren">(</span>ConstCellIterator <em>first_cell</em>, bool <em>clone</em> = false<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF9Piecewise13set_all_cellsE17ConstCellIteratorb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set all cells. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">first_cell</span></code>: An iterator over (const) pointers to cells pointing to the first cell (the one with x index = y index = 0. </li>
<li><code class="docutils literal"><span class="pre">clone</span></code>: Whether to store clones of the cells instead of the cells </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9PiecewiseclEdd">
<span id="PSF::Piecewise::call-operator__double.doubleC"></span><span class="target" id="classPSF_1_1Piecewise_1a7184535e48a52059e77427bc6316e4a6"></span>double <code class="descname">operator()</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9PiecewiseclEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Evaluates the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> at the given position. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9PiecewiseclEddRKNSt6vectorINSt8valarrayIdEEEE">
<span id="PSF::Piecewise::call-operator__double.double.std::vector:std::valarray:double::CRC"></span><span class="target" id="classPSF_1_1Piecewise_1ad30e36f12dbf9e7fbd1ab7d39ed69053"></span>std::valarray&lt;double&gt; <code class="descname">operator()</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em>, <em class="property">const</em> std::vector&lt;std::valarray&lt;double&gt;&gt; &amp;<em>parameter_sets</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9PiecewiseclEddRKNSt6vectorINSt8valarrayIdEEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Evaluates the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> at the given position assuming a list of cell parameters. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x</span></code>: The x coordinate where to evaluate the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a>. </li>
<li><code class="docutils literal"><span class="pre">y</span></code>: The y coordinate where to evaluate the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a>. </li>
<li><code class="docutils literal"><span class="pre">parameter_sets</span></code>: The sets of coefficients to use. The sets of coefficients to use for a cell with index i are parameter_sets[i]. Each set is 16 values long and all sets for a single pixel are concatenated. If this argument is empty, the current <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> setup is used. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise17grid_column_widthEN4Core16vector_size_typeE">
<span id="PSF::Piecewise::grid_column_width__Core::vector_size_typeC"></span><span class="target" id="classPSF_1_1Piecewise_1ad870faa8d30e4438389b8295c4573e74"></span>double <code class="descname">grid_column_width</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>column</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise17grid_column_widthEN4Core16vector_size_typeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the width of the column-th cell column. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise15grid_row_heightEN4Core16vector_size_typeE">
<span id="PSF::Piecewise::grid_row_height__Core::vector_size_typeC"></span><span class="target" id="classPSF_1_1Piecewise_1a9088d1d84afb8d054feb2aa41cb62292"></span>double <code class="descname">grid_row_height</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>row</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise15grid_row_heightEN4Core16vector_size_typeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the height of the rowth-th cell row. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise5min_xEv">
<span id="PSF::Piecewise::min_xC"></span><span class="target" id="classPSF_1_1Piecewise_1af3a8a47a901b15b6fb685eb760518d15"></span>double <code class="descname">min_x</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise5min_xEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The left boundary of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> grid. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise5max_xEv">
<span id="PSF::Piecewise::max_xC"></span><span class="target" id="classPSF_1_1Piecewise_1ad92caff8d26d497eca504bf2190ee8c1"></span>double <code class="descname">max_x</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise5max_xEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The right boundary of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> grid. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise5min_yEv">
<span id="PSF::Piecewise::min_yC"></span><span class="target" id="classPSF_1_1Piecewise_1a6c6f4f8e4d98633481b8af6b12a6e33a"></span>double <code class="descname">min_y</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise5min_yEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The bottom boundary of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> grid. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise5max_yEv">
<span id="PSF::Piecewise::max_yC"></span><span class="target" id="classPSF_1_1Piecewise_1ac6defc7d4e710852c98284736d3cd8d2"></span>double <code class="descname">max_y</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise5max_yEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The top boundary of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> grid. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise30integrate_rectangle_parametersEddddRKNSt6vectorINSt8valarrayIdEEEE">
<span id="PSF::Piecewise::integrate_rectangle_parameters__double.double.double.double.std::vector:std::valarray:double::CRC"></span><span class="target" id="classPSF_1_1Piecewise_1a8dcf614097c8f2e447834a2b2a9ed1cf"></span>std::valarray&lt;double&gt; <code class="descname">integrate_rectangle_parameters</code><span class="sig-paren">(</span>double <em>center_x</em>, double <em>center_y</em>, double <em>dx</em>, double <em>dy</em>, <em class="property">const</em> std::vector&lt;std::valarray&lt;double&gt;&gt; &amp;<em>parameter_sets</em> = std::vector&lt; std::valarray&lt; double &gt; &gt;()<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise30integrate_rectangle_parametersEddddRKNSt6vectorINSt8valarrayIdEEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculates the integral of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> over a rectangle. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">center_x</span></code>: The x coordinate of the center of the rectangle </li>
<li><code class="docutils literal"><span class="pre">center_y</span></code>: The x coordinate of the center of the rectangle </li>
<li><code class="docutils literal"><span class="pre">dx</span></code>: The full width of the rectangle. </li>
<li><code class="docutils literal"><span class="pre">dy</span></code>: The full height of the rectangle. </li>
<li><code class="docutils literal"><span class="pre">parameter_sets</span></code>: Optional sets of coefficients to use. The sets of coefficients to use for a cell with index i are parameter_sets[i]. Each set is 16 values long and all sets for a single pixel are concatenated. If this argument is omitted or empty, the current <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> setup is used. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Protected Functions</p>
<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise19integrate_rectangleEdddd">
<span id="PSF::Piecewise::integrate_rectangle__double.double.double.doubleC"></span><span class="target" id="classPSF_1_1Piecewise_1adcef587b2345da3103e10a254f3aeb75"></span>double <code class="descname">integrate_rectangle</code><span class="sig-paren">(</span>double <em>center_x</em>, double <em>center_y</em>, double <em>dx</em>, double <em>dy</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise19integrate_rectangleEdddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculates the integral of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> over a rectangle. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise15integrate_wedgeEdddbb">
<span id="PSF::Piecewise::integrate_wedge__double.double.double.b.bC"></span><span class="target" id="classPSF_1_1Piecewise_1aefc070663de2ca53b62d8e6a21930ae4"></span>double <code class="descname">integrate_wedge</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em>, double <em>radius</em>, bool <em>left</em> = false, bool <em>bottom</em> = false<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise15integrate_wedgeEdddbb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Integrates the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> over the smallest of the four wedges with the. </p>
<p><ul class="simple">
<li>the line x=x</li>
<li>the line y=y</li>
<li>the circle centered at (0, 0) with a radius=radius If x is 0 the left vs right wedge is chosen according to left Same for y0 and bottom. </li>
</ul>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise10cell_indexEN4Core16vector_size_typeEN4Core16vector_size_typeE">
<span id="PSF::Piecewise::cell_index__Core::vector_size_type.Core::vector_size_typeC"></span><span class="target" id="classPSF_1_1Piecewise_1a9b21044c37a2b0901e539742a8d9cde7"></span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <code class="descname">cell_index</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>x_ind</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>y_ind</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise10cell_indexEN4Core16vector_size_typeEN4Core16vector_size_typeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The index of the cell with the given x and y indices. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise10cell_indexERKNSt6vectorIdEERKdN4Core16vector_size_typeEN4Core16vector_size_typeE">
<span id="PSF::Piecewise::cell_index__std::vector:double:CR.doubleCR.Core::vector_size_type.Core::vector_size_typeC"></span><span class="target" id="classPSF_1_1Piecewise_1ac97b274ac5008c49dd0818d7beaa8b97"></span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <code class="descname">cell_index</code><span class="sig-paren">(</span><em class="property">const</em> std::vector&lt;double&gt; &amp;<em>grid</em>, <em class="property">const</em> double &amp;<em>x</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>hint_lower</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>hint_upper</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise10cell_indexERKNSt6vectorIdEERKdN4Core16vector_size_typeEN4Core16vector_size_typeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">grid</span></code>: The cell boundaries. </li>
<li><code class="docutils literal"><span class="pre">x</span></code>: The coordinate whose cell index is required. </li>
<li><code class="docutils literal"><span class="pre">hint_lower</span></code>: An index of a cell boundary known to be less than x. </li>
<li><code class="docutils literal"><span class="pre">hint_upper</span></code>: An index of a cell boundary known to be greater than x. </li>
</ul>
</dd>
</dl>
</p>
<p>The index of the cell to which the given coordinate belongs.</p>
<p>Cell boundaries are assumed to belong to the smaller cell index, except the boundary at hint_lower which belongs to the hint_lower cell. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise10cell_indexERKNSt6vectorIdEERKd">
<span id="PSF::Piecewise::cell_index__std::vector:double:CR.doubleCRC"></span><span class="target" id="classPSF_1_1Piecewise_1a8d9358718ba764cb89934798af32b1a9"></span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <code class="descname">cell_index</code><span class="sig-paren">(</span><em class="property">const</em> std::vector&lt;double&gt; &amp;<em>grid</em>, <em class="property">const</em> double &amp;<em>x</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise10cell_indexERKNSt6vectorIdEERKd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The index of the cell to which the given coordinate belongs. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">grid</span></code>: The cell boundaries. </li>
<li><code class="docutils literal"><span class="pre">x</span></code>: The coordinate whose cell index is required. </li>
</ul>
</dd>
</dl>
</p>
<p>Cell boundaries are assumed to belong to the smaller cell index, except the smallest boundary which belongs to the first cell. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise10cell_indexERKNSt6vectorIdEERKdN4Core16vector_size_typeE">
<span id="PSF::Piecewise::cell_index__std::vector:double:CR.doubleCR.Core::vector_size_typeC"></span><span class="target" id="classPSF_1_1Piecewise_1a31162fd2826c1f5ff85ecbdd65baf6b2"></span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <code class="descname">cell_index</code><span class="sig-paren">(</span><em class="property">const</em> std::vector&lt;double&gt; &amp;<em>grid</em>, <em class="property">const</em> double &amp;<em>x</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>hint_lower</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise10cell_indexERKNSt6vectorIdEERKdN4Core16vector_size_typeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The index of the cell to which the given coordinate belongs. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">grid</span></code>: The cell boundaries. </li>
<li><code class="docutils literal"><span class="pre">x</span></code>: The coordinate whose cell index is required. </li>
<li><code class="docutils literal"><span class="pre">hint_lower</span></code>: An index of a cell boundary known to be less than x. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise17impose_boundariesERN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeE">
<span id="PSF::Piecewise::impose_boundaries__Core::vector_size_typeR.Core::vector_size_type.Core::vector_size_typeC"></span><span class="target" id="classPSF_1_1Piecewise_1aff963e13dae249b13cc49d38b4d2430b"></span>void <code class="descname">impose_boundaries</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> &amp;<em>index</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>boundary1</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>buondary2</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise17impose_boundariesERN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>If an index is outside a range it is replaced by the closest boundary. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise9cell_spanERKNSt6vectorIdEEddRN4Core16vector_size_typeERN4Core16vector_size_typeE">
<span id="PSF::Piecewise::cell_span__std::vector:double:CR.double.double.Core::vector_size_typeR.Core::vector_size_typeRC"></span><span class="target" id="classPSF_1_1Piecewise_1a265919595e03f8563f9bfa2f845826e2"></span>void <code class="descname">cell_span</code><span class="sig-paren">(</span><em class="property">const</em> std::vector&lt;double&gt; &amp;<em>grid</em>, double <em>min_x</em>, double <em>max_x</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> &amp;<em>low</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> &amp;<em>high</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise9cell_spanERKNSt6vectorIdEEddRN4Core16vector_size_typeERN4Core16vector_size_typeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Finds the range of cells that tightly cover a range of positions. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">grid</span></code>: The cell boundaries. </li>
<li><code class="docutils literal"><span class="pre">min_x</span></code>: The lower bound of the range to cover. </li>
<li><code class="docutils literal"><span class="pre">max_x</span></code>: The upper bound of the range to cover. </li>
<li><code class="docutils literal"><span class="pre">low</span></code>: On output set to the index of the first cell that covers the range. </li>
<li><code class="docutils literal"><span class="pre">high</span></code>: On output set to the index of the last cell that covers the range. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise17check_inside_gridEdd">
<span id="PSF::Piecewise::check_inside_grid__double.doubleC"></span><span class="target" id="classPSF_1_1Piecewise_1af7ef67a815881fa9da06af08db4009cb"></span>void <code class="descname">check_inside_grid</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise17check_inside_gridEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Throws an exception if x or y are not inside the grid range. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise33integrate_single_column_rectangleEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEddddRKNSt6vectorINSt8valarrayIdEEEE">
<span id="PSF::Piecewise::integrate_single_column_rectangle__Core::vector_size_type.Core::vector_size_type.Core::vector_size_type.double.double.double.double.std::vector:std::valarray:double::CRC"></span><span class="target" id="classPSF_1_1Piecewise_1aa0616b31fb300595057adf5a93d903c9"></span>std::valarray&lt;double&gt; <code class="descname">integrate_single_column_rectangle</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>x_index</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>first_y_index</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>last_y_index</em>, double <em>xmin_cell</em>, double <em>xmax_cell</em>, double <em>ymin_cell</em>, double <em>ymax_cell</em>, <em class="property">const</em> std::vector&lt;std::valarray&lt;double&gt;&gt; &amp;<em>parameter_sets</em> = std::vector&lt; std::valarray&lt; double &gt; &gt;()<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise33integrate_single_column_rectangleEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEddddRKNSt6vectorINSt8valarrayIdEEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculates the integral over a rectangle that fits in a single column of cells. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x_index</span></code>: The index in __grid_x of the cell containing the rectangle. </li>
<li><code class="docutils literal"><span class="pre">first_y_index</span></code>: The index of the first y cell that overlaps with the rectangle. </li>
<li><code class="docutils literal"><span class="pre">last_y_index</span></code>: The index of the last y cell that overlaps with the rectangle. </li>
<li><code class="docutils literal"><span class="pre">xmin_cell</span></code>: The left boundary of the rectangle in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">xmax_cell</span></code>: The right boundary of the rectangle in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">ymin_cell</span></code>: The bottom boundary of the rectangle in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">ymax_cell</span></code>: The top boundary of the rectangle in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">parameter_sets</span></code>: Optional sets of coefficients to try. The sets of coefficients to try for a cell with index i are parameter_sets[i]. Each set is 16 values long and all sets for a single pixel are concatenated. </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSF_single_column_rectangle_iiidddd.png" src="_images/PiecewisePSF_single_column_rectangle_iiidddd.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise30integrate_single_row_rectangleEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEddddRKNSt6vectorINSt8valarrayIdEEEE">
<span id="PSF::Piecewise::integrate_single_row_rectangle__Core::vector_size_type.Core::vector_size_type.Core::vector_size_type.double.double.double.double.std::vector:std::valarray:double::CRC"></span><span class="target" id="classPSF_1_1Piecewise_1aba608aa611e18dff5e480868b5013a02"></span>std::valarray&lt;double&gt; <code class="descname">integrate_single_row_rectangle</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>first_x_index</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>last_x_index</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>y_index</em>, double <em>xmin_cell</em>, double <em>xmax_cell</em>, double <em>ymin_cell</em>, double <em>ymax_cell</em>, <em class="property">const</em> std::vector&lt;std::valarray&lt;double&gt;&gt; &amp;<em>parameter_sets</em> = std::vector&lt; std::valarray&lt; double &gt; &gt;()<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise30integrate_single_row_rectangleEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEddddRKNSt6vectorINSt8valarrayIdEEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculates the integral over a rectangle that fits in a single row of cells. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">first_x_index</span></code>: The index of the first x cell that overlaps with the rectangle. </li>
<li><code class="docutils literal"><span class="pre">last_x_index</span></code>: The index of the last x cell that overlaps with the rectangle. </li>
<li><code class="docutils literal"><span class="pre">y_index</span></code>: The index of the y cell that contains the rectagle. </li>
<li><code class="docutils literal"><span class="pre">xmin_cell</span></code>: The left boundary of the rectangle in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">xmax_cell</span></code>: The right boundary of the rectangle in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">ymin_cell</span></code>: The bottom boundary of the rectangle in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">ymax_cell</span></code>: The top boundary of the rectangle in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">parameter_sets</span></code>: Optional sets of coefficients to try. The sets of coefficients to try for a cell with index i are parameter_sets[i]. Each set is 16 values long and all sets for a single pixel are concatenated. </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSF_single_row_rectangle_iiidddd.png" src="_images/PiecewisePSF_single_row_rectangle_iiidddd.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise36integrate_multi_row_column_rectangleEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEddddRKNSt6vectorINSt8valarrayIdEEEE">
<span id="PSF::Piecewise::integrate_multi_row_column_rectangle__Core::vector_size_type.Core::vector_size_type.Core::vector_size_type.Core::vector_size_type.double.double.double.double.std::vector:std::valarray:double::CRC"></span><span class="target" id="classPSF_1_1Piecewise_1a2eafab62eb570adc3da07808495784e8"></span>std::valarray&lt;double&gt; <code class="descname">integrate_multi_row_column_rectangle</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>first_x_index</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>last_x_index</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>first_y_index</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>last_y_index</em>, double <em>xmin_cell</em>, double <em>xmax_cell</em>, double <em>ymin_cell</em>, double <em>ymax_cell</em>, <em class="property">const</em> std::vector&lt;std::valarray&lt;double&gt;&gt; &amp;<em>parameter_sets</em> = std::vector&lt; std::valarray&lt; double &gt; &gt;()<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise36integrate_multi_row_column_rectangleEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEddddRKNSt6vectorINSt8valarrayIdEEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">first_x_index</span></code>: The index of the first x cell that overlaps with the rectangle. </li>
<li><code class="docutils literal"><span class="pre">last_x_index</span></code>: The index of the last x cell that overlaps with the rectangle. </li>
<li><code class="docutils literal"><span class="pre">first_y_index</span></code>: The index of the first y cell that overlaps with the rectangle. </li>
<li><code class="docutils literal"><span class="pre">last_y_index</span></code>: The index of the last y cell that overlaps with the rectangle. </li>
<li><code class="docutils literal"><span class="pre">xmin_cell</span></code>: The left boundary of the rectangle in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">xmax_cell</span></code>: The right boundary of the rectangle in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">ymin_cell</span></code>: The bottom boundary of the rectangle in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">ymax_cell</span></code>: The top boundary of the rectangle in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">parameter_sets</span></code>: Optional sets of coefficients to try. The sets of coefficients to try for a cell with index i are parameter_sets[i]. Each set is 16 values long and all sets for a single pixel are concatenated. </li>
</ul>
</dd>
</dl>
</p>
<p>Calculates the integral over a rectangle spanning multiple rows and columns.</p>
<p><img alt="_images/PiecewisePSF_multi_row_column_rectangle_iiiidddd.png" src="_images/PiecewisePSF_multi_row_column_rectangle_iiiidddd.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise29integrate_single_column_wedgeEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEdddd">
<span id="PSF::Piecewise::integrate_single_column_wedge__Core::vector_size_type.Core::vector_size_type.Core::vector_size_type.double.double.double.doubleC"></span><span class="target" id="classPSF_1_1Piecewise_1aaac072a5bed871b631c66ee84948cdbb"></span>double <code class="descname">integrate_single_column_wedge</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>x_index</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>tip_y_index</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>corner_y_index</em>, double <em>cell_corner_x</em>, double <em>cell_corner_y</em>, double <em>cell_tip_y</em>, double <em>radius</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise29integrate_single_column_wedgeEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEdddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x_index</span></code>: The index in __grid_x of the cell containing the wedge. </li>
<li><code class="docutils literal"><span class="pre">tip_y_index</span></code>: The index of the cell in __grid_y containing the tip of the wedge. </li>
<li><code class="docutils literal"><span class="pre">corner_y_index</span></code>: The index of the cell in __grid_y containing the corner of the wedge. </li>
<li><code class="docutils literal"><span class="pre">cell_corner_x</span></code>: The x coordinate of the wedge corner in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">cell_corner_y</span></code>: The y coordinate of the wedge corner in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">cell_tip_y</span></code>: The y coordinate of the y tip of the wedge in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">radius</span></code>: The radius of curvature of the wedge arc. </li>
</ul>
</dd>
</dl>
</p>
<p>Calculates the integral over a wedge that fits in a single column of cells.</p>
<p>The area being integrated matches one of the following diagrams. <img alt="_images/PiecewisePSF_single_column_wedge_iiidddd_ur.png" src="_images/PiecewisePSF_single_column_wedge_iiidddd_ur.png" /><img alt="_images/PiecewisePSF_single_column_wedge_iiidddd_ul.png" src="_images/PiecewisePSF_single_column_wedge_iiidddd_ul.png" /><img alt="_images/PiecewisePSF_single_column_wedge_iiidddd_dr.png" src="_images/PiecewisePSF_single_column_wedge_iiidddd_dr.png" /><img alt="_images/PiecewisePSF_single_column_wedge_iiidddd_dl.png" src="_images/PiecewisePSF_single_column_wedge_iiidddd_dl.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise26integrate_single_row_wedgeEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEdddd">
<span id="PSF::Piecewise::integrate_single_row_wedge__Core::vector_size_type.Core::vector_size_type.Core::vector_size_type.double.double.double.doubleC"></span><span class="target" id="classPSF_1_1Piecewise_1a18a75bf1e74fe8ba82b065ac7afe5dc7"></span>double <code class="descname">integrate_single_row_wedge</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>tip_x_index</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>corner_x_index</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>y_index</em>, double <em>cell_corner_x</em>, double <em>cell_corner_y</em>, double <em>cell_tip_x</em>, double <em>radius</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise26integrate_single_row_wedgeEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEdddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">tip_x_index</span></code>: The index in __grid_x of the cell containing the tip of the wedge. </li>
<li><code class="docutils literal"><span class="pre">corner_x_index</span></code>: The index in __grid_x of the cell containing the corner of the wedge. </li>
<li><code class="docutils literal"><span class="pre">y_index</span></code>: The index of the cell in __grid_y containing the wedge. </li>
<li><code class="docutils literal"><span class="pre">cell_corner_x</span></code>: The x coordinate of the wedge corner in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">cell_corner_y</span></code>: The y coordinate of the wedge corner in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">cell_tip_x</span></code>: The x coordinate of the y tip of the wedge in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">radius</span></code>: The radius of curvature of the wedge arc. </li>
</ul>
</dd>
</dl>
</p>
<p>Calculates the integral over a wedge that fits in a single row of cells. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise20integrate_inside_arcEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEd">
<span id="PSF::Piecewise::integrate_inside_arc__Core::vector_size_type.Core::vector_size_type.Core::vector_size_type.doubleC"></span><span class="target" id="classPSF_1_1Piecewise_1a8d1f05c5eac2a065f8c651a16b06911c"></span>double <code class="descname">integrate_inside_arc</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>start_col</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>end_col</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>row</em>, double <em>radius</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise20integrate_inside_arcEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Integrates over the area interior to a circle that overlaps with a row of cells. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">start_col</span></code>: The column of the end cell whose vertical wall is intersected by the arc. </li>
<li><code class="docutils literal"><span class="pre">end_col</span></code>: The column of the cell whose horizontal wall is intersected by the arc. </li>
<li><code class="docutils literal"><span class="pre">row</span></code>: The row of the cells. </li>
<li><code class="docutils literal"><span class="pre">radius</span></code>: The radius of the circle the arc is part of. </li>
</ul>
</dd>
</dl>
</p>
<p>The configuration of the circle and cells must be such that the circle intersect the outside vertical wall of one end cells and one of the horizontal walls of the other end cell.</p>
<p>In addition the arc may not go through <span class="math">\(n\pi/2\)</span>. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise20integrate_bottom_rowEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEdddddb">
<span id="PSF::Piecewise::integrate_bottom_row__Core::vector_size_type.Core::vector_size_type.Core::vector_size_type.Core::vector_size_type.double.double.double.double.double.bC"></span><span class="target" id="classPSF_1_1Piecewise_1a7cb8911d0e404a2150d41139ae8ee0b9"></span>double <code class="descname">integrate_bottom_row</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>corner_col</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>corner_row</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>crossing_col</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>tip_col</em>, double <em>cell_crossing_x</em>, double <em>cell_tip_x</em>, double <em>cell_corner_x</em>, double <em>cell_corner_y</em>, double <em>radius</em>, bool <em>up</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise20integrate_bottom_rowEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEdddddb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Integrates the row containing the corner of a multi row and column wedge. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">corner_col</span></code>: The column of the cell containing the corner. </li>
<li><code class="docutils literal"><span class="pre">corner_row</span></code>: The row of the cells being integrated. </li>
<li><code class="docutils literal"><span class="pre">crossing_col</span></code>: The column of the cell where the arc enters the row of cells. </li>
<li><code class="docutils literal"><span class="pre">tip_col</span></code>: The column of the cell containing the tip furthest from the corner in the x direction. </li>
<li><code class="docutils literal"><span class="pre">cell_crossing_x</span></code>: The x coordinate where the arc enters the row of cells in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">cell_tip_x</span></code>: The x coordinate of the tip of the wedge in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">cell_corner_x</span></code>: The x coordinate of the corner of the wedge in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">cell_corner_y</span></code>: The y coordinate of the corner of the wedge in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">radius</span></code>: The radius of the circle the wedge arc is part of. </li>
<li><code class="docutils literal"><span class="pre">up</span></code>: Wether the wedge lies above the corner. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise20integrate_middle_rowEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEdddi">
<span id="PSF::Piecewise::integrate_middle_row__Core::vector_size_type.Core::vector_size_type.Core::vector_size_type.Core::vector_size_type.double.double.double.iC"></span><span class="target" id="classPSF_1_1Piecewise_1a805715d2d6c1d9e9376e374cd366c4e2"></span>double <code class="descname">integrate_middle_row</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>row</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>corner_col</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>inner_crossing_col</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>last_col</em>, double <em>cell_corner_x</em>, double <em>inner_cell_crossing_x</em>, double <em>radius</em>, int <em>right</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise20integrate_middle_rowEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEdddi" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Integrates a row betweent the corner and the tip of a multi row and column wedge. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">row</span></code>: The row being integrated. </li>
<li><code class="docutils literal"><span class="pre">corner_col</span></code>: The column of the cell containing the corner. </li>
<li><code class="docutils literal"><span class="pre">inner_crossing_col</span></code>: The column where the arc first enters the row being integrated. </li>
<li><code class="docutils literal"><span class="pre">last_col</span></code>: The column furthest from the corner column which still contains a piece of the wedge. </li>
<li><code class="docutils literal"><span class="pre">cell_corner_x</span></code>: The x coordinate of the wedge corner in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">inner_cell_crossing_x</span></code>: The innermost x where the arc enters the row in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">radius</span></code>: The radius of the circle the wedge arc is part of. </li>
<li><code class="docutils literal"><span class="pre">right</span></code>: If the wedge extends to the right/left of the corner +/- 1. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise17integrate_tip_rowEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEdddbb">
<span id="PSF::Piecewise::integrate_tip_row__Core::vector_size_type.Core::vector_size_type.Core::vector_size_type.double.double.double.b.bC"></span><span class="target" id="classPSF_1_1Piecewise_1ac6979e575d69230bbf194115b37d0cb1"></span>double <code class="descname">integrate_tip_row</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>tip_row</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>corner_col</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>crossing_col</em>, double <em>cell_corner_x</em>, double <em>cell_tip_y</em>, double <em>radius</em>, bool <em>up</em>, bool <em>right</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise17integrate_tip_rowEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEdddbb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Integrates the row of cells containing the tip of a wedge. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">tip_row</span></code>: The row being integrated. </li>
<li><code class="docutils literal"><span class="pre">corner_col</span></code>: The column of the cell containing the corner. </li>
<li><code class="docutils literal"><span class="pre">crossing_col</span></code>: The column where the wedge crosses the row boundary. </li>
<li><code class="docutils literal"><span class="pre">cell_corner_x</span></code>: The x coordinate of the wedge corner in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">cell_tip_y</span></code>: The y coordinate of the wedge tip in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">radius</span></code>: The radius of the circle the wedge arc is part of. </li>
<li><code class="docutils literal"><span class="pre">up</span></code>: Does the wedge extend upwards of the corner? </li>
<li><code class="docutils literal"><span class="pre">right</span></code>: Does the wedge extend rightward of the corner? </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF9Piecewise32integrate_multi_row_column_wedgeEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEddddd">
<span id="PSF::Piecewise::integrate_multi_row_column_wedge__Core::vector_size_type.Core::vector_size_type.Core::vector_size_type.Core::vector_size_type.double.double.double.double.doubleC"></span><span class="target" id="classPSF_1_1Piecewise_1abf7f55e2dc5b8663a19b6ed70c5e6a3f"></span>double <code class="descname">integrate_multi_row_column_wedge</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>tip_col</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>corner_col</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>tip_row</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>corner_row</em>, double <em>cell_corner_x</em>, double <em>cell_corner_y</em>, double <em>cell_tip_x</em>, double <em>cell_tip_y</em>, double <em>radius</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF9Piecewise32integrate_multi_row_column_wedgeEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEN4Core16vector_size_typeEddddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculates the integral over a wedge that spans multiple rows and colunms of cells. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">tip_col</span></code>: The index in __grid_x of the cell containing the most horizontally displaced from the corner tip of the wedge. </li>
<li><code class="docutils literal"><span class="pre">corner_col</span></code>: The index in __grid_x of the cell containing the corner of the wedge. </li>
<li><code class="docutils literal"><span class="pre">tip_row</span></code>: The index of the cell in __grid_y containing the most vertically displaced from the corner tip of the wedge. </li>
<li><code class="docutils literal"><span class="pre">corner_row</span></code>: The index in __grid_y of the cell containing the corner of the wedge. </li>
<li><code class="docutils literal"><span class="pre">cell_corner_x</span></code>: The x coordinate of the wedge corner in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">cell_corner_y</span></code>: The y coordinate of the wedge corner in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">cell_tip_x</span></code>: The x coordinate of the y tip of the wedge in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">cell_tip_y</span></code>: The y coordinate of the y tip of the wedge in cell coordinates. </li>
<li><code class="docutils literal"><span class="pre">radius</span></code>: The radius of curvature of the wedge arc. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N3PSF9Piecewise8__grid_xE">
<span id="PSF::Piecewise::__grid_x__std::vector:double:"></span><span class="target" id="classPSF_1_1Piecewise_1a05cb6957a4238f6e9d1ea3e442d150a8"></span>std::vector&lt;double&gt; <code class="descname">__grid_x</code><a class="headerlink" href="#_CPPv2N3PSF9Piecewise8__grid_xE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The horizontal boundaries of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> grid cells. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF9Piecewise8__grid_yE">
<span id="PSF::Piecewise::__grid_y__std::vector:double:"></span><span class="target" id="classPSF_1_1Piecewise_1a356a0c2bba3fa366da1909eab18b90b4"></span>std::vector&lt;double&gt; <code class="descname">__grid_y</code><a class="headerlink" href="#_CPPv2N3PSF9Piecewise8__grid_yE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The vertical boundaries of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> grid cells. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF9Piecewise7__cellsE">
<span id="PSF::Piecewise::__cells__std::vector:PiecewiseCellCP:"></span><span class="target" id="classPSF_1_1Piecewise_1a52c903196fd6261075785faf223a9ab1"></span>std::vector&lt;<em class="property">const</em> <a class="reference internal" href="#_CPPv2N3PSF13PiecewiseCellE" title="PSF::PiecewiseCell">PiecewiseCell</a> *&gt; <code class="descname">__cells</code><a class="headerlink" href="#_CPPv2N3PSF9Piecewise7__cellsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The cells indexed as x_ind + y_ind*Nx. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF9Piecewise13__cloned_cellE">
<span id="PSF::Piecewise::__cloned_cell__std::vector:b:"></span><span class="target" id="classPSF_1_1Piecewise_1a5291b7ceaddc2d8834b9fcf4af242d47"></span>std::vector&lt;bool&gt; <code class="descname">__cloned_cell</code><a class="headerlink" href="#_CPPv2N3PSF9Piecewise13__cloned_cellE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Flags for whether the corresponding cell was cloned. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N3PSF16PiecewiseBicubicE">
<span id="PSF::PiecewiseBicubic"></span><span class="target" id="classPSF_1_1PiecewiseBicubic"></span><em class="property">class </em><code class="descname">PiecewiseBicubic</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF9PiecewiseE" title="PSF::Piecewise">Piecewise</a><a class="headerlink" href="#_CPPv2N3PSF16PiecewiseBicubicE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;PiecewiseBicubic.h&gt;</em><p>A <a class="reference internal" href="#classPSF_1_1Piecewise"><span class="std std-ref">Piecewise</span></a> defined as a bicubic interpolation over a grid, where at each grid point the value, the x and y derivatives and the cross-derivative are specified. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF16PiecewiseBicubic16PiecewiseBicubicE20RandomAccessIterator20RandomAccessIterator20RandomAccessIterator20RandomAccessIterator">
<span id="PSF::PiecewiseBicubic::PiecewiseBicubic__RandomAccessIterator.RandomAccessIterator.RandomAccessIterator.RandomAccessIterator"></span><em class="property">template </em>&lt;<em class="property">class</em> RandomAccessIterator&gt;<br /><span class="target" id="classPSF_1_1PiecewiseBicubic_1a152392317803059e56fc85e017d58868"></span><code class="descname">PiecewiseBicubic</code><span class="sig-paren">(</span>RandomAccessIterator <em>first_x</em>, RandomAccessIterator <em>last_x</em>, RandomAccessIterator <em>first_y</em>, RandomAccessIterator <em>last_y</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF16PiecewiseBicubic16PiecewiseBicubicE20RandomAccessIterator20RandomAccessIterator20RandomAccessIterator20RandomAccessIterator" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> model on a specified grid with invalid cells. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">first_x</span></code>: The first horizonatal boundary. </li>
<li><code class="docutils literal"><span class="pre">last_x</span></code>: One past the last horizontal boundary. </li>
<li><code class="docutils literal"><span class="pre">first_y</span></code>: The first vertical boundary. </li>
<li><code class="docutils literal"><span class="pre">last_y</span></code>: One past the last vertical boundary. </li>
</ul>
</dd>
</dl>
</p>
<p>Use set_values to finish specifying the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a>. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF16PiecewiseBicubic10set_valuesE20RandomAccessIterator20RandomAccessIterator20RandomAccessIterator20RandomAccessIterator">
<span id="PSF::PiecewiseBicubic::set_values__RandomAccessIterator.RandomAccessIterator.RandomAccessIterator.RandomAccessIterator"></span><em class="property">template </em>&lt;<em class="property">class</em> RandomAccessIterator&gt;<br /><span class="target" id="classPSF_1_1PiecewiseBicubic_1a50cc252c4c082a253ea97c4813704cd2"></span>void <code class="descname">set_values</code><span class="sig-paren">(</span>RandomAccessIterator <em>first_value</em>, RandomAccessIterator <em>first_x_deriv</em>, RandomAccessIterator <em>first_y_deriv</em>, RandomAccessIterator <em>first_xy_deriv</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF16PiecewiseBicubic10set_valuesE20RandomAccessIterator20RandomAccessIterator20RandomAccessIterator20RandomAccessIterator" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> values and derivatives. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">first_value</span></code>: The <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> value on the first grid point. Subsequent values should have the x index varying faster than the y index. </li>
<li><code class="docutils literal"><span class="pre">first_x_deriv</span></code>: The first x derivative. </li>
<li><code class="docutils literal"><span class="pre">first_y_deriv</span></code>: The first y derivative. </li>
<li><code class="docutils literal"><span class="pre">first_xy_deriv</span></code>: The first xy cross-derivative. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF16PiecewiseBicubicD0Ev">
<span id="PSF::PiecewiseBicubic::~PiecewiseBicubic"></span><span class="target" id="classPSF_1_1PiecewiseBicubic_1adcbf199b136ac7370181aae01cdebc9b"></span><code class="descname">~PiecewiseBicubic</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF16PiecewiseBicubicD0Ev" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Deallocate any cells that were allocated. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N3PSF16PiecewiseBicubic14__x_resolutionE">
<span id="PSF::PiecewiseBicubic::__x_resolution__Core::vector_size_type"></span><span class="target" id="classPSF_1_1PiecewiseBicubic_1a8f59afb8a935ca440a259b59b089dec1"></span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <code class="descname">__x_resolution</code><a class="headerlink" href="#_CPPv2N3PSF16PiecewiseBicubic14__x_resolutionE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of cell in the horizontal direction. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF16PiecewiseBicubic14__y_resolutionE">
<span id="PSF::PiecewiseBicubic::__y_resolution__Core::vector_size_type"></span><span class="target" id="classPSF_1_1PiecewiseBicubic_1a45e4e5499e6b2c7c409cdc2d8d30c521"></span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <code class="descname">__y_resolution</code><a class="headerlink" href="#_CPPv2N3PSF16PiecewiseBicubic14__y_resolutionE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of cell in the vertical direction. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF16PiecewiseBicubic7__cellsE">
<span id="PSF::PiecewiseBicubic::__cells__std::vector:PiecewiseBicubicCellP:"></span><span class="target" id="classPSF_1_1PiecewiseBicubic_1a2d9c2ed502697b46c1bf1fa04bb3c3b6"></span>std::vector&lt;<a class="reference internal" href="#_CPPv2N3PSF20PiecewiseBicubicCellE" title="PSF::PiecewiseBicubicCell">PiecewiseBicubicCell</a> *&gt; <code class="descname">__cells</code><a class="headerlink" href="#_CPPv2N3PSF16PiecewiseBicubic7__cellsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The cells comprising the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a>. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N3PSF20PiecewiseBicubicCellE">
<span id="PSF::PiecewiseBicubicCell"></span><span class="target" id="classPSF_1_1PiecewiseBicubicCell"></span><em class="property">class </em><code class="descname">PiecewiseBicubicCell</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF13PiecewiseCellE" title="PSF::PiecewiseCell">PiecewiseCell</a><a class="headerlink" href="#_CPPv2N3PSF20PiecewiseBicubicCellE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;PiecewiseBicubicCell.h&gt;</em><p>A class for <a class="reference internal" href="#classPSF_1_1Piecewise"><span class="std std-ref">Piecewise</span></a> cells over which the intensity is given by a bi-cubic polynomial. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF20PiecewiseBicubicCell20PiecewiseBicubicCellEdd">
<span id="PSF::PiecewiseBicubicCell::PiecewiseBicubicCell__double.double"></span><span class="target" id="classPSF_1_1PiecewiseBicubicCell_1a9e157f02c8ff876137f7e9cbc87caf06"></span><code class="descname">PiecewiseBicubicCell</code><span class="sig-paren">(</span>double <em>horizontal_size</em>, double <em>vertical_size</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF20PiecewiseBicubicCell20PiecewiseBicubicCellEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a cell with the given horizontal and vertical sizes. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF20PiecewiseBicubicCell20PiecewiseBicubicCellEdd12IteratorType12IteratorType">
<span id="PSF::PiecewiseBicubicCell::PiecewiseBicubicCell__double.double.IteratorType.IteratorType"></span><em class="property">template </em>&lt;<em class="property">class</em> IteratorType&gt;<br /><span class="target" id="classPSF_1_1PiecewiseBicubicCell_1ab195b5c381cbb1c4bbc5fb1ef554354e"></span><code class="descname">PiecewiseBicubicCell</code><span class="sig-paren">(</span>double <em>horizontal_size</em>, double <em>vertical_size</em>, IteratorType <em>first_coef</em>, IteratorType <em>last_coef</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF20PiecewiseBicubicCell20PiecewiseBicubicCellEdd12IteratorType12IteratorType" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a cell with the given horizontal and vertical sizes and initialize the coefficients. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF20PiecewiseBicubicCell20PiecewiseBicubicCellERK20PiecewiseBicubicCell">
<span id="PSF::PiecewiseBicubicCell::PiecewiseBicubicCell__PiecewiseBicubicCellCR"></span><span class="target" id="classPSF_1_1PiecewiseBicubicCell_1a876f8af69d3ec73017a25cb0e7637c6d"></span><code class="descname">PiecewiseBicubicCell</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N3PSF20PiecewiseBicubicCell20PiecewiseBicubicCellEdd" title="PSF::PiecewiseBicubicCell::PiecewiseBicubicCell">PiecewiseBicubicCell</a> &amp;<em>orig</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF20PiecewiseBicubicCell20PiecewiseBicubicCellERK20PiecewiseBicubicCell" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF20PiecewiseBicubicCell19integrate_rectangleEdddd">
<span id="PSF::PiecewiseBicubicCell::integrate_rectangle__double.double.double.doubleC"></span><span class="target" id="classPSF_1_1PiecewiseBicubicCell_1aeba429b02f82aed37b669b6ef187db47"></span><em class="property">virtual</em> double <code class="descname">integrate_rectangle</code><span class="sig-paren">(</span>double <em>xmin</em>, double <em>xmax</em>, double <em>ymin</em>, double <em>ymax</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF20PiecewiseBicubicCell19integrate_rectangleEdddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate the integral of the intensity over a rectangle that is contained entirely within the cell. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">xmin</span></code>: The left boundary of the rectangle. Must lie between the horizontal cell boundaries. Defined relative to the left cell boundary. </li>
<li><code class="docutils literal"><span class="pre">xmax</span></code>: The right boundary of the rectangle. Must lie between the horizontal cell boundaries. Defined relative to the left cell boundary. </li>
<li><code class="docutils literal"><span class="pre">ymin</span></code>: The bottom boundary of the rectangle. Must lie between the vertical cell boundaries. Defined relative to the bottom cell boundary. </li>
<li><code class="docutils literal"><span class="pre">ymax</span></code>: The top boundary of the rectangle. Must lie between the vertical cell boundaries. Defined relative to the bottom cell boundary. </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSFCell_integrate_rectangle_dddd.png" src="_images/PiecewisePSFCell_integrate_rectangle_dddd.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF20PiecewiseBicubicCell19integrate_rectangleEddddRKNSt8valarrayIdEE">
<span id="PSF::PiecewiseBicubicCell::integrate_rectangle__double.double.double.double.std::valarray:double:CRC"></span><span class="target" id="classPSF_1_1PiecewiseBicubicCell_1abf694a54b2660d889bb8e1bcd0313ca7"></span>std::valarray&lt;double&gt; <code class="descname">integrate_rectangle</code><span class="sig-paren">(</span>double <em>xmin</em>, double <em>xmax</em>, double <em>ymin</em>, double <em>ymax</em>, <em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>coef_sets</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF20PiecewiseBicubicCell19integrate_rectangleEddddRKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate the integral of the intensity over a rectangle that is contained entirely within the cell for several sets of coefficients. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">xmin</span></code>: The left boundary of the rectangle. Must lie between the horizontal cell boundaries. Defined relative to the left cell boundary. </li>
<li><code class="docutils literal"><span class="pre">xmax</span></code>: The right boundary of the rectangle. Must lie between the horizontal cell boundaries. Defined relative to the left cell boundary. </li>
<li><code class="docutils literal"><span class="pre">ymin</span></code>: The bottom boundary of the rectangle. Must lie between the vertical cell boundaries. Defined relative to the bottom cell boundary. </li>
<li><code class="docutils literal"><span class="pre">ymax</span></code>: The top boundary of the rectangle. Must lie between the vertical cell boundaries. Defined relative to the bottom cell boundary. </li>
<li><code class="docutils literal"><span class="pre">coef_sets</span></code>: The sets of coefficients to compute the integral for. Each set must contain 16 coefficients and the sets are concatenated. </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSFCell_integrate_rectangle_dddd.png" src="_images/PiecewisePSFCell_integrate_rectangle_dddd.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF20PiecewiseBicubicCell23integrate_hcircle_pieceEdddddd">
<span id="PSF::PiecewiseBicubicCell::integrate_hcircle_piece__double.double.double.double.double.doubleC"></span><span class="target" id="classPSF_1_1PiecewiseBicubicCell_1a5d3fcece573c9d5e593542ed8837daac"></span>double <code class="descname">integrate_hcircle_piece</code><span class="sig-paren">(</span>double <em>ymin</em>, double <em>ymax</em>, double <em>xbound</em>, double <em>radius</em>, double <em>circle_x</em>, double <em>circle_y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF20PiecewiseBicubicCell23integrate_hcircle_pieceEdddddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Integrate the intensity over a region bounded by one vertical, two horizontal lines and an arc that intersects the two horizontal lines. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">ymin</span></code>: The bottom boundary of the region. </li>
<li><code class="docutils literal"><span class="pre">ymax</span></code>: The top boundary of the region. </li>
<li><code class="docutils literal"><span class="pre">xbound</span></code>: The straight vertical boundary of the region. </li>
<li><code class="docutils literal"><span class="pre">radius</span></code>: The radius of the circle the bounding arc is part of. </li>
<li><code class="docutils literal"><span class="pre">circle_x</span></code>: The x coordinate of the circle center relative to the cell center. </li>
<li><code class="docutils literal"><span class="pre">circle_y</span></code>: The y coordinate of the circle center relative to the cell center. </li>
</ul>
</dd>
</dl>
</p>
<p><p>. </p>
<img alt="_images/PiecewisePSFCell_integrate_hcircle_piece_dddddd.png" src="_images/PiecewisePSFCell_integrate_hcircle_piece_dddddd.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF20PiecewiseBicubicCell23integrate_vcircle_pieceEdddddd">
<span id="PSF::PiecewiseBicubicCell::integrate_vcircle_piece__double.double.double.double.double.doubleC"></span><span class="target" id="classPSF_1_1PiecewiseBicubicCell_1a79377429cb98506706d714b96d9a56f8"></span>double <code class="descname">integrate_vcircle_piece</code><span class="sig-paren">(</span>double <em>xmin</em>, double <em>xmax</em>, double <em>ybound</em>, double <em>radius</em>, double <em>circle_x</em>, double <em>circle_y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF20PiecewiseBicubicCell23integrate_vcircle_pieceEdddddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Integrate the intensity over a region bounded by one horizontal, two vertical lines and an arc that intersects the two horizontal lines. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">xmin</span></code>: The left boundary of the region. </li>
<li><code class="docutils literal"><span class="pre">xmax</span></code>: The right boundary of the region. </li>
<li><code class="docutils literal"><span class="pre">ybound</span></code>: The straight horizontal boundary of the region. </li>
<li><code class="docutils literal"><span class="pre">radius</span></code>: The radius of the circle the bounding arc is part of. </li>
<li><code class="docutils literal"><span class="pre">circle_x</span></code>: The x coordinate of the circle center relative to the cell center. </li>
<li><code class="docutils literal"><span class="pre">circle_y</span></code>: The y coordinate of the circle center relative to the cell center. </li>
</ul>
</dd>
</dl>
</p>
<p><p>. </p>
<img alt="_images/PiecewisePSFCell_integrate_vcircle_piece_dddddd.png" src="_images/PiecewisePSFCell_integrate_vcircle_piece_dddddd.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF20PiecewiseBicubicCellclEdd">
<span id="PSF::PiecewiseBicubicCell::call-operator__double.doubleC"></span><span class="target" id="classPSF_1_1PiecewiseBicubicCell_1afed9f0f7f9ce93ee3e3bf987ee503626"></span><em class="property">virtual</em> double <code class="descname">operator()</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF20PiecewiseBicubicCellclEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the value of the intensity at the given position relative to the bottom left cell corner. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x</span></code>: The horizontal offset from the left cell wall where the intensity should be returned </li>
<li><code class="docutils literal"><span class="pre">y</span></code>: The vertical offset from the bottom cell wall where the intensity should be returned </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF20PiecewiseBicubicCellclEddRKNSt8valarrayIdEE">
<span id="PSF::PiecewiseBicubicCell::call-operator__double.double.std::valarray:double:CRC"></span><span class="target" id="classPSF_1_1PiecewiseBicubicCell_1a9919505b2a477a329152c4458773608e"></span>std::valarray&lt;double&gt; <code class="descname">operator()</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em>, <em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>coef_sets</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF20PiecewiseBicubicCellclEddRKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the value of the intensity at the given position relative to the bottom left cell corner. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x</span></code>: The horizontal offset from the left cell wall where the intensity should be returned </li>
<li><code class="docutils literal"><span class="pre">y</span></code>: The vertical offset from the bottom cell wall where the intensity should be returned </li>
<li><code class="docutils literal"><span class="pre">coef_sets</span></code>: The sets of coefficients to compute the intensity for. Each set must contain 16 coefficients and the sets are concatenated. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF20PiecewiseBicubicCell5cloneEv">
<span id="PSF::PiecewiseBicubicCell::cloneC"></span><span class="target" id="classPSF_1_1PiecewiseBicubicCell_1a5651f1827d529fc1762ce60402e22a3a"></span><em class="property">virtual</em> <a class="reference internal" href="#_CPPv2N3PSF13PiecewiseCellE" title="PSF::PiecewiseCell">PiecewiseCell</a> *<code class="descname">clone</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF20PiecewiseBicubicCell5cloneEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return a newly allocated copy of this object. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N3PSF20PiecewiseBicubicCell6__coefE">
<span id="PSF::PiecewiseBicubicCell::__coef__std::valarray:double:"></span><span class="target" id="classPSF_1_1PiecewiseBicubicCell_1adb31daeec75ed8b6146dd256bb0f210b"></span>std::valarray&lt;double&gt; <code class="descname">__coef</code><a class="headerlink" href="#_CPPv2N3PSF20PiecewiseBicubicCell6__coefE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The sets of polynomial coefficients.</p>
<p>The coefficient in front of <span class="math">\(x^m y^n\)</span> is __coef[m+4*n]. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N3PSF19PiecewiseBicubicMapE">
<span id="PSF::PiecewiseBicubicMap"></span><span class="target" id="classPSF_1_1PiecewiseBicubicMap"></span><em class="property">class </em><code class="descname">PiecewiseBicubicMap</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF3MapE" title="PSF::Map">Map</a><a class="headerlink" href="#_CPPv2N3PSF19PiecewiseBicubicMapE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;PiecewiseBicubicMap.h&gt;</em><p>Smoothly varying over an image piecewise bicubic <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a>. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF19PiecewiseBicubicMap19PiecewiseBicubicMapERKN2IO12H5IODataTreeEd">
<span id="PSF::PiecewiseBicubicMap::PiecewiseBicubicMap__IO::H5IODataTreeCR.double"></span><span class="target" id="classPSF_1_1PiecewiseBicubicMap_1af0196f4e7c67517aeab5fee64e42a013"></span><code class="descname">PiecewiseBicubicMap</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data</em>, double <em>min_psf_span</em> = 0<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF19PiecewiseBicubicMap19PiecewiseBicubicMapERKN2IO12H5IODataTreeEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Construct a map from the given data tree. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">data</span></code>: The I/O data tree to construct the map from. It should contain at least the quantities identified by <a class="reference internal" href="#classPSF_1_1PiecewiseBicubicMap_1a8a454178ce2ea12618360a0bb3071460"><span class="std std-ref">PiecewiseBicubicMap::required_data_tree_quantities()</span></a>. </li>
<li><code class="docutils literal"><span class="pre">min_psf_span</span></code>: The <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> grid should be expanded to cover at least a circle of this radius around each source. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF19PiecewiseBicubicMap19PiecewiseBicubicMapERKN5Eigen8VectorXdERKNSt6vectorIdEERKNSt6vectorIdEE">
<span id="PSF::PiecewiseBicubicMap::PiecewiseBicubicMap__Eigen::VectorXdCR.std::vector:double:CR.std::vector:double:CR"></span><span class="target" id="classPSF_1_1PiecewiseBicubicMap_1a7e775775e96c0675f338fd002bfa25b6"></span><code class="descname">PiecewiseBicubicMap</code><span class="sig-paren">(</span><em class="property">const</em> Eigen::VectorXd &amp;<em>expansion_coef</em>, <em class="property">const</em> std::vector&lt;double&gt; &amp;<em>x_grid</em>, <em class="property">const</em> std::vector&lt;double&gt; &amp;<em>y_grid</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF19PiecewiseBicubicMap19PiecewiseBicubicMapERKN5Eigen8VectorXdERKNSt6vectorIdEERKNSt6vectorIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> map from a given polynomial expansion of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> parameters. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">expansion_coef</span></code>: The coefficients of the polynomial expansion of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> parameters. Should consist of 4 parts of equal length, giving the expansion of the values, x derivatives, y derivatives and xy cross-derivatives at each grid point. In each part, the polynomial expansion coefficients for a single grid intersection are sequential in memory, with each row of grid intersections occupying a contiguous block. </li>
<li><code class="docutils literal"><span class="pre">x_grid</span></code>: The x coordinates of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> cell boundaries. </li>
<li><code class="docutils literal"><span class="pre">y_grid</span></code>: The y coordinates of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> cell boundaries. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF19PiecewiseBicubicMap6x_gridEv">
<span id="PSF::PiecewiseBicubicMap::x_gridC"></span><span class="target" id="classPSF_1_1PiecewiseBicubicMap_1ac50c24ada8dfcf3faf5021ef36f6e7bf"></span><em class="property">const</em> std::vector&lt;double&gt; &amp;<code class="descname">x_grid</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF19PiecewiseBicubicMap6x_gridEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The horizontal boundaries between <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> grid cells. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF19PiecewiseBicubicMap6y_gridEv">
<span id="PSF::PiecewiseBicubicMap::y_gridC"></span><span class="target" id="classPSF_1_1PiecewiseBicubicMap_1a6f1f38057ec3c219517e8c9c0a2704cd"></span><em class="property">const</em> std::vector&lt;double&gt; &amp;<code class="descname">y_grid</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF19PiecewiseBicubicMap6y_gridEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The vertical boundaries between <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> grid cells. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF19PiecewiseBicubicMap12coefficientsEv">
<span id="PSF::PiecewiseBicubicMap::coefficientsC"></span><span class="target" id="classPSF_1_1PiecewiseBicubicMap_1ac7570e0c4c757fe6eb8a3ef8cddc6738"></span><em class="property">const</em> double *<code class="descname">coefficients</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF19PiecewiseBicubicMap12coefficientsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The underlying <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> fit coefficients (as given by <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> fitting) </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF19PiecewiseBicubicMap7get_psfERKN5Eigen8VectorXdEd">
<span id="PSF::PiecewiseBicubicMap::get_psf__Eigen::VectorXdCR.doubleC"></span><span class="target" id="classPSF_1_1PiecewiseBicubicMap_1a0336f5d3234d28022797cb4b7159853f"></span><a class="reference internal" href="#_CPPv2N3PSF16PiecewiseBicubicE" title="PSF::PiecewiseBicubic">PiecewiseBicubic</a> *<code class="descname">get_psf</code><span class="sig-paren">(</span><em class="property">const</em> Eigen::VectorXd &amp;<em>terms</em>, double <em>background</em> = 0<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF19PiecewiseBicubicMap7get_psfERKN5Eigen8VectorXdEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">terms</span></code>: The values of the terms on which the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> map depends. </li>
<li><code class="docutils literal"><span class="pre">background</span></code>: Background to add to the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> (assumed constant) normalized in the same way as the backgroundless PSFs produced by the map. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF19PiecewiseBicubicMapclERKN5Eigen8VectorXdEd">
<span id="PSF::PiecewiseBicubicMap::call-operator__Eigen::VectorXdCR.doubleC"></span><span class="target" id="classPSF_1_1PiecewiseBicubicMap_1a47c2ada5e56989bf0ae7071eb8b8c8b6"></span><a class="reference internal" href="#_CPPv2N3PSF16PiecewiseBicubicE" title="PSF::PiecewiseBicubic">PiecewiseBicubic</a> *<code class="descname">operator()</code><span class="sig-paren">(</span><em class="property">const</em> Eigen::VectorXd &amp;<em>terms</em>, double <em>background</em> = 0<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF19PiecewiseBicubicMapclERKN5Eigen8VectorXdEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A reference to a dynamically allocated <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a>. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">terms</span></code>: The values of the terms on which the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> map depends. </li>
<li><code class="docutils literal"><span class="pre">background</span></code>: Background to add to the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> (assumed constant) normalized in the same way as the backgroundless PSFs produced by the map. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Static Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF19PiecewiseBicubicMap29required_data_tree_quantitiesEv">
<span id="PSF::PiecewiseBicubicMap::required_data_tree_quantities"></span><span class="target" id="classPSF_1_1PiecewiseBicubicMap_1a8a454178ce2ea12618360a0bb3071460"></span><em class="property">const</em> std::set&lt;std::string&gt; &amp;<code class="descname">required_data_tree_quantities</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF19PiecewiseBicubicMap29required_data_tree_quantitiesEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>All quantities needed to construct the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> map from an I/O data tree. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF19PiecewiseBicubicMap17fill_coefficientsERK11VECTOR_TYPE">
<span id="PSF::PiecewiseBicubicMap::fill_coefficients__VECTOR_TYPECR"></span><em class="property">template </em>&lt;<em class="property">class</em> VECTOR_TYPE&gt;<br /><span class="target" id="classPSF_1_1PiecewiseBicubicMap_1ac04f639d4454d247753a93d13f5a26eb"></span>void <code class="descname">fill_coefficients</code><span class="sig-paren">(</span><em class="property">const</em> VECTOR_TYPE &amp;<em>coefficient_vector</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF19PiecewiseBicubicMap17fill_coefficientsERK11VECTOR_TYPE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fills the coefficients for a vector of values. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">coefficient_vector</span></code>: The values of the coefficients as they are returned by <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> fitting. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N3PSF19PiecewiseBicubicMap8__x_gridE">
<span id="PSF::PiecewiseBicubicMap::__x_grid__std::vector:double:"></span><span class="target" id="classPSF_1_1PiecewiseBicubicMap_1a225396ece9e9ca58a4bf3d7f1b094298"></span>std::vector&lt;double&gt; <code class="descname">__x_grid</code><a class="headerlink" href="#_CPPv2N3PSF19PiecewiseBicubicMap8__x_gridE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The horizontal boundaries between <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> grid cells. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19PiecewiseBicubicMap8__y_gridE">
<span id="PSF::PiecewiseBicubicMap::__y_grid__std::vector:double:"></span><span class="target" id="classPSF_1_1PiecewiseBicubicMap_1ab85d6ddcfe120204f94dcb6c55b29e45"></span>std::vector&lt;double&gt; <code class="descname">__y_grid</code><a class="headerlink" href="#_CPPv2N3PSF19PiecewiseBicubicMap8__y_gridE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The vertical boundaries between <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> grid cells. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19PiecewiseBicubicMap14__coefficientsE">
<span id="PSF::PiecewiseBicubicMap::__coefficients__doubleCP"></span><span class="target" id="classPSF_1_1PiecewiseBicubicMap_1a34c8eeb61b0e2ebcf52b013df592f45f"></span><em class="property">const</em> double *<code class="descname">__coefficients</code><a class="headerlink" href="#_CPPv2N3PSF19PiecewiseBicubicMap14__coefficientsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A direct pointer to the coefficients as read from a file. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19PiecewiseBicubicMap17__value_expansionE">
<span id="PSF::PiecewiseBicubicMap::__value_expansion__Eigen::MatrixXd"></span><span class="target" id="classPSF_1_1PiecewiseBicubicMap_1ae321a94ad24842c3de68872075b0c0bd"></span>Eigen::MatrixXd <code class="descname">__value_expansion</code><a class="headerlink" href="#_CPPv2N3PSF19PiecewiseBicubicMap17__value_expansionE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Apply to a vector of polynomial terms to get the values of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> at the grid intersections. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19PiecewiseBicubicMap19__x_deriv_expansionE">
<span id="PSF::PiecewiseBicubicMap::__x_deriv_expansion__Eigen::MatrixXd"></span><span class="target" id="classPSF_1_1PiecewiseBicubicMap_1afb3bb6cda518abe54fb1534ac740ff06"></span>Eigen::MatrixXd <code class="descname">__x_deriv_expansion</code><a class="headerlink" href="#_CPPv2N3PSF19PiecewiseBicubicMap19__x_deriv_expansionE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Apply to a vector of polynomial terms to get the x derivatives of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> at the grid intersections. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19PiecewiseBicubicMap19__y_deriv_expansionE">
<span id="PSF::PiecewiseBicubicMap::__y_deriv_expansion__Eigen::MatrixXd"></span><span class="target" id="classPSF_1_1PiecewiseBicubicMap_1aac969c81534debc1d845a544a7e54339"></span>Eigen::MatrixXd <code class="descname">__y_deriv_expansion</code><a class="headerlink" href="#_CPPv2N3PSF19PiecewiseBicubicMap19__y_deriv_expansionE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Apply to a vector of polynomial terms to get the y derivatives of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> at the grid intersections. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19PiecewiseBicubicMap20__xy_deriv_expansionE">
<span id="PSF::PiecewiseBicubicMap::__xy_deriv_expansion__Eigen::MatrixXd"></span><span class="target" id="classPSF_1_1PiecewiseBicubicMap_1ae90414579aa17aed52c845edc5d612bc"></span>Eigen::MatrixXd <code class="descname">__xy_deriv_expansion</code><a class="headerlink" href="#_CPPv2N3PSF19PiecewiseBicubicMap20__xy_deriv_expansionE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Apply to a vector of polynomial terms to get the x-y cross derivatives of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> at the grid intersections. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19PiecewiseBicubicMap15__expanded_leftE">
<span id="PSF::PiecewiseBicubicMap::__expanded_left__short"></span><span class="target" id="classPSF_1_1PiecewiseBicubicMap_1a84900f0a07ce88191971e9c44ef5ea50"></span>short <code class="descname">__expanded_left</code><a class="headerlink" href="#_CPPv2N3PSF19PiecewiseBicubicMap15__expanded_leftE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Was the x grid expanded to the left (1: yes, 0: no)? </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19PiecewiseBicubicMap16__expanded_rightE">
<span id="PSF::PiecewiseBicubicMap::__expanded_right__short"></span><span class="target" id="classPSF_1_1PiecewiseBicubicMap_1a578cc6fc51dccd2d9e284cdc41a7cbb5"></span>short <code class="descname">__expanded_right</code><a class="headerlink" href="#_CPPv2N3PSF19PiecewiseBicubicMap16__expanded_rightE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Was the x grid expanded to the right (1: yes, 0: no)? </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19PiecewiseBicubicMap13__expanded_upE">
<span id="PSF::PiecewiseBicubicMap::__expanded_up__short"></span><span class="target" id="classPSF_1_1PiecewiseBicubicMap_1abc7d07159eb63bcc8a5dda546b53a01b"></span>short <code class="descname">__expanded_up</code><a class="headerlink" href="#_CPPv2N3PSF19PiecewiseBicubicMap13__expanded_upE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Was the y grid expanded upward (1: yes, 0: no)? </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF19PiecewiseBicubicMap15__expanded_downE">
<span id="PSF::PiecewiseBicubicMap::__expanded_down__short"></span><span class="target" id="classPSF_1_1PiecewiseBicubicMap_1a1b6eac6fcc57c1e1debf5ea0d87dbaba"></span>short <code class="descname">__expanded_down</code><a class="headerlink" href="#_CPPv2N3PSF19PiecewiseBicubicMap15__expanded_downE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Was the y grid expanded downward (1: yes, 0: no)? </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N3PSF13PiecewiseCellE">
<span id="PSF::PiecewiseCell"></span><span class="target" id="classPSF_1_1PiecewiseCell"></span><em class="property">class </em><code class="descname">PiecewiseCell</code><a class="headerlink" href="#_CPPv2N3PSF13PiecewiseCellE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;PiecewiseCell.h&gt;</em><p>An abstract base class for all cell of a Piecesiwe. </p>
<p>Subclassed by <a class="reference internal" href="#classPSF_1_1PiecewiseBicubicCell"><span class="std std-ref">PSF::PiecewiseBicubicCell</span></a></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF13PiecewiseCell13PiecewiseCellEdd">
<span id="PSF::PiecewiseCell::PiecewiseCell__double.double"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a736eae74f49582aa9ba6347becbf73ba"></span><code class="descname">PiecewiseCell</code><span class="sig-paren">(</span>double <em>horizontal_size</em>, double <em>vertical_size</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF13PiecewiseCell13PiecewiseCellEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a cell with the given horizontal and vertical sizes. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell19integrate_rectangleEdddd">
<span id="PSF::PiecewiseCell::integrate_rectangle__double.double.double.doubleC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a1972e1ffed48c1325b767262efe4032d"></span><em class="property">virtual</em> double <code class="descname">integrate_rectangle</code><span class="sig-paren">(</span>double <em>xmin</em>, double <em>xmax</em>, double <em>ymin</em>, double <em>ymax</em><span class="sig-paren">)</span> <em class="property">const</em> = 0<a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell19integrate_rectangleEdddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate the integral of the intensity over a rectangle that is contained entirely within the cell. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">xmin</span></code>: The left boundary of the rectangle. Must lie between the horizontal cell boundaries. Defined relative to the left cell boundary. </li>
<li><code class="docutils literal"><span class="pre">xmax</span></code>: The right boundary of the rectangle. Must lie between the horizontal cell boundaries. Defined relative to the left cell boundary. </li>
<li><code class="docutils literal"><span class="pre">ymin</span></code>: The bottom boundary of the rectangle. Must lie between the vertical cell boundaries. Defined relative to the bottom cell boundary. </li>
<li><code class="docutils literal"><span class="pre">ymax</span></code>: The top boundary of the rectangle. Must lie between the vertical cell boundaries. Defined relative to the bottom cell boundary. </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSFCell_integrate_rectangle_dddd.png" src="_images/PiecewisePSFCell_integrate_rectangle_dddd.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell19integrate_rectangleEddddRKNSt8valarrayIdEE">
<span id="PSF::PiecewiseCell::integrate_rectangle__double.double.double.double.std::valarray:double:CRC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1ac80752936bea6554c96f21a4d7462aa3"></span><em class="property">virtual</em> std::valarray&lt;double&gt; <code class="descname">integrate_rectangle</code><span class="sig-paren">(</span>double <em>xmin</em>, double <em>xmax</em>, double <em>ymin</em>, double <em>ymax</em>, <em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>coef_sets</em><span class="sig-paren">)</span> <em class="property">const</em> = 0<a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell19integrate_rectangleEddddRKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate the integral of the intensity over a rectangle that is contained entirely within the cell. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">xmin</span></code>: The left boundary of the rectangle. Must lie between the horizontal cell boundaries. Defined relative to the left cell boundary. </li>
<li><code class="docutils literal"><span class="pre">xmax</span></code>: The right boundary of the rectangle. Must lie between the horizontal cell boundaries. Defined relative to the left cell boundary. </li>
<li><code class="docutils literal"><span class="pre">ymin</span></code>: The bottom boundary of the rectangle. Must lie between the vertical cell boundaries. Defined relative to the bottom cell boundary. </li>
<li><code class="docutils literal"><span class="pre">ymax</span></code>: The top boundary of the rectangle. Must lie between the vertical cell boundaries. Defined relative to the bottom cell boundary. </li>
<li><code class="docutils literal"><span class="pre">coef_sets</span></code>: The sets of coefficients to compute the integral for. Each set must contain 16 coefficients and the sets are concatenated. </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSFCell_integrate_rectangle_dddd.png" src="_images/PiecewisePSFCell_integrate_rectangle_dddd.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell23integrate_hcircle_pieceEdddddd">
<span id="PSF::PiecewiseCell::integrate_hcircle_piece__double.double.double.double.double.doubleC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1acc985c0dc8829e1d7328c1eeada97840"></span><em class="property">virtual</em> double <code class="descname">integrate_hcircle_piece</code><span class="sig-paren">(</span>double <em>ymin</em>, double <em>ymax</em>, double <em>xbound</em>, double <em>radius</em>, double <em>circle_x</em>, double <em>circle_y</em><span class="sig-paren">)</span> <em class="property">const</em> = 0<a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell23integrate_hcircle_pieceEdddddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Integrate the intensity over a region bounded by one vertical, two horizontal lines and an arc that intersects the two horizontal lines. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">ymin</span></code>: The bottom boundary of the region. </li>
<li><code class="docutils literal"><span class="pre">ymax</span></code>: The top boundary of the region. </li>
<li><code class="docutils literal"><span class="pre">xbound</span></code>: The straight vertical boundary of the region. </li>
<li><code class="docutils literal"><span class="pre">radius</span></code>: The radius of the circle the bounding arc is part of. </li>
<li><code class="docutils literal"><span class="pre">circle_x</span></code>: The x coordinate of the circle center relative to the cell center. </li>
<li><code class="docutils literal"><span class="pre">circle_y</span></code>: The y coordinate of the circle center relative to the cell center. </li>
</ul>
</dd>
</dl>
</p>
<p><p>. </p>
<img alt="_images/PiecewisePSFCell_integrate_hcircle_piece_dddddd.png" src="_images/PiecewisePSFCell_integrate_hcircle_piece_dddddd.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell23integrate_vcircle_pieceEdddddd">
<span id="PSF::PiecewiseCell::integrate_vcircle_piece__double.double.double.double.double.doubleC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1ac421496a8f1d44b73356285431a0e40b"></span><em class="property">virtual</em> double <code class="descname">integrate_vcircle_piece</code><span class="sig-paren">(</span>double <em>xmin</em>, double <em>xmax</em>, double <em>ybound</em>, double <em>radius</em>, double <em>circle_x</em>, double <em>circle_y</em><span class="sig-paren">)</span> <em class="property">const</em> = 0<a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell23integrate_vcircle_pieceEdddddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Integrate the intensity over a region bounded by one horizontal, two vertical lines and an arc that intersects the two horizontal lines. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">xmin</span></code>: The left boundary of the region. </li>
<li><code class="docutils literal"><span class="pre">xmax</span></code>: The right boundary of the region. </li>
<li><code class="docutils literal"><span class="pre">ybound</span></code>: The straight horizontal boundary of the region. </li>
<li><code class="docutils literal"><span class="pre">radius</span></code>: The radius of the circle the bounding arc is part of. </li>
<li><code class="docutils literal"><span class="pre">circle_x</span></code>: The x coordinate of the circle center relative to the cell center. </li>
<li><code class="docutils literal"><span class="pre">circle_y</span></code>: The y coordinate of the circle center relative to the cell center. </li>
</ul>
</dd>
</dl>
</p>
<p><p>. </p>
<img alt="_images/PiecewisePSFCell_integrate_vcircle_piece_dddddd.png" src="_images/PiecewisePSFCell_integrate_vcircle_piece_dddddd.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell23integrate_partial_vspanEdddb">
<span id="PSF::PiecewiseCell::integrate_partial_vspan__double.double.double.bC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a05d0405902038032a4b2e2a54ea74b40"></span><em class="property">virtual</em> double <code class="descname">integrate_partial_vspan</code><span class="sig-paren">(</span>double <em>x_min</em>, double <em>x_max</em>, double <em>y</em>, bool <em>up</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell23integrate_partial_vspanEdddb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate the integral of the intensity over a rectangle spanning the cell partially in the vertical direction. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x_min</span></code>: The left boundary of the rectangle. Must lie between the horizontal cell boundaries. Defined relative to the left cell boundary. </li>
<li><code class="docutils literal"><span class="pre">x_max</span></code>: The right boundary of the rectangle. Must lie between the horizontal cell boundaries. Defined relative to the left cell boundary. </li>
<li><code class="docutils literal"><span class="pre">y</span></code>: The bottom/top y boundary of the rectangle if top is true/false. The other boundary is the top/bottom cell boundary. Defined relative to the bottom cell boundary. </li>
<li><code class="docutils literal"><span class="pre">up</span></code>: Wether the rectangle extends upward of y. </li>
</ul>
</dd>
</dl>
</p>
<p><p>. </p>
<img alt="_images/PiecewisePSFCell_integrate_partial_vspan_dddb.png" src="_images/PiecewisePSFCell_integrate_partial_vspan_dddb.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell23integrate_partial_vspanEdddbRKNSt8valarrayIdEE">
<span id="PSF::PiecewiseCell::integrate_partial_vspan__double.double.double.b.std::valarray:double:CRC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1aec017594e5e79468cb12969285019f5b"></span><em class="property">virtual</em> std::valarray&lt;double&gt; <code class="descname">integrate_partial_vspan</code><span class="sig-paren">(</span>double <em>x_min</em>, double <em>x_max</em>, double <em>y</em>, bool <em>up</em>, <em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>coef_sets</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell23integrate_partial_vspanEdddbRKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate the integral of the intensity over a rectangle spanning the cell partially in the vertical direction. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x_min</span></code>: The left boundary of the rectangle. Must lie between the horizontal cell boundaries. Defined relative to the left cell boundary. </li>
<li><code class="docutils literal"><span class="pre">x_max</span></code>: The right boundary of the rectangle. Must lie between the horizontal cell boundaries. Defined relative to the left cell boundary. </li>
<li><code class="docutils literal"><span class="pre">y</span></code>: The bottom/top y boundary of the rectangle if top is true/false. The other boundary is the top/bottom cell boundary. Defined relative to the bottom cell boundary. </li>
<li><code class="docutils literal"><span class="pre">up</span></code>: Wether the rectangle extends upward of y. </li>
<li><code class="docutils literal"><span class="pre">coef_sets</span></code>: The sets of coefficients to compute the integral for. Each set must contain 16 coefficients and the sets are concatenated. </li>
</ul>
</dd>
</dl>
</p>
<p><p>. </p>
<img alt="_images/PiecewisePSFCell_integrate_partial_vspan_dddb.png" src="_images/PiecewisePSFCell_integrate_partial_vspan_dddb.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell23integrate_partial_hspanEdddb">
<span id="PSF::PiecewiseCell::integrate_partial_hspan__double.double.double.bC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a66911788792c263ab9cba5526e782ae8"></span><em class="property">virtual</em> double <code class="descname">integrate_partial_hspan</code><span class="sig-paren">(</span>double <em>y_min</em>, double <em>y_max</em>, double <em>x</em>, bool <em>right</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell23integrate_partial_hspanEdddb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate the integral of the intensity over a rectangle spanning the cell partially in the horizontal direction.. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">y_min</span></code>: The bottom boundary of the rectangle. Must lie between the vertical cell boundaries. Defined relative to the bottom cell boundary. </li>
<li><code class="docutils literal"><span class="pre">y_max</span></code>: The top boundary of the rectangle. Must lie between the vertical cell boundaries. Defined relative to the bottom cell boundary. </li>
<li><code class="docutils literal"><span class="pre">x</span></code>: The left/right y boundary of the rectangle if right is true/false. The other boundary is the right/left cell boundary. Defined relative to the left cell boundary. </li>
<li><code class="docutils literal"><span class="pre">right</span></code>: Wether the rectangle extends rightward of x. </li>
</ul>
</dd>
</dl>
</p>
<p><p>. </p>
<img alt="_images/PiecewisePSFCell_integrate_partial_hspan_dddb.png" src="_images/PiecewisePSFCell_integrate_partial_hspan_dddb.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell23integrate_partial_hspanEdddbRKNSt8valarrayIdEE">
<span id="PSF::PiecewiseCell::integrate_partial_hspan__double.double.double.b.std::valarray:double:CRC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a5df36cb62fa799c32de6e622aa461764"></span><em class="property">virtual</em> std::valarray&lt;double&gt; <code class="descname">integrate_partial_hspan</code><span class="sig-paren">(</span>double <em>y_min</em>, double <em>y_max</em>, double <em>x</em>, bool <em>right</em>, <em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>coef_sets</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell23integrate_partial_hspanEdddbRKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate the integral of the intensity over a rectangle spanning the cell partially in the horizontal direction.. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">y_min</span></code>: The bottom boundary of the rectangle. Must lie between the vertical cell boundaries. Defined relative to the bottom cell boundary. </li>
<li><code class="docutils literal"><span class="pre">y_max</span></code>: The top boundary of the rectangle. Must lie between the vertical cell boundaries. Defined relative to the bottom cell boundary. </li>
<li><code class="docutils literal"><span class="pre">x</span></code>: The left/right y boundary of the rectangle if right is true/false. The other boundary is the right/left cell boundary. Defined relative to the left cell boundary. </li>
<li><code class="docutils literal"><span class="pre">right</span></code>: Wether the rectangle extends rightward of x. </li>
<li><code class="docutils literal"><span class="pre">coef_sets</span></code>: The sets of coefficients to compute the integral for. Each set must contain 16 coefficients and the sets are concatenated. </li>
</ul>
</dd>
</dl>
</p>
<p><p>. </p>
<img alt="_images/PiecewisePSFCell_integrate_partial_hspan_dddb.png" src="_images/PiecewisePSFCell_integrate_partial_hspan_dddb.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell9integrateEv">
<span id="PSF::PiecewiseCell::integrateC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1add76105271aeeffb68c26ada9f2d6f73"></span><em class="property">virtual</em> double <code class="descname">integrate</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell9integrateEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate the integral of the intensity over the enitire cell. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell9integrateERKNSt8valarrayIdEE">
<span id="PSF::PiecewiseCell::integrate__std::valarray:double:CRC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1adeeda35eedcf23984e7354f7a4d05c70"></span><em class="property">virtual</em> std::valarray&lt;double&gt; <code class="descname">integrate</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>coef_sets</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell9integrateERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate the integral of the intensity over the enitire cell. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">coef_sets</span></code>: The sets of coefficients to compute the integral for. Each set must contain 16 coefficients and the sets are concatenated. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell15integrate_vspanEdd">
<span id="PSF::PiecewiseCell::integrate_vspan__double.doubleC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a3807f679d93b0717d555c5062403e1e1"></span><em class="property">virtual</em> double <code class="descname">integrate_vspan</code><span class="sig-paren">(</span>double <em>x_min</em>, double <em>x_max</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell15integrate_vspanEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate the integral of the intensity over a rectangle spanning the cell fully in the vertical direction.. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x_min</span></code>: The left boundary of the rectangle. Must lie between the horizontal cell boundaries. Defined relative to the left cell boundary. </li>
<li><code class="docutils literal"><span class="pre">x_max</span></code>: The right boundary of the rectangle. Must lie between the horizontal cell boundaries. Defined relative to the left cell boundary. </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSFCell_integrate_vspan_dd.png" src="_images/PiecewisePSFCell_integrate_vspan_dd.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell15integrate_vspanEddRKNSt8valarrayIdEE">
<span id="PSF::PiecewiseCell::integrate_vspan__double.double.std::valarray:double:CRC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1abaede043e6dd659ecd43f1e910c74771"></span><em class="property">virtual</em> std::valarray&lt;double&gt; <code class="descname">integrate_vspan</code><span class="sig-paren">(</span>double <em>x_min</em>, double <em>x_max</em>, <em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>coef_sets</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell15integrate_vspanEddRKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate the integral of the intensity over a rectangle spanning the cell fully in the vertical direction.. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x_min</span></code>: The left boundary of the rectangle. Must lie between the horizontal cell boundaries. Defined relative to the left cell boundary. </li>
<li><code class="docutils literal"><span class="pre">x_max</span></code>: The right boundary of the rectangle. Must lie between the horizontal cell boundaries. Defined relative to the left cell boundary. </li>
<li><code class="docutils literal"><span class="pre">coef_sets</span></code>: The sets of coefficients to compute the integral for. Each set must contain 16 coefficients and the sets are concatenated. </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSFCell_integrate_vspan_dd.png" src="_images/PiecewisePSFCell_integrate_vspan_dd.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell15integrate_hspanEdd">
<span id="PSF::PiecewiseCell::integrate_hspan__double.doubleC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1af66efa0e4f91e6f8aed7cefa28c80807"></span><em class="property">virtual</em> double <code class="descname">integrate_hspan</code><span class="sig-paren">(</span>double <em>y_min</em>, double <em>y_max</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell15integrate_hspanEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate the integral of the intensity over a rectangle spanning the cell fully in the horizontal direction.. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">y_min</span></code>: The bottom boundary of the rectangle. Must lie between the vertical cell boundaries. Defined relative to the bottom cell boundary. </li>
<li><code class="docutils literal"><span class="pre">y_max</span></code>: The top boundary of the rectangle. Must lie between the vertical cell boundaries. Defined relative to the bottom cell boundary. </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSFCell_integrate_hspan_dd.png" src="_images/PiecewisePSFCell_integrate_hspan_dd.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell15integrate_hspanEddRKNSt8valarrayIdEE">
<span id="PSF::PiecewiseCell::integrate_hspan__double.double.std::valarray:double:CRC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a70433896e0139f5322f0a3a37f506f65"></span><em class="property">virtual</em> std::valarray&lt;double&gt; <code class="descname">integrate_hspan</code><span class="sig-paren">(</span>double <em>y_min</em>, double <em>y_max</em>, <em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>coef_sets</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell15integrate_hspanEddRKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate the integral of the intensity over a rectangle spanning the cell fully in the horizontal direction.. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">y_min</span></code>: The bottom boundary of the rectangle. Must lie between the vertical cell boundaries. Defined relative to the bottom cell boundary. </li>
<li><code class="docutils literal"><span class="pre">y_max</span></code>: The top boundary of the rectangle. Must lie between the vertical cell boundaries. Defined relative to the bottom cell boundary. </li>
<li><code class="docutils literal"><span class="pre">coef_sets</span></code>: The sets of coefficients to compute the integral for. Each set must contain 16 coefficients and the sets are concatenated. </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSFCell_integrate_hspan_dd.png" src="_images/PiecewisePSFCell_integrate_hspan_dd.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell15integrate_vspanEdb">
<span id="PSF::PiecewiseCell::integrate_vspan__double.bC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a8910909ff0bb2b46e30c3f83370ac5ee"></span><em class="property">virtual</em> double <code class="descname">integrate_vspan</code><span class="sig-paren">(</span>double <em>x</em>, bool <em>right</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell15integrate_vspanEdb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate the integral of the intensity over a rectangle spanning the cell fully in the vertical direction.. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x</span></code>: The left/right boundary of the rectangle if right is true/false the other boundary is the right/left cell boundary. Must lie between the horizontal cell boundaries. Defined relative to the left cell boundary. </li>
<li><code class="docutils literal"><span class="pre">right</span></code>: Does the rectangle extend rightward of the x argument? </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSFCell_integrate_vspan_db.png" src="_images/PiecewisePSFCell_integrate_vspan_db.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell15integrate_vspanEdbRKNSt8valarrayIdEE">
<span id="PSF::PiecewiseCell::integrate_vspan__double.b.std::valarray:double:CRC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1aafff3136497827394320baa92ea21304"></span><em class="property">virtual</em> std::valarray&lt;double&gt; <code class="descname">integrate_vspan</code><span class="sig-paren">(</span>double <em>x</em>, bool <em>right</em>, <em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>coef_sets</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell15integrate_vspanEdbRKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate the integral of the intensity over a rectangle spanning the cell fully in the vertical direction.. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x</span></code>: The left/right boundary of the rectangle if right is true/false the other boundary is the right/left cell boundary. Must lie between the horizontal cell boundaries. Defined relative to the left cell boundary. </li>
<li><code class="docutils literal"><span class="pre">right</span></code>: Does the rectangle extend rightward of the x argument? </li>
<li><code class="docutils literal"><span class="pre">coef_sets</span></code>: The sets of coefficients to compute the integral for. Each set must contain 16 coefficients and the sets are concatenated. </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSFCell_integrate_vspan_db.png" src="_images/PiecewisePSFCell_integrate_vspan_db.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell15integrate_hspanEdb">
<span id="PSF::PiecewiseCell::integrate_hspan__double.bC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a9fdf2ac34601bd1fe80872804e50532c"></span><em class="property">virtual</em> double <code class="descname">integrate_hspan</code><span class="sig-paren">(</span>double <em>y</em>, bool <em>up</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell15integrate_hspanEdb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate the integral of the intensity over a rectangle spanning the cell fully in the horizontal direction.. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">y</span></code>: The top/bottom boundary of the rectangle if top is false/true the other boundary is the bottom/top cell boundary. Must lie between the vertical cell boundaries. Defined relative to the bottom cell boundary. </li>
<li><code class="docutils literal"><span class="pre">up</span></code>: Does the rectangle extend upward of the y argument? </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSFCell_integrate_hspan_db.png" src="_images/PiecewisePSFCell_integrate_hspan_db.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell15integrate_hspanEdbRKNSt8valarrayIdEE">
<span id="PSF::PiecewiseCell::integrate_hspan__double.b.std::valarray:double:CRC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a20b81a06a6ce88f5ddf22c3393df0d40"></span><em class="property">virtual</em> std::valarray&lt;double&gt; <code class="descname">integrate_hspan</code><span class="sig-paren">(</span>double <em>y</em>, bool <em>up</em>, <em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>coef_sets</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell15integrate_hspanEdbRKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculate the integral of the intensity over a rectangle spanning the cell fully in the horizontal direction.. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">y</span></code>: The top/bottom boundary of the rectangle if top is false/true the other boundary is the bottom/top cell boundary. Must lie between the vertical cell boundaries. Defined relative to the bottom cell boundary. </li>
<li><code class="docutils literal"><span class="pre">up</span></code>: Does the rectangle extend upward of the y argument? </li>
<li><code class="docutils literal"><span class="pre">coef_sets</span></code>: The sets of coefficients to compute the integral for. Each set must contain 16 coefficients and the sets are concatenated. </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSFCell_integrate_hspan_db.png" src="_images/PiecewisePSFCell_integrate_hspan_db.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell19integrate_rectangleEddbb">
<span id="PSF::PiecewiseCell::integrate_rectangle__double.double.b.bC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a58d25366d8dbff9e262c4f63c2cb697e"></span><em class="property">virtual</em> double <code class="descname">integrate_rectangle</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em>, bool <em>right</em>, bool <em>up</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell19integrate_rectangleEddbb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x</span></code>: The left/right boundary of the rectangle if right is true/false the other boundary is the right/left cell boundary. Must lie between the horizontal cell boundaries. Defined relative to the left cell boundary. </li>
<li><code class="docutils literal"><span class="pre">y</span></code>: The top/bottom boundary of the rectangle if top is false/true the other boundary is the bottom/top cell boundary. Must lie between the vertical cell boundaries. Defined relative to the bottom cell boundary. </li>
<li><code class="docutils literal"><span class="pre">right</span></code>: Does the rectangle extend rightward of the x argument? </li>
<li><code class="docutils literal"><span class="pre">up</span></code>: Does the rectangle extend upward of the y argument? </li>
</ul>
</dd>
</dl>
</p>
<p>Calculate the integral of the intensity over a rectangle.</p>
<p><img alt="_images/PiecewisePSFCell_integrate_rectangle_ddbb.png" src="_images/PiecewisePSFCell_integrate_rectangle_ddbb.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell19integrate_rectangleEddbbRKNSt8valarrayIdEE">
<span id="PSF::PiecewiseCell::integrate_rectangle__double.double.b.b.std::valarray:double:CRC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a0444192f19e6263575394942c9a125f6"></span><em class="property">virtual</em> std::valarray&lt;double&gt; <code class="descname">integrate_rectangle</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em>, bool <em>right</em>, bool <em>up</em>, <em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>coef_sets</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell19integrate_rectangleEddbbRKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x</span></code>: The left/right boundary of the rectangle if right is true/false the other boundary is the right/left cell boundary. Must lie between the horizontal cell boundaries. Defined relative to the left cell boundary. </li>
<li><code class="docutils literal"><span class="pre">y</span></code>: The top/bottom boundary of the rectangle if top is false/true the other boundary is the bottom/top cell boundary. Must lie between the vertical cell boundaries. Defined relative to the bottom cell boundary. </li>
<li><code class="docutils literal"><span class="pre">right</span></code>: Does the rectangle extend rightward of the x argument? </li>
<li><code class="docutils literal"><span class="pre">up</span></code>: Does the rectangle extend upward of the y argument? </li>
<li><code class="docutils literal"><span class="pre">coef_sets</span></code>: The sets of coefficients to compute the integral for. Each set must contain 16 coefficients and the sets are concatenated. </li>
</ul>
</dd>
</dl>
</p>
<p>Calculate the integral of the intensity over a rectangle.</p>
<p><img alt="_images/PiecewisePSFCell_integrate_rectangle_ddbb.png" src="_images/PiecewisePSFCell_integrate_rectangle_ddbb.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell23integrate_hcircle_pieceEdddddb">
<span id="PSF::PiecewiseCell::integrate_hcircle_piece__double.double.double.double.double.bC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a53646c2ceb6ce4ae6131997a459c9a5e"></span><em class="property">virtual</em> double <code class="descname">integrate_hcircle_piece</code><span class="sig-paren">(</span>double <em>ybound</em>, double <em>xbound</em>, double <em>radius</em>, double <em>circle_x</em>, double <em>circle_y</em>, bool <em>up</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell23integrate_hcircle_pieceEdddddb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Same as integrate_hcircle_piece(double, double, double, double, double, double) but with either the top or the bottom boundary coinciding with the cell&#8217;s. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">ybound</span></code>: The top/bottom boundary of the region if up is false/true. </li>
<li><code class="docutils literal"><span class="pre">xbound</span></code>: The straight vertical boundary of the region. </li>
<li><code class="docutils literal"><span class="pre">radius</span></code>: The radius of the circle the bounding arc is part of. </li>
<li><code class="docutils literal"><span class="pre">circle_x</span></code>: The x coordinate of the circle center relative to the cell center. </li>
<li><code class="docutils literal"><span class="pre">circle_y</span></code>: The y coordinate of the circle center relative to the cell center. </li>
<li><code class="docutils literal"><span class="pre">up</span></code>: Wether the region extends upwards from ybound. </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSFCell_integrate_hcircle_piece_dddddb.png" src="_images/PiecewisePSFCell_integrate_hcircle_piece_dddddb.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell23integrate_hcircle_pieceEddddd">
<span id="PSF::PiecewiseCell::integrate_hcircle_piece__double.double.double.double.doubleC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a4dc2a01bf42a1fc073bc8688255922a5"></span><em class="property">virtual</em> double <code class="descname">integrate_hcircle_piece</code><span class="sig-paren">(</span>double <em>ymin</em>, double <em>ymax</em>, double <em>radius</em>, double <em>circle_x</em>, double <em>circle_y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell23integrate_hcircle_pieceEddddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Same as integrate_hcircle_piece(double, double, double, double, double, double) but with the vertical boundary coinciding with the cell wall inside the circle of the boundinc arc. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">ymin</span></code>: The bottom boundary of the region. </li>
<li><code class="docutils literal"><span class="pre">ymax</span></code>: The top boundary of the region. </li>
<li><code class="docutils literal"><span class="pre">radius</span></code>: The radius of the circle the bounding arc is part of. </li>
<li><code class="docutils literal"><span class="pre">circle_x</span></code>: The x coordinate of the circle center relative to the cell center. </li>
<li><code class="docutils literal"><span class="pre">circle_y</span></code>: The y coordinate of the circle center relative to the cell center. </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSFCell_integrate_hcircle_piece_ddddd.png" src="_images/PiecewisePSFCell_integrate_hcircle_piece_ddddd.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell23integrate_hcircle_pieceEdddd">
<span id="PSF::PiecewiseCell::integrate_hcircle_piece__double.double.double.doubleC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1aaffd3d658fbf7b72c7543786a2ccd01b"></span><em class="property">virtual</em> double <code class="descname">integrate_hcircle_piece</code><span class="sig-paren">(</span>double <em>xbound</em>, double <em>radius</em>, double <em>circle_x</em>, double <em>circle_y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell23integrate_hcircle_pieceEdddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Same as integrate_hcircle_piece(double, double, double, double, double, double) but with both the top and the bottom boundary coinciding with the cell&#8217;s. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">xbound</span></code>: The straight vertical boundary of the region. </li>
<li><code class="docutils literal"><span class="pre">radius</span></code>: The radius of the circle the bounding arc is part of. </li>
<li><code class="docutils literal"><span class="pre">circle_x</span></code>: The x coordinate of the circle center relative to the cell center. </li>
<li><code class="docutils literal"><span class="pre">circle_y</span></code>: The y coordinate of the circle center relative to the cell center. </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSFCell_integrate_hcircle_piece_dddd.png" src="_images/PiecewisePSFCell_integrate_hcircle_piece_dddd.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell23integrate_hcircle_pieceEddd">
<span id="PSF::PiecewiseCell::integrate_hcircle_piece__double.double.doubleC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a3b50c9f02767bde5ea74c8972ba37f39"></span><em class="property">virtual</em> double <code class="descname">integrate_hcircle_piece</code><span class="sig-paren">(</span>double <em>radius</em>, double <em>circle_x</em>, double <em>circle_y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell23integrate_hcircle_pieceEddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Same as integrate_hcircle_piece(double, double, double, double, double, double) but with all three straight boundaries coinciding with the cell&#8217;s. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">radius</span></code>: The radius of the circle the bounding arc is part of. </li>
<li><code class="docutils literal"><span class="pre">circle_x</span></code>: The x coordinate of the circle center relative to the cell center. </li>
<li><code class="docutils literal"><span class="pre">circle_y</span></code>: The y coordinate of the circle center relative to the cell center. </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSFCell_integrate_hcircle_piece_ddd.png" src="_images/PiecewisePSFCell_integrate_hcircle_piece_ddd.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell23integrate_vcircle_pieceEdddddb">
<span id="PSF::PiecewiseCell::integrate_vcircle_piece__double.double.double.double.double.bC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1ae784a99631fb27a9e4df83ef66a6c765"></span><em class="property">virtual</em> double <code class="descname">integrate_vcircle_piece</code><span class="sig-paren">(</span>double <em>xbound</em>, double <em>ybound</em>, double <em>radius</em>, double <em>circle_x</em>, double <em>circle_y</em>, bool <em>right</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell23integrate_vcircle_pieceEdddddb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Same as integrate_vcircle_piece(double, double, double, double, double, double) but with either the left or the right boundary coinciding with the cell&#8217;s. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">xbound</span></code>: The left/right boundary of the region if right is true/false. </li>
<li><code class="docutils literal"><span class="pre">ybound</span></code>: The straight horizontal boundary of the region. </li>
<li><code class="docutils literal"><span class="pre">radius</span></code>: The radius of the circle the bounding arc is part of. </li>
<li><code class="docutils literal"><span class="pre">circle_x</span></code>: The x coordinate of the circle center relative to the cell center. </li>
<li><code class="docutils literal"><span class="pre">circle_y</span></code>: The y coordinate of the circle center relative to the cell center. </li>
<li><code class="docutils literal"><span class="pre">right</span></code>: Wether the region extends rightward from xbound. </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSFCell_integrate_vcircle_piece_dddddb.png" src="_images/PiecewisePSFCell_integrate_vcircle_piece_dddddb.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell23integrate_vcircle_pieceEddddd">
<span id="PSF::PiecewiseCell::integrate_vcircle_piece__double.double.double.double.doubleC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a7eb9f6ad2c0221ec405977e7253a75e5"></span><em class="property">virtual</em> double <code class="descname">integrate_vcircle_piece</code><span class="sig-paren">(</span>double <em>xmin</em>, double <em>xmax</em>, double <em>radius</em>, double <em>circle_x</em>, double <em>circle_y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell23integrate_vcircle_pieceEddddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Same as integrate_vcircle_piece(double, double, double, double, double, double) but with the horizontal boundary coinciding with the cell wall inside the circle of the boundinc arc. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">xmin</span></code>: The bottom boundary of the region. </li>
<li><code class="docutils literal"><span class="pre">xmax</span></code>: The top boundary of the region. </li>
<li><code class="docutils literal"><span class="pre">radius</span></code>: The radius of the circle the bounding arc is part of. </li>
<li><code class="docutils literal"><span class="pre">circle_x</span></code>: The x coordinate of the circle center relative to the cell center. </li>
<li><code class="docutils literal"><span class="pre">circle_y</span></code>: The y coordinate of the circle center relative to the cell center. </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSFCell_integrate_vcircle_piece_ddddd.png" src="_images/PiecewisePSFCell_integrate_vcircle_piece_ddddd.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell23integrate_vcircle_pieceEdddd">
<span id="PSF::PiecewiseCell::integrate_vcircle_piece__double.double.double.doubleC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a540b8df262b029649946ab61160627d1"></span><em class="property">virtual</em> double <code class="descname">integrate_vcircle_piece</code><span class="sig-paren">(</span>double <em>ybound</em>, double <em>radius</em>, double <em>circle_x</em>, double <em>circle_y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell23integrate_vcircle_pieceEdddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Same as integrate_vcircle_piece(double, double, double, double, double, double) but with both the left and the right boundary coinciding with the cell&#8217;s. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">ybound</span></code>: The straight horizontal boundary of the region. </li>
<li><code class="docutils literal"><span class="pre">radius</span></code>: The radius of the circle the bounding arc is part of. </li>
<li><code class="docutils literal"><span class="pre">circle_x</span></code>: The x coordinate of the circle center relative to the cell center. </li>
<li><code class="docutils literal"><span class="pre">circle_y</span></code>: The y coordinate of the circle center relative to the cell center. </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSFCell_integrate_vcircle_piece_dddd.png" src="_images/PiecewisePSFCell_integrate_vcircle_piece_dddd.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell23integrate_vcircle_pieceEddddb">
<span id="PSF::PiecewiseCell::integrate_vcircle_piece__double.double.double.double.bC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a7fa3542eea4bc5c91404b2495bf2ebcd"></span><em class="property">virtual</em> double <code class="descname">integrate_vcircle_piece</code><span class="sig-paren">(</span>double <em>xbound</em>, double <em>radius</em>, double <em>circle_x</em>, double <em>circle_y</em>, bool <em>right</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell23integrate_vcircle_pieceEddddb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Same as integrate_vcircle_piece(double, double, double, double, double, double) but the horizontal as well as one of the vertical boundaries coinciding with the cell&#8217;s. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">xbound</span></code>: The vertical boundary of the region not coinciding with a cell wall. </li>
<li><code class="docutils literal"><span class="pre">radius</span></code>: The radius of the circle the bounding arc is part of. </li>
<li><code class="docutils literal"><span class="pre">circle_x</span></code>: The x coordinate of the circle center relative to the cell center. </li>
<li><code class="docutils literal"><span class="pre">circle_y</span></code>: The y coordinate of the circle center relative to the cell center. </li>
<li><code class="docutils literal"><span class="pre">right</span></code>: Whether the region extends to the right of xbound. </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSFCell_integrate_vcircle_piece_ddddb.png" src="_images/PiecewisePSFCell_integrate_vcircle_piece_ddddb.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell23integrate_vcircle_pieceEddd">
<span id="PSF::PiecewiseCell::integrate_vcircle_piece__double.double.doubleC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1ac473ca8a2ed44a290e6cb4a2516745a9"></span><em class="property">virtual</em> double <code class="descname">integrate_vcircle_piece</code><span class="sig-paren">(</span>double <em>radius</em>, double <em>circle_x</em>, double <em>circle_y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell23integrate_vcircle_pieceEddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Same as integrate_vcircle_piece(double, double, double, double, double, double) but with all three straight boundaries coinciding with the cell&#8217;s. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">radius</span></code>: The radius of the circle the bounding arc is part of. </li>
<li><code class="docutils literal"><span class="pre">circle_x</span></code>: The x coordinate of the circle center relative to the cell center. </li>
<li><code class="docutils literal"><span class="pre">circle_y</span></code>: The y coordinate of the circle center relative to the cell center. </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSFCell_integrate_vcircle_piece_ddd.png" src="_images/PiecewisePSFCell_integrate_vcircle_piece_ddd.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell15integrate_wedgeEddd">
<span id="PSF::PiecewiseCell::integrate_wedge__double.double.doubleC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a64cc4cf2af0a6820599dfe163a283204"></span><em class="property">virtual</em> double <code class="descname">integrate_wedge</code><span class="sig-paren">(</span>double <em>radius</em>, double <em>circle_x</em>, double <em>circle_y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell15integrate_wedgeEddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Integrates the intensity over a region with boundaries two adjacent cell walls and an arc of a circle intersecting both of them. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">radius</span></code>: The radius of the circle the bounding arc is part of. </li>
<li><code class="docutils literal"><span class="pre">circle_x</span></code>: The x coordinate of the circle center relative to the cell center. </li>
<li><code class="docutils literal"><span class="pre">circle_y</span></code>: The y coordinate of the circle center relative to the cell center. </li>
</ul>
</dd>
</dl>
</p>
<p><img alt="_images/PiecewisePSFCell_integrate_wedge_ddd.png" src="_images/PiecewisePSFCell_integrate_wedge_ddd.png" /></p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCellclEdd">
<span id="PSF::PiecewiseCell::call-operator__double.doubleC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1aa6be48a3aa46339f01cff9cdee2a64e8"></span><em class="property">virtual</em> double <code class="descname">operator()</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em><span class="sig-paren">)</span> <em class="property">const</em> = 0<a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCellclEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the value of the intensity at the given position relative to the bottom left cell corner. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x</span></code>: The horizontal offset from the left cell wall where the intensity should be returned </li>
<li><code class="docutils literal"><span class="pre">y</span></code>: The vertical offset from the bottom cell wall where the intensity should be returned </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCellclEddRKNSt8valarrayIdEE">
<span id="PSF::PiecewiseCell::call-operator__double.double.std::valarray:double:CRC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1af0c5c689d4e1425243a4f289ddd0e52a"></span><em class="property">virtual</em> std::valarray&lt;double&gt; <code class="descname">operator()</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em>, <em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>coef_sets</em><span class="sig-paren">)</span> <em class="property">const</em> = 0<a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCellclEddRKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the value of the intensity at the given position relative to the bottom left cell corner. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x</span></code>: The horizontal offset from the left cell wall where the intensity should be returned </li>
<li><code class="docutils literal"><span class="pre">y</span></code>: The vertical offset from the bottom cell wall where the intensity should be returned </li>
<li><code class="docutils literal"><span class="pre">coef_sets</span></code>: The sets of coefficients to compute the intensity for. Each set must contain 16 coefficients and the sets are concatenated. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell5cloneEv">
<span id="PSF::PiecewiseCell::cloneC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1ad9ffa37f1460a3a4b87f30c38c84fff0"></span><em class="property">virtual</em> <a class="reference internal" href="#_CPPv2N3PSF13PiecewiseCellE" title="PSF::PiecewiseCell">PiecewiseCell</a> *<code class="descname">clone</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em> = 0<a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell5cloneEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return a newly allocated copy of this object. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell15horizontal_sizeEv">
<span id="PSF::PiecewiseCell::horizontal_sizeC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a6ee680fa503b0899f26dce9444f73d48"></span>double <code class="descname">horizontal_size</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell15horizontal_sizeEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The horizontal size of the cell. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF13PiecewiseCell13vertical_sizeEv">
<span id="PSF::PiecewiseCell::vertical_sizeC"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a4f682724a19cb2bc20ee797256aa4142"></span>double <code class="descname">vertical_size</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF13PiecewiseCell13vertical_sizeEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The vertical size of the cell. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF13PiecewiseCellD0Ev">
<span id="PSF::PiecewiseCell::~PiecewiseCell"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a336ba7ea2178f6020fd246ab525a1b94"></span><em class="property">virtual</em> <code class="descname">~PiecewiseCell</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF13PiecewiseCellD0Ev" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Virtual destructor. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N3PSF13PiecewiseCell17__horizontal_sizeE">
<span id="PSF::PiecewiseCell::__horizontal_size__double"></span><span class="target" id="classPSF_1_1PiecewiseCell_1a14d133bc69487fb51a008c79c36461a7"></span>double <code class="descname">__horizontal_size</code><a class="headerlink" href="#_CPPv2N3PSF13PiecewiseCell17__horizontal_sizeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The horizontal size of the cell. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13PiecewiseCell15__vertical_sizeE">
<span id="PSF::PiecewiseCell::__vertical_size__double"></span><span class="target" id="classPSF_1_1PiecewiseCell_1ab6fb053ac89b3e4d0ca6fbaf37a2146e"></span>double <code class="descname">__vertical_size</code><a class="headerlink" href="#_CPPv2N3PSF13PiecewiseCell15__vertical_sizeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The vertical size of the cell. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N3PSF3PSFE">
<span id="PSF::PSF"></span><span class="target" id="classPSF_1_1PSF"></span><em class="property">class </em><code class="descname">PSF</code><a class="headerlink" href="#_CPPv2N3PSF3PSFE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;PSF.h&gt;</em><p>An abstract parent class for all <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> models. </p>
<p>Subclassed by <a class="reference internal" href="#classPSF_1_1EllipticalGaussian"><span class="std std-ref">PSF::EllipticalGaussian</span></a>, <a class="reference internal" href="#classPSF_1_1LocalPolynomial"><span class="std std-ref">PSF::LocalPolynomial</span></a>, <a class="reference internal" href="#classPSF_1_1Piecewise"><span class="std std-ref">PSF::Piecewise</span></a></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2NK3PSF3PSF13set_precisionEdd">
<span id="PSF::PSF::set_precision__double.doubleC"></span><span class="target" id="classPSF_1_1PSF_1ae96622f6c53a6d1762a9eaae56c563c7"></span><em class="property">virtual</em> void <code class="descname">set_precision</code><span class="sig-paren">(</span>double, double<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF3PSF13set_precisionEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set a precision requirement for integrals. May be ignored by actual <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a>. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF3PSFclEdd">
<span id="PSF::PSF::call-operator__double.doubleC"></span><span class="target" id="classPSF_1_1PSF_1a0bdcbd3f03020f4f8fdd112def8f0927"></span><em class="property">virtual</em> double <code class="descname">operator()</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em><span class="sig-paren">)</span> <em class="property">const</em> = 0<a class="headerlink" href="#_CPPv2NK3PSF3PSFclEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Evaluates the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> at the given position. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF3PSF9integrateEddddd">
<span id="PSF::PSF::integrate__double.double.double.double.doubleC"></span><span class="target" id="classPSF_1_1PSF_1ad1369bebdb9084b2f324a6b4ce883385"></span>double <code class="descname">integrate</code><span class="sig-paren">(</span>double <em>center_x</em>, double <em>center_y</em>, double <em>dx</em>, double <em>dy</em>, double <em>circle_radius</em> = 0<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF3PSF9integrateEddddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculates the integral of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> over (a piece of, if circle_radius!=0) a rectangle interior to a circle.</p>
<p>The rectangle is defined by: center_x - dx/2 &lt; x &lt; center_x + dx/2, center_y - dy/2 &lt; y &lt; center_y + dy/2 and the circle is centered at 0 and has the given radius </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF3PSFD0Ev">
<span id="PSF::PSF::~PSF"></span><span class="target" id="classPSF_1_1PSF_1a0db2a110d671bff0522abaa41753326d"></span><em class="property">virtual</em> <code class="descname">~PSF</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF3PSFD0Ev" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Virtual destructor. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Protected Functions</p>
<dl class="function">
<dt id="_CPPv2NK3PSF3PSF19integrate_rectangleEdddd">
<span id="PSF::PSF::integrate_rectangle__double.double.double.doubleC"></span><span class="target" id="classPSF_1_1PSF_1aa4c50c38cc4d6fda0373a83ff095980b"></span><em class="property">virtual</em> double <code class="descname">integrate_rectangle</code><span class="sig-paren">(</span>double <em>center_x</em>, double <em>center_y</em>, double <em>dx</em>, double <em>dy</em><span class="sig-paren">)</span> <em class="property">const</em> = 0<a class="headerlink" href="#_CPPv2NK3PSF3PSF19integrate_rectangleEdddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calculates the integral of the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> over a rectangle. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">center_x</span></code>: The x coordinate of the center of the rectangle. </li>
<li><code class="docutils literal"><span class="pre">center_y</span></code>: The y coordinate of the center of the rectangle. </li>
<li><code class="docutils literal"><span class="pre">dx</span></code>: The full x size of the rectangle. </li>
<li><code class="docutils literal"><span class="pre">dy</span></code>: The full y size of the rectangle. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF3PSF15integrate_wedgeEdddbb">
<span id="PSF::PSF::integrate_wedge__double.double.double.b.bC"></span><span class="target" id="classPSF_1_1PSF_1a2555b23419b2f19f5c39f4ba45bfacac"></span><em class="property">virtual</em> double <code class="descname">integrate_wedge</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em>, double <em>radius</em>, bool <em>left</em> = false, bool <em>bottom</em> = false<span class="sig-paren">)</span> <em class="property">const</em> = 0<a class="headerlink" href="#_CPPv2NK3PSF3PSF15integrate_wedgeEdddbb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Integrates the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> over the smallest of the four wedges with the. </p>
<p><ul class="simple">
<li>the line x=x</li>
<li>the line y=y</li>
<li>the circle centered at (0, 0) with a radius=radius If x is 0 the the left vs right wedge is chosen according to left Same for y0 and bottom. </li>
</ul>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2NK3PSF3PSF25line_circle_intersectionsEddddbb">
<span id="PSF::PSF::line_circle_intersections__double.double.double.double.b.bC"></span><span class="target" id="classPSF_1_1PSF_1accc0fe438773429585d1c1594e43bd2e"></span>double <code class="descname">line_circle_intersections</code><span class="sig-paren">(</span>double <em>x1</em>, double <em>x2</em>, double <em>y</em>, double <em>r</em>, bool <em>left_on_circle</em> = false, bool <em>right_on_circle</em> = false<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF3PSF25line_circle_intersectionsEddddbb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the points at which the line segment betwenn (x1, y) and (x2, y) intersects the circle centered at (0,0) with a radius r. The arguments (left/right)_on_circle indicate that the point at (x(1/2), y) respectively lie exactly on the circle, in which case they are not included in the list of intersections returned. It is assumed that x1&lt;x2, y&gt;0, and x1 and x2 have the same sign. The return values have the following meaning:<ul class="simple">
<li>0 : the line is entirely outside the circle (or is just touching it)</li>
<li>NaN : the line is entirely within the circle</li>
<li>positive value : a single point of intersection exists at the returned value</li>
<li>negative value : two intersections exist at +- the returned value </li>
</ul>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF3PSF28integrate_overlap_bottom_outEdddddNSt8valarrayIbEERNSt8valarrayIdEE">
<span id="PSF::PSF::integrate_overlap_bottom_out__double.double.double.double.double.std::valarray:b:.std::valarray:double:RC"></span><span class="target" id="classPSF_1_1PSF_1aab08317e88df02c4f479fb6e1ff26205"></span>double <code class="descname">integrate_overlap_bottom_out</code><span class="sig-paren">(</span>double <em>x1</em>, double <em>y1</em>, double <em>x2</em>, double <em>y2</em>, double <em>rc</em>, std::valarray&lt;bool&gt; <em>on_circle</em>, std::valarray&lt;double&gt; &amp;<em>intersections</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF3PSF28integrate_overlap_bottom_outEdddddNSt8valarrayIbEERNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Integrates the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> over the intersection of a rectangle and a cirle under the assumption that the bottom side of the rectangle lies outside the circle. See integrate_overlap for description of command line arguments. Also assumes the rectangle is entirely contained within a quadrant. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF3PSF27integrate_overlap_bottom_inEdddddNSt8valarrayIbEERNSt8valarrayIdEE">
<span id="PSF::PSF::integrate_overlap_bottom_in__double.double.double.double.double.std::valarray:b:.std::valarray:double:RC"></span><span class="target" id="classPSF_1_1PSF_1af53baad2264f7601b4ff9c77ac1af308"></span>double <code class="descname">integrate_overlap_bottom_in</code><span class="sig-paren">(</span>double <em>x1</em>, double <em>y1</em>, double <em>x2</em>, double <em>y2</em>, double <em>rc</em>, std::valarray&lt;bool&gt; <em>on_circle</em>, std::valarray&lt;double&gt; &amp;<em>intersections</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF3PSF27integrate_overlap_bottom_inEdddddNSt8valarrayIbEERNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Integrates the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> over the intersection of a rectangle and a cirle under the assumption that the bottom side of the rectangle lies inside the circle. See integrate_overlap for description of command line arguments. Also assumes the rectangle is entirely contained within a quadrant. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF3PSF17integrate_overlapEdddddRKNSt8valarrayIbEE">
<span id="PSF::PSF::integrate_overlap__double.double.double.double.double.std::valarray:b:CRC"></span><span class="target" id="classPSF_1_1PSF_1a9ec5b04ec2c567816e5a4ed710d6eddc"></span>double <code class="descname">integrate_overlap</code><span class="sig-paren">(</span>double <em>x1</em>, double <em>y1</em>, double <em>x2</em>, double <em>y2</em>, double <em>rc</em>, <em class="property">const</em> std::valarray&lt;bool&gt; &amp;<em>on_circle</em> = std::valarray&lt; bool &gt;(false, 4)<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF3PSF17integrate_overlapEdddddRKNSt8valarrayIbEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Integrates the <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> over the common overlapping area of the rectangle with corners at (x1, y1), (x2, y1), (x2, y2), (x1, y2) and the circle centered on (0, 0) with a radius rc. The on_circle array identifies rectangle corners (in the order given above) which lie exactly on the circle. It must be true that x1&lt;x2, y1&lt;y2. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N3PSF5SplitE">
<span id="PSF::Split"></span><span class="target" id="classPSF_1_1Split"></span><em class="property">class </em><code class="descname">Split</code><a class="headerlink" href="#_CPPv2N3PSF5SplitE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;Split.h&gt;</em><p>Describes a splitting of a rectangular area into smaller pieces. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF5Split5SplitEdddddddd">
<span id="PSF::Split::Split__double.double.double.double.double.double.double.double"></span><span class="target" id="classPSF_1_1Split_1ac0732cdde1bd2ec7a61d4999a080f8f1"></span><code class="descname">Split</code><span class="sig-paren">(</span>double <em>spd</em>, double <em>smd</em>, double <em>k</em>, double <em>x0</em>, double <em>y0</em>, double <em>dx</em>, double <em>dy</em>, double <em>max_exp_coef</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF5Split5SplitEdddddddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">spd</span></code>: S+D </li>
<li><code class="docutils literal"><span class="pre">smd</span></code>: S-D </li>
<li><code class="docutils literal"><span class="pre">k</span></code>: K </li>
<li><code class="docutils literal"><span class="pre">x0</span></code>: The x coondinate of the center of the area. </li>
<li><code class="docutils literal"><span class="pre">y0</span></code>: The y coondinate of the center of the area. </li>
<li><code class="docutils literal"><span class="pre">dx</span></code>: The x size of the pieces. </li>
<li><code class="docutils literal"><span class="pre">dy</span></code>: The y size of the pieces. </li>
<li><code class="docutils literal"><span class="pre">max_exp_coef</span></code>: The maximum value allowed for any exponent argument. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF5SplitcvbEv">
<span id="PSF::Split::castto-b-operator"></span><span class="target" id="classPSF_1_1Split_1ad4ae917631d96c0bf86e1f2f99237bf5"></span><code class="descname">operator bool</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF5SplitcvbEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Is any splitting necessary. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF5Split7x_splitEv">
<span id="PSF::Split::x_split"></span><span class="target" id="classPSF_1_1Split_1a73e17d10b0c8002219db7902a8c9f2fb"></span>int <code class="descname">x_split</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF5Split7x_splitEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of pieces to split the area in along x. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF5Split7y_splitEv">
<span id="PSF::Split::y_split"></span><span class="target" id="classPSF_1_1Split_1ae4481112512bf5bf0a782a9256470df4"></span>int <code class="descname">y_split</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF5Split7y_splitEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of pieces to split the area in along y. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF5Split10num_piecesEv">
<span id="PSF::Split::num_pieces"></span><span class="target" id="classPSF_1_1Split_1a639d5322af25d1bd08e92be8d4b0207d"></span>int <code class="descname">num_pieces</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF5Split10num_piecesEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of pieces the region was splin into. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF5Split6sub_x0Ev">
<span id="PSF::Split::sub_x0"></span><span class="target" id="classPSF_1_1Split_1af6da46084d8fd87e21a08379aeaa3a8d"></span>double <code class="descname">sub_x0</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF5Split6sub_x0Ev" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The x coordinate center of the first piece. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF5Split6sub_y0Ev">
<span id="PSF::Split::sub_y0"></span><span class="target" id="classPSF_1_1Split_1ab3c544a8050f04a5577176f7faa544ca"></span>double <code class="descname">sub_y0</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF5Split6sub_y0Ev" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The y coordinate center of the first piece. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF5Split6sub_dxEv">
<span id="PSF::Split::sub_dx"></span><span class="target" id="classPSF_1_1Split_1a1ea4553c98f52b5311dc418612c0e71b"></span>double <code class="descname">sub_dx</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF5Split6sub_dxEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The x size of the pieces. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF5Split6sub_dyEv">
<span id="PSF::Split::sub_dy"></span><span class="target" id="classPSF_1_1Split_1a4e98afb1196ebf20d95690223c73ab55"></span>double <code class="descname">sub_dy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF5Split6sub_dyEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The y size of the pieces. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N3PSF5Split9__x_splitE">
<span id="PSF::Split::__x_split__i"></span><span class="target" id="classPSF_1_1Split_1a708dd52697daa94ca3346da0a64b6e05"></span>int <code class="descname">__x_split</code><a class="headerlink" href="#_CPPv2N3PSF5Split9__x_splitE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of pieces to split the area in along x. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF5Split9__y_splitE">
<span id="PSF::Split::__y_split__i"></span><span class="target" id="classPSF_1_1Split_1ad95e6bb1b7540cae5337a6a57eaa6d78"></span>int <code class="descname">__y_split</code><a class="headerlink" href="#_CPPv2N3PSF5Split9__y_splitE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of pieces to split the area in along y. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF5Split8__sub_x0E">
<span id="PSF::Split::__sub_x0__double"></span><span class="target" id="classPSF_1_1Split_1a7f48c749a295933c5c9ecdf2dec39d4e"></span>double <code class="descname">__sub_x0</code><a class="headerlink" href="#_CPPv2N3PSF5Split8__sub_x0E" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The x coordinate center of the first piece. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF5Split8__sub_y0E">
<span id="PSF::Split::__sub_y0__double"></span><span class="target" id="classPSF_1_1Split_1a852ba7390d30bdc42c0781dbee25a0a3"></span>double <code class="descname">__sub_y0</code><a class="headerlink" href="#_CPPv2N3PSF5Split8__sub_y0E" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The y coordinate center of the first piece. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF5Split8__sub_dxE">
<span id="PSF::Split::__sub_dx__double"></span><span class="target" id="classPSF_1_1Split_1a7a9c2075e0d36faae8ded78f8da3db47"></span>double <code class="descname">__sub_dx</code><a class="headerlink" href="#_CPPv2N3PSF5Split8__sub_dxE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The x size of the pieces. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF5Split8__sub_dyE">
<span id="PSF::Split::__sub_dy__double"></span><span class="target" id="classPSF_1_1Split_1a311cad8f201711afad55a63db0e16734"></span>double <code class="descname">__sub_dy</code><a class="headerlink" href="#_CPPv2N3PSF5Split8__sub_dyE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The y size of the pieces. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF5Split7__splitE">
<span id="PSF::Split::__split__b"></span><span class="target" id="classPSF_1_1Split_1a9addaafa4fa3217506084e2a411cd813"></span>bool <code class="descname">__split</code><a class="headerlink" href="#_CPPv2N3PSF5Split7__splitE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Is any splitting necessary. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N3PSF12TermValarrayE">
<span id="PSF::TermValarray"></span><span class="target" id="classPSF_1_1TermValarray"></span><em class="property">class </em><code class="descname">TermValarray</code> : <em class="property">public</em> std::valarray&lt;double&gt;<a class="headerlink" href="#_CPPv2N3PSF12TermValarrayE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;TermCalculator.h&gt;</em><p>Same as valarray&lt;double&gt; but on assignment resizes result as necessary. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF12TermValarray12TermValarrayE6size_t">
<span id="PSF::TermValarray::TermValarray__s"></span><span class="target" id="classPSF_1_1TermValarray_1a0ed3c5ec6801fc242fb71524118204f8"></span><code class="descname">TermValarray</code><span class="sig-paren">(</span>size_t <em>size</em> = 0<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF12TermValarray12TermValarrayE6size_t" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF12TermValarray12TermValarrayEd6size_t">
<span id="PSF::TermValarray::TermValarray__double.s"></span><span class="target" id="classPSF_1_1TermValarray_1a046025170bb11ddfd1bcb66147540d14"></span><code class="descname">TermValarray</code><span class="sig-paren">(</span>double <em>value</em>, size_t <em>size</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF12TermValarray12TermValarrayEd6size_t" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF12TermValarray12TermValarrayERKNSt8valarrayIdEE">
<span id="PSF::TermValarray::TermValarray__std::valarray:double:CR"></span><span class="target" id="classPSF_1_1TermValarray_1a4e1496338d035c10bab8c77ad9a01ba2"></span><code class="descname">TermValarray</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>orig</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF12TermValarray12TermValarrayERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF12TermValarray12TermValarrayEPKd6size_t">
<span id="PSF::TermValarray::TermValarray__doubleCP.s"></span><span class="target" id="classPSF_1_1TermValarray_1a54dd06e65a63dcb7b033766dae58db9b"></span><code class="descname">TermValarray</code><span class="sig-paren">(</span><em class="property">const</em> double *<em>data</em>, size_t <em>data_size</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF12TermValarray12TermValarrayEPKd6size_t" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF12TermValarrayaSERKNSt8valarrayIdEE">
<span id="PSF::TermValarray::assign-operator__std::valarray:double:CR"></span><span class="target" id="classPSF_1_1TermValarray_1aa2e06a95908ceb93e97eb4e559aa1dd1"></span><a class="reference internal" href="#_CPPv2N3PSF12TermValarrayE" title="PSF::TermValarray">TermValarray</a> &amp;<code class="descname">operator=</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>rhs</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF12TermValarrayaSERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF12TermValarraymLERKNSt8valarrayIdEE">
<span id="PSF::TermValarray::mul-assign-operator__std::valarray:double:CR"></span><span class="target" id="classPSF_1_1TermValarray_1a28f689a81bac3af4a3a9016f024c19ed"></span><a class="reference internal" href="#_CPPv2N3PSF12TermValarrayE" title="PSF::TermValarray">TermValarray</a> &amp;<code class="descname">operator*=</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>rhs</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF12TermValarraymLERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF12TermValarraydVERKNSt8valarrayIdEE">
<span id="PSF::TermValarray::div-assign-operator__std::valarray:double:CR"></span><span class="target" id="classPSF_1_1TermValarray_1a154fb0199a08c33b5524e7e38fcc0a03"></span><a class="reference internal" href="#_CPPv2N3PSF12TermValarrayE" title="PSF::TermValarray">TermValarray</a> &amp;<code class="descname">operator/=</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>rhs</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF12TermValarraydVERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF12TermValarraypLERKNSt8valarrayIdEE">
<span id="PSF::TermValarray::add-assign-operator__std::valarray:double:CR"></span><span class="target" id="classPSF_1_1TermValarray_1a131ab17313101d3938c2ecfbffbab764"></span><a class="reference internal" href="#_CPPv2N3PSF12TermValarrayE" title="PSF::TermValarray">TermValarray</a> &amp;<code class="descname">operator+=</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>rhs</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF12TermValarraypLERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF12TermValarraymIERKNSt8valarrayIdEE">
<span id="PSF::TermValarray::sub-assign-operator__std::valarray:double:CR"></span><span class="target" id="classPSF_1_1TermValarray_1aa3ee9b21a42e67468454d99c2b7f8544"></span><a class="reference internal" href="#_CPPv2N3PSF12TermValarrayE" title="PSF::TermValarray">TermValarray</a> &amp;<code class="descname">operator-=</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>rhs</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF12TermValarraymIERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Static Attributes</p>
<dl class="member">
<dt id="_CPPv2N3PSF12TermValarray8__max_idE">
<span id="PSF::TermValarray::__max_id__unsigned"></span><span class="target" id="classPSF_1_1TermValarray_1a7ebd7728b957b43c13469c6dd2f8d426"></span>unsigned <code class="descname">__max_id</code><a class="headerlink" href="#_CPPv2N3PSF12TermValarray8__max_idE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N3PSF13WedgeIntegralE">
<span id="PSF::WedgeIntegral"></span><span class="target" id="classPSF_1_1WedgeIntegral"></span><em class="property">class </em><code class="descname">WedgeIntegral</code><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegralE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;WedgeIntegral.h&gt;</em><p>A class that implements the integral of x^my^n over a circle wedge. </p>
<p>The wedge is defined by r, <span class="math">\(x_0\)</span> and <span class="math">\(y_0\)</span> as in the following diagram:</p>
<p><img alt="_images/circle_wedge.png" src="_images/circle_wedge.png" /></p>
<p>The is solution described here. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF13WedgeIntegral13WedgeIntegralEddd">
<span id="PSF::WedgeIntegral::WedgeIntegral__double.double.double"></span><span class="target" id="classPSF_1_1WedgeIntegral_1a3356182247f41f667dfb56f0a96b1d15"></span><code class="descname">WedgeIntegral</code><span class="sig-paren">(</span>double <em>r</em>, double <em>x0</em>, double <em>y0</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral13WedgeIntegralEddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create an integral over a wedge with the center of the chord at (x0, y0) in a circle with radius r. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF13WedgeIntegralclEjj">
<span id="PSF::WedgeIntegral::call-operator__unsigned.unsigned"></span><span class="target" id="classPSF_1_1WedgeIntegral_1aff2ec895af431287d533472d9513be4f"></span>double <code class="descname">operator()</code><span class="sig-paren">(</span>unsigned <em>m</em>, unsigned <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegralclEjj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the integral of x^m y^n over the wedge. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF13WedgeIntegral11fill_p_evenEN4Core16vector_size_typeE">
<span id="PSF::WedgeIntegral::fill_p_even__Core::vector_size_type"></span><span class="target" id="classPSF_1_1WedgeIntegral_1ad08401d4b248e7128eb5a930ab8e2f5c"></span>void <code class="descname">fill_p_even</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>max_n</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral11fill_p_evenEN4Core16vector_size_typeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Computes all <span class="math">\(P^{even}_n\)</span> for n&lt;max_n and stores them in __q[0]. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF13WedgeIntegral10fill_p_oddEN4Core16vector_size_typeE">
<span id="PSF::WedgeIntegral::fill_p_odd__Core::vector_size_type"></span><span class="target" id="classPSF_1_1WedgeIntegral_1a18129b0a7197cc0f37708c2a5da23942"></span>void <code class="descname">fill_p_odd</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>max_n</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral10fill_p_oddEN4Core16vector_size_typeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Computes all <span class="math">\(P^{odd}_n\)</span> for n&lt;max_n and stores them in __q[1]. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF13WedgeIntegral15fill_q_diagonalEN4Core16vector_size_typeEN4Core16vector_size_typeE">
<span id="PSF::WedgeIntegral::fill_q_diagonal__Core::vector_size_type.Core::vector_size_type"></span><span class="target" id="classPSF_1_1WedgeIntegral_1acc45d75c046f267b6fab32b64d2c91b0"></span>void <code class="descname">fill_q_diagonal</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>m</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral15fill_q_diagonalEN4Core16vector_size_typeEN4Core16vector_size_typeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fills in a diagonal of __q with indices that sum up to (m+n) and the first of which has the same parity as m, up to (m, n), assuming all earlier diagonals are filled. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF13WedgeIntegral11calculate_qEN4Core16vector_size_typeEN4Core16vector_size_typeE">
<span id="PSF::WedgeIntegral::calculate_q__Core::vector_size_type.Core::vector_size_type"></span><span class="target" id="classPSF_1_1WedgeIntegral_1a005670e24796ec5fa49a67d7a2e90289"></span>void <code class="descname">calculate_q</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>m</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral11calculate_qEN4Core16vector_size_typeEN4Core16vector_size_typeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fills in __q[m][n] and possibly other entries of __q if they are calculated along the way. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF13WedgeIntegral14expand_storageEN4Core16vector_size_typeEN4Core16vector_size_typeE">
<span id="PSF::WedgeIntegral::expand_storage__Core::vector_size_type.Core::vector_size_type"></span><span class="target" id="classPSF_1_1WedgeIntegral_1a6cfc22160ec938a18d777ba29f5ff97d"></span>void <code class="descname">expand_storage</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>min_m_size</em>, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <em>min_n_size</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral14expand_storageEN4Core16vector_size_typeEN4Core16vector_size_typeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Increases the size of all vectors holding pre-calculated values by a power of 2 such that they can hold at least the given m and n values. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N3PSF13WedgeIntegral4__x0E">
<span id="PSF::WedgeIntegral::__x0__double"></span><span class="target" id="classPSF_1_1WedgeIntegral_1a7aa8e8c5361b6e73161ee1c3b91fd45c"></span>double <code class="descname">__x0</code><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral4__x0E" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The x distance from the circle center to the center of the chord. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13WedgeIntegral4__y0E">
<span id="PSF::WedgeIntegral::__y0__double"></span><span class="target" id="classPSF_1_1WedgeIntegral_1a798fd27f8bd8ec5965687e7c71eecb7d"></span>double <code class="descname">__y0</code><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral4__y0E" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The y distance from the circle center to the center of the chord. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13WedgeIntegral5__y02E">
<span id="PSF::WedgeIntegral::__y02__double"></span><span class="target" id="classPSF_1_1WedgeIntegral_1ac705f07826b23d1d3338db85046d4630"></span>double <code class="descname">__y02</code><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral5__y02E" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The square of __y0. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13WedgeIntegral10__twice_y0E">
<span id="PSF::WedgeIntegral::__twice_y0__double"></span><span class="target" id="classPSF_1_1WedgeIntegral_1ad5e95d2c7a5b7be98afec4d1b3f84794"></span>double <code class="descname">__twice_y0</code><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral10__twice_y0E" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>2*__y0 </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13WedgeIntegral8__deltaxE">
<span id="PSF::WedgeIntegral::__deltax__double"></span><span class="target" id="classPSF_1_1WedgeIntegral_1a629954ed12be875f288b81ab77d3d3ca"></span>double <code class="descname">__deltax</code><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral8__deltaxE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><span class="math">\(\Delta x\)</span> </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13WedgeIntegral8__deltayE">
<span id="PSF::WedgeIntegral::__deltay__double"></span><span class="target" id="classPSF_1_1WedgeIntegral_1acfa192f686e3c9f6b9b2ed52782a0ee5"></span>double <code class="descname">__deltay</code><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral8__deltayE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><span class="math">\(\Delta y\)</span> </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13WedgeIntegral4__r2E">
<span id="PSF::WedgeIntegral::__r2__double"></span><span class="target" id="classPSF_1_1WedgeIntegral_1a1c5830ae580b11a4cae09741944ade38"></span>double <code class="descname">__r2</code><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral4__r2E" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The square of the circle radius. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13WedgeIntegral10__r2_m_y02E">
<span id="PSF::WedgeIntegral::__r2_m_y02__double"></span><span class="target" id="classPSF_1_1WedgeIntegral_1a23040685ce6b79ba2d9340b71aa34fb8"></span>double <code class="descname">__r2_m_y02</code><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral10__r2_m_y02E" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><span class="math">\(r^2-y_0^2\)</span>. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13WedgeIntegral7__x_minE">
<span id="PSF::WedgeIntegral::__x_min__double"></span><span class="target" id="classPSF_1_1WedgeIntegral_1acfe01b953b163ee1719985114d8afbe3"></span>double <code class="descname">__x_min</code><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral7__x_minE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The smallest distance to the circle center in x. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13WedgeIntegral7__y_minE">
<span id="PSF::WedgeIntegral::__y_min__double"></span><span class="target" id="classPSF_1_1WedgeIntegral_1aa7d3fd7172403c10f0c3a987d8b8c31d"></span>double <code class="descname">__y_min</code><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral7__y_minE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The smallest distance to the circle center in y. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13WedgeIntegral7__x_maxE">
<span id="PSF::WedgeIntegral::__x_max__double"></span><span class="target" id="classPSF_1_1WedgeIntegral_1ac0a7912d00efe22aea0cc399d71dbcb3"></span>double <code class="descname">__x_max</code><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral7__x_maxE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The largest distance to the circle center in x. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13WedgeIntegral7__y_maxE">
<span id="PSF::WedgeIntegral::__y_max__double"></span><span class="target" id="classPSF_1_1WedgeIntegral_1add5db525632e20ccfac0d143c9263b6f"></span>double <code class="descname">__y_max</code><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral7__y_maxE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The largest distance to the circle center in y. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13WedgeIntegral27__p_odd_free_term_mult_evenE">
<span id="PSF::WedgeIntegral::__p_odd_free_term_mult_even__double"></span><span class="target" id="classPSF_1_1WedgeIntegral_1a7e1f37d25f3ed4fc44c53de61a5f40ad"></span>double <code class="descname">__p_odd_free_term_mult_even</code><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral27__p_odd_free_term_mult_evenE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The n independent part of the term from the recursive relation for <span class="math">\(P^odd\)</span> which does not depend on previous <span class="math">\(P^odd\)</span> for even n. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13WedgeIntegral26__p_odd_free_term_mult_oddE">
<span id="PSF::WedgeIntegral::__p_odd_free_term_mult_odd__double"></span><span class="target" id="classPSF_1_1WedgeIntegral_1ac1358df2e4a34b9a689ec6a6e77af7ac"></span>double <code class="descname">__p_odd_free_term_mult_odd</code><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral26__p_odd_free_term_mult_oddE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The n independent part of the term from the recursive relation for <span class="math">\(P^odd\)</span> which does not depend on previous <span class="math">\(P^odd\)</span> for odd n. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13WedgeIntegral8__valuesE">
<span id="PSF::WedgeIntegral::__values__std::vector:std::vector:double::"></span><span class="target" id="classPSF_1_1WedgeIntegral_1af3636cb2a8346bddd58cbd862f5ce620"></span>std::vector&lt;std::vector&lt;double&gt;&gt; <code class="descname">__values</code><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral8__valuesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>All previously computed values of the integral. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13WedgeIntegral3__qE">
<span id="PSF::WedgeIntegral::__q__std::vector:std::vector:double::"></span><span class="target" id="classPSF_1_1WedgeIntegral_1abb78e0d93e22536907fee6528d02c968"></span>std::vector&lt;std::vector&lt;double&gt;&gt; <code class="descname">__q</code><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral3__qE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>All previously computed <span class="math">\(Q_{m,n}\)</span> values.</p>
<p>The first (outer) index is m and the second (inner) is n. This way __q[0] is <span class="math">\(P^{even}\)</span> and __q[1] is <span class="math">\(P^{odd}\)</span>. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13WedgeIntegral12__deltax_powE">
<span id="PSF::WedgeIntegral::__deltax_pow__std::vector:double:"></span><span class="target" id="classPSF_1_1WedgeIntegral_1ae4c0bf4a1c137fec1a5b2a68bd01e70e"></span>std::vector&lt;double&gt; <code class="descname">__deltax_pow</code><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral12__deltax_powE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Various powers of <span class="math">\(\Delta x\)</span>. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13WedgeIntegral12__deltay_powE">
<span id="PSF::WedgeIntegral::__deltay_pow__std::vector:double:"></span><span class="target" id="classPSF_1_1WedgeIntegral_1a5759a8c4d005aed875a6ef8a4030f4eb"></span>std::vector&lt;double&gt; <code class="descname">__deltay_pow</code><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral12__deltay_powE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Various powers of <span class="math">\(\Delta y\)</span>. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13WedgeIntegral8__x0_powE">
<span id="PSF::WedgeIntegral::__x0_pow__std::vector:double:"></span><span class="target" id="classPSF_1_1WedgeIntegral_1aae98fa459765076261d706fb355d0725"></span>std::vector&lt;double&gt; <code class="descname">__x0_pow</code><a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral8__x0_powE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Previously computed powers of __y0. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Static Attributes</p>
<dl class="member">
<dt id="_CPPv2N3PSF13WedgeIntegral17__initial_storageE">
<span id="PSF::WedgeIntegral::__initial_storage__Core::vector_size_typeC"></span><span class="target" id="classPSF_1_1WedgeIntegral_1a1bc854025bde826ad05e371124c0ea3e"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core16vector_size_typeE" title="Core::vector_size_type">vector_size_type</a> <code class="descname">__initial_storage</code> = 30<a class="headerlink" href="#_CPPv2N3PSF13WedgeIntegral17__initial_storageE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N3PSF14TermCalculatorE">
<span id="PSF::TermCalculator"></span><span class="target" id="namespacePSF_1_1TermCalculator"></span><em class="property">namespace </em><code class="descname">TermCalculator</code><a class="headerlink" href="#_CPPv2N3PSF14TermCalculatorE" title="Permalink to this definition">¶</a><br /></dt>
<dd><dl class="class">
<dt id="_CPPv2N3PSF14TermCalculator7GrammarE">
<span id="PSF::TermCalculator::Grammar"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar"></span><em class="property">template </em>&lt;<em class="property">typename</em> Iterator, <em class="property">typename</em> ResultType&gt;<br /><em class="property">class </em><code class="descname">Grammar</code> : <em class="property">public</em> boost::spirit::qi::grammar&lt;Iterator, ResultType<span class="sig-paren">(</span><span class="sig-paren">)</span>, ascii::space_type&gt;<a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7GrammarE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;TermCalculator.h&gt;</em><p>The grammar defining the calculator. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar7GrammarE6size_t">
<span id="PSF::TermCalculator::Grammar::Grammar__s"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1a90e7526c4ba1a5c39ea8180a2a62d406"></span><code class="descname">Grammar</code><span class="sig-paren">(</span>size_t <em>result_size</em> = 0<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar7GrammarE6size_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Construct a term calculator producing results of the given length. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar15set_result_sizeE6size_t">
<span id="PSF::TermCalculator::Grammar::set_result_size__s"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1af17ae601fec247b42bead2222f674db9"></span>void <code class="descname">set_result_size</code><span class="sig-paren">(</span>size_t <em>result_size</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar15set_result_sizeE6size_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Define length of the final result vector. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar12add_variableERKNSt6stringERK10ResultType">
<span id="PSF::TermCalculator::Grammar::add_variable__ssCR.ResultTypeCR"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1a32bafa22ac14417cb9ff390433c342ab"></span>void <code class="descname">add_variable</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>name</em>, <em class="property">const</em> ResultType &amp;<em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar12add_variableERKNSt6stringERK10ResultType" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Define a new variable which may participate in the expressions evaluated. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">name</span></code>: The name to use for the variable. </li>
<li><code class="docutils literal"><span class="pre">value</span></code>: The actual vector of values for the variable. The size must match the currently defined result size. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK3PSF14TermCalculator7Grammar9variablesEv">
<span id="PSF::TermCalculator::Grammar::variablesC"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1a9bc9ad1c8f055025fe2dde1bf0389b91"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N3PSF14TermCalculator9VariablesE" title="PSF::TermCalculator::Variables">Variables</a>&lt;ResultType&gt; &amp;<code class="descname">variables</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK3PSF14TermCalculator7Grammar9variablesEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Unmodifiable reference to the defined variables. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar3powERKNSt8valarrayIdEERKNSt8valarrayIdEE">
<span id="PSF::TermCalculator::Grammar::pow__std::valarray:double:CR.std::valarray:double:CR"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1a36fe2b5ce8e5602bf3237906b47ac15a"></span>ResultType <code class="descname">pow</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>base</em>, <em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>exponent</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar3powERKNSt8valarrayIdEERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias of std::pow, needed for type determination. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar3cosERKNSt8valarrayIdEE">
<span id="PSF::TermCalculator::Grammar::cos__std::valarray:double:CR"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1a15dccceb12ac508007949df3417fc43b"></span>ResultType <code class="descname">cos</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar3cosERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias of std::cos, needed for type determination. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar3sinERKNSt8valarrayIdEE">
<span id="PSF::TermCalculator::Grammar::sin__std::valarray:double:CR"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1a4d74af3263eeb5a7ff9d7ea6c0e673eb"></span>ResultType <code class="descname">sin</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar3sinERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias of std::sin, needed for type determination. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar3tanERKNSt8valarrayIdEE">
<span id="PSF::TermCalculator::Grammar::tan__std::valarray:double:CR"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1add5cd0ab1b5d0c3d627bd872f2dbf412"></span>ResultType <code class="descname">tan</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar3tanERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias of std::tan, needed for type determination. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar4acosERKNSt8valarrayIdEE">
<span id="PSF::TermCalculator::Grammar::acos__std::valarray:double:CR"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1ac6affca587facc73ee78ad5a91a66f75"></span>ResultType <code class="descname">acos</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar4acosERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias of std::acos, needed for type determination. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar4asinERKNSt8valarrayIdEE">
<span id="PSF::TermCalculator::Grammar::asin__std::valarray:double:CR"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1a9c906809a6182857bb6dd721e0c105d5"></span>ResultType <code class="descname">asin</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar4asinERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias of std::asin, needed for type determination. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar4atanERKNSt8valarrayIdEE">
<span id="PSF::TermCalculator::Grammar::atan__std::valarray:double:CR"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1af96ab2bb0c1c8096600a40e5cb8611ce"></span>ResultType <code class="descname">atan</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar4atanERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias of std::atan, needed for type determination. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar5atan2ERKNSt8valarrayIdEERKNSt8valarrayIdEE">
<span id="PSF::TermCalculator::Grammar::atan2__std::valarray:double:CR.std::valarray:double:CR"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1a0072c585ab48db8434d52ab58e178435"></span>ResultType <code class="descname">atan2</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>x</em>, <em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar5atan2ERKNSt8valarrayIdEERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias of std::atan2, needed for type determination. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar4coshERKNSt8valarrayIdEE">
<span id="PSF::TermCalculator::Grammar::cosh__std::valarray:double:CR"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1aadb9b543a893d662a97049c52f96f22e"></span>ResultType <code class="descname">cosh</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar4coshERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias of std::cosh, needed for type determination. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar4sinhERKNSt8valarrayIdEE">
<span id="PSF::TermCalculator::Grammar::sinh__std::valarray:double:CR"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1abff592f204decf810e2eebb03e1990cc"></span>ResultType <code class="descname">sinh</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar4sinhERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias of std::sinh, needed for type determination. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar4tanhERKNSt8valarrayIdEE">
<span id="PSF::TermCalculator::Grammar::tanh__std::valarray:double:CR"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1a65f45fe2e1e41f08d9ebecb324cd78be"></span>ResultType <code class="descname">tanh</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar4tanhERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias of std::tanh, needed for type determination. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar3expERKNSt8valarrayIdEE">
<span id="PSF::TermCalculator::Grammar::exp__std::valarray:double:CR"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1a2be1b83e4bbcaddc08dc79ecde00ac3a"></span>ResultType <code class="descname">exp</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar3expERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias of std::exp, needed for type determination. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar3logERKNSt8valarrayIdEE">
<span id="PSF::TermCalculator::Grammar::log__std::valarray:double:CR"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1a13be0d30d5b34513be88c9c95b5063d8"></span>ResultType <code class="descname">log</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar3logERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias of std::log, needed for type determination. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar5log10ERKNSt8valarrayIdEE">
<span id="PSF::TermCalculator::Grammar::log10__std::valarray:double:CR"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1ad2f76fb477619e78e1615de0d78d7b2e"></span>ResultType <code class="descname">log10</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar5log10ERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias of std::log10, needed for type determination. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar4sqrtERKNSt8valarrayIdEE">
<span id="PSF::TermCalculator::Grammar::sqrt__std::valarray:double:CR"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1aa411e8d24f94aae5e722738f0244ac98"></span>ResultType <code class="descname">sqrt</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar4sqrtERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias of std::sqrt, needed for type determination. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar4ceilERK10ResultType">
<span id="PSF::TermCalculator::Grammar::ceil__ResultTypeCR"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1afb67bdbc00741778d57a9cd9dffe852a"></span>ResultType <code class="descname">ceil</code><span class="sig-paren">(</span><em class="property">const</em> ResultType &amp;<em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar4ceilERK10ResultType" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias of std::ceil, needed for type determination. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar5floorERK10ResultType">
<span id="PSF::TermCalculator::Grammar::floor__ResultTypeCR"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1aeef0df3d1446e1ce105d44903e3f1b14"></span>ResultType <code class="descname">floor</code><span class="sig-paren">(</span><em class="property">const</em> ResultType &amp;<em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar5floorERK10ResultType" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias of std::floor, needed for type determination. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar4fmodERK10ResultTypeRK10ResultType">
<span id="PSF::TermCalculator::Grammar::fmod__ResultTypeCR.ResultTypeCR"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1af72a9615671b3c53de0ebc97a953f5a0"></span>ResultType <code class="descname">fmod</code><span class="sig-paren">(</span><em class="property">const</em> ResultType &amp;<em>numer</em>, <em class="property">const</em> ResultType &amp;<em>denom</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar4fmodERK10ResultTypeRK10ResultType" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias of std::fmod, needed for type determination. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar3absERKNSt8valarrayIdEE">
<span id="PSF::TermCalculator::Grammar::abs__std::valarray:double:CR"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1aaddf92a8803227e294baafbf851dcfaa"></span>ResultType <code class="descname">abs</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;double&gt; &amp;<em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar3absERKNSt8valarrayIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias of std::abs, needed for type determination. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar13__result_sizeE">
<span id="PSF::TermCalculator::Grammar::__result_size__s"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1af312ca1f1d6447319c71a52189de1bc2"></span>size_t <code class="descname">__result_size</code><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar13__result_sizeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The size of the resulting arrays. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar12__expressionE">
<span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1a3b8348f77428658edc83f0f621d80ef9"></span>qi::rule&lt;Iterator, ResultType<span class="sig-paren">(</span><span class="sig-paren">)</span>, ascii::space_type&gt; <code class="descname">__expression</code><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar12__expressionE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Rule defining the final expression as a sum of terms. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar8__factorE">
<span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1a78aaace016d6f559cba5e45b14511e58"></span>qi::rule&lt;Iterator, ResultType<span class="sig-paren">(</span><span class="sig-paren">)</span>, ascii::space_type&gt; <code class="descname">__factor</code><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar8__factorE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Rule defining a term in the expression as a product of factors. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar7__valueE">
<span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1ac40abe3e826d243f428cf310c236db84"></span>qi::rule&lt;Iterator, ResultType<span class="sig-paren">(</span><span class="sig-paren">)</span>, ascii::space_type&gt; <code class="descname">__value</code><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar7__valueE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Rule defining a value in a power as unary function or number. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar16__exponentiationE">
<span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1af10ed485680adbbac4eb22dda4a7a35b"></span>qi::rule&lt;Iterator, ResultType<span class="sig-paren">(</span><span class="sig-paren">)</span>, ascii::space_type&gt; <code class="descname">__exponentiation</code><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar16__exponentiationE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Rule defining exponentiation. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF14TermCalculator7Grammar11__variablesE">
<span id="PSF::TermCalculator::Grammar::__variables__Variables:ResultType:"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Grammar_1a0e52c9feea49ec4dc5968641549935fe"></span><a class="reference internal" href="#_CPPv2N3PSF14TermCalculator9VariablesE" title="PSF::TermCalculator::Variables">Variables</a>&lt;ResultType&gt; <code class="descname">__variables</code><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator7Grammar11__variablesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The user defined variables that may appear in the expressions. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N3PSF14TermCalculator9VariablesE">
<span id="PSF::TermCalculator::Variables"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Variables"></span><em class="property">template </em>&lt;typename <em>ResultType</em>&gt;<br /><em class="property">class </em><code class="descname">Variables</code> : <em class="property">public</em> boost::spirit::qi::symbols&lt;char, ResultType&gt;<a class="headerlink" href="#_CPPv2N3PSF14TermCalculator9VariablesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;TermCalculator.h&gt;</em><p>A class to hold the variables that may appear it <a class="reference internal" href="#classPSF_1_1PSF"><span class="std std-ref">PSF</span></a> terms. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF14TermCalculator9Variables9VariablesEv">
<span id="PSF::TermCalculator::Variables::Variables"></span><span class="target" id="classPSF_1_1TermCalculator_1_1Variables_1a83c8bb84d5508e18bccb08b66af5eb82"></span><code class="descname">Variables</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF14TermCalculator9Variables9VariablesEv" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

</dd></dl>

<dl class="type">
<dt id="_CPPv2N3PSF13TermGeneratorE">
<span id="PSF::TermGenerator"></span><span class="target" id="namespacePSF_1_1TermGenerator"></span><em class="property">namespace </em><code class="descname">TermGenerator</code><a class="headerlink" href="#_CPPv2N3PSF13TermGeneratorE" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Variables</p>
<dl class="member">
<dt id="_CPPv2N3PSF13TermGenerator15ebnf_definitionE">
<span id="PSF::TermGenerator::ebnf_definition__ssC"></span><span class="target" id="TermCalculator_8h_1a809815097a063dc37edca74ce3ca5c07"></span><em class="property">const</em> std::string <code class="descname">ebnf_definition</code><p>=</p>
<p>            &quot;(* items in angle brackets (&lt; or &gt;) are assumed to be obvious &quot;</p>
<p>            &quot;and thus not defined. *)\n&quot;</p>
<p>            &quot;termchar = &lt;ascii character&gt; - \&quot;,\&quot; - \&quot;}\&quot; ;\n&quot;</p>
<p>            &quot;term = termchar , { termchar } ; &quot;</p>
<p>            &quot;(* mathematical expressions involving variables, floating point&quot;</p>
<p>            &quot; numbers and Pi. The complete list of mathematical functions &quot;</p>
<p>            &quot;from c++99's cmath library are supported. *)\n&quot;</p>
<p>            &quot;list = \&quot;{\&quot; , term , { \&quot;,\&quot; , term } , \&quot;}\&quot;; &quot;</p>
<p>            &quot;(* simple listing of terms to include *)\n&quot;</p>
<p>            &quot;poly = \&quot;O\&quot; , &lt;integer&gt; , list; &quot;</p>
<p>            &quot;(* Expands to all polynomial terms of up to &quot;</p>
<p>            &quot;combined order &lt;integer&gt; of the entries in list *)\n&quot;</p>
<p>            &quot;set = list | poly ;&quot;</p>
<p>            &quot;cross = set , { \&quot;*\&quot; , set } ;&quot;</p>
<p>            &quot;(* expands to the cross product of all sets. *)\n&quot;</p>
<p>            &quot;expression = cross , { \&quot;+\&quot; , cross } (* merge the terms of &quot;</p>
<p>            &quot;all cross products together. *)\n&quot;</p>
<a class="headerlink" href="#_CPPv2N3PSF13TermGenerator15ebnf_definitionE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
<dl class="class">
<dt id="_CPPv2N3PSF13TermGenerator7GrammarE">
<span id="PSF::TermGenerator::Grammar"></span><span class="target" id="classPSF_1_1TermGenerator_1_1Grammar"></span><em class="property">template </em>&lt;<em class="property">typename</em> Iterator, <em class="property">typename</em> ResultType&gt;<br /><em class="property">class </em><code class="descname">Grammar</code> : <em class="property">public</em> boost::spirit::qi::grammar&lt;Iterator, ResultType<span class="sig-paren">(</span><span class="sig-paren">)</span>, ascii::space_type&gt;<a class="headerlink" href="#_CPPv2N3PSF13TermGenerator7GrammarE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;TermCalculator.h&gt;</em><p>The grammar of the term generator language. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF13TermGenerator7Grammar7GrammarEv">
<span id="PSF::TermGenerator::Grammar::Grammar"></span><span class="target" id="classPSF_1_1TermGenerator_1_1Grammar_1afb9c720f4f9d3727b88cffd78cc3e7f7"></span><code class="descname">Grammar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF13TermGenerator7Grammar7GrammarEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create an instance. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N3PSF13TermGenerator7Grammar14add_poly_termsEjRKN10ResultType14const_iteratorERKN10ResultType14const_iteratorER10ResultTypeRKNSt6stringE">
<span id="PSF::TermGenerator::Grammar::add_poly_terms__unsigned.ResultType::const_iteratorCR.ResultType::const_iteratorCR.ResultTypeR.ssCR"></span><span class="target" id="classPSF_1_1TermGenerator_1_1Grammar_1affed0669ad2fc28b8c4a4039d4bdb541"></span>void <code class="descname">add_poly_terms</code><span class="sig-paren">(</span>unsigned <em>order</em>, <em class="property">const</em> <em class="property">typename</em> ResultType::const_iterator &amp;<em>first_input_term</em>, <em class="property">const</em> <em class="property">typename</em> ResultType::const_iterator &amp;<em>last_input_term</em>, ResultType &amp;<em>output_terms</em>, <em class="property">const</em> std::string &amp;<em>prefix</em> = &quot;&quot;<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF13TermGenerator7Grammar14add_poly_termsEjRKN10ResultType14const_iteratorERKN10ResultType14const_iteratorER10ResultTypeRKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Add all terms of a giver order to the result. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">order</span></code>: The order of the term to add (cumulative). </li>
<li><code class="docutils literal"><span class="pre">first_input_term</span></code>: The first term to use in the expansion. </li>
<li><code class="docutils literal"><span class="pre">last_input_term</span></code>: One past the last term to use in the expansion. </li>
<li><code class="docutils literal"><span class="pre">output_terms</span></code>: The container to add the generated terms to. </li>
<li><code class="docutils literal"><span class="pre">prefix</span></code>: Prefix to prepend to each added term. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF13TermGenerator7Grammar5orderEjRK10ResultTypeR10ResultType">
<span id="PSF::TermGenerator::Grammar::order__unsigned.ResultTypeCR.ResultTypeR"></span><span class="target" id="classPSF_1_1TermGenerator_1_1Grammar_1a2bb584ac2a06dd12de2b90157dd17b18"></span>void <code class="descname">order</code><span class="sig-paren">(</span>unsigned <em>max_order</em>, <em class="property">const</em> ResultType &amp;<em>input_terms</em>, ResultType &amp;<em>output_terms</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF13TermGenerator7Grammar5orderEjRK10ResultTypeR10ResultType" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Combine terms in all possible ways up to a maximum combined order. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">max_order</span></code>: The maximum cumulative order of all terms involved. </li>
<li><code class="docutils literal"><span class="pre">input_terms</span></code>: The terms to combine. </li>
<li><code class="docutils literal"><span class="pre">output_terms</span></code>: The target to fill with the combined terms. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF13TermGenerator7Grammar9cross_setER10ResultTypeRK10ResultType">
<span id="PSF::TermGenerator::Grammar::cross_set__ResultTypeR.ResultTypeCR"></span><span class="target" id="classPSF_1_1TermGenerator_1_1Grammar_1ac91be60491b7b3b128e552cc0c375baf"></span>void <code class="descname">cross_set</code><span class="sig-paren">(</span>ResultType &amp;<em>lhs</em>, <em class="property">const</em> ResultType &amp;<em>rhs</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF13TermGenerator7Grammar9cross_setER10ResultTypeRK10ResultType" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The cross product of two sets of terms. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N3PSF13TermGenerator7Grammar9union_setER10ResultTypeRK10ResultType">
<span id="PSF::TermGenerator::Grammar::union_set__ResultTypeR.ResultTypeCR"></span><span class="target" id="classPSF_1_1TermGenerator_1_1Grammar_1adc699c406852625a089e88ffccf74422"></span>void <code class="descname">union_set</code><span class="sig-paren">(</span>ResultType &amp;<em>lhs</em>, <em class="property">const</em> ResultType &amp;<em>rhs</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N3PSF13TermGenerator7Grammar9union_setER10ResultTypeRK10ResultType" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Combine the terms of two sets. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N3PSF13TermGenerator7Grammar13__simple_termE">
<span class="target" id="classPSF_1_1TermGenerator_1_1Grammar_1a0cea5dce532da73544166969d6d30716"></span>qi::rule&lt;Iterator, std::string<span class="sig-paren">(</span><span class="sig-paren">)</span>, ascii::space_type&gt; <code class="descname">__simple_term</code><a class="headerlink" href="#_CPPv2N3PSF13TermGenerator7Grammar13__simple_termE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Rule defining a single term in a comma separated list. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13TermGenerator7Grammar11__term_listE">
<span class="target" id="classPSF_1_1TermGenerator_1_1Grammar_1ae815e24998beb433b759905f9f68bc2e"></span>qi::rule&lt;Iterator, ResultType<span class="sig-paren">(</span><span class="sig-paren">)</span>, ascii::space_type&gt; <code class="descname">__term_list</code><a class="headerlink" href="#_CPPv2N3PSF13TermGenerator7Grammar11__term_listE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Rule defining a comma separated list of terms in {...}. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13TermGenerator7Grammar10__term_setE">
<span class="target" id="classPSF_1_1TermGenerator_1_1Grammar_1a4f7b3b99e4dac8921036645368115b6f"></span>qi::rule&lt;Iterator, ResultType<span class="sig-paren">(</span><span class="sig-paren">)</span>, ascii::space_type&gt; <code class="descname">__term_set</code><a class="headerlink" href="#_CPPv2N3PSF13TermGenerator7Grammar10__term_setE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Rule defining a set of terms. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13TermGenerator7Grammar15__cross_productE">
<span class="target" id="classPSF_1_1TermGenerator_1_1Grammar_1a52e994dc5885d8ae9d9d2d172512f536"></span>qi::rule&lt;Iterator, ResultType<span class="sig-paren">(</span><span class="sig-paren">)</span>, ascii::space_type&gt; <code class="descname">__cross_product</code><a class="headerlink" href="#_CPPv2N3PSF13TermGenerator7Grammar15__cross_productE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Rule defining a cross product of an arbitrary number of term sets. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3PSF13TermGenerator7Grammar12__expressionE">
<span class="target" id="classPSF_1_1TermGenerator_1_1Grammar_1aa985ba3e0b5dc2bf01664c7b22cbfffd"></span>qi::rule&lt;Iterator, ResultType<span class="sig-paren">(</span><span class="sig-paren">)</span>, ascii::space_type&gt; <code class="descname">__expression</code><a class="headerlink" href="#_CPPv2N3PSF13TermGenerator7Grammar12__expressionE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Rule defining the full generator as union of cross products. </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</dd></dl>

</div>
<div class="section" id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="_CPPv210Background">
<span id="Background"></span><span class="target" id="namespaceBackground"></span><em class="property">namespace </em><code class="descname">Background</code><a class="headerlink" href="#_CPPv210Background" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Functions</p>
<dl class="function">
<dt id="_CPPv2N10Background8validateERN5boost3anyERKNSt6vectorINSt6stringEEEP7Annulusi">
<span id="Background::validate__boost::anyR.std::vector:ss:CR.AnnulusP.i"></span><span class="target" id="Background_2CommandLineUtil_8cpp_1a69c3f064c3870bc30a65cc496f651c36"></span>void <code class="descname">validate</code><span class="sig-paren">(</span>boost::any &amp;<em>value</em>, <em class="property">const</em> std::vector&lt;std::string&gt; &amp;<em>option_strings</em>, <a class="reference internal" href="#_CPPv2N10Background7AnnulusE" title="Background::Annulus">Annulus</a> *, int<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background8validateERN5boost3anyERKNSt6vectorINSt6stringEEEP7Annulusi" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Parse a background annulus option. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">value</span></code>: The value to parse into. </li>
<li><code class="docutils literal"><span class="pre">option_strings</span></code>: The strings passed to this option on the command line. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10BackgroundlsERNSt7ostreamERK6Source">
<span id="Background::lshift-operator__osR.SourceCR"></span><span class="target" id="Source_8cpp_1a69462b8385e467f2119f7da15bc7111b"></span>std::ostream &amp;<code class="descname">operator&lt;&lt;</code><span class="sig-paren">(</span>std::ostream &amp;<em>os</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> &amp;<em>source</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10BackgroundlsERNSt7ostreamERK6Source" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Output Human readable representation of the source background to stream. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">os</span></code>: The stream to write to. </li>
<li><code class="docutils literal"><span class="pre">source</span></code>: The background under a source to output. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<dl class="class">
<dt id="_CPPv2N10Background7AnnulusE">
<span id="Background::Annulus"></span><span class="target" id="classBackground_1_1Annulus"></span><em class="property">class </em><code class="descname">Annulus</code><a class="headerlink" href="#_CPPv2N10Background7AnnulusE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;Annulus.h&gt;</em><p>The annulus used to measure the background under a source. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N10Background7Annulus7AnnulusEdd">
<span id="Background::Annulus::Annulus__double.double"></span><span class="target" id="classBackground_1_1Annulus_1a0187a4f7e39269e0f3deedee43e5e09c"></span><code class="descname">Annulus</code><span class="sig-paren">(</span>double <em>inner_radius</em> = Core::NaN, double <em>width</em> = Core::NaN<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background7Annulus7AnnulusEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Make an annulus with the given inner radius and width. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK10Background7Annulus12inner_radiusEv">
<span id="Background::Annulus::inner_radiusC"></span><span class="target" id="classBackground_1_1Annulus_1aa744c325e7792e2306ba0c1ff9626f1d"></span>double <code class="descname">inner_radius</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK10Background7Annulus12inner_radiusEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The radius of the inside boundary. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background7Annulus12inner_radiusEv">
<span id="Background::Annulus::inner_radius"></span><span class="target" id="classBackground_1_1Annulus_1a46ca8d148861acc6d3f3f3c9fe1f46f9"></span>double &amp;<code class="descname">inner_radius</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background7Annulus12inner_radiusEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The radius of the inside boundary. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK10Background7Annulus12outer_radiusEv">
<span id="Background::Annulus::outer_radiusC"></span><span class="target" id="classBackground_1_1Annulus_1a54ba70b8e376cce1348bf728d67ba2f9"></span>double <code class="descname">outer_radius</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK10Background7Annulus12outer_radiusEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The radius of the outside boundary. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK10Background7Annulus5widthEv">
<span id="Background::Annulus::widthC"></span><span class="target" id="classBackground_1_1Annulus_1aad6fc68802c5342e7cbaa345b4f6cef0"></span>double <code class="descname">width</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK10Background7Annulus5widthEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The difference between the radi of the inside and outside boundaries. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background7Annulus5widthEv">
<span id="Background::Annulus::width"></span><span class="target" id="classBackground_1_1Annulus_1a091d71607942f9fd740dd1f57973cf91"></span>double &amp;<code class="descname">width</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background7Annulus5widthEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The difference between the radi of the inside and outside boundaries. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK10Background7AnnuluscvNSt6stringEEv">
<span id="Background::Annulus::castto-ss-operatorC"></span><span class="target" id="classBackground_1_1Annulus_1a61994c2c9e70447405048aeb65c29bf8"></span><code class="descname">operator std::string</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK10Background7AnnuluscvNSt6stringEEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Represent the annulus as a string: &#8216;&lt;inner&gt;:&lt;width&gt;&#8217;. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N10Background7Annulus14__inner_radiusE">
<span id="Background::Annulus::__inner_radius__double"></span><span class="target" id="classBackground_1_1Annulus_1a5dd5b27454dd84cad939198875841d61"></span>double <code class="descname">__inner_radius</code><a class="headerlink" href="#_CPPv2N10Background7Annulus14__inner_radiusE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The radius of the inside boundary. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10Background7Annulus7__widthE">
<span id="Background::Annulus::__width__double"></span><span class="target" id="classBackground_1_1Annulus_1aca54342140bb7bd9519f42cce5295fef"></span>double <code class="descname">__width</code><a class="headerlink" href="#_CPPv2N10Background7Annulus7__widthE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Outer radius=width+inner radius. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N10Background6ManualE">
<span id="Background::Manual"></span><span class="target" id="classBackground_1_1Manual"></span><em class="property">class </em><code class="descname">Manual</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background7MeasureE" title="Background::Measure">Measure</a><a class="headerlink" href="#_CPPv2N10Background6ManualE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;Manual.h&gt;</em><p>The background is manually specified for a list of sources. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N10Background6Manual6ManualEPdPdPjj">
<span id="Background::Manual::Manual__doubleP.doubleP.unsignedP.unsigned"></span><span class="target" id="classBackground_1_1Manual_1a623b3efd61b5c23eb36b301b74801b55"></span><code class="descname">Manual</code><span class="sig-paren">(</span>double *<em>value</em>, double *<em>error</em>, unsigned *<em>num_pixels</em>, unsigned <em>num_sources</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background6Manual6ManualEPdPdPjj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Construct from c-style arrays. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">value</span></code>: The background values for all sources. </li>
<li><code class="docutils literal"><span class="pre">error</span></code>: Estimate of the background error for all sources. </li>
<li><code class="docutils literal"><span class="pre">num_pixels</span></code>: How many pixels is each of the value and error entries based on. </li>
<li><code class="docutils literal"><span class="pre">num_sources</span></code>: How many sources are known (the length of all of the above arrays). </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background6Manual10add_sourceEdd">
<span id="Background::Manual::add_source__double.double"></span><span class="target" id="classBackground_1_1Manual_1aeb3b812102c27bb16e01b5a52a5e0f53"></span><em class="property">virtual</em> void <code class="descname">add_source</code><span class="sig-paren">(</span>double, double<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background6Manual10add_sourceEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Adding sources is not supported. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background6Manual10add_sourceERKN4Core5PointIdEE">
<span id="Background::Manual::add_source__Core::Point:double:CR"></span><span class="target" id="classBackground_1_1Manual_1a780468a3b6f4ce68e9a3f23b8553ccc7"></span><em class="property">virtual</em> void <code class="descname">add_source</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5PointE" title="Core::Point">Point</a>&lt;double&gt;&amp;<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background6Manual10add_sourceERKN4Core5PointIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Adding sources is not supported. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK10Background6ManualclEv">
<span id="Background::Manual::call-operatorC"></span><span class="target" id="classBackground_1_1Manual_1ad327cfb9c447945a32280f7202e0ce40"></span><em class="property">virtual</em> <a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> <code class="descname">operator()</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK10Background6ManualclEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Estimate the background around the current source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background6Manual11next_sourceEv">
<span id="Background::Manual::next_source"></span><span class="target" id="classBackground_1_1Manual_1a79716fb810a0ab5cdea41ceeea73b3f0"></span><em class="property">virtual</em> bool <code class="descname">next_source</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background6Manual11next_sourceEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Jump to the next source. </p>
<p>The next evaluation (operator()) will return the background estimate for the next source. Retruns true iff the new source exists. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background6Manual15previous_sourceEv">
<span id="Background::Manual::previous_source"></span><span class="target" id="classBackground_1_1Manual_1aeaa67ab6f5d15968d562795d222c78be"></span><em class="property">virtual</em> bool <code class="descname">previous_source</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background6Manual15previous_sourceEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Move one source back. Returns true iff the new source exists. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background6Manual20jump_to_first_sourceEv">
<span id="Background::Manual::jump_to_first_source"></span><span class="target" id="classBackground_1_1Manual_1adfc62dd24cad408be61f566081ca0f0b"></span><em class="property">virtual</em> void <code class="descname">jump_to_first_source</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background6Manual20jump_to_first_sourceEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Restart iteration over sources from the beginning. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N10Background6Manual9__sourcesE">
<span id="Background::Manual::__sources__std::vector:Source:"></span><span class="target" id="classBackground_1_1Manual_1acd1e113205dd8454a47c2a20a2ff3330"></span>std::vector&lt;<a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a>&gt; <code class="descname">__sources</code><a class="headerlink" href="#_CPPv2N10Background6Manual9__sourcesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The sources for which background is known. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10Background6Manual16__current_sourceE">
<span id="Background::Manual::__current_source__std::vector:Source:::const_iterator"></span><span class="target" id="classBackground_1_1Manual_1abbbccbdb5f9e1dd4c1bf6c66fc007c2d"></span>std::vector&lt;<a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a>&gt;::const_iterator <code class="descname">__current_source</code><a class="headerlink" href="#_CPPv2N10Background6Manual16__current_sourceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The current source. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N10Background7MeasureE">
<span id="Background::Measure"></span><span class="target" id="classBackground_1_1Measure"></span><em class="property">class </em><code class="descname">Measure</code><a class="headerlink" href="#_CPPv2N10Background7MeasureE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;Measure.h&gt;</em><p>The minimum requirements for a Background extractor class. </p>
<p>Subclassed by <a class="reference internal" href="#classBackground_1_1Manual"><span class="std std-ref">Background::Manual</span></a>, <a class="reference internal" href="#classBackground_1_1MeasureExcludingSources"><span class="std std-ref">Background::MeasureExcludingSources</span></a>, <a class="reference internal" href="#classBackground_1_1Zero"><span class="std std-ref">Background::Zero</span></a></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N10Background7Measure10add_sourceEdd">
<span id="Background::Measure::add_source__double.double"></span><span class="target" id="classBackground_1_1Measure_1a837b677b35989884ad0506b53523bbc8"></span><em class="property">virtual</em> void <code class="descname">add_source</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em><span class="sig-paren">)</span> = 0<a class="headerlink" href="#_CPPv2N10Background7Measure10add_sourceEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Notify the background extractor of (another) source at the given location. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background7Measure10add_sourceERKN4Core5PointIdEE">
<span id="Background::Measure::add_source__Core::Point:double:CR"></span><span class="target" id="classBackground_1_1Measure_1adfc2bee20e5d6ace02d9bd04b558b438"></span><em class="property">virtual</em> void <code class="descname">add_source</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5PointE" title="Core::Point">Point</a>&lt;double&gt; &amp;<em>location</em><span class="sig-paren">)</span> = 0<a class="headerlink" href="#_CPPv2N10Background7Measure10add_sourceERKN4Core5PointIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classBackground_1_1Measure_1a837b677b35989884ad0506b53523bbc8"><span class="std std-ref">add_source(double, double)</span></a>. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK10Background7MeasureclEv">
<span id="Background::Measure::call-operatorC"></span><span class="target" id="classBackground_1_1Measure_1a89083050439dece3bda6dc4d8a669a09"></span><em class="property">virtual</em> <a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> <code class="descname">operator()</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em> = 0<a class="headerlink" href="#_CPPv2NK10Background7MeasureclEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Estimate the background around the current source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background7Measure11next_sourceEv">
<span id="Background::Measure::next_source"></span><span class="target" id="classBackground_1_1Measure_1ab0bc9cbcffc43dc36103dd38a030e11b"></span><em class="property">virtual</em> bool <code class="descname">next_source</code><span class="sig-paren">(</span><span class="sig-paren">)</span> = 0<a class="headerlink" href="#_CPPv2N10Background7Measure11next_sourceEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Jump to the next source. </p>
<p>The next evaluation (operator()) will return the background estimate for the next source. Retruns true iff the new source exists. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background7Measure15previous_sourceEv">
<span id="Background::Measure::previous_source"></span><span class="target" id="classBackground_1_1Measure_1a9fe0820abcf07c92067ea12179aa29f8"></span><em class="property">virtual</em> bool <code class="descname">previous_source</code><span class="sig-paren">(</span><span class="sig-paren">)</span> = 0<a class="headerlink" href="#_CPPv2N10Background7Measure15previous_sourceEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Move one source back. Returns true iff the new source exists. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background7Measure20jump_to_first_sourceEv">
<span id="Background::Measure::jump_to_first_source"></span><span class="target" id="classBackground_1_1Measure_1acbb3fcabba49990e8910165208bef2cf"></span><em class="property">virtual</em> void <code class="descname">jump_to_first_source</code><span class="sig-paren">(</span><span class="sig-paren">)</span> = 0<a class="headerlink" href="#_CPPv2N10Background7Measure20jump_to_first_sourceEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Restart iteration over sources from the beginning. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background7MeasureD0Ev">
<span id="Background::Measure::~Measure"></span><span class="target" id="classBackground_1_1Measure_1a8b98199d3291b0eb580772899cd6e364"></span><em class="property">virtual</em> <code class="descname">~Measure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background7MeasureD0Ev" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Do nothing by default. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N10Background14MeasureAnnulusE">
<span id="Background::MeasureAnnulus"></span><span class="target" id="classBackground_1_1MeasureAnnulus"></span><em class="property">class </em><code class="descname">MeasureAnnulus</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background23MeasureExcludingSourcesE" title="Background::MeasureExcludingSources">MeasureExcludingSources</a><a class="headerlink" href="#_CPPv2N10Background14MeasureAnnulusE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;MeasureAnnulus.h&gt;</em><p><a class="reference internal" href="#classBackground_1_1Measure"><span class="std std-ref">Measure</span></a> the background in an annulus around each source. </p>
<p>Uses the pixels whose centers lie between two circles centered on each source to estimate the background (median) and its error (quantiles in the individual pixel values).</p>
<p>Pixels within the annulus for a given source are not included in the background determination if they fall inside the exclusion radius of another source. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N10Background14MeasureAnnulus14MeasureAnnulusEdddRKN4Core5ImageIdEEd">
<span id="Background::MeasureAnnulus::MeasureAnnulus__double.double.double.Core::Image:double:CR.double"></span><span class="target" id="classBackground_1_1MeasureAnnulus_1ad87d8214f96e2cf928e2e6bcb91b6bc7"></span><code class="descname">MeasureAnnulus</code><span class="sig-paren">(</span>double <em>inner_radius</em>, double <em>outer_radius</em>, double <em>exclude_aperture</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5ImageE" title="Core::Image">Image</a>&lt;double&gt; &amp;<em>image</em>, double <em>error_confidence</em> = 0.68<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background14MeasureAnnulus14MeasureAnnulusEdddRKN4Core5ImageIdEEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Use the given radii to determive background. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">inner_radius</span></code>: Inner radius of the annulus used for background determination. </li>
<li><code class="docutils literal"><span class="pre">outer_radius</span></code>: Outer radius of the annulus used for background determination. </li>
<li><code class="docutils literal"><span class="pre">exclude_aperture</span></code>: Size of the area to exclude from other source&#8217;s annuli. </li>
<li><code class="docutils literal"><span class="pre">image</span></code>: The image to determine the backgrounds on. </li>
<li><code class="docutils literal"><span class="pre">error_confidence</span></code>: The confidence to require of the error estimate. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background14MeasureAnnulus14MeasureAnnulusEdddRKN4Core5ImageIdEERKNSt4listI10POINT_TYPEEEd">
<span id="Background::MeasureAnnulus::MeasureAnnulus__double.double.double.Core::Image:double:CR.std::list:POINT_TYPE:CR.double"></span><em class="property">template </em>&lt;<em class="property">class</em> POINT_TYPE&gt;<br /><span class="target" id="classBackground_1_1MeasureAnnulus_1a7aefaa75f2be4e63f3fcf12fb69b1537"></span><code class="descname">MeasureAnnulus</code><span class="sig-paren">(</span>double <em>inner_radius</em>, double <em>outer_radius</em>, double <em>exclude_aperture</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5ImageE" title="Core::Image">Image</a>&lt;double&gt; &amp;<em>image</em>, <em class="property">const</em> std::list&lt;POINT_TYPE&gt; &amp;<em>sources</em>, double <em>error_confidence</em> = 0.68<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background14MeasureAnnulus14MeasureAnnulusEdddRKN4Core5ImageIdEERKNSt4listI10POINT_TYPEEEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Use the given radii to determive background. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">inner_radius</span></code>: Inner radius of the annulus used for background determination. </li>
<li><code class="docutils literal"><span class="pre">outer_radius</span></code>: Outer radius of the annulus used for background determination. </li>
<li><code class="docutils literal"><span class="pre">exclude_aperture</span></code>: Size of the area to exclude from other source&#8217;s annuli. </li>
<li><code class="docutils literal"><span class="pre">image</span></code>: The image to determine the backgrounds on. </li>
<li><code class="docutils literal"><span class="pre">sources</span></code>: The sources in the image. </li>
<li><code class="docutils literal"><span class="pre">error_confidence</span></code>: The confidence to require of the error estimate. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK10Background14MeasureAnnulusclEdd">
<span id="Background::MeasureAnnulus::call-operator__double.doubleC"></span><span class="target" id="classBackground_1_1MeasureAnnulus_1ae6483d4a18b99c25c1a3f330768d8798"></span><a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> <code class="descname">operator()</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK10Background14MeasureAnnulusclEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>measure the background for a source at (x,y). </p>
<p>Estimate the background around the given position as the median of the points whose centers lie within the annulus and not within the inner edge of another source&#8217;s annulus.</p>
<p>The uncertainty of the determined value is estimated as <span class="math">\(\sqrt{\frac{\pi}{2(N-1)}}\)</span> times half the size of the interval centered on the determined background value that contains the fraction of the points specified at construction as the error_confidence argument. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N10Background14MeasureAnnulus14__inner_radiusE">
<span id="Background::MeasureAnnulus::__inner_radius__double"></span><span class="target" id="classBackground_1_1MeasureAnnulus_1a43cd41aee138f5a91feb756e61ae9edb"></span>double <code class="descname">__inner_radius</code><a class="headerlink" href="#_CPPv2N10Background14MeasureAnnulus14__inner_radiusE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The inner radius of the region around a source used to deterime the background. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10Background14MeasureAnnulus14__outer_radiusE">
<span id="Background::MeasureAnnulus::__outer_radius__double"></span><span class="target" id="classBackground_1_1MeasureAnnulus_1aa7f68b5731239c99c27a573b20d7b4bd"></span>double <code class="descname">__outer_radius</code><a class="headerlink" href="#_CPPv2N10Background14MeasureAnnulus14__outer_radiusE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The outer radius of the region around a source used to deterime the background. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10Background14MeasureAnnulus18__error_confidenceE">
<span id="Background::MeasureAnnulus::__error_confidence__double"></span><span class="target" id="classBackground_1_1MeasureAnnulus_1a5e750e3be73d14dd7c8219fdc189ac6f"></span>double <code class="descname">__error_confidence</code><a class="headerlink" href="#_CPPv2N10Background14MeasureAnnulus18__error_confidenceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>What fraction of the pixels on which the background is based should fall within the error range. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N10Background23MeasureExcludingSourcesE">
<span id="Background::MeasureExcludingSources"></span><span class="target" id="classBackground_1_1MeasureExcludingSources"></span><em class="property">class </em><code class="descname">MeasureExcludingSources</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background7MeasureE" title="Background::Measure">Measure</a><a class="headerlink" href="#_CPPv2N10Background23MeasureExcludingSourcesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;MeasureExcludingSources.h&gt;</em><p>Avoid pixels close to sources when extracting a background. </p>
<p>A base class for background extractors which exclude some circular aperture around every source when determining the backgrounds of other sources.</p>
<p>Masks (assigns NaN to) the pixels in the given image whose centers lie within the specified aperture of at least one source. This masked array can then be used by a non-abstract child class to derive a background value and uncertainty. </p>
<p>Subclassed by <a class="reference internal" href="#classBackground_1_1MeasureAnnulus"><span class="std std-ref">Background::MeasureAnnulus</span></a></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N10Background23MeasureExcludingSources23MeasureExcludingSourcesERKN4Core5ImageIdEEd">
<span id="Background::MeasureExcludingSources::MeasureExcludingSources__Core::Image:double:CR.double"></span><span class="target" id="classBackground_1_1MeasureExcludingSources_1abf84de066a9b352e5f3e9f86c0f420c3"></span><code class="descname">MeasureExcludingSources</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5ImageE" title="Core::Image">Image</a>&lt;double&gt; &amp;<em>image</em>, double <em>exclude_aperture</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background23MeasureExcludingSources23MeasureExcludingSourcesERKN4Core5ImageIdEEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Construct a background extractor for the given image excluding pixels with centers inside the given aperture around all sources. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">image</span></code>: The image for which background extraction is to be done. </li>
<li><code class="docutils literal"><span class="pre">exclude_aperture</span></code>: The size of the aperture to exclude around each source. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background23MeasureExcludingSources23MeasureExcludingSourcesERKN4Core5ImageIdEEdRKNSt4listI10POINT_TYPEEE">
<span id="Background::MeasureExcludingSources::MeasureExcludingSources__Core::Image:double:CR.double.std::list:POINT_TYPE:CR"></span><em class="property">template </em>&lt;<em class="property">class</em> POINT_TYPE&gt;<br /><span class="target" id="classBackground_1_1MeasureExcludingSources_1a83b738ab93228333240b38c6fe9b319d"></span><code class="descname">MeasureExcludingSources</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5ImageE" title="Core::Image">Image</a>&lt;double&gt; &amp;<em>image</em>, double <em>exclude_aperture</em>, <em class="property">const</em> std::list&lt;POINT_TYPE&gt; &amp;<em>sources</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background23MeasureExcludingSources23MeasureExcludingSourcesERKN4Core5ImageIdEEdRKNSt4listI10POINT_TYPEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Construct a background extractor for the given image excluding pixels with centers inside the given aperture around all listed sources. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">image</span></code>: The image for which background extraction is to be done. </li>
<li><code class="docutils literal"><span class="pre">exclude_aperture</span></code>: The size of the aperture to exclude around each source. </li>
<li><code class="docutils literal"><span class="pre">sources</span></code>: The sources in the image. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background23MeasureExcludingSources10add_sourceEdd">
<span id="Background::MeasureExcludingSources::add_source__double.double"></span><span class="target" id="classBackground_1_1MeasureExcludingSources_1a7d68a9e2432ccc6caf62e36cac3e7942"></span>void <code class="descname">add_source</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background23MeasureExcludingSources10add_sourceEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Add a source. </p>
<p>Register another source and remove the values in its aperture from _bg_values. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background23MeasureExcludingSources10add_sourceERKN4Core5PointIdEE">
<span id="Background::MeasureExcludingSources::add_source__Core::Point:double:CR"></span><span class="target" id="classBackground_1_1MeasureExcludingSources_1a337e1129603eb312fc6ecce85bdbb9e8"></span><em class="property">virtual</em> void <code class="descname">add_source</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5PointE" title="Core::Point">Point</a>&lt;double&gt; &amp;<em>location</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background23MeasureExcludingSources10add_sourceERKN4Core5PointIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classBackground_1_1MeasureExcludingSources_1a7d68a9e2432ccc6caf62e36cac3e7942"><span class="std std-ref">add_source(double, double)</span></a> </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background23MeasureExcludingSources10add_sourceEPKN4Core5PointIdEE">
<span id="Background::MeasureExcludingSources::add_source__Core::Point:double:CP"></span><span class="target" id="classBackground_1_1MeasureExcludingSources_1aa68e8a3c2741927aedbb505b8f4dea4f"></span><em class="property">virtual</em> void <code class="descname">add_source</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5PointE" title="Core::Point">Point</a>&lt;double&gt; *<em>location</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background23MeasureExcludingSources10add_sourceEPKN4Core5PointIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classBackground_1_1MeasureExcludingSources_1a7d68a9e2432ccc6caf62e36cac3e7942"><span class="std std-ref">add_source(double, double)</span></a> </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK10Background23MeasureExcludingSourcesclEv">
<span id="Background::MeasureExcludingSources::call-operatorC"></span><span class="target" id="classBackground_1_1MeasureExcludingSources_1a285770ad49963da07a7fd825809fb0b0"></span><em class="property">virtual</em> <a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> <code class="descname">operator()</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK10Background23MeasureExcludingSourcesclEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Estimate the background around the current source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK10Background23MeasureExcludingSourcesclERKN4Core5PointIdEE">
<span id="Background::MeasureExcludingSources::call-operator__Core::Point:double:CRC"></span><span class="target" id="classBackground_1_1MeasureExcludingSources_1a2af1430bb751dc2b6096422feb68e0b8"></span><em class="property">virtual</em> <a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> <code class="descname">operator()</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5PointE" title="Core::Point">Point</a>&lt;double&gt; &amp;<em>location</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK10Background23MeasureExcludingSourcesclERKN4Core5PointIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Estimate the background around the given position. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK10Background23MeasureExcludingSourcesclEdd">
<span id="Background::MeasureExcludingSources::call-operator__double.doubleC"></span><span class="target" id="classBackground_1_1MeasureExcludingSources_1a4c45472a4f4ef10b185e4354a8e58a2e"></span><em class="property">virtual</em> <a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> <code class="descname">operator()</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em><span class="sig-paren">)</span> <em class="property">const</em> = 0<a class="headerlink" href="#_CPPv2NK10Background23MeasureExcludingSourcesclEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Estimate the background around the given position. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background23MeasureExcludingSources11next_sourceEv">
<span id="Background::MeasureExcludingSources::next_source"></span><span class="target" id="classBackground_1_1MeasureExcludingSources_1a2c6c0da54ca6387fbc869edf359d1ca0"></span><em class="property">virtual</em> bool <code class="descname">next_source</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background23MeasureExcludingSources11next_sourceEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Jump to the next source and return true iff it exists. </p>
<p>The next evaluation (operator()) will return the background estimate for the next source. Retruns true iff the new source exists. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background23MeasureExcludingSources15previous_sourceEv">
<span id="Background::MeasureExcludingSources::previous_source"></span><span class="target" id="classBackground_1_1MeasureExcludingSources_1afde4a794bb500690a48d5cc6573f98dc"></span><em class="property">virtual</em> bool <code class="descname">previous_source</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background23MeasureExcludingSources15previous_sourceEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Move one source back. Returns true iff the new source exists. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background23MeasureExcludingSources20jump_to_first_sourceEv">
<span id="Background::MeasureExcludingSources::jump_to_first_source"></span><span class="target" id="classBackground_1_1MeasureExcludingSources_1a8671d331a41144b8c47c07a8bb8f62e4"></span><em class="property">virtual</em> void <code class="descname">jump_to_first_source</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background23MeasureExcludingSources20jump_to_first_sourceEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Restart iteration over sources from the beginning. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Protected Attributes</p>
<dl class="member">
<dt id="_CPPv2N10Background23MeasureExcludingSources8_sourcesE">
<span id="Background::MeasureExcludingSources::_sources__std::list:Core::Point:double::"></span><span class="target" id="classBackground_1_1MeasureExcludingSources_1ad5e2b1b72fd7a7c4cec50015bdcc0382"></span>std::list&lt;<a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5PointE" title="Core::Point">Point</a>&lt;double&gt;&gt; <code class="descname">_sources</code><a class="headerlink" href="#_CPPv2N10Background23MeasureExcludingSources8_sourcesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The sources in the image. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10Background23MeasureExcludingSources10_bg_valuesE">
<span id="Background::MeasureExcludingSources::_bg_values__Core::Image:double:"></span><span class="target" id="classBackground_1_1MeasureExcludingSources_1abde4fc244295c1927f50780188af3589"></span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5ImageE" title="Core::Image">Image</a>&lt;double&gt; <code class="descname">_bg_values</code><a class="headerlink" href="#_CPPv2N10Background23MeasureExcludingSources10_bg_valuesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The original image with the areas near sources masked. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N10Background23MeasureExcludingSources12exclude_maskEv">
<span id="Background::MeasureExcludingSources::exclude_mask"></span><span class="target" id="classBackground_1_1MeasureExcludingSources_1a89eba873d3a721b6c6a0a6f99492b9b5"></span>void <code class="descname">exclude_mask</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background23MeasureExcludingSources12exclude_maskEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Excludes all pixels which have a mask other than GOOD. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N10Background23MeasureExcludingSources10__apertureE">
<span id="Background::MeasureExcludingSources::__aperture__double"></span><span class="target" id="classBackground_1_1MeasureExcludingSources_1ac967abac64ec6d4ed6ef29743b5dd277"></span>double <code class="descname">__aperture</code><a class="headerlink" href="#_CPPv2N10Background23MeasureExcludingSources10__apertureE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The radius of the exclusion area around each source. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10Background23MeasureExcludingSources13__source_iterE">
<span id="Background::MeasureExcludingSources::__source_iter__std::list:Core::Point:double::::const_iterator"></span><span class="target" id="classBackground_1_1MeasureExcludingSources_1ad9c808f0ec70ef24d16c3a0378b9d42a"></span>std::list&lt;<a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5PointE" title="Core::Point">Point</a>&lt;double&gt;&gt;::const_iterator <code class="descname">__source_iter</code><a class="headerlink" href="#_CPPv2N10Background23MeasureExcludingSources13__source_iterE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>An iterator over the sources in the image. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N10Background6SourceE">
<span id="Background::Source"></span><span class="target" id="classBackground_1_1Source"></span><em class="property">class </em><code class="descname">Source</code><a class="headerlink" href="#_CPPv2N10Background6SourceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;Source.h&gt;</em><p>The base class for the backgnound under a source. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Unnamed Group</p>
<dl class="function">
<dt id="_CPPv2NK10Background6Source5valueEv">
<span id="Background::Source::valueC"></span><span class="target" id="classBackground_1_1Source_1af2ac08dfe0798dfef4976df04dd3e2a1"></span>double <code class="descname">value</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK10Background6Source5valueEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The best estimate of the background level under the source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background6Source5valueEv">
<span id="Background::Source::value"></span><span class="target" id="classBackground_1_1Source_1aa59fa244f6a395de23f23889840f5448"></span>double &amp;<code class="descname">value</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background6Source5valueEv" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Unnamed Group</p>
<dl class="function">
<dt id="_CPPv2NK10Background6Source5errorEv">
<span id="Background::Source::errorC"></span><span class="target" id="classBackground_1_1Source_1a6f684bd10023c42276f12a068ed496d4"></span>double <code class="descname">error</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK10Background6Source5errorEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The best estimate of the uncertainty in the backgronud determination. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background6Source5errorEv">
<span id="Background::Source::error"></span><span class="target" id="classBackground_1_1Source_1a9b1287590117f0c9e588115cf1151381"></span>double &amp;<code class="descname">error</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background6Source5errorEv" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Unnamed Group</p>
<dl class="function">
<dt id="_CPPv2NK10Background6Source6pixelsEv">
<span id="Background::Source::pixelsC"></span><span class="target" id="classBackground_1_1Source_1a16498e61309bd1064e79b9ee52e45ae1"></span>unsigned <code class="descname">pixels</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK10Background6Source6pixelsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of pixels that contributed to the determination of the value and error. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background6Source6pixelsEv">
<span id="Background::Source::pixels"></span><span class="target" id="classBackground_1_1Source_1a2f391d8902748745026d56274a7cf4d5"></span>unsigned &amp;<code class="descname">pixels</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background6Source6pixelsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N10Background6Source6SourceEddj">
<span id="Background::Source::Source__double.double.unsigned"></span><span class="target" id="classBackground_1_1Source_1acab15cc1c07f2b7eea36783796de40ba"></span><code class="descname">Source</code><span class="sig-paren">(</span>double <em>value</em> = Core::NaN, double <em>error</em> = Core::NaN, unsigned <em>pixels</em> = 0<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background6Source6SourceEddj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a background object. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">value</span></code>: Value of the background </li>
<li><code class="docutils literal"><span class="pre">error</span></code>: Uncertainty in the background value </li>
<li><code class="docutils literal"><span class="pre">pixels</span></code>: Number of pixels used in the measurement </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N10Background6Source7__valueE">
<span id="Background::Source::__value__double"></span><span class="target" id="classBackground_1_1Source_1a8d3a23e892abb1f8b08c410e35c5fb87"></span>double <code class="descname">__value</code><a class="headerlink" href="#_CPPv2N10Background6Source7__valueE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>An estimate of the background for the source. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10Background6Source7__errorE">
<span id="Background::Source::__error__double"></span><span class="target" id="classBackground_1_1Source_1a815975fb8c4670bb7f2d67eb10e6e6a2"></span>double <code class="descname">__error</code><a class="headerlink" href="#_CPPv2N10Background6Source7__errorE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>An estimate of the uncertainty in the value. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10Background6Source8__pixelsE">
<span id="Background::Source::__pixels__unsigned"></span><span class="target" id="classBackground_1_1Source_1af0ddfc8b5cd00dc33f7f2bdaa3bc9cb2"></span>unsigned <code class="descname">__pixels</code><a class="headerlink" href="#_CPPv2N10Background6Source8__pixelsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>How many pixels were incuded in the determination. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N10Background4ZeroE">
<span id="Background::Zero"></span><span class="target" id="classBackground_1_1Zero"></span><em class="property">class </em><code class="descname">Zero</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background7MeasureE" title="Background::Measure">Measure</a><a class="headerlink" href="#_CPPv2N10Background4ZeroE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;Zero.h&gt;</em><p>The background is assumed already subtracted from the input image. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N10Background4Zero4ZeroEv">
<span id="Background::Zero::Zero"></span><span class="target" id="classBackground_1_1Zero_1aa97e705b3c22f756748bca1a2a148b86"></span><code class="descname">Zero</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background4Zero4ZeroEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Default constructor. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background4Zero4ZeroEj">
<span id="Background::Zero::Zero__unsigned"></span><span class="target" id="classBackground_1_1Zero_1a347ccc5da8de52e13baec7b9d0d36154"></span><code class="descname">Zero</code><span class="sig-paren">(</span>unsigned <em>number_sources</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background4Zero4ZeroEj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><a class="reference internal" href="#classBackground_1_1Zero"><span class="std std-ref">Zero</span></a> background for the given number of sources. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background4Zero10add_sourceEdd">
<span id="Background::Zero::add_source__double.double"></span><span class="target" id="classBackground_1_1Zero_1acb13a735ebf8177d8fe4f6f2dd5c5ac8"></span>void <code class="descname">add_source</code><span class="sig-paren">(</span>double, double<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background4Zero10add_sourceEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classBackground_1_1Measure_1a837b677b35989884ad0506b53523bbc8"><span class="std std-ref">Measure::add_source(double, double)</span></a> </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background4Zero10add_sourceERKN4Core5PointIdEE">
<span id="Background::Zero::add_source__Core::Point:double:CR"></span><span class="target" id="classBackground_1_1Zero_1a0c1cdaf2bf40adaaf833b2111259e6e3"></span>void <code class="descname">add_source</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5PointE" title="Core::Point">Point</a>&lt;double&gt;&amp;<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background4Zero10add_sourceERKN4Core5PointIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classBackground_1_1Measure_1adfc2bee20e5d6ace02d9bd04b558b438"><span class="std std-ref">Measure::add_source(const Core::Point&lt;double&gt; &amp;)</span></a> </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK10Background4ZeroclEv">
<span id="Background::Zero::call-operatorC"></span><span class="target" id="classBackground_1_1Zero_1a6495bfa22ef600695547e14506ee8e8a"></span><a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> <code class="descname">operator()</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK10Background4ZeroclEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Estimate the background around the current source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background4Zero11next_sourceEv">
<span id="Background::Zero::next_source"></span><span class="target" id="classBackground_1_1Zero_1ac5ebfae60ce81aee1599a60a5d4a8406"></span>bool <code class="descname">next_source</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background4Zero11next_sourceEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Jump to the next source. </p>
<p>The next evaluation (operator()) will return the background estimate for the next source. Retruns true iff the new source exists. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background4Zero15previous_sourceEv">
<span id="Background::Zero::previous_source"></span><span class="target" id="classBackground_1_1Zero_1ae931784f7124eb30ff1ab24cd12a8852"></span>bool <code class="descname">previous_source</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background4Zero15previous_sourceEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Move one source back. Returns true iff the new source exists. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N10Background4Zero20jump_to_first_sourceEv">
<span id="Background::Zero::jump_to_first_source"></span><span class="target" id="classBackground_1_1Zero_1a910acbc34a8787baa93b17c08a2d2a2c"></span><em class="property">virtual</em> void <code class="descname">jump_to_first_source</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N10Background4Zero20jump_to_first_sourceEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Restart iteration over sources from the beginning. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N10Background4Zero16__number_sourcesE">
<span id="Background::Zero::__number_sources__unsigned"></span><span class="target" id="classBackground_1_1Zero_1a2d0e48ebd1418971b499bed7fa1590a7"></span>unsigned <code class="descname">__number_sources</code><a class="headerlink" href="#_CPPv2N10Background4Zero16__number_sourcesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>How many sources have been added so far. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10Background4Zero15__current_indexE">
<span id="Background::Zero::__current_index__unsigned"></span><span class="target" id="classBackground_1_1Zero_1a642c104dfa3199f807566353a2ff4f69"></span>unsigned <code class="descname">__current_index</code><a class="headerlink" href="#_CPPv2N10Background4Zero15__current_indexE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The index of the currently selected source. </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="io">
<h2>IO<a class="headerlink" href="#io" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="_CPPv22IO">
<span id="IO"></span><span class="target" id="namespaceIO"></span><em class="property">namespace </em><code class="descname">IO</code><a class="headerlink" href="#_CPPv22IO" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Typedefs</p>
<dl class="type">
<dt id="_CPPv2N2IO10IOTreeBaseE">
<span id="IO::IOTreeBase"></span><span class="target" id="H5IODataTree_8h_1acacf08f9d944a251e55cb8eb68937805"></span><em class="property">typedef </em>boost::property_tree::basic_ptree&lt;std::string, boost::any&gt; <code class="descname">IOTreeBase</code><a class="headerlink" href="#_CPPv2N2IO10IOTreeBaseE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Convenience alias for the boost base class for the IO tree. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Functions</p>
<dl class="function">
<dt id="_CPPv2N2IO13double_to_intEPd6size_tdPmPlPmPi">
<span id="IO::double_to_int__doubleP.s.double.unsigned-l-iP.lP.unsigned-l-iP.iP"></span><span class="target" id="Binary_8cpp_1a948ffc6428d481a45c806cdc62c62bd5"></span>int <code class="descname">double_to_int</code><span class="sig-paren">(</span>double *<em>values</em>, size_t <em>val_count</em>, double <em>precision</em>, unsigned long int *<em>converted</em>, long *<em>offset</em>, unsigned long int *<em>max</em>, int *<em>has_nan</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO13double_to_intEPd6size_tdPmPlPmPi" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO9nan_valueEi">
<span id="IO::nan_value__i"></span><span class="target" id="Binary_8cpp_1a7e3d8557f125528664bd968bef5025ae"></span>unsigned long int <code class="descname">nan_value</code><span class="sig-paren">(</span>int <em>num_bits</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO9nan_valueEi" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO4pushEmiiPc">
<span id="IO::push__unsigned-l.i.i.cP"></span><span class="target" id="Binary_8cpp_1ad696e51265bd2a3cdf11f0e1647ade02"></span>void <code class="descname">push</code><span class="sig-paren">(</span>unsigned long <em>val</em>, int, int <em>bit_offset</em>, char *<em>dest</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO4pushEmiiPc" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO3popEiiPc">
<span id="IO::pop__i.i.cP"></span><span class="target" id="Binary_8cpp_1a6c4e60a8cbe36e316068d8387123a038"></span>unsigned long <code class="descname">pop</code><span class="sig-paren">(</span>int <em>num_bits</em>, int <em>offset</em>, char *<em>source</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO3popEiiPc" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO4packEPmP4FILEmmi">
<span id="IO::pack__unsigned-lP.FILEP.unsigned-l.unsigned-l.i"></span><span class="target" id="Binary_8cpp_1ab8ac5c10222326e3fb814ae2b82072b0"></span>void <code class="descname">pack</code><span class="sig-paren">(</span>unsigned long *<em>values</em>, FILE *<em>outfile</em>, unsigned long <em>val_count</em>, unsigned long <em>max_value</em>, int <em>has_nan</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO4packEPmP4FILEmmi" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO13bin_chararrayEiildPmmmPPcPm">
<span id="IO::bin_chararray__i.i.l.double.unsigned-lP.unsigned-l.unsigned-l.cPP.unsigned-lP"></span><span class="target" id="Binary_8cpp_1a86197856b1a2fe94d41ba2719e4edf1b"></span>int <code class="descname">bin_chararray</code><span class="sig-paren">(</span>int <em>type_id</em>, int <em>has_nan</em>, long <em>offset</em>, double <em>precision</em>, unsigned long *<em>truncated</em>, unsigned long <em>val_count</em>, unsigned long <em>max_value</em>, char **<em>packed</em>, unsigned long *<em>num_bytes</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO13bin_chararrayEiildPmmmPPcPm" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO13int_to_binaryEPi6size_tPmPPc">
<span id="IO::int_to_binary__iP.s.unsigned-l-iP.cPP"></span><span class="target" id="Binary_8cpp_1ab1264bbd7b33e32ef307976eb1f09991"></span>int <code class="descname">int_to_binary</code><span class="sig-paren">(</span>int *<em>values</em>, size_t <em>val_count</em>, unsigned long int *<em>num_bytes</em>, char **<em>packed</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO13int_to_binaryEPi6size_tPmPPc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Packs the given integer values to an array of characters, along with all the information required to read that array from a file. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO16double_to_binaryEPd6size_tdiPmPPc">
<span id="IO::double_to_binary__doubleP.s.double.i.unsigned-l-iP.cPP"></span><span class="target" id="Binary_8cpp_1a8c4949a792ea8c62a657d9a76820460e"></span>int <code class="descname">double_to_binary</code><span class="sig-paren">(</span>double *<em>values</em>, size_t <em>val_count</em>, double <em>precision</em>, int <em>has_nan</em>, unsigned long int *<em>num_bytes</em>, char **<em>packed</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO16double_to_binaryEPd6size_tdiPmPPc" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO10bin_outputEP4FILEPv6size_tiz">
<span id="IO::bin_output__FILEP.voidP.s.i.z"></span><span class="target" id="Binary_8cpp_1a5669a682224ecdea1d4316f6b0ce7f83"></span>int <code class="descname">bin_output</code><span class="sig-paren">(</span>FILE *<em>outfile</em>, void *<em>values</em>, size_t <em>val_count</em>, int <em>type_id</em>, ...<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO10bin_outputEP4FILEPv6size_tiz" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO9bin_inputEP4FILEPiPmPKm">
<span id="IO::bin_input__FILEP.iP.unsigned-lP.unsigned-lCP"></span><span class="target" id="Binary_8cpp_1afb07ddf7c8d1c6f03d2d18cd73a0e926"></span>void *<code class="descname">bin_input</code><span class="sig-paren">(</span>FILE *<em>infile</em>, int *<em>type_id</em>, unsigned long *<em>val_count</em>, <em class="property">const</em> unsigned long *<em>indices</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO9bin_inputEP4FILEPiPmPKm" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14bin_input_skipEP4FILE">
<span id="IO::bin_input_skip__FILEP"></span><span class="target" id="Binary_8cpp_1a8aeb926dfc767a32f8d070ef2bdfe7a8"></span>int <code class="descname">bin_input_skip</code><span class="sig-paren">(</span>FILE *<em>infile</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14bin_input_skipEP4FILE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO20verify_input_columnsERKNSt4listIN4Phot7ColumnsEEEb">
<span id="IO::verify_input_columns__std::list:Phot::Columns:CR.b"></span><span class="target" id="IO_2CommandLineUtil_8cpp_1acdbc5c5a765d3cd8af8f7bab535eed13"></span>void <code class="descname">verify_input_columns</code><span class="sig-paren">(</span><em class="property">const</em> std::list&lt;Phot::Columns&gt; &amp;<em>columns</em>, bool <em>need_PSF</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO20verify_input_columnsERKNSt4listIN4Phot7ColumnsEEEb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Throws an error if columns is missing an entry required for photometry. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">columns</span></code>: A list of the input columns for photometry. </li>
<li><code class="docutils literal"><span class="pre">need_PSF</span></code>: Whether PSF information is required </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO4trimERNSt6stringERKNSt6stringE">
<span id="IO::trim__ssR.ssCR"></span><span class="target" id="FitsHeader_8cpp_1a59dd5ff007daf0021a2333028db29602"></span><em class="property">static</em> void <code class="descname">trim</code><span class="sig-paren">(</span>std::string &amp;<em>s</em>, <em class="property">const</em> std::string &amp;<em>trim_characters</em> = &quot; fnrtv&quot;<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO4trimERNSt6stringERKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N2IOlsERNSt7ostreamERK10IOTreeBase">
<span id="IO::lshift-operator__osR.IOTreeBaseCR"></span><span class="target" id="H5IODataTree_8cpp_1a1c5f5647fefb149a7d144eb139c9fa1f"></span>std::ostream &amp;<code class="descname">operator&lt;&lt;</code><span class="sig-paren">(</span>std::ostream &amp;<em>os</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO10IOTreeBaseE" title="IO::IOTreeBase">IOTreeBase</a> &amp;<em>tree</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IOlsERNSt7ostreamERK10IOTreeBase" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>List the entries in an IO tree flagging which are filled and which are empty. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">os</span></code>: The stream to print to. </li>
<li><code class="docutils literal"><span class="pre">tree</span></code>: The tree to report on. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO13less_than_absERK1TRK1T">
<span id="IO::less_than_abs__TCR.TCR"></span><em class="property">template </em>&lt;<em class="property">typename</em> T&gt;<br /><span class="target" id="HDF5DefaultDataType_8h_1a7b213801c859ce157faa5ad443f9ec08"></span>bool <code class="descname">less_than_abs</code><span class="sig-paren">(</span><em class="property">const</em> T &amp;<em>a</em>, <em class="property">const</em> T &amp;<em>b</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO13less_than_absERK1TRK1T" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Less than comparison working on the absolute values. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO17parse_grid_stringERKNSt6stringE">
<span id="IO::parse_grid_string__ssCR"></span><span class="target" id="parse__grid_8cpp_1af3e7d897bba9091bb6af4034236ff2f1"></span><a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF4GridE" title="PSF::Grid">Grid</a> <code class="descname">parse_grid_string</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>grid_string</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO17parse_grid_stringERKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return the grid represented in the given string. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">grid_string</span></code>: The string to parse. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14represent_gridERKN3PSF4GridE">
<span id="IO::represent_grid__PSF::GridCR"></span><span class="target" id="parse__grid_8cpp_1a1c9f41e1cc0d0b7fc9060c94cf5c74df"></span>std::string <code class="descname">represent_grid</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF4GridE" title="PSF::Grid">Grid</a> &amp;<em>grid</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14represent_gridERKN3PSF4GridE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return the string representing the given grid. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">grid</span></code>: The grid to represent </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14parse_hat_maskEPKcllPc">
<span id="IO::parse_hat_mask__cCP.l.l.cP"></span><span class="target" id="parse__hat__mask_8cpp_1ab40a538a790c1bb5ee5c0b471fcd49b2"></span>void <code class="descname">parse_hat_mask</code><span class="sig-paren">(</span><em class="property">const</em> char *<em>mask_string</em>, long <em>x_resolution</em>, long <em>y_resolution</em>, char *<em>mask</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14parse_hat_maskEPKcllPc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fill a pre-allocated array with resolution of (x_resolution x y_resolution) with the parsed mask. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">mask_string</span></code>: The concatenated MASKINFO entries from the header. </li>
<li><code class="docutils literal"><span class="pre">x_resolution</span></code>: The horizontal resolution of the image. </li>
<li><code class="docutils literal"><span class="pre">y_resolution</span></code>: The vertical resolution of the image. </li>
<li><code class="docutils literal"><span class="pre">mask</span></code>: The array to write the mask to. Only the masked entries are updated using logical or, thus calling this function with different mask_string values but the same mask array combines all masks. </li>
</ul>
</dd>
</dl>
</p>
<p>C-binding alias for IO::parse_hat_mask. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IOlsERNSt7ostreamERK11OutputArrayI11SCALAR_TYPEE">
<span id="IO::lshift-operator__osR.OutputArray:SCALAR_TYPE:CR"></span><em class="property">template </em>&lt;<em class="property">typename</em> SCALAR_TYPE&gt;<br /><span class="target" id="SubPixHDF5File_8cpp_1abd7ce7565d0c7e45616f3f40090d6951"></span>std::ostream &amp;<code class="descname">operator&lt;&lt;</code><span class="sig-paren">(</span>std::ostream &amp;<em>os</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO11OutputArrayE" title="IO::OutputArray">OutputArray</a>&lt;SCALAR_TYPE&gt; &amp;<em>array</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IOlsERNSt7ostreamERK11OutputArrayI11SCALAR_TYPEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Output all values in an <a class="reference internal" href="#classIO_1_1OutputArray"><span class="std std-ref">OutputArray</span></a> to a stream. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">os</span></code>: The stream to output to. </li>
<li><code class="docutils literal"><span class="pre">array</span></code>: The array to output. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO19simple_read_from_h5ERKN2H57DataSetERKN2H58DataTypeEPv">
<span id="IO::simple_read_from_h5__H5::DataSetCR.H5::DataTypeCR.voidP"></span><span class="target" id="SubPixHDF5File_8cpp_1a3fa7afb5075d9ff7b399f47bcdc90201"></span>void <code class="descname">simple_read_from_h5</code><span class="sig-paren">(</span><em class="property">const</em> H5::DataSet &amp;<em>dataset</em>, <em class="property">const</em> H5::DataType &amp;<em>memory_type</em>, void *<em>destination</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO19simple_read_from_h5ERKN2H57DataSetERKN2H58DataTypeEPv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Present a uniform reading function for attributes and datasets. This one reads datasets. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">dataset</span></code>: The actual dataset handle to read from. </li>
<li><code class="docutils literal"><span class="pre">memory_type</span></code>: The memory type for the read. See H5::DataSet::read() </li>
<li><code class="docutils literal"><span class="pre">destination</span></code>: The destination for the new data. </li>
</ul>
</dd>
</dl>
</p>
<p>The memory type for the read. See H5::DataSet::read() </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO19simple_read_from_h5ERKN2H59AttributeERKN2H58DataTypeEPv">
<span id="IO::simple_read_from_h5__H5::AttributeCR.H5::DataTypeCR.voidP"></span><span class="target" id="SubPixHDF5File_8cpp_1a9db59f4fa89ac883d15f2d4b03f8a5ea"></span>void <code class="descname">simple_read_from_h5</code><span class="sig-paren">(</span><em class="property">const</em> H5::Attribute &amp;<em>attribute</em>, <em class="property">const</em> H5::DataType &amp;<em>memory_type</em>, void *<em>destination</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO19simple_read_from_h5ERKN2H59AttributeERKN2H58DataTypeEPv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Same as simple_read_from_h5(const H5::DataSet &amp;, H5::DataType &amp;, void *) but for attributes. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO11output_treeERKN5boost13property_tree5ptreeERKNSt6stringE">
<span id="IO::output_tree__boost::property_tree::ptreeCR.ssCR"></span><span class="target" id="SubPixHDF5File_8cpp_1a09496ad1d574f274d50d7b5e702a446d"></span>void <code class="descname">output_tree</code><span class="sig-paren">(</span><em class="property">const</em> boost::property_tree::ptree &amp;<em>pt</em>, <em class="property">const</em> std::string &amp;<em>indent</em> = &quot;&quot;<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO11output_treeERKN5boost13property_tree5ptreeERKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">pt</span></code>: The tree to output. </li>
<li><code class="docutils literal"><span class="pre">indent</span></code>: Indentation to use for the outermost nodes. </li>
</ul>
</dd>
</dl>
</p>
<p>Output the contents of a proprty tree to a stream.</p>
<p>The output is organized as a vertical tree with nested nodes indented to their parents. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Variables</p>
<dl class="member">
<dt id="_CPPv2N2IO13translate_intE">
<span id="IO::translate_int__TranslateToAny:i:C"></span><span class="target" id="TranslateToAny_8h_1a638bf6e8ae0adc70b5f8c2494f62e873"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO14TranslateToAnyE" title="IO::TranslateToAny">TranslateToAny</a>&lt;int&gt; <code class="descname">translate_int</code><a class="headerlink" href="#_CPPv2N2IO13translate_intE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Translator for signed integers. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO18translate_unsignedE">
<span id="IO::translate_unsigned__TranslateToAny:unsigned:C"></span><span class="target" id="TranslateToAny_8h_1a67f7a59aaea0a6055c9fabad6f5bfde8"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO14TranslateToAnyE" title="IO::TranslateToAny">TranslateToAny</a>&lt;unsigned&gt; <code class="descname">translate_unsigned</code><a class="headerlink" href="#_CPPv2N2IO18translate_unsignedE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Translator for unsigned integers. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO16translate_doubleE">
<span id="IO::translate_double__TranslateToAny:double:C"></span><span class="target" id="TranslateToAny_8h_1af177b89eef3a9de040b4da6dd52a851b"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO14TranslateToAnyE" title="IO::TranslateToAny">TranslateToAny</a>&lt;double&gt; <code class="descname">translate_double</code><a class="headerlink" href="#_CPPv2N2IO16translate_doubleE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Translator for doubles. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO16translate_stringE">
<span id="IO::translate_string__TranslateToAny:ss:C"></span><span class="target" id="TranslateToAny_8h_1a57cdc75f5cdb54ab5c41679cae501d69"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO14TranslateToAnyE" title="IO::TranslateToAny">TranslateToAny</a>&lt;std::string&gt; <code class="descname">translate_string</code><a class="headerlink" href="#_CPPv2N2IO16translate_stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Translator for strings. </p>
</dd></dl>

</div>
<dl class="class">
<dt id="_CPPv2N2IO11binofstreamE">
<span id="IO::binofstream"></span><span class="target" id="classIO_1_1binofstream"></span><em class="property">class </em><code class="descname">binofstream</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv22IO" title="IO">IO</a>::<a class="reference internal" href="#_CPPv2N2IO10binostreamE" title="IO::binostream">binostream</a><a class="headerlink" href="#_CPPv2N2IO11binofstreamE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;binofstream.h&gt;</em><p>A binary output stream connected to a file. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N2IO11binofstream11binofstreamEv">
<span id="IO::binofstream::binofstream"></span><span class="target" id="classIO_1_1binofstream_1a8613d74079aaea44af26449e5bdd9dea"></span><code class="descname">binofstream</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO11binofstream11binofstreamEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Make a binary output stream that will be bound to a file later using the open method inherited from std::ofstream. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO11binofstream11binofstreamERKNSt6stringE">
<span id="IO::binofstream::binofstream__ssCR"></span><span class="target" id="classIO_1_1binofstream_1af1922dd0ec8739b6a5f796ed02ea4692"></span><code class="descname">binofstream</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>fname</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO11binofstream11binofstreamERKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Make a stream that does binary output to the given file. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO11binofstreamcvRNSt8ofstreamEEv">
<span id="IO::binofstream::castto-std::ofstreamR-operator"></span><span class="target" id="classIO_1_1binofstream_1aa174052dd4002e37c330a857543d9552"></span><code class="descname">operator std::ofstream&amp;</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO11binofstreamcvRNSt8ofstreamEEv" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO11binofstreamcvRKNSt8ofstreamEEv">
<span id="IO::binofstream::castto-std::ofstreamCR-operator"></span><span class="target" id="classIO_1_1binofstream_1a3d8b3d4b36a12677f75f867e3271364d"></span><code class="descname">operator const std::ofstream&amp;</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO11binofstreamcvRKNSt8ofstreamEEv" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO11binofstream5closeEv">
<span id="IO::binofstream::close"></span><span class="target" id="classIO_1_1binofstream_1a5c72c0971cf93207ff5e1d460e4f78e5"></span>void <code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO11binofstream5closeEv" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N2IO11binofstream11m_outstreamE">
<span id="IO::binofstream::m_outstream__std::ofstream"></span><span class="target" id="classIO_1_1binofstream_1a15e9ce5ff51d192e445c2aa3e731b778"></span>std::ofstream <code class="descname">m_outstream</code><a class="headerlink" href="#_CPPv2N2IO11binofstream11m_outstreamE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N2IO10binostreamE">
<span id="IO::binostream"></span><span class="target" id="classIO_1_1binostream"></span><em class="property">class </em><code class="descname">binostream</code> : <em class="property">public</em> <em class="property">virtual</em> ostream<a class="headerlink" href="#_CPPv2N2IO10binostreamE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;binostream.h&gt;</em><p>Performs binary output of column of integer or double values. </p>
<p>Subclassed by <a class="reference internal" href="#classIO_1_1binofstream"><span class="std std-ref">IO::binofstream</span></a></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N2IO10binostreamlsERKNSt8valarrayI8VAL_TYPEEE">
<span id="IO::binostream::lshift-operator__std::valarray:VAL_TYPE:CR"></span><em class="property">template </em>&lt;<em class="property">class</em> VAL_TYPE&gt;<br /><span class="target" id="classIO_1_1binostream_1a04c2179b57034cf73b81a02c5e9eeec9"></span><a class="reference internal" href="#_CPPv2N2IO10binostreamE" title="IO::binostream">binostream</a> &amp;<code class="descname">operator&lt;&lt;</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;VAL_TYPE&gt; &amp;<em>column</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO10binostreamlsERKNSt8valarrayI8VAL_TYPEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Pack in binary form the given column, if VAL_TYPE is integer the packing is lossless, if it is real valued, the precision (number of digits after the decimal point to keep) should be pre-set using the precision method inherited from ostream. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N2IO10binostream12convert_realERKNSt8valarrayI9REAL_TYPEEE">
<span id="IO::binostream::convert_real__std::valarray:REAL_TYPE:CR"></span><em class="property">template </em>&lt;<em class="property">class</em> REAL_TYPE&gt;<br /><span class="target" id="classIO_1_1binostream_1aab80f99736b64793be1223536b0722fe"></span>void <code class="descname">convert_real</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;REAL_TYPE&gt; &amp;<em>column</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO10binostream12convert_realERKNSt8valarrayI9REAL_TYPEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Converts a real-valued column to unsigned long integers preserving the values to the currently set precision. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO10binostream11convert_intERKNSt8valarrayI8INT_TYPEEE">
<span id="IO::binostream::convert_int__std::valarray:INT_TYPE:CR"></span><em class="property">template </em>&lt;<em class="property">class</em> INT_TYPE&gt;<br /><span class="target" id="classIO_1_1binostream_1afa0e3f895a780ee6f6bb99d80a777caf"></span>void <code class="descname">convert_int</code><span class="sig-paren">(</span><em class="property">const</em> std::valarray&lt;INT_TYPE&gt; &amp;<em>column</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO10binostream11convert_intERKNSt8valarrayI8INT_TYPEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Converts an integer-valued column to unsigned long integers losslessly. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N2IO10binostream11__convertedE">
<span id="IO::binostream::__converted__std::valarray:unsigned-l:"></span><span class="target" id="classIO_1_1binostream_1a6d1faab31e614398b939282f7a7e1fd7"></span>std::valarray&lt;unsigned long&gt; <code class="descname">__converted</code><a class="headerlink" href="#_CPPv2N2IO10binostream11__convertedE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The next set of values to pack to the output stream, already converted to properly scaled and offset integers. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO10binostream8__offsetE">
<span id="IO::binostream::__offset__l"></span><span class="target" id="classIO_1_1binostream_1ae3cc9dd2ad5a11839bb8080dccc27b03"></span>long <code class="descname">__offset</code><a class="headerlink" href="#_CPPv2N2IO10binostream8__offsetE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The offset to apply to the converted values before converting them back to whatever type they were. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO10binostream11__max_valueE">
<span id="IO::binostream::__max_value__unsigned-l"></span><span class="target" id="classIO_1_1binostream_1a3c02142e2a010834e2e6924ab12d59e4"></span>unsigned long <code class="descname">__max_value</code><a class="headerlink" href="#_CPPv2N2IO10binostream11__max_valueE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The maximum value of the converted column. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO10binostream9__has_nanE">
<span id="IO::binostream::__has_nan__b"></span><span class="target" id="classIO_1_1binostream_1a9785df4403ffd7d64b03827b914b9e96"></span>bool <code class="descname">__has_nan</code><a class="headerlink" href="#_CPPv2N2IO10binostream9__has_nanE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Whether to allow for NaN values. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO10binostream16__discretizationE">
<span id="IO::binostream::__discretization__double"></span><span class="target" id="classIO_1_1binostream_1a8c4cff65ea9607c967216b99f2670033"></span>double <code class="descname">__discretization</code><a class="headerlink" href="#_CPPv2N2IO10binostream16__discretizationE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The discretization used for real value conversion. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N2IO17CommandLineConfigE">
<span id="IO::CommandLineConfig"></span><span class="target" id="classIO_1_1CommandLineConfig"></span><em class="property">class </em><code class="descname">CommandLineConfig</code> : <em class="property">public</em> variables_map<a class="headerlink" href="#_CPPv2N2IO17CommandLineConfigE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;CommandLineConfig.h&gt;</em><p>A base class for configuration of tools using the command line. </p>
<p>Subclassed by <a class="reference internal" href="#classFitPSF_1_1Config"><span class="std std-ref">FitPSF::Config</span></a>, <a class="reference internal" href="#classSubPixPhot_1_1Config"><span class="std std-ref">SubPixPhot::Config</span></a></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N2IO17CommandLineConfig17CommandLineConfigEiPPc">
<span id="IO::CommandLineConfig::CommandLineConfig__i.cPP"></span><span class="target" id="classIO_1_1CommandLineConfig_1aadea4187f4790efcd9f509908b7de48a"></span><code class="descname">CommandLineConfig</code><span class="sig-paren">(</span>int <em>argc</em> = 0, char **<em>argv</em> = NULL<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO17CommandLineConfig17CommandLineConfigEiPPc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Parse the command line (if any arguments are given as arguments). </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">argc</span></code>: The number of command line arguments. </li>
<li><code class="docutils literal"><span class="pre">argv</span></code>: The actual command line arguments. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N17CommandLineConfig5parseEiPPc">
<span id="CommandLineConfig::parse__i.cPP"></span><span class="target" id="classIO_1_1CommandLineConfig_1a60457cc39bec668563bfe9557a8b4ac6"></span>void <code class="descname">parse</code><span class="sig-paren">(</span>int <em>argc</em>, char **<em>argv</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N17CommandLineConfig5parseEiPPc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Parse the command line. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">argc</span></code>: The number of arguments on the command line (+1 for the executable) </li>
<li><code class="docutils literal"><span class="pre">argv</span></code>: A C style array of the actual command line arguments. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK2IO17CommandLineConfig7proceedEv">
<span id="IO::CommandLineConfig::proceedC"></span><span class="target" id="classIO_1_1CommandLineConfig_1a6e5c45e8aa825428b667dcda394cc08a"></span>bool <code class="descname">proceed</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK2IO17CommandLineConfig7proceedEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Did parsing succeed? </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK2IO17CommandLineConfig10executableEv">
<span id="IO::CommandLineConfig::executableC"></span><span class="target" id="classIO_1_1CommandLineConfig_1ac8b69ada56649660d9e6b7b2216d5cbc"></span><em class="property">const</em> std::string &amp;<code class="descname">executable</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK2IO17CommandLineConfig10executableEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The executable whose command line is being processed (no path). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK2IO17CommandLineConfig14hidden_optionsEv">
<span id="IO::CommandLineConfig::hidden_optionsC"></span><span class="target" id="classIO_1_1CommandLineConfig_1ad92b53cc6e185466b9dc655b9802d261"></span><em class="property">const</em> opt::options_description &amp;<code class="descname">hidden_options</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK2IO17CommandLineConfig14hidden_optionsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See opt::variables_map::_hidden. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK2IO17CommandLineConfig20cmdline_only_optionsEv">
<span id="IO::CommandLineConfig::cmdline_only_optionsC"></span><span class="target" id="classIO_1_1CommandLineConfig_1a35ab472a3683a531fe52bb62c1c002e0"></span><em class="property">const</em> opt::options_description &amp;<code class="descname">cmdline_only_options</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK2IO17CommandLineConfig20cmdline_only_optionsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See opt::variables_map::_cmdline_only. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK2IO17CommandLineConfig22cmdline_config_optionsEv">
<span id="IO::CommandLineConfig::cmdline_config_optionsC"></span><span class="target" id="classIO_1_1CommandLineConfig_1a1261a3032eb3b113f0b8cb9f9491e9b1"></span><em class="property">const</em> opt::options_description &amp;<code class="descname">cmdline_config_options</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK2IO17CommandLineConfig22cmdline_config_optionsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See opt::variables_map::_cmdline_config. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Protected Attributes</p>
<dl class="member">
<dt id="_CPPv2N2IO17CommandLineConfig7_hiddenE">
<span id="IO::CommandLineConfig::_hidden__opt::options_description"></span><span class="target" id="classIO_1_1CommandLineConfig_1a412212d4c5afe7db9f41e259c137e4d6"></span>opt::options_description <code class="descname">_hidden</code><a class="headerlink" href="#_CPPv2N2IO17CommandLineConfig7_hiddenE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The descriptions of options not included in the help message. </p>
<p>In this case the positional options. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO17CommandLineConfig13_cmdline_onlyE">
<span id="IO::CommandLineConfig::_cmdline_only__opt::options_description"></span><span class="target" id="classIO_1_1CommandLineConfig_1abb2f9358885ac2bf71a4247a89985a10"></span>opt::options_description <code class="descname">_cmdline_only</code><a class="headerlink" href="#_CPPv2N2IO17CommandLineConfig13_cmdline_onlyE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Options accessible only on the command line. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO17CommandLineConfig15_cmdline_configE">
<span id="IO::CommandLineConfig::_cmdline_config__opt::options_description"></span><span class="target" id="classIO_1_1CommandLineConfig_1a8e3abce6cccedcab50facc9bf1dd3390"></span>opt::options_description <code class="descname">_cmdline_config</code><a class="headerlink" href="#_CPPv2N2IO17CommandLineConfig15_cmdline_configE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Options accessible from both command line and config file. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO17CommandLineConfig11_positionalE">
<span id="IO::CommandLineConfig::_positional__opt::positional_options_description"></span><span class="target" id="classIO_1_1CommandLineConfig_1a8d11b8e10a4ac310587a1f226e57e518"></span>opt::positional_options_description <code class="descname">_positional</code><a class="headerlink" href="#_CPPv2N2IO17CommandLineConfig11_positionalE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Description of the positional command line arguments. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N2IO17CommandLineConfig16describe_optionsEv">
<span id="IO::CommandLineConfig::describe_options"></span><span class="target" id="classIO_1_1CommandLineConfig_1a48deecc8d57d2b094e64ed9c9a68d609"></span><em class="property">virtual</em> void <code class="descname">describe_options</code><span class="sig-paren">(</span><span class="sig-paren">)</span> = 0<a class="headerlink" href="#_CPPv2N2IO17CommandLineConfig16describe_optionsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Describes the available command line options. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK2IO17CommandLineConfig10usage_helpERKNSt6stringE">
<span id="IO::CommandLineConfig::usage_help__ssCRC"></span><span class="target" id="classIO_1_1CommandLineConfig_1a0dc1a25081f9ff5b9801e93754c25f84"></span><em class="property">virtual</em> std::string <code class="descname">usage_help</code><span class="sig-paren">(</span><em class="property">const</em> std::string&amp;<span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK2IO17CommandLineConfig10usage_helpERKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The part of the help describing the usage and purpose (no options). </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N2IO17CommandLineConfig11__parsed_okE">
<span id="IO::CommandLineConfig::__parsed_ok__b"></span><span class="target" id="classIO_1_1CommandLineConfig_1a7b6494144edb16028f3cd1b34b155612"></span>bool <code class="descname">__parsed_ok</code><a class="headerlink" href="#_CPPv2N2IO17CommandLineConfig11__parsed_okE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Whether the parsing was successful. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO17CommandLineConfig12__executableE">
<span id="IO::CommandLineConfig::__executable__ss"></span><span class="target" id="classIO_1_1CommandLineConfig_1a4f58bc0d1b077ee6fe75b2fea07cd39d"></span>std::string <code class="descname">__executable</code><a class="headerlink" href="#_CPPv2N2IO17CommandLineConfig12__executableE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The name of the executable invoked (without any path information). </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N2IO10FitsHeaderE">
<span id="IO::FitsHeader"></span><span class="target" id="classIO_1_1FitsHeader"></span><em class="property">class </em><code class="descname">FitsHeader</code><a class="headerlink" href="#_CPPv2N2IO10FitsHeaderE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;FitsHeader.h&gt;</em><p>A structure representing the header of a fits file. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N2IO10FitsHeader10FitsHeaderEP8fitsfile">
<span id="IO::FitsHeader::FitsHeader__fitsfileP"></span><span class="target" id="classIO_1_1FitsHeader_1a23f69c494a1022bf0cda9af2f59f8d22"></span><code class="descname">FitsHeader</code><span class="sig-paren">(</span>fitsfile *<em>fptr</em> = NULL<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO10FitsHeader10FitsHeaderEP8fitsfile" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Attach to the header in the given fits file. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO10FitsHeader10FitsHeaderERK10FitsHeader">
<span id="IO::FitsHeader::FitsHeader__FitsHeaderCR"></span><span class="target" id="classIO_1_1FitsHeader_1accdcdaac422543677604006f2b1b829f"></span><code class="descname">FitsHeader</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO10FitsHeader10FitsHeaderEP8fitsfile" title="IO::FitsHeader::FitsHeader">FitsHeader</a> &amp;<em>orig</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO10FitsHeader10FitsHeaderERK10FitsHeader" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Copy orig to *this. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO10FitsHeader4readEP8fitsfile">
<span id="IO::FitsHeader::read__fitsfileP"></span><span class="target" id="classIO_1_1FitsHeader_1a6bff63803ef579455e379e58e254fabe"></span>void <code class="descname">read</code><span class="sig-paren">(</span>fitsfile *<em>fptr</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO10FitsHeader4readEP8fitsfile" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Attach to the header in the given fits file. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK2IO10FitsHeader12get_keywordsEv">
<span id="IO::FitsHeader::get_keywordsC"></span><span class="target" id="classIO_1_1FitsHeader_1a7927fb2df209a8305b7c27915442bac8"></span><em class="property">const</em> std::list&lt;std::string&gt; &amp;<code class="descname">get_keywords</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK2IO10FitsHeader12get_keywordsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns a list of the keywords in the header. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO10FitsHeader9get_valueERKNSt6stringE">
<span id="IO::FitsHeader::get_value__ssCR"></span><span class="target" id="classIO_1_1FitsHeader_1ae121c1a3dbd698da04325f8e40eefa7d"></span><em class="property">const</em> std::string &amp;<code class="descname">get_value</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>keyword</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO10FitsHeader9get_valueERKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the value corresponding to the given keyword. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO10FitsHeaderixERKNSt6stringE">
<span id="IO::FitsHeader::subscript-operator__ssCR"></span><span class="target" id="classIO_1_1FitsHeader_1acfa36f107746ee98cb027ef5a5d3dd46"></span><em class="property">const</em> std::string &amp;<code class="descname">operator[]</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>keyword</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO10FitsHeaderixERKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the value corresponding to the given keyword. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO10FitsHeader11get_commentERKNSt6stringE">
<span id="IO::FitsHeader::get_comment__ssCR"></span><span class="target" id="classIO_1_1FitsHeader_1a38ba0f4134eb803bc93e349d4be20d09"></span><em class="property">const</em> std::string &amp;<code class="descname">get_comment</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>keyword</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO10FitsHeader11get_commentERKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the comment to the given keyword. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO10FitsHeaderaSERK10FitsHeader">
<span id="IO::FitsHeader::assign-operator__FitsHeaderCR"></span><span class="target" id="classIO_1_1FitsHeader_1ad7478cf8ab364228a45ad3aa1fbab16d"></span><a class="reference internal" href="#_CPPv2N2IO10FitsHeaderE" title="IO::FitsHeader">FitsHeader</a> &amp;<code class="descname">operator=</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO10FitsHeaderE" title="IO::FitsHeader">FitsHeader</a> &amp;<em>rhs</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO10FitsHeaderaSERK10FitsHeader" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Copy rhs to *this. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N2IO10FitsHeader10__keywordsE">
<span id="IO::FitsHeader::__keywords__std::list:ss:"></span><span class="target" id="classIO_1_1FitsHeader_1aa878c72c01d57b7e31a34d3ba0c5af27"></span>std::list&lt;std::string&gt; <code class="descname">__keywords</code><a class="headerlink" href="#_CPPv2N2IO10FitsHeader10__keywordsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The keywords found in the header. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO10FitsHeader8__valuesE">
<span id="IO::FitsHeader::__values__std::map:ss.ss:"></span><span class="target" id="classIO_1_1FitsHeader_1a618e6294b0ba665d53828c59f135e23a"></span>std::map&lt;std::string, std::string&gt; <code class="descname">__values</code><a class="headerlink" href="#_CPPv2N2IO10FitsHeader8__valuesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The value of the header keywords. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO10FitsHeader10__commentsE">
<span id="IO::FitsHeader::__comments__std::map:ss.ss:"></span><span class="target" id="classIO_1_1FitsHeader_1a224bfaa4a851e2d47a040ab0ae983f21"></span>std::map&lt;std::string, std::string&gt; <code class="descname">__comments</code><a class="headerlink" href="#_CPPv2N2IO10FitsHeader10__commentsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The comments of the header keywords. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N2IO9FitsImageE">
<span id="IO::FitsImage"></span><span class="target" id="classIO_1_1FitsImage"></span><em class="property">template </em>&lt;typename <em>DATA_TYPE</em>&gt;<br /><em class="property">class </em><code class="descname">FitsImage</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5ImageE" title="Core::Image">Image</a>&lt;DATA_TYPE&gt;<a class="headerlink" href="#_CPPv2N2IO9FitsImageE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;FitsImage.h&gt;</em><p>An interface for working with FITS images. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N2IO9FitsImage9FitsImageERKNSt6stringEjbj">
<span id="IO::FitsImage::FitsImage__ssCR.unsigned.b.unsigned"></span><span class="target" id="classIO_1_1FitsImage_1af850f30a386f04d1b8bd5e9477af8e60"></span><code class="descname">FitsImage</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>filename</em> = &quot;&quot;, unsigned <em>values_hdu</em> = 0, bool <em>allow_rounding</em> = false, unsigned <em>errors_hdu</em> = 0<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO9FitsImage9FitsImageERKNSt6stringEjbj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reads the data in the given fits image(s). </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">filename</span></code>: The filename of the image containing pixel fluxes as primary HDU. </li>
<li><code class="docutils literal"><span class="pre">values_hdu</span></code>: The HDU number to containing the required image. If, zero, the first non-trivial image HDU is used. </li>
<li><code class="docutils literal"><span class="pre">allow_rounding</span></code>: Should rounding real valued images to integer be allowed. Rounding is only performed if DATA_TYPE is integer and the input image contains floating point vaules. </li>
<li><code class="docutils literal"><span class="pre">errors_hdu</span></code>: The HDU number of the extension containing error estimates for the pixel values. If zero, no error estimate is read-in. </li>
</ul>
</dd>
</dl>
</p>
<p>If both expect_errors is false and error_image == &#8220;&#8221;, the errors are estimated assuming Poisson statistics of the pixel fluxes. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO9FitsImage9FitsImageERK9FitsImage">
<span id="IO::FitsImage::FitsImage__FitsImageCR"></span><span class="target" id="classIO_1_1FitsImage_1afded9917210cadb4339448271be88f3b"></span><code class="descname">FitsImage</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO9FitsImage9FitsImageERKNSt6stringEjbj" title="IO::FitsImage::FitsImage">FitsImage</a> &amp;<em>orig</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO9FitsImage9FitsImageERK9FitsImage" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Copies orig to *this. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO9FitsImage4openERKNSt6stringEjbj">
<span id="IO::FitsImage::open__ssCR.unsigned.b.unsigned"></span><span class="target" id="classIO_1_1FitsImage_1a5581363eef56d2c7df21dbffa2e0689e"></span>void <code class="descname">open</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>fits_filename</em>, unsigned <em>values_hdu</em> = 0, bool <em>allow_rounding</em> = false, unsigned <em>errors_hdu</em> = 0<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO9FitsImage4openERKNSt6stringEjbj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Open the given fits image (see constructor documentation for details). </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fits_filename</span></code>: The name of the file to open. Only used in error messages. </li>
<li><code class="docutils literal"><span class="pre">values_hdu</span></code>: The HDU number to containing the pixel values. </li>
<li><code class="docutils literal"><span class="pre">allow_rounding</span></code>: Should rounding real valued images to integer be allowed. Rounding is only performed if DATA_TYPE is integer and the input image contains floating point vaules. </li>
<li><code class="docutils literal"><span class="pre">errors_hdu</span></code>: The HDU number to containing the estimated pixel errors. If zero, no error image is read. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK2IO9FitsImage6headerEv">
<span id="IO::FitsImage::headerC"></span><span class="target" id="classIO_1_1FitsImage_1a375c13c71debd2461cb257c75715973f"></span><em class="property">virtual</em> <em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO10FitsHeaderE" title="IO::FitsHeader">FitsHeader</a> &amp;<code class="descname">header</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK2IO9FitsImage6headerEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns immutable reference to the image header. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO9FitsImage6headerEv">
<span id="IO::FitsImage::header"></span><span class="target" id="classIO_1_1FitsImage_1ab53564ae927c638a20f9128d275f86a8"></span><em class="property">virtual</em> <a class="reference internal" href="#_CPPv2N2IO10FitsHeaderE" title="IO::FitsHeader">FitsHeader</a> &amp;<code class="descname">header</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO9FitsImage6headerEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns mutable reference to the image header. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO9FitsImageaSERK9FitsImage">
<span id="IO::FitsImage::assign-operator__FitsImageCR"></span><span class="target" id="classIO_1_1FitsImage_1ad4b0981b9ca80404108d24c70aeae3ab"></span><a class="reference internal" href="#_CPPv2N2IO9FitsImageE" title="IO::FitsImage">FitsImage</a> &amp;<code class="descname">operator=</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO9FitsImageE" title="IO::FitsImage">FitsImage</a> &amp;<em>rhs</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO9FitsImageaSERK9FitsImage" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Copies RHS to *this. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK2IO9FitsImage8filenameEv">
<span id="IO::FitsImage::filenameC"></span><span class="target" id="classIO_1_1FitsImage_1a8143d30f08c10e50297be5639ef5eb47"></span><em class="property">const</em> std::string &amp;<code class="descname">filename</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK2IO9FitsImage8filenameEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The name of the FITS file to which this image is attached. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO9FitsImageD0Ev">
<span id="IO::FitsImage::~FitsImage"></span><span class="target" id="classIO_1_1FitsImage_1ac6b27841954180b95ecd8d1c2b51d582"></span><code class="descname">~FitsImage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO9FitsImageD0Ev" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Clean up any allocated arrays. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N2IO9FitsImage9open_fitsERKNSt6stringE">
<span id="IO::FitsImage::open_fits__ssCR"></span><span class="target" id="classIO_1_1FitsImage_1ae2b8f283e55e00abfaa83cc7241fe077"></span>fitsfile *<code class="descname">open_fits</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO9FitsImage9open_fitsERKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Opens a fits file for reading. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO9FitsImage10close_fitsEP8fitsfileRKNSt6stringE">
<span id="IO::FitsImage::close_fits__fitsfileP.ssCR"></span><span class="target" id="classIO_1_1FitsImage_1a67de7707a4bfd992337672ed34320b34"></span>void <code class="descname">close_fits</code><span class="sig-paren">(</span>fitsfile *<em>fptr</em>, <em class="property">const</em> std::string &amp;<em>filename</em> = &quot;unknown fits file&quot;<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO9FitsImage10close_fitsEP8fitsfileRKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Closes as previously opened fits file. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO9FitsImage17parse_mask_stringERKNSt6stringEll">
<span id="IO::FitsImage::parse_mask_string__ssCR.l.l"></span><span class="target" id="classIO_1_1FitsImage_1a2f8eac6f53c59811640e1f2f59298fcc"></span>void <code class="descname">parse_mask_string</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>mask_string</em>, long <em>x_resolution</em>, long <em>y_resolution</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO9FitsImage17parse_mask_stringERKNSt6stringEll" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Based on the fi function for parsing mask strings from the header. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">mask_string</span></code>: The mask string to parse. </li>
<li><code class="docutils literal"><span class="pre">x_resolution</span></code>: The horizontal resolution of the image. </li>
<li><code class="docutils literal"><span class="pre">y_resolution</span></code>: The vertical resolution of the image. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO9FitsImage11input_imageEP8fitsfilelP9DATA_TYPEj">
<span id="IO::FitsImage::input_image__fitsfileP.l.DATA_TYPEP.unsigned"></span><span class="target" id="classIO_1_1FitsImage_1ab0e2cd22fab00546b6ae364d0f901635"></span>void <code class="descname">input_image</code><span class="sig-paren">(</span>fitsfile *<em>fptr</em>, long <em>num_pixels</em>, DATA_TYPE *<em>destination</em>, unsigned <em>read_hdu</em> = 0<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO9FitsImage11input_imageEP8fitsfilelP9DATA_TYPEj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Read pixel data from an HDU in a FITS file. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fptr</span></code>: The open fits file from which to read. </li>
<li><code class="docutils literal"><span class="pre">num_pixels</span></code>: The number of pixels to read from the image. </li>
<li><code class="docutils literal"><span class="pre">destination</span></code>: The memory location where to place the data. </li>
<li><code class="docutils literal"><span class="pre">read_hdu</span></code>: The HDU to read from. If zero, the currently selected HDU in fptr is read. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N2IO9FitsImage14__pixel_valuesE">
<span id="IO::FitsImage::__pixel_values__DATA_TYPEP"></span><span class="target" id="classIO_1_1FitsImage_1a26d97ba534f5f388dedc68b479fb1ec3"></span>DATA_TYPE *<code class="descname">__pixel_values</code><a class="headerlink" href="#_CPPv2N2IO9FitsImage14__pixel_valuesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The value of each pixel. See values argument of Image::Image. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO9FitsImage14__pixel_errorsE">
<span id="IO::FitsImage::__pixel_errors__DATA_TYPEP"></span><span class="target" id="classIO_1_1FitsImage_1ae7cf7601b48c8ca6c3de153b712d3289"></span>DATA_TYPE *<code class="descname">__pixel_errors</code><a class="headerlink" href="#_CPPv2N2IO9FitsImage14__pixel_errorsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Error estimateof each pixel. See errors argument of Image::Image. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO9FitsImage6__maskE">
<span id="IO::FitsImage::__mask__cP"></span><span class="target" id="classIO_1_1FitsImage_1a01815553aade1e58b50837827da34ed0"></span>char *<code class="descname">__mask</code><a class="headerlink" href="#_CPPv2N2IO9FitsImage6__maskE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The bad pixel mask. See mask argument of Image::Image. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO9FitsImage8__headerE">
<span id="IO::FitsImage::__header__FitsHeader"></span><span class="target" id="classIO_1_1FitsImage_1a68f6b6612e5fd62dab44b54bfc37a7f2"></span><a class="reference internal" href="#_CPPv2N2IO10FitsHeaderE" title="IO::FitsHeader">FitsHeader</a> <code class="descname">__header</code><a class="headerlink" href="#_CPPv2N2IO9FitsImage8__headerE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The FITS header. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO9FitsImage10__filenameE">
<span id="IO::FitsImage::__filename__ss"></span><span class="target" id="classIO_1_1FitsImage_1af17c3da2841537b872bec047d899fe9b"></span>std::string <code class="descname">__filename</code><a class="headerlink" href="#_CPPv2N2IO9FitsImage10__filenameE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classIO_1_1FitsImage_1a8143d30f08c10e50297be5639ef5eb47"><span class="std std-ref">filename()</span></a>. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N2IO17H5DefaultDataTypeE">
<span id="IO::H5DefaultDataType"></span><span class="target" id="classIO_1_1H5DefaultDataType"></span><em class="property">template </em>&lt;<em class="property">typename</em> SCALAR&gt;<br /><em class="property">class </em><code class="descname">H5DefaultDataType</code><a class="headerlink" href="#_CPPv2N2IO17H5DefaultDataTypeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;HDF5DefaultDataType.h&gt;</em><p>Determine the default data type to use for writing data to an HDF5 file. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N2IO17H5DefaultDataType6nativeEv">
<span id="IO::H5DefaultDataType::native"></span><em class="property">template </em>&lt;&gt;<br /><span class="target" id="classIO_1_1H5DefaultDataType_1a71c725474a5b9e8b6ee2c8437e6179ad"></span><em class="property">const</em> H5::PredType &amp;<code class="descname">native</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO17H5DefaultDataType6nativeEv" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO17H5DefaultDataType6nativeEv">
<em class="property">template </em>&lt;&gt;<br /><span class="target" id="classIO_1_1H5DefaultDataType_1a584adfd6b3ddf24b8c878648ba048c4f"></span><em class="property">const</em> H5::PredType &amp;<code class="descname">native</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO17H5DefaultDataType6nativeEv" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt>
<em class="property">template </em>&lt;&gt;<br /><span class="target" id="classIO_1_1H5DefaultDataType_1a704a4a79f1ac959a68e763876b3f68d1"></span><em class="property">const</em> H5::PredType &amp;<code class="descname">native</code><span class="sig-paren">(</span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt>
<em class="property">template </em>&lt;&gt;<br /><span class="target" id="classIO_1_1H5DefaultDataType_1a650890ee08b8836e6a458d8f65a84d8a"></span><em class="property">const</em> H5::PredType &amp;<code class="descname">native</code><span class="sig-paren">(</span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt>
<em class="property">template </em>&lt;&gt;<br /><span class="target" id="classIO_1_1H5DefaultDataType_1a2fe2409980da635dd505752b9c9a683b"></span><em class="property">const</em> H5::PredType &amp;<code class="descname">native</code><span class="sig-paren">(</span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt>
<em class="property">template </em>&lt;&gt;<br /><span class="target" id="classIO_1_1H5DefaultDataType_1aeb4b06c0b987917232b6a726d6b12d69"></span><em class="property">const</em> H5::PredType &amp;<code class="descname">native</code><span class="sig-paren">(</span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt>
<em class="property">template </em>&lt;&gt;<br /><span class="target" id="classIO_1_1H5DefaultDataType_1a0bfe2b465ec2fb22765def880ff7d746"></span><em class="property">const</em> H5::PredType &amp;<code class="descname">native</code><span class="sig-paren">(</span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt>
<em class="property">template </em>&lt;&gt;<br /><span class="target" id="classIO_1_1H5DefaultDataType_1aac957899fc1c83fff7dc748b97c2d0c6"></span><em class="property">const</em> H5::PredType &amp;<code class="descname">native</code><span class="sig-paren">(</span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt>
<em class="property">template </em>&lt;&gt;<br /><span class="target" id="classIO_1_1H5DefaultDataType_1a20d52d6dff6e0c09b1ed873847aa1af3"></span><em class="property">const</em> H5::PredType &amp;<code class="descname">native</code><span class="sig-paren">(</span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO17H5DefaultDataType4fileERKNSt6vectorIdEE">
<span id="IO::H5DefaultDataType::file__std::vector:double:CR"></span><em class="property">template </em>&lt;&gt;<br /><span class="target" id="classIO_1_1H5DefaultDataType_1aa3456a5281651c2328561159650c217e"></span><em class="property">const</em> H5::PredType &amp;<code class="descname">file</code><span class="sig-paren">(</span><em class="property">const</em> std::vector&lt;double&gt;&amp;<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO17H5DefaultDataType4fileERKNSt6vectorIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Static Functions</p>
<dl class="function">
<dt id="_CPPv2N2IO17H5DefaultDataType4fileERKNSt6vectorI6SCALAREE">
<span id="IO::H5DefaultDataType::file__std::vector:SCALAR:CR"></span><span class="target" id="classIO_1_1H5DefaultDataType_1ac7905d6e5ea4fddb878cc9073e39e58f"></span><em class="property">const</em> H5::PredType &amp;<code class="descname">file</code><span class="sig-paren">(</span><em class="property">const</em> std::vector&lt;SCALAR&gt; &amp;<em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO17H5DefaultDataType4fileERKNSt6vectorI6SCALAREE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Static Attributes</p>
<dl class="member">
<dt id="_CPPv2N2IO17H5DefaultDataType6nativeE">
<span id="IO::H5DefaultDataType::native__H5::PredTypeCR"></span><span class="target" id="classIO_1_1H5DefaultDataType_1a98e12f89a9e979966e9ef66222f13543"></span><em class="property">const</em> H5::PredType &amp;<code class="descname">native</code><a class="headerlink" href="#_CPPv2N2IO17H5DefaultDataType6nativeE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N2IO12H5IODataTreeE">
<span id="IO::H5IODataTree"></span><span class="target" id="classIO_1_1H5IODataTree"></span><em class="property">class </em><code class="descname">H5IODataTree</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv2N2IO10IOTreeBaseE" title="IO::IOTreeBase">IOTreeBase</a><a class="headerlink" href="#_CPPv2N2IO12H5IODataTreeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;H5IODataTree.h&gt;</em><p>A property tree to hold all datasets, attributes and links to output. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N2IO12H5IODataTree12H5IODataTreeEv">
<span id="IO::H5IODataTree::H5IODataTree"></span><span class="target" id="classIO_1_1H5IODataTree_1a80589ee62bd0c76b9d74f30e8fce7866"></span><code class="descname">H5IODataTree</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO12H5IODataTree12H5IODataTreeEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Creates an empty tree. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO12H5IODataTree12H5IODataTreeEiPPcRKNSt6stringERK17CommandLineConfig">
<span id="IO::H5IODataTree::H5IODataTree__i.cPP.ssCR.CommandLineConfigCR"></span><span class="target" id="classIO_1_1H5IODataTree_1a25ce465d6fb107af1a7b0c7a2049902c"></span><code class="descname">H5IODataTree</code><span class="sig-paren">(</span>int <em>argc</em>, char **<em>argv</em>, <em class="property">const</em> std::string &amp;<em>version</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO17CommandLineConfigE" title="IO::CommandLineConfig">CommandLineConfig</a> &amp;<em>options</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO12H5IODataTree12H5IODataTreeEiPPcRKNSt6stringERK17CommandLineConfig" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fills all command line information. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">argc</span></code>: The number of command line tokens. </li>
<li><code class="docutils literal"><span class="pre">argv</span></code>: The command line tokens. </li>
<li><code class="docutils literal"><span class="pre">version</span></code>: The version of the tool used. </li>
<li><code class="docutils literal"><span class="pre">options</span></code>: The parsed command line options. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO12H5IODataTree18fill_configurationERKN5boost15program_options13variables_mapE">
<span id="IO::H5IODataTree::fill_configuration__boost::program_options::variables_mapCR"></span><span class="target" id="classIO_1_1H5IODataTree_1a8b9b9839a979107699f80644fcb43a16"></span>void <code class="descname">fill_configuration</code><span class="sig-paren">(</span><em class="property">const</em> boost::program_options::variables_map &amp;<em>options</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO12H5IODataTree18fill_configurationERKN5boost15program_options13variables_mapE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fills all attributes defining the configuration from the command line. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">options</span></code>: The parsed command line options. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Types</p>
<dl class="type">
<dt id="_CPPv2N2IO4TOOLE">
<span id="IO::TOOL"></span><span class="target" id="classIO_1_1H5IODataTree_1ab27643dcfe44d4b7c263fcf5ef4e1031"></span><em class="property">enum </em><code class="descname">TOOL</code><a class="headerlink" href="#_CPPv2N2IO4TOOLE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Tags for the various tools that can fill this tree with data. </p>
<p><em>Values:</em></p>
<dl class="enumerator">
<dt id="_CPPv2N2IO6FITPSFE">
<span class="target" id="classIO_1_1H5IODataTree_1ab27643dcfe44d4b7c263fcf5ef4e1031a06805326debba2456946ad04c75a5861"></span><code class="descname">FITPSF</code><a class="headerlink" href="#_CPPv2N2IO6FITPSFE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N2IO6FITPRFE">
<span class="target" id="classIO_1_1H5IODataTree_1ab27643dcfe44d4b7c263fcf5ef4e1031a3a2be373b5efee89b0b36b871fb1aead"></span><code class="descname">FITPRF</code><a class="headerlink" href="#_CPPv2N2IO6FITPRFE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N2IO10SUBPIXPHOTE">
<span class="target" id="classIO_1_1H5IODataTree_1ab27643dcfe44d4b7c263fcf5ef4e1031aed5fb8c41425304bc9391bb63eeea37e"></span><code class="descname">SUBPIXPHOT</code><a class="headerlink" href="#_CPPv2N2IO10SUBPIXPHOTE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N2IO9FITSUBPIXE">
<span class="target" id="classIO_1_1H5IODataTree_1ab27643dcfe44d4b7c263fcf5ef4e1031a284c8d592f1a7f47a7e8ae4644092ad1"></span><code class="descname">FITSUBPIX</code><a class="headerlink" href="#_CPPv2N2IO9FITSUBPIXE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N2IO12H5IODataTree23initialize_command_lineEiPPcRKNSt6stringERKNSt6stringE">
<span id="IO::H5IODataTree::initialize_command_line__i.cPP.ssCR.ssCR"></span><span class="target" id="classIO_1_1H5IODataTree_1ad229d523453b8966b602712c8c57942c"></span>void <code class="descname">initialize_command_line</code><span class="sig-paren">(</span>int <em>argc</em>, char **<em>argv</em>, <em class="property">const</em> std::string &amp;<em>executable</em>, <em class="property">const</em> std::string &amp;<em>version</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO12H5IODataTree23initialize_command_lineEiPPcRKNSt6stringERKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Prepares the tree for the specific tool used. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">argc</span></code>: The number of command line tokens. </li>
<li><code class="docutils literal"><span class="pre">argv</span></code>: The command line tokens. </li>
<li><code class="docutils literal"><span class="pre">executable</span></code>: The executable invoked (no path). </li>
<li><code class="docutils literal"><span class="pre">version</span></code>: The version of the tool used. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO12H5IODataTree21process_psffit_optionERKNSt6stringERKN3opt14variable_valueE">
<span id="IO::H5IODataTree::process_psffit_option__ssCR.opt::variable_valueCR"></span><span class="target" id="classIO_1_1H5IODataTree_1ae94b603ffec3dfc6603d78f54828d2b1"></span>void <code class="descname">process_psffit_option</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>key</em>, <em class="property">const</em> opt::variable_value &amp;<em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO12H5IODataTree21process_psffit_optionERKNSt6stringERKN3opt14variable_valueE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Decides what to do with a single options entry for psf fitting. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">key</span></code>: The key this option is identified by. </li>
<li><code class="docutils literal"><span class="pre">value</span></code>: The value of the option. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO12H5IODataTree25process_subpixphot_optionERKNSt6stringERKN3opt14variable_valueE">
<span id="IO::H5IODataTree::process_subpixphot_option__ssCR.opt::variable_valueCR"></span><span class="target" id="classIO_1_1H5IODataTree_1a08e45dceb20a20d691689df00d5b758a"></span>void <code class="descname">process_subpixphot_option</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>key</em>, <em class="property">const</em> opt::variable_value &amp;<em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO12H5IODataTree25process_subpixphot_optionERKNSt6stringERKN3opt14variable_valueE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Decides what to do with a single options entry for psf fitting. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">key</span></code>: The key this option is identified by. </li>
<li><code class="docutils literal"><span class="pre">value</span></code>: The value of the option. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N2IO12H5IODataTree6__toolE">
<span id="IO::H5IODataTree::__tool__TOOL"></span><span class="target" id="classIO_1_1H5IODataTree_1ad2658f14598882607961a67f344370c5"></span><a class="reference internal" href="#_CPPv2N2IO4TOOLE" title="IO::TOOL">TOOL</a> <code class="descname">__tool</code><a class="headerlink" href="#_CPPv2N2IO12H5IODataTree6__toolE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The that was used to generate the data in the tree. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO12H5IODataTree8__prefixE">
<span id="IO::H5IODataTree::__prefix__ss"></span><span class="target" id="classIO_1_1H5IODataTree_1ae51465c781ddd1b4ab07ff2e95f0b606"></span>std::string <code class="descname">__prefix</code><a class="headerlink" href="#_CPPv2N2IO12H5IODataTree8__prefixE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The first part of the key for elements corresponding to the given tool. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO12H5IODataTree11__psf_modelE">
<span id="IO::H5IODataTree::__psf_model__ss"></span><span class="target" id="classIO_1_1H5IODataTree_1a4ada965e4a2c03dc1c22ec8daf2bae32"></span>std::string <code class="descname">__psf_model</code><a class="headerlink" href="#_CPPv2N2IO12H5IODataTree11__psf_modelE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The PSF model used (for PSF fitting only). </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N2IO11OutputArrayE">
<span id="IO::OutputArray"></span><span class="target" id="classIO_1_1OutputArray"></span><em class="property">template </em>&lt;typename <em>UNIT_TYPE</em>&gt;<br /><em class="property">class </em><code class="descname">OutputArray</code><a class="headerlink" href="#_CPPv2N2IO11OutputArrayE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;OutputArray.h&gt;</em><p>Prepares to write an array of values from from boost::any. </p>
<p>Each element of the array moust have UNIT_TYPE type, otherwise boost::bad_any_cast is thrown. The original data should have been either a std::vector&lt;UNIT_TYPE&gt; or an std::valarray&lt;UNIT_TYPE&gt;. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N2IO11OutputArray11OutputArrayEv">
<span id="IO::OutputArray::OutputArray"></span><span class="target" id="classIO_1_1OutputArray_1ab7313a2e174d566c10379ad8049f683d"></span><code class="descname">OutputArray</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO11OutputArray11OutputArrayEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>To be filled later using <a class="reference internal" href="#classIO_1_1OutputArray_1a2feadc779aeea863db6777550d8b278e"><span class="std std-ref">parse()</span></a>. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO11OutputArray11OutputArrayERKN5boost3anyE">
<span id="IO::OutputArray::OutputArray__boost::anyCR"></span><span class="target" id="classIO_1_1OutputArray_1a44cff483000bdc1fd9d302d7d571e332"></span><code class="descname">OutputArray</code><span class="sig-paren">(</span><em class="property">const</em> boost::any &amp;<em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO11OutputArray11OutputArrayERKN5boost3anyE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Attempts all possible casts on the given value. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO11OutputArray5parseERKN5boost3anyE">
<span id="IO::OutputArray::parse__boost::anyCR"></span><span class="target" id="classIO_1_1OutputArray_1a2feadc779aeea863db6777550d8b278e"></span>void <code class="descname">parse</code><span class="sig-paren">(</span><em class="property">const</em> boost::any &amp;<em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO11OutputArray5parseERKN5boost3anyE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Parses the given value into this. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK2IO11OutputArray4sizeEv">
<span id="IO::OutputArray::sizeC"></span><span class="target" id="classIO_1_1OutputArray_1a378d304e54c047ea2ff39ab8ac3a7f98"></span><em class="property">const</em> hsize_t &amp;<code class="descname">size</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK2IO11OutputArray4sizeEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of elements in the array. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK2IO11OutputArray4dataEv">
<span id="IO::OutputArray::dataC"></span><span class="target" id="classIO_1_1OutputArray_1a3e2e17d2eba7dcf22fb5060e55776ae1"></span><em class="property">const</em> UNIT_TYPE *<code class="descname">data</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK2IO11OutputArray4dataEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A pointer to the first element in the array, the rest are contiguous. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK2IO11OutputArrayixE7hsize_t">
<span id="IO::OutputArray::subscript-operator__hsize_tC"></span><span class="target" id="classIO_1_1OutputArray_1ad35757212b0836d20207b1b3cab36e54"></span><em class="property">const</em> UNIT_TYPE &amp;<code class="descname">operator[]</code><span class="sig-paren">(</span>hsize_t <em>index</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK2IO11OutputArrayixE7hsize_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constant reference to an array element. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO11OutputArrayeqERK11OutputArrayI9UNIT_TYPEE">
<span id="IO::OutputArray::eq-operator__OutputArray:UNIT_TYPE:CR"></span><span class="target" id="classIO_1_1OutputArray_1aafe365b9930a836d99f788424cc6b86e"></span>bool <code class="descname">operator==</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO11OutputArrayE" title="IO::OutputArray">OutputArray</a>&lt;UNIT_TYPE&gt; &amp;<em>rhs</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO11OutputArrayeqERK11OutputArrayI9UNIT_TYPEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Compares two arrays element by element (empty arrays compare equal). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO11OutputArrayD0Ev">
<span id="IO::OutputArray::~OutputArray"></span><span class="target" id="classIO_1_1OutputArray_1ac72ea2c48f44e486de7a1f4cfc6f77f0"></span><code class="descname">~OutputArray</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO11OutputArrayD0Ev" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO11OutputArray5parseERKN5boost3anyE">
<em class="property">template </em>&lt;&gt;<br /><span class="target" id="classIO_1_1OutputArray_1a5b525b484b37b943225f01bdf1fed3a4"></span>void <code class="descname">parse</code><span class="sig-paren">(</span><em class="property">const</em> boost::any &amp;<em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO11OutputArray5parseERKN5boost3anyE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt>
<em class="property">template </em>&lt;&gt;<br /><span class="target" id="classIO_1_1OutputArray_1a5b525b484b37b943225f01bdf1fed3a4"></span>void <code class="descname">parse</code><span class="sig-paren">(</span><em class="property">const</em> boost::any &amp;<em>value</em><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N2IO11OutputArray18try_container_typeERKN5boost3anyE">
<span id="IO::OutputArray::try_container_type__boost::anyCR"></span><em class="property">template </em>&lt;<em class="property">class</em> INPUT_ARRAY_TYPE&gt;<br /><span class="target" id="classIO_1_1OutputArray_1ad15debf028d1b2ef312b15de33ac1bfc"></span>bool <code class="descname">try_container_type</code><span class="sig-paren">(</span><em class="property">const</em> boost::any &amp;<em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO11OutputArray18try_container_typeERKN5boost3anyE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Try reading the input data assuming it is in some type of container providing beging() and end() const_iterators. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO11OutputArray14try_array_typeERKN5boost3anyE">
<span id="IO::OutputArray::try_array_type__boost::anyCR"></span><em class="property">template </em>&lt;<em class="property">class</em> INPUT_ARRAY_TYPE&gt;<br /><span class="target" id="classIO_1_1OutputArray_1aebf5fa77cbdfa7a8bd43f1e86c23de87"></span>bool <code class="descname">try_array_type</code><span class="sig-paren">(</span><em class="property">const</em> boost::any &amp;<em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO11OutputArray14try_array_typeERKN5boost3anyE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Try reading the input data assuming it is in some type of container where entries are stored contigously in memory. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N2IO11OutputArray6__sizeE">
<span id="IO::OutputArray::__size__hsize_t"></span><span class="target" id="classIO_1_1OutputArray_1a4688888b414e4bef81c91de3239bc557"></span>hsize_t <code class="descname">__size</code><a class="headerlink" href="#_CPPv2N2IO11OutputArray6__sizeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The size of the array. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO11OutputArray6__dataE">
<span id="IO::OutputArray::__data__UNIT_TYPECP"></span><span class="target" id="classIO_1_1OutputArray_1ace3a82e89dbe43fde7cad33f6c95a9f7"></span><em class="property">const</em> UNIT_TYPE *<code class="descname">__data</code><a class="headerlink" href="#_CPPv2N2IO11OutputArray6__dataE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The first element. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO11OutputArray16__allocated_dataE">
<span id="IO::OutputArray::__allocated_data__UNIT_TYPEP"></span><span class="target" id="classIO_1_1OutputArray_1ad502fdd3e83c6eedafffc86efa69ed32"></span>UNIT_TYPE *<code class="descname">__allocated_data</code><a class="headerlink" href="#_CPPv2N2IO11OutputArray16__allocated_dataE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N2IO15OutputSDKSourceE">
<span id="IO::OutputSDKSource"></span><span class="target" id="classIO_1_1OutputSDKSource"></span><em class="property">class </em><code class="descname">OutputSDKSource</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core9SDKSourceE" title="Core::SDKSource">SDKSource</a><a class="headerlink" href="#_CPPv2N2IO15OutputSDKSourceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;OutputSDKSource.h&gt;</em><p>A class for SDK sources with all kinds of other attributes that can be set by the various fitting/photometering methods. For now additional information is:<ol class="arabic simple">
<li>Is the source enabled (for whatever)</li>
<li>The reduced chi2 assigned to this source by some fitting method</li>
<li>The number of pixels assigned to this source in an image </li>
</ol>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N2IO15OutputSDKSource15OutputSDKSourceERKNSt6stringERKNSt6stringERKN4Core8SourceIDEjddddddRKN10Background6SourceEdjd">
<span id="IO::OutputSDKSource::OutputSDKSource__ssCR.ssCR.Core::SourceIDCR.unsigned.double.double.double.double.double.double.Background::SourceCR.double.unsigned.double"></span><span class="target" id="classIO_1_1OutputSDKSource_1ac786559b380eebfdf02a938fbbef2e9b"></span><code class="descname">OutputSDKSource</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>image_fname</em>, <em class="property">const</em> std::string &amp;<em>output_fname</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> &amp;<em>id</em> = Core::SourceID (), unsigned <em>num_apertures</em> = 1, double <em>x</em> = Core::NaN, double <em>y</em> = Core::NaN, double <em>s</em> = Core::NaN, double <em>d</em> = Core::NaN, double <em>k</em> = Core::NaN, double <em>amp</em> = Core::NaN, <em class="property">const</em> <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> &amp;<em>bg</em> = Background::Source (), double <em>reduced_chi2</em> = Core::NaN, unsigned <em>num_pixels</em> = 0, double <em>signal_to_noise</em> = Core::NaN<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO15OutputSDKSource15OutputSDKSourceERKNSt6stringERKNSt6stringERKN4Core8SourceIDEjddddddRKN10Background6SourceEdjd" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO15OutputSDKSource15OutputSDKSourceERK15OutputSDKSource">
<span id="IO::OutputSDKSource::OutputSDKSource__OutputSDKSourceCR"></span><span class="target" id="classIO_1_1OutputSDKSource_1aea79d3634fd22e5915f0c089f1a9a165"></span><code class="descname">OutputSDKSource</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO15OutputSDKSource15OutputSDKSourceERKNSt6stringERKNSt6stringERKN4Core8SourceIDEjddddddRKN10Background6SourceEdjd" title="IO::OutputSDKSource::OutputSDKSource">OutputSDKSource</a> &amp;<em>orig</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO15OutputSDKSource15OutputSDKSourceERK15OutputSDKSource" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2NK2IO15OutputSDKSource12reduced_chi2Ev">
<span id="IO::OutputSDKSource::reduced_chi2C"></span><span class="target" id="classIO_1_1OutputSDKSource_1af53865672b539b497f1ad89011977f82"></span>double <code class="descname">reduced_chi2</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK2IO15OutputSDKSource12reduced_chi2Ev" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The reduced chi squared that is source had in the fit. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK2IO15OutputSDKSource11pixel_countEv">
<span id="IO::OutputSDKSource::pixel_countC"></span><span class="target" id="classIO_1_1OutputSDKSource_1ae45cf74cea9bbda28c27d5a4d6585504"></span>unsigned <code class="descname">pixel_count</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK2IO15OutputSDKSource11pixel_countEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of pixels assigned to this source during the fit. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK2IO15OutputSDKSource15signal_to_noiseEv">
<span id="IO::OutputSDKSource::signal_to_noiseC"></span><span class="target" id="classIO_1_1OutputSDKSource_1a8a9bf4f2aa218eeb9e8f6a1a6419e79d"></span>double <code class="descname">signal_to_noise</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK2IO15OutputSDKSource15signal_to_noiseEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The total signal to noise of the source (all pixels combined). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK2IO15OutputSDKSource14image_filenameEv">
<span id="IO::OutputSDKSource::image_filenameC"></span><span class="target" id="classIO_1_1OutputSDKSource_1a0b89ccff63365807149a27fef16411f8"></span><em class="property">const</em> std::string &amp;<code class="descname">image_filename</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK2IO15OutputSDKSource14image_filenameEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The filename of the image from which this source was extracted. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK2IO15OutputSDKSource15output_filenameEv">
<span id="IO::OutputSDKSource::output_filenameC"></span><span class="target" id="classIO_1_1OutputSDKSource_1aa81775f70339111688a56553d0173512"></span><em class="property">const</em> std::string &amp;<code class="descname">output_filename</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK2IO15OutputSDKSource15output_filenameEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The output filename where this source should be saved. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N2IO15OutputSDKSource14__reduced_chi2E">
<span id="IO::OutputSDKSource::__reduced_chi2__double"></span><span class="target" id="classIO_1_1OutputSDKSource_1a79e86c846e6bc8e9e4207114d7c6066b"></span>double <code class="descname">__reduced_chi2</code><a class="headerlink" href="#_CPPv2N2IO15OutputSDKSource14__reduced_chi2E" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The reduced <span class="math">\(\chi^2\)</span> for the source after PSF fitting. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO15OutputSDKSource17__signal_to_noiseE">
<span id="IO::OutputSDKSource::__signal_to_noise__double"></span><span class="target" id="classIO_1_1OutputSDKSource_1a657ad9b95d006dbccec2674843d12394"></span>double <code class="descname">__signal_to_noise</code><a class="headerlink" href="#_CPPv2N2IO15OutputSDKSource17__signal_to_noiseE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The signal to noise in the pixels assigned to the source (PSF fitting only). </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO15OutputSDKSource12__num_pixelsE">
<span id="IO::OutputSDKSource::__num_pixels__unsigned"></span><span class="target" id="classIO_1_1OutputSDKSource_1a915e7a4fb81495471a7efe9a58cc7e85"></span>unsigned <code class="descname">__num_pixels</code><a class="headerlink" href="#_CPPv2N2IO15OutputSDKSource12__num_pixelsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of pixels assigned to the source (PSF fitting only). </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO15OutputSDKSource16__image_filenameE">
<span id="IO::OutputSDKSource::__image_filename__ss"></span><span class="target" id="classIO_1_1OutputSDKSource_1a92bc26062a3b82303c027f5f0ee69bb3"></span>std::string <code class="descname">__image_filename</code><a class="headerlink" href="#_CPPv2N2IO15OutputSDKSource16__image_filenameE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classIO_1_1OutputSDKSource_1a0b89ccff63365807149a27fef16411f8"><span class="std std-ref">image_filename()</span></a>. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO15OutputSDKSource17__output_filenameE">
<span id="IO::OutputSDKSource::__output_filename__ss"></span><span class="target" id="classIO_1_1OutputSDKSource_1a3745e33d8ed972a54dc7fcb2103a3324"></span>std::string <code class="descname">__output_filename</code><a class="headerlink" href="#_CPPv2N2IO15OutputSDKSource17__output_filenameE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classIO_1_1OutputSDKSource_1aa81775f70339111688a56553d0173512"><span class="std std-ref">output_filename()</span></a>. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N2IO14SubPixHDF5FileE">
<span id="IO::SubPixHDF5File"></span><span class="target" id="classIO_1_1SubPixHDF5File"></span><em class="property">class </em><code class="descname">SubPixHDF5File</code> : <em class="property">public</em> H5File<a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5FileE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;SubPixHDF5File.h&gt;</em><p>A class for reading/writing HDF5 files imposing a user defined structure. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File14SubPixHDF5FileEv">
<span id="IO::SubPixHDF5File::SubPixHDF5File"></span><span class="target" id="classIO_1_1SubPixHDF5File_1acb587e53c5d775ea9db4a9cca42ca0ed"></span><code class="descname">SubPixHDF5File</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File14SubPixHDF5FileEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Default constructor allows opening the file later. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File14SubPixHDF5FileEPKcjRKN2H517FileCreatPropListERKN2H515FileAccPropListE">
<span id="IO::SubPixHDF5File::SubPixHDF5File__cCP.unsigned-i.H5::FileCreatPropListCR.H5::FileAccPropListCR"></span><span class="target" id="classIO_1_1SubPixHDF5File_1a1422f864771db7a3697d3ff17fe15a3c"></span><code class="descname">SubPixHDF5File</code><span class="sig-paren">(</span><em class="property">const</em> char *<em>name</em>, unsigned int <em>flags</em>, <em class="property">const</em> H5::FileCreatPropList &amp;<em>create_plist</em> = H5::FileCreatPropList::DEFAULT, <em class="property">const</em> H5::FileAccPropList &amp;<em>access_plist</em> = H5::FileAccPropList::DEFAULT<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File14SubPixHDF5FileEPKcjRKN2H517FileCreatPropListERKN2H515FileAccPropListE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Expose H5File constructor (see HDF5 documentation for description). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File11openDataSetERKNSt6stringE">
<span id="IO::SubPixHDF5File::openDataSet__ssCR"></span><span class="target" id="classIO_1_1SubPixHDF5File_1a083c4102516ed77bf34b94508366e880"></span>H5::DataSet <code class="descname">openDataSet</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>dataset_key</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File11openDataSetERKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Opens the dataset identified by the given key. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">dataset_key</span></code>: The key identifying the dataset (e.g. &#8216;psffit.mag&#8217;) </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File13openAttributeERKNSt6stringE">
<span id="IO::SubPixHDF5File::openAttribute__ssCR"></span><span class="target" id="classIO_1_1SubPixHDF5File_1a03631378065c306724a431053b5a961e"></span>H5::Attribute <code class="descname">openAttribute</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>attribute_key</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File13openAttributeERKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Opens the attribute identified by the given key. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">attribute_key</span></code>: The key identifying the attribute (e.g. &#8216;psffit.cmdline&#8217;) </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File5writeERK12H5IODataTreeb">
<span id="IO::SubPixHDF5File::write__H5IODataTreeCR.b"></span><span class="target" id="classIO_1_1SubPixHDF5File_1a05597f3b36c5c51d05325534299eb7a3"></span>void <code class="descname">write</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data</em>, bool <em>overwrite</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File5writeERK12H5IODataTreeb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Adds/overwrites data to an open file (attributes groups and links). </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">data</span></code>: The content to write. Should be organized in a boost property tree with string keys and boost::any values. All keys should have one of the recognized names. </li>
<li><code class="docutils literal"><span class="pre">overwrite</span></code>: If an element in data is found to already exist this argument determines if it will be overwritten (True) or an Error::HDF5 exception will be raised (False). </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File11read_psfmapER12H5IODataTree">
<span id="IO::SubPixHDF5File::read_psfmap__H5IODataTreeR"></span><span class="target" id="classIO_1_1SubPixHDF5File_1a7fdd2eb96d54651671e924172488e4d6"></span>void <code class="descname">read_psfmap</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File11read_psfmapER12H5IODataTree" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reads in the coefficients of the PSF map. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">data</span></code>: The data tree to write the PSF map coefficients to. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File21read_psfmap_variablesER12H5IODataTree">
<span id="IO::SubPixHDF5File::read_psfmap_variables__H5IODataTreeR"></span><span class="target" id="classIO_1_1SubPixHDF5File_1a6822efab7d428cfe4fc7a4e914341e26"></span>void <code class="descname">read_psfmap_variables</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File21read_psfmap_variablesER12H5IODataTree" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reads in the variables which participate in the PSF map. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">data</span></code>: The data tree to write the PSF map variables to. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File4readE13InputIterator13InputIteratorR12H5IODataTreeb">
<span id="IO::SubPixHDF5File::read__InputIterator.InputIterator.H5IODataTreeR.b"></span><em class="property">template </em>&lt;<em class="property">class</em> InputIterator&gt;<br /><span class="target" id="classIO_1_1SubPixHDF5File_1ada5e4f7904b24a216457c0bc257f0921"></span>void <code class="descname">read</code><span class="sig-paren">(</span>InputIterator <em>first</em>, InputIterator <em>last</em>, <a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data</em>, bool <em>require_all</em> = true<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File4readE13InputIterator13InputIteratorR12H5IODataTreeb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reads from the file into an I/O tree. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">first</span></code>: The first of a set of string objects giving the keys to the quantities which should be read. </li>
<li><code class="docutils literal"><span class="pre">last</span></code>: One past the last quantity to read. </li>
<li><code class="docutils literal"><span class="pre">data</span></code>: The I/O tree to fill. </li>
<li><code class="docutils literal"><span class="pre">require_all</span></code>: Must all quantities be present. If false, missing quantities are simply not inserted in data. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Static Functions</p>
<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File9configureEPKc">
<span id="IO::SubPixHDF5File::configure__cCP"></span><span class="target" id="classIO_1_1SubPixHDF5File_1aca6be4d1cfca17ca8af2d63a066aba86"></span>void <code class="descname">configure</code><span class="sig-paren">(</span><em class="property">const</em> char *<em>xml_config_fname</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File9configureEPKc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reads the structure of the desired HDF5 output from an XML file. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">xml_config_fname</span></code>: The name of the file to read the structure from. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Types</p>
<dl class="type">
<dt id="_CPPv2N2IO13__H5COMPONENTE">
<span id="IO::__H5COMPONENT"></span><span class="target" id="classIO_1_1SubPixHDF5File_1ab396ac143c95105c6dafc44883ed5afd"></span><em class="property">enum </em><code class="descname">__H5COMPONENT</code><a class="headerlink" href="#_CPPv2N2IO13__H5COMPONENTE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Identifiers for the various HDF5 components. </p>
<p><em>Values:</em></p>
<dl class="enumerator">
<dt id="_CPPv2N2IO5GROUPE">
<span class="target" id="classIO_1_1SubPixHDF5File_1ab396ac143c95105c6dafc44883ed5afda2aa371f37ff465543f318310c63cb058"></span><code class="descname">GROUP</code><a class="headerlink" href="#_CPPv2N2IO5GROUPE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>An HDF5 group. </p>
</dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N2IO7DATASETE">
<span class="target" id="classIO_1_1SubPixHDF5File_1ab396ac143c95105c6dafc44883ed5afdab613c1282f235cf18998af583e5ae5db"></span><code class="descname">DATASET</code><a class="headerlink" href="#_CPPv2N2IO7DATASETE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>An HDF5 dataset. </p>
</dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N2IO4LINKE">
<span class="target" id="classIO_1_1SubPixHDF5File_1ab396ac143c95105c6dafc44883ed5afdaaefb44ebe0c6b9de4324c2b5755b71b3"></span><code class="descname">LINK</code><a class="headerlink" href="#_CPPv2N2IO4LINKE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>An HDF5 link to a dataset. </p>
</dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N2IO9ATTRIBUTEE">
<span class="target" id="classIO_1_1SubPixHDF5File_1ab396ac143c95105c6dafc44883ed5afda880b4d471e5c049003e0d2160bae0754"></span><code class="descname">ATTRIBUTE</code><a class="headerlink" href="#_CPPv2N2IO9ATTRIBUTEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>An HDF5 attribute. </p>
</dd></dl>

</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File12dataset_typeERKNSt6stringE">
<span id="IO::SubPixHDF5File::dataset_type__ssCR"></span><span class="target" id="classIO_1_1SubPixHDF5File_1ac9621f0603d8e979cf5a1a792278b0dd"></span><em class="property">const</em> H5::DataType &amp;<code class="descname">dataset_type</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>dataset_key</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File12dataset_typeERKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the type to use for a dataset of the given name. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">dataset_key</span></code>: The key identifying the dataset. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File17substitute_ap_indERKNSt6stringEj">
<span id="IO::SubPixHDF5File::substitute_ap_ind__ssCR.unsigned"></span><span class="target" id="classIO_1_1SubPixHDF5File_1a40c9f0df51a4a97847c4fd559f9bc47c"></span>std::string <code class="descname">substitute_ap_ind</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>format_string</em>, unsigned <em>ap_ind</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File17substitute_ap_indERKNSt6stringEj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Substitutes the aperture index in a string. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">format_string</span></code>: The string to substitute in. It may or may not contain %(ap_ind)&lt;format&gt; style substitution. </li>
<li><code class="docutils literal"><span class="pre">ap_ind</span></code>: The aperture index to assume. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File16create_attributeERN2H58H5ObjectERKNSt6stringERKN5boost3anyEi">
<span id="IO::SubPixHDF5File::create_attribute__H5::H5ObjectR.ssCR.boost::anyCR.i"></span><span class="target" id="classIO_1_1SubPixHDF5File_1a60ac49fd53923ac78e364e7bacc9f538"></span>void <code class="descname">create_attribute</code><span class="sig-paren">(</span>H5::H5Object &amp;<em>destination</em>, <em class="property">const</em> std::string &amp;<em>name</em>, <em class="property">const</em> boost::any &amp;<em>value</em>, int <em>aperture_index</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File16create_attributeERN2H58H5ObjectERKNSt6stringERKN5boost3anyEi" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Creates a new attribute, assuming no conflict with an existing one. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">destination</span></code>: The hdf5 location to add the attribute to. </li>
<li><code class="docutils literal"><span class="pre">name</span></code>: The name of the new attribute to add. </li>
<li><code class="docutils literal"><span class="pre">value</span></code>: The value of the attribute. </li>
<li><code class="docutils literal"><span class="pre">aperture_index</span></code>: The index of the aperture to output for aperture photometry dependent attributes. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File14add_attributesERKN5boost13property_tree5ptreeERK12H5IODataTreeRN2H58H5ObjectEbi">
<span id="IO::SubPixHDF5File::add_attributes__boost::property_tree::ptreeCR.H5IODataTreeCR.H5::H5ObjectR.b.i"></span><span class="target" id="classIO_1_1SubPixHDF5File_1a3a1069e81296c0e07cb4f02b8eacc9b5"></span>void <code class="descname">add_attributes</code><span class="sig-paren">(</span><em class="property">const</em> boost::property_tree::ptree &amp;<em>structure_node</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data</em>, H5::H5Object &amp;<em>destination</em>, bool <em>overwrite</em>, int <em>aperture_index</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File14add_attributesERKN5boost13property_tree5ptreeERK12H5IODataTreeRN2H58H5ObjectEbi" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Adds all known attributes to a group or a dataset. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">structure_node</span></code>: The node in the structure corresponding to the location being filled. </li>
<li><code class="docutils literal"><span class="pre">data</span></code>: The same as the data argument of <a class="reference internal" href="#classIO_1_1SubPixHDF5File_1a05597f3b36c5c51d05325534299eb7a3"><span class="std std-ref">SubPixHDF5File::write</span></a>. </li>
<li><code class="docutils literal"><span class="pre">destination</span></code>: The location to which attributes must be added. </li>
<li><code class="docutils literal"><span class="pre">overwrite</span></code>: Should existing attributes be overwritten? If false, encountering an existintg attribute will throw an Error::HDF5 exception. </li>
<li><code class="docutils literal"><span class="pre">aperture_index</span></code>: The index of the aperture to output for aperture photometry dependent attributes. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File25add_psfmap_variable_namesERKNSt4listIN3PSF15MapVariableTypeEEE">
<span id="IO::SubPixHDF5File::add_psfmap_variable_names__std::list:PSF::MapVariableType:CR"></span><span class="target" id="classIO_1_1SubPixHDF5File_1a983b59ee938b0b078ad1bc6876212500"></span>void <code class="descname">add_psfmap_variable_names</code><span class="sig-paren">(</span><em class="property">const</em> std::list&lt;<a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF15MapVariableTypeE" title="PSF::MapVariableType">MapVariableType</a>&gt; &amp;<em>variables</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File25add_psfmap_variable_namesERKNSt4listIN3PSF15MapVariableTypeEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Adds the list of variables names attribute to the output file. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">variables</span></code>: The list of variables being output. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File20compression_proplistERKNSt6stringEb7hsize_t">
<span id="IO::SubPixHDF5File::compression_proplist__ssCR.b.hsize_t"></span><span class="target" id="classIO_1_1SubPixHDF5File_1a712703fd9eeec1b3282d655845193975"></span>H5::DSetCreatPropList <code class="descname">compression_proplist</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>compression_string</em>, bool <em>floating_point_data</em>, hsize_t <em>dataset_size</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File20compression_proplistERKNSt6stringEb7hsize_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns a H5::DSetCreatPropList that implements a given compression. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">compression_string</span></code>: What compression to use (if any) for a dataset. Can be a combination of: &#8216;gzip:&lt;level&gt;&#8217;, &#8216;shuffle&#8217; and &#8216;scaleoffset:&lt;precision&gt;&#8217;, separated by &#8216;;&#8217;. The precision for scale offset filters and the level of the gzip filter are defined the same as for the corresponding HDF5 filters. </li>
<li><code class="docutils literal"><span class="pre">floating_point_data</span></code>: Will the dataset contain floating point (true) or integer (false) data </li>
<li><code class="docutils literal"><span class="pre">dataset_size</span></code>: The size of the dataset being written (may determinene chunk size) </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File10add_psfmapERKNSt6stringERN2H55GroupERK12H5IODataTreeRKNSt6stringEb">
<span id="IO::SubPixHDF5File::add_psfmap__ssCR.H5::GroupR.H5IODataTreeCR.ssCR.b"></span><span class="target" id="classIO_1_1SubPixHDF5File_1ab6c7a52d2da286bdf897faa2ce10c19a"></span>H5::DataSet <code class="descname">add_psfmap</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>dataset_name</em>, H5::Group &amp;<em>destination</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data</em>, <em class="property">const</em> std::string &amp;<em>compression</em>, bool <em>overwrite</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File10add_psfmapERKNSt6stringERN2H55GroupERK12H5IODataTreeRKNSt6stringEb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Creates (or overwwrites) the PSF map dataset. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">dataset_name</span></code>: The name to give to the new dataset. </li>
<li><code class="docutils literal"><span class="pre">destination</span></code>: The group under which to place the dataset. </li>
<li><code class="docutils literal"><span class="pre">data</span></code>: The same as the data argument to <a class="reference internal" href="#classIO_1_1SubPixHDF5File_1a05597f3b36c5c51d05325534299eb7a3"><span class="std std-ref">SubPixHDF5File::write</span></a> </li>
<li><code class="docutils literal"><span class="pre">compression</span></code>: The compression string to use. </li>
<li><code class="docutils literal"><span class="pre">overwrite</span></code>: If a dataset with the given name already exists, should it be overwritten? If false, an existing dataset throws Error::HDF5 </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File20add_psfmap_variablesERKNSt6stringERN2H55GroupERK12H5IODataTreeRKNSt6stringEb">
<span id="IO::SubPixHDF5File::add_psfmap_variables__ssCR.H5::GroupR.H5IODataTreeCR.ssCR.b"></span><span class="target" id="classIO_1_1SubPixHDF5File_1a5a29d708ba29468f326ffde1d7fadeb2"></span>H5::DataSet <code class="descname">add_psfmap_variables</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>dataset_name</em>, H5::Group &amp;<em>destination</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data</em>, <em class="property">const</em> std::string &amp;<em>compression</em>, bool <em>overwrite</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File20add_psfmap_variablesERKNSt6stringERN2H55GroupERK12H5IODataTreeRKNSt6stringEb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Creates (or overwwrites) the dataset containing the variables required by the PSF map. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">dataset_name</span></code>: The name to give to the new dataset. </li>
<li><code class="docutils literal"><span class="pre">destination</span></code>: The group under which to place the dataset. </li>
<li><code class="docutils literal"><span class="pre">data</span></code>: The same as the data argument to <a class="reference internal" href="#classIO_1_1SubPixHDF5File_1a05597f3b36c5c51d05325534299eb7a3"><span class="std std-ref">SubPixHDF5File::write</span></a> </li>
<li><code class="docutils literal"><span class="pre">compression</span></code>: The compression string to use. </li>
<li><code class="docutils literal"><span class="pre">overwrite</span></code>: If a dataset with the given name already exists, should it be overwritten? If false, an existing dataset throws Error::HDF5 </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File17find_dataset_dataERKNSt6stringEiRK12H5IODataTree">
<span id="IO::SubPixHDF5File::find_dataset_data__ssCR.i.H5IODataTreeCR"></span><span class="target" id="classIO_1_1SubPixHDF5File_1a1b858426232bac64b02822320761b423"></span><a class="reference internal" href="#_CPPv2N2IO10IOTreeBaseE" title="IO::IOTreeBase">IOTreeBase</a>::const_assoc_iterator <code class="descname">find_dataset_data</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>dataset_id</em>, int <em>aperture_index</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File17find_dataset_dataERKNSt6stringEiRK12H5IODataTree" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return an iterator to the node containing the data for a dataset. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">dataset_id</span></code>: The ID of the dataset (e.g. projsrc.x). </li>
<li><code class="docutils literal"><span class="pre">aperture_index</span></code>: See same name argument to add_dataset. </li>
<li><code class="docutils literal"><span class="pre">data</span></code>: The output data tree to find the data in. </li>
</ul>
</dd>
</dl>
</p>
<p>Takes care of aperture index if necessary and split by output filename. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File14add_1d_datasetERKNSt6stringERN2H55GroupERKN2H58DataTypeERKN2H58DataTypeEbRKN5boost3anyERKN5boost13property_tree5ptreeEb">
<span id="IO::SubPixHDF5File::add_1d_dataset__ssCR.H5::GroupR.H5::DataTypeCR.H5::DataTypeCR.b.boost::anyCR.boost::property_tree::ptreeCR.b"></span><em class="property">template </em>&lt;<em class="property">typename</em> DATA_TYPE&gt;<br /><span class="target" id="classIO_1_1SubPixHDF5File_1ac899eafae94358334b8128e050d3c169"></span>H5::DataSet <code class="descname">add_1d_dataset</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>dataset_name</em>, H5::Group &amp;<em>destination</em>, <em class="property">const</em> H5::DataType &amp;<em>memory_data_type</em>, <em class="property">const</em> H5::DataType &amp;<em>output_data_type</em>, bool <em>floating_point_data</em>, <em class="property">const</em> boost::any &amp;<em>any_array</em>, <em class="property">const</em> boost::property_tree::ptree &amp;<em>structure_node</em>, bool <em>overwrite</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File14add_1d_datasetERKNSt6stringERN2H55GroupERKN2H58DataTypeERKN2H58DataTypeEbRKN5boost3anyERKN5boost13property_tree5ptreeEb" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File19add_generic_datasetERKNSt6stringERN2H55GroupERKN2H58DataTypeERKN5boost3anyERKN5boost13property_tree5ptreeEb">
<span id="IO::SubPixHDF5File::add_generic_dataset__ssCR.H5::GroupR.H5::DataTypeCR.boost::anyCR.boost::property_tree::ptreeCR.b"></span><span class="target" id="classIO_1_1SubPixHDF5File_1a9461eeaaa292b97059ad2d4c8f9674bb"></span>H5::DataSet <code class="descname">add_generic_dataset</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>dataset_name</em>, H5::Group &amp;<em>destination</em>, <em class="property">const</em> H5::DataType &amp;<em>output_data_type</em>, <em class="property">const</em> boost::any &amp;<em>any_array</em>, <em class="property">const</em> boost::property_tree::ptree &amp;<em>structure_node</em>, bool <em>overwrite</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File19add_generic_datasetERKNSt6stringERN2H55GroupERKN2H58DataTypeERKN5boost3anyERKN5boost13property_tree5ptreeEb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Creates (or overwrites) a dataset other than the PSF map and PSF map variables. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">dataset_name</span></code>: The name to give to the new dataset. </li>
<li><code class="docutils literal"><span class="pre">destination</span></code>: The group under which to place the dataset. </li>
<li><code class="docutils literal"><span class="pre">output_data_type</span></code>: The data type to use when saving the dataset. </li>
<li><code class="docutils literal"><span class="pre">any_array</span></code>: The array of values to write. </li>
<li><code class="docutils literal"><span class="pre">structure_node</span></code>: The node in the HDF5 file structure corresponding to the dataset. </li>
<li><code class="docutils literal"><span class="pre">overwrite</span></code>: If a dataset with the given name already exists, should it be overwritten? If false, an existing dataset throws Error::HDF5 </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File11add_datasetERKNSt6stringERN2H55GroupERK12H5IODataTreeRKN5boost13property_tree5ptreeEbi">
<span id="IO::SubPixHDF5File::add_dataset__ssCR.H5::GroupR.H5IODataTreeCR.boost::property_tree::ptreeCR.b.i"></span><span class="target" id="classIO_1_1SubPixHDF5File_1a326183af5624f31f9e86e06d2c576f16"></span>void <code class="descname">add_dataset</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>dataset_name</em>, H5::Group &amp;<em>destination</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data</em>, <em class="property">const</em> boost::property_tree::ptree &amp;<em>structure_node</em>, bool <em>overwrite</em>, int <em>aperture_index</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File11add_datasetERKNSt6stringERN2H55GroupERK12H5IODataTreeRKN5boost13property_tree5ptreeEbi" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Creates (or overwrites) and fills a dataset. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">dataset_name</span></code>: The name to give to the new dataset. </li>
<li><code class="docutils literal"><span class="pre">destination</span></code>: The group under which to place the dataset. </li>
<li><code class="docutils literal"><span class="pre">data</span></code>: The same as the data argument to <a class="reference internal" href="#classIO_1_1SubPixHDF5File_1a05597f3b36c5c51d05325534299eb7a3"><span class="std std-ref">SubPixHDF5File::write</span></a> </li>
<li><code class="docutils literal"><span class="pre">structure_node</span></code>: The node in the HDF5 file structure corresponding to the dataset. </li>
<li><code class="docutils literal"><span class="pre">overwrite</span></code>: If a dataset with the given name already exists, should it be overwritten? If false, an existing dataset throws Error::HDF5 </li>
<li><code class="docutils literal"><span class="pre">aperture_index</span></code>: The index of the aperture to output for aperture photometry dependent quantities. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File8add_linkERKNSt6stringERKNSt6stringERN2H55GroupEb">
<span id="IO::SubPixHDF5File::add_link__ssCR.ssCR.H5::GroupR.b"></span><span class="target" id="classIO_1_1SubPixHDF5File_1a47ee7b1f4a23d90518a24d0886e765f7"></span>void <code class="descname">add_link</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>dataset_to_link_id</em>, <em class="property">const</em> std::string &amp;<em>link_name</em>, H5::Group &amp;<em>destination</em>, bool <em>overwrite</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File8add_linkERKNSt6stringERKNSt6stringERN2H55GroupEb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Creates (or overwrites) a soft link to a dataset. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">dataset_to_link_id</span></code>: The ID of the dataset to link. </li>
<li><code class="docutils literal"><span class="pre">link_name</span></code>: The name to give to the new link, </li>
<li><code class="docutils literal"><span class="pre">destination</span></code>: The group to create the link under. </li>
<li><code class="docutils literal"><span class="pre">overwrite</span></code>: Should a pre-existing link be overwritten? If false and a link with the given name already exists Error::HDF5 is thrown. If anything other than soft a link with the given name exists, Error::HDF5 is thrown. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File10write_nodeERK12H5IODataTreeRN2H55GroupERKNSt6stringERKN5boost13property_tree5ptreeEbi">
<span id="IO::SubPixHDF5File::write_node__H5IODataTreeCR.H5::GroupR.ssCR.boost::property_tree::ptreeCR.b.i"></span><span class="target" id="classIO_1_1SubPixHDF5File_1ac110fd93e750c126a3f92ad1052c6032"></span>void <code class="descname">write_node</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data</em>, H5::Group &amp;<em>destination</em>, <em class="property">const</em> std::string &amp;<em>new_name</em>, <em class="property">const</em> boost::property_tree::ptree &amp;<em>node</em>, bool <em>overwrite</em>, int <em>aperture_index</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File10write_nodeERK12H5IODataTreeRN2H55GroupERKNSt6stringERKN5boost13property_tree5ptreeEbi" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Handles the writing of a single node from write_data. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">data</span></code>: See write_data. </li>
<li><code class="docutils literal"><span class="pre">destination</span></code>: See write_data. </li>
<li><code class="docutils literal"><span class="pre">new_name</span></code>: The name to give to the newly created component. </li>
<li><code class="docutils literal"><span class="pre">node</span></code>: How to structure the data one of the nodes under structure in write_data. </li>
<li><code class="docutils literal"><span class="pre">overwrite</span></code>: The same as the overwrite argument of <a class="reference internal" href="#classIO_1_1SubPixHDF5File_1a05597f3b36c5c51d05325534299eb7a3"><span class="std std-ref">SubPixHDF5File::write</span></a>. </li>
<li><code class="docutils literal"><span class="pre">aperture_index</span></code>: The index of the aperture to output for aperture photometry entries. Should be -1 if not currently outputting per aperture quantities. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File10write_dataERK12H5IODataTreeRN2H55GroupERKN5boost13property_tree5ptreeEbi">
<span id="IO::SubPixHDF5File::write_data__H5IODataTreeCR.H5::GroupR.boost::property_tree::ptreeCR.b.i"></span><span class="target" id="classIO_1_1SubPixHDF5File_1aecd6b750153e496e51af4f9ba7ab9697"></span>void <code class="descname">write_data</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data</em>, H5::Group &amp;<em>destination</em>, <em class="property">const</em> boost::property_tree::ptree &amp;<em>structure</em>, bool <em>overwrite</em>, int <em>aperture_index</em> = -1<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File10write_dataERK12H5IODataTreeRN2H55GroupERKN5boost13property_tree5ptreeEbi" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Adds/overwrites data to (part of) the HDF5 file. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">data</span></code>: The same as the data argument of <a class="reference internal" href="#classIO_1_1SubPixHDF5File_1a05597f3b36c5c51d05325534299eb7a3"><span class="std std-ref">SubPixHDF5File::write</span></a>. </li>
<li><code class="docutils literal"><span class="pre">destination</span></code>: The location where the data should be written, should be a group in this file, possibly &#8216;/&#8217;. </li>
<li><code class="docutils literal"><span class="pre">structure</span></code>: How to structure the data (subtree of structure argument of <a class="reference internal" href="#classIO_1_1SubPixHDF5File_1a05597f3b36c5c51d05325534299eb7a3"><span class="std std-ref">SubPixHDF5File::write</span></a>)&gt; </li>
<li><code class="docutils literal"><span class="pre">overwrite</span></code>: The same as the overwrite argument of <a class="reference internal" href="#classIO_1_1SubPixHDF5File_1a05597f3b36c5c51d05325534299eb7a3"><span class="std std-ref">SubPixHDF5File::write</span></a>. </li>
<li><code class="docutils literal"><span class="pre">aperture_index</span></code>: The index of the aperture to output for aperture photometry entries. Should be -1 if not currently outputting per aperture quantities. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File7read_1dERK9DSET_ATTRRKN2H59DataSpaceERKN2H58DataTypeER12H5IODataTreeRKNSt6stringE">
<span id="IO::SubPixHDF5File::read_1d__DSET_ATTRCR.H5::DataSpaceCR.H5::DataTypeCR.H5IODataTreeR.ssCR"></span><em class="property">template </em>&lt;<em class="property">class</em> DSET_ATTR, <em class="property">typename</em> UNIT_TYPE&gt;<br /><span class="target" id="classIO_1_1SubPixHDF5File_1a7c9e3655ee6c7293d81e505bbb2df612"></span>void <code class="descname">read_1d</code><span class="sig-paren">(</span><em class="property">const</em> DSET_ATTR &amp;<em>source</em>, <em class="property">const</em> H5::DataSpace &amp;<em>data_space</em>, <em class="property">const</em> H5::DataType &amp;<em>memory_type</em>, <a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data</em>, <em class="property">const</em> std::string &amp;<em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File7read_1dERK9DSET_ATTRRKN2H59DataSpaceERKN2H58DataTypeER12H5IODataTreeRKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">source</span></code>: The dataset or attribute to read. </li>
<li><code class="docutils literal"><span class="pre">data_space</span></code>: The space of the dataset or attribute. </li>
<li><code class="docutils literal"><span class="pre">memory_type</span></code>: The memory type to use when reading. </li>
<li><code class="docutils literal"><span class="pre">data</span></code>: The data tree to fill. </li>
<li><code class="docutils literal"><span class="pre">path</span></code>: The path within the data tree to fill. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File14read_1d_stringERK9DSET_ATTRRKN2H59DataSpaceERKN2H58DataTypeER12H5IODataTreeRKNSt6stringE">
<span id="IO::SubPixHDF5File::read_1d_string__DSET_ATTRCR.H5::DataSpaceCR.H5::DataTypeCR.H5IODataTreeR.ssCR"></span><em class="property">template </em>&lt;<em class="property">class</em> DSET_ATTR&gt;<br /><span class="target" id="classIO_1_1SubPixHDF5File_1a6c2c831384c7cdcb875d4845aaca6a5a"></span>void <code class="descname">read_1d_string</code><span class="sig-paren">(</span><em class="property">const</em> DSET_ATTR &amp;<em>source</em>, <em class="property">const</em> H5::DataSpace &amp;<em>data_space</em>, <em class="property">const</em> H5::DataType &amp;<em>memory_type</em>, <a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data</em>, <em class="property">const</em> std::string &amp;<em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File14read_1d_stringERK9DSET_ATTRRKN2H59DataSpaceERKN2H58DataTypeER12H5IODataTreeRKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">source</span></code>: The dataset or attribute to read. </li>
<li><code class="docutils literal"><span class="pre">data_space</span></code>: The space of the dataset or attribute. </li>
<li><code class="docutils literal"><span class="pre">memory_type</span></code>: The memory type to use when reading. </li>
<li><code class="docutils literal"><span class="pre">data</span></code>: The data tree to fill. </li>
<li><code class="docutils literal"><span class="pre">path</span></code>: The path within the data tree to fill. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File11read_scalarERK9DSET_ATTRR12H5IODataTreeRKNSt6stringE">
<span id="IO::SubPixHDF5File::read_scalar__DSET_ATTRCR.H5IODataTreeR.ssCR"></span><em class="property">template </em>&lt;<em class="property">class</em> DSET_ATTR&gt;<br /><span class="target" id="classIO_1_1SubPixHDF5File_1a3ec9739d701d457ff4d80dcbf6e41057"></span>bool <code class="descname">read_scalar</code><span class="sig-paren">(</span><em class="property">const</em> DSET_ATTR &amp;<em>source</em>, <a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data</em>, <em class="property">const</em> std::string &amp;<em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File11read_scalarERK9DSET_ATTRR12H5IODataTreeRKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reading a scalar 1d dataset or attribute (return false if not scalar). </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">source</span></code>: The dataset or attribute to read. </li>
<li><code class="docutils literal"><span class="pre">data</span></code>: The data tree to fill. </li>
<li><code class="docutils literal"><span class="pre">path</span></code>: The path within the data tree to fill. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File19read_pair_attributeERKN2H59AttributeER12H5IODataTreeRKNSt6stringE">
<span id="IO::SubPixHDF5File::read_pair_attribute__H5::AttributeCR.H5IODataTreeR.ssCR"></span><span class="target" id="classIO_1_1SubPixHDF5File_1a4f000f1a94dd8d914f522b8fedb46cc3"></span>void <code class="descname">read_pair_attribute</code><span class="sig-paren">(</span><em class="property">const</em> H5::Attribute &amp;<em>attribute</em>, <a class="reference internal" href="#_CPPv2N2IO12H5IODataTreeE" title="IO::H5IODataTree">H5IODataTree</a> &amp;<em>data</em>, <em class="property">const</em> std::string &amp;<em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File19read_pair_attributeERKN2H59AttributeER12H5IODataTreeRKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reads an attribute consisting of a pair of values. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">attribute</span></code>: The attribute to read. </li>
<li><code class="docutils literal"><span class="pre">data</span></code>: The data tree to fill </li>
<li><code class="docutils literal"><span class="pre">path</span></code>: The path within the data tree to fill. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Static Functions</p>
<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File13get_node_typeERKN5boost13property_tree5ptreeE">
<span id="IO::SubPixHDF5File::get_node_type__boost::property_tree::ptreeCR"></span><span class="target" id="classIO_1_1SubPixHDF5File_1a2e204c9ba9d9098ef2dad9248479ebe0"></span><a class="reference internal" href="#_CPPv2N2IO14SubPixHDF5FileE" title="IO::SubPixHDF5File">SubPixHDF5File</a>::__H5COMPONENT <code class="descname">get_node_type</code><span class="sig-paren">(</span><em class="property">const</em> boost::property_tree::ptree &amp;<em>node</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File13get_node_typeERKN5boost13property_tree5ptreeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The H5COMPONENT corresponding to a node in the HDF5 structure. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">node</span></code>: The node whose type we need. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N2IO14SubPixHDF5File10fill_pathsERN5boost13property_tree5ptreeERKNSt6stringEK13__H5COMPONENT">
<span id="IO::SubPixHDF5File::fill_paths__boost::property_tree::ptreeR.ssCR.__H5COMPONENTC"></span><span class="target" id="classIO_1_1SubPixHDF5File_1ab59c83a07b7f646cfc6cf97484f4e382"></span>void <code class="descname">fill_paths</code><span class="sig-paren">(</span>boost::property_tree::ptree &amp;<em>sub_structure</em> = __structure, <em class="property">const</em> std::string &amp;<em>parent_path</em> = &quot;/&quot;, <em class="property">const</em> <a class="reference internal" href="#_CPPv2N2IO13__H5COMPONENTE" title="IO::__H5COMPONENT">__H5COMPONENT</a> <em>parent_type</em> = GROUP<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File10fill_pathsERN5boost13property_tree5ptreeERKNSt6stringEK13__H5COMPONENT" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fills the __(dataset/property/link)_paths also fixed source id entry. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Static Attributes</p>
<dl class="member">
<dt id="_CPPv2N2IO14SubPixHDF5File15VARLEN_STR_TYPEE">
<span id="IO::SubPixHDF5File::VARLEN_STR_TYPE__H5::StrTypeC"></span><span class="target" id="classIO_1_1SubPixHDF5File_1a685a43a265d629098a57aef1eab4bf67"></span><em class="property">const</em> H5::StrType <code class="descname">VARLEN_STR_TYPE</code><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File15VARLEN_STR_TYPEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The type to use for storing variable length strings. </p>
<p>Examples of quantities needing this type include:<ul class="simple">
<li>named sources (not HAT-IDs).</li>
<li>PSF map variable names </li>
</ul>
</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO14SubPixHDF5File12__chunk_sizeE">
<span id="IO::SubPixHDF5File::__chunk_size__hsize_tC"></span><span class="target" id="classIO_1_1SubPixHDF5File_1a88390c6df5e4ee105ac8985b7077ea67"></span><em class="property">const</em> hsize_t <code class="descname">__chunk_size</code> =100<a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File12__chunk_sizeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The chunk size to use for chunked datasets. </p>
<p>All compressed datasets are chunked. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO14SubPixHDF5File11__structureE">
<span id="IO::SubPixHDF5File::__structure__boost::property_tree::ptree"></span><span class="target" id="classIO_1_1SubPixHDF5File_1a4cb9b02ac06e681929a5db96d54cfcbe"></span>boost::property_tree::ptree <code class="descname">__structure</code><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File11__structureE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The structure of the output file parsed on creation. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO14SubPixHDF5File15__dataset_pathsE">
<span id="IO::SubPixHDF5File::__dataset_paths__boost::property_tree::ptree"></span><span class="target" id="classIO_1_1SubPixHDF5File_1ad3ab54ff2c3bc994b924991aaba764e6"></span>boost::property_tree::ptree <code class="descname">__dataset_paths</code><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File15__dataset_pathsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The paths to the recognized datasets in __structure. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO14SubPixHDF5File17__attribute_pathsE">
<span id="IO::SubPixHDF5File::__attribute_paths__boost::property_tree::ptree"></span><span class="target" id="classIO_1_1SubPixHDF5File_1af1e8ec7f97821dc5f1d14908dd7ec273"></span>boost::property_tree::ptree <code class="descname">__attribute_paths</code><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File17__attribute_pathsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The paths to the recognized attributes. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N2IO14SubPixHDF5File12__link_pathsE">
<span id="IO::SubPixHDF5File::__link_paths__boost::property_tree::ptree"></span><span class="target" id="classIO_1_1SubPixHDF5File_1a1189258a5729e58a2191ee851aee72b7"></span>boost::property_tree::ptree <code class="descname">__link_paths</code><a class="headerlink" href="#_CPPv2N2IO14SubPixHDF5File12__link_pathsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The paths to the various links. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N2IO14TranslateToAnyE">
<span id="IO::TranslateToAny"></span><span class="target" id="classIO_1_1TranslateToAny"></span><em class="property">template </em>&lt;typename <em>DATA_TYPE</em>&gt;<br /><em class="property">class </em><code class="descname">TranslateToAny</code><a class="headerlink" href="#_CPPv2N2IO14TranslateToAnyE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;TranslateToAny.h&gt;</em><p>Translator that works with boost::any for use with boost property trees. </p>
<p>If a value to translate is passed by reference, it is copied (good for small values). If instead a pointer is passed, the pointer is stored, but when the value is recovered the pointer is derereferenced. This avoids copying the object, but means that the object must not be destroyed (by e.g. going out of scope) before it is used. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N2IO14TranslateToAny14TranslateToAnyEv">
<span id="IO::TranslateToAny::TranslateToAny"></span><span class="target" id="classIO_1_1TranslateToAny_1a24177ab3f5c6b61761f802bde5f22d56"></span><code class="descname">TranslateToAny</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N2IO14TranslateToAny14TranslateToAnyEv" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2NK2IO14TranslateToAny9get_valueERKN5boost3anyE">
<span id="IO::TranslateToAny::get_value__boost::anyCRC"></span><span class="target" id="classIO_1_1TranslateToAny_1a16db76797e4ed82bba5be831062ed235"></span><em class="property">const</em> DATA_TYPE &amp;<code class="descname">get_value</code><span class="sig-paren">(</span><em class="property">const</em> boost::any &amp;<em>value</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK2IO14TranslateToAny9get_valueERKN5boost3anyE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2NK2IO14TranslateToAny9put_valueERK9DATA_TYPE">
<span id="IO::TranslateToAny::put_value__DATA_TYPECRC"></span><span class="target" id="classIO_1_1TranslateToAny_1a3134764252d8ce09121c6032a4a8f18c"></span>boost::any <code class="descname">put_value</code><span class="sig-paren">(</span><em class="property">const</em> DATA_TYPE &amp;<em>value</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK2IO14TranslateToAny9put_valueERK9DATA_TYPE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2NK2IO14TranslateToAny9put_valueEPK9DATA_TYPE">
<span id="IO::TranslateToAny::put_value__DATA_TYPECPC"></span><span class="target" id="classIO_1_1TranslateToAny_1a1055ec16664306f10b8567ebabf30ddf"></span>boost::any <code class="descname">put_value</code><span class="sig-paren">(</span><em class="property">const</em> DATA_TYPE *<em>value</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK2IO14TranslateToAny9put_valueEPK9DATA_TYPE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="core">
<h2>Core<a class="headerlink" href="#core" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="_CPPv24Core">
<span id="Core"></span><span class="target" id="namespaceCore"></span><em class="property">namespace </em><code class="descname">Core</code><a class="headerlink" href="#_CPPv24Core" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Typedefs</p>
<dl class="type">
<dt id="_CPPv2N4Core16vector_size_typeE">
<span id="Core::vector_size_type"></span><span class="target" id="Core_2Typedefs_8h_1a285a47e008b3a371dddad36b58c18810"></span><em class="property">typedef </em>std::vector&lt;double&gt;::size_type <code class="descname">vector_size_type</code><a class="headerlink" href="#_CPPv2N4Core16vector_size_typeE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Alias for the type to use for size/index of double vectors. </p>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N4Core14IntImageMatrixE">
<span id="Core::IntImageMatrix"></span><span class="target" id="Core_2Typedefs_8h_1a3878af9caac1f5b7c5849c1dbd4bd065"></span><em class="property">typedef </em>Eigen::Matrix&lt;int, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; <code class="descname">IntImageMatrix</code><a class="headerlink" href="#_CPPv2N4Core14IntImageMatrixE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>An Eigen integer matrix suitable organized for saving as FITS image. </p>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N4Core17DoubleImageMatrixE">
<span id="Core::DoubleImageMatrix"></span><span class="target" id="Core_2Typedefs_8h_1a56150491fa2dd494b416141c5f793655"></span><em class="property">typedef </em>Eigen::Matrix&lt;double, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; <code class="descname">DoubleImageMatrix</code><a class="headerlink" href="#_CPPv2N4Core17DoubleImageMatrixE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>An Eigen double matrix suitable organized for saving as FITS image. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Enums</p>
<dl class="type">
<dt id="_CPPv2N4Core14PhotometryFlagE">
<span id="Core::PhotometryFlag"></span><span class="target" id="Core_2Typedefs_8h_1a0284392b810d69336f74bd704daa5de8"></span><em class="property">enum </em><code class="descname">PhotometryFlag</code><a class="headerlink" href="#_CPPv2N4Core14PhotometryFlagE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Flags for the quality of a photometric measurement. </p>
<p><em>Values:</em></p>
<dl class="enumerator">
<dt id="_CPPv2N4Core9UNDEFINEDE">
<span class="target" id="Core_2Typedefs_8h_1a0284392b810d69336f74bd704daa5de8a184de68a0931048cfddd7d14bcd01b3a"></span><code class="descname">UNDEFINED</code> =-1<a class="headerlink" href="#_CPPv2N4Core9UNDEFINEDE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N4Core4GOODE">
<span class="target" id="Core_2Typedefs_8h_1a0284392b810d69336f74bd704daa5de8ac45fe6ee2449f108749fdc87d80a2851"></span><code class="descname">GOOD</code><a class="headerlink" href="#_CPPv2N4Core4GOODE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N4Core9SATURATEDE">
<span class="target" id="Core_2Typedefs_8h_1a0284392b810d69336f74bd704daa5de8ad7c9cd36cbc2cb7a8d335f90eb474e49"></span><code class="descname">SATURATED</code><a class="headerlink" href="#_CPPv2N4Core9SATURATEDE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="enumerator">
<dt id="_CPPv2N4Core3BADE">
<span class="target" id="Core_2Typedefs_8h_1a0284392b810d69336f74bd704daa5de8a58c7c656ad590f681f096baf6c95b507"></span><code class="descname">BAD</code><a class="headerlink" href="#_CPPv2N4Core3BADE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Functions</p>
<dl class="function">
<dt id="_CPPv2N4Core8validateERN5boost3anyERKNSt6vectorINSt6stringEEEP8RealListi">
<span id="Core::validate__boost::anyR.std::vector:ss:CR.RealListP.i"></span><span class="target" id="Core_2CommandLineUtil_8cpp_1a48a055b31247860b6d0e78d401820455"></span>void <code class="descname">validate</code><span class="sig-paren">(</span>boost::any &amp;<em>value</em>, <em class="property">const</em> std::vector&lt;std::string&gt; &amp;<em>option_strings</em>, <a class="reference internal" href="#_CPPv2N4Core8RealListE" title="Core::RealList">RealList</a> *, int<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core8validateERN5boost3anyERKNSt6vectorINSt6stringEEEP8RealListi" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Parse a commas separated list of real values to <a class="reference internal" href="#classCore_1_1RealList"><span class="std std-ref">RealList</span></a>. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">value</span></code>: The value to parse into. </li>
<li><code class="docutils literal"><span class="pre">option_strings</span></code>: The strings passed to this option on the command line. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core8validateERN5boost3anyERKNSt6vectorINSt6stringEEEP10StringListi">
<span id="Core::validate__boost::anyR.std::vector:ss:CR.StringListP.i"></span><span class="target" id="Core_2CommandLineUtil_8cpp_1a250e51dc4b6cdc300a2b29496e8fe74c"></span>void <code class="descname">validate</code><span class="sig-paren">(</span>boost::any &amp;<em>value</em>, <em class="property">const</em> std::vector&lt;std::string&gt; &amp;<em>option_strings</em>, <a class="reference internal" href="#_CPPv2N4Core10StringListE" title="Core::StringList">StringList</a> *, int<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core8validateERN5boost3anyERKNSt6vectorINSt6stringEEEP10StringListi" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Parse a commas separated list of strings to <a class="reference internal" href="#classCore_1_1StringList"><span class="std std-ref">StringList</span></a>. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">value</span></code>: The value to parse into. </li>
<li><code class="docutils literal"><span class="pre">option_strings</span></code>: The strings passed to this option on the command line. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core8validateERN5boost3anyERKNSt6vectorINSt6stringEEEP10ColumnListi">
<span id="Core::validate__boost::anyR.std::vector:ss:CR.ColumnListP.i"></span><span class="target" id="Core_2CommandLineUtil_8cpp_1a8bcfd2608798c70718955ea91d44d9d1"></span>void <code class="descname">validate</code><span class="sig-paren">(</span>boost::any &amp;<em>value</em>, <em class="property">const</em> std::vector&lt;std::string&gt; &amp;<em>option_strings</em>, <a class="reference internal" href="#_CPPv2N4Core10ColumnListE" title="Core::ColumnList">ColumnList</a> *, int<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core8validateERN5boost3anyERKNSt6vectorINSt6stringEEEP10ColumnListi" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Parse a list of column names option. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">value</span></code>: The value to parse into. </li>
<li><code class="docutils literal"><span class="pre">option_strings</span></code>: The strings passed to this option on the command line. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core26silence_unused_nan_warningEd">
<span id="Core::silence_unused_nan_warning__double"></span><span class="target" id="NaN_8h_1aba210da3210c5b2973110d458b6bc855"></span>void <code class="descname">silence_unused_nan_warning</code><span class="sig-paren">(</span>double = NaN<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core26silence_unused_nan_warningEd" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core26silence_unused_inf_warningEd">
<span id="Core::silence_unused_inf_warning__double"></span><span class="target" id="NaN_8h_1a3b6c5d20491f5994838ae1e66264b059"></span>void <code class="descname">silence_unused_inf_warning</code><span class="sig-paren">(</span>double = Inf<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core26silence_unused_inf_warningEd" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core14replicate_lastER9ITER_TYPEjRNSt4listI8VAL_TYPEEE">
<span id="Core::replicate_last__ITER_TYPER.unsigned.std::list:VAL_TYPE:R"></span><em class="property">template </em>&lt;<em class="property">class</em> ITER_TYPE, <em class="property">class</em> VAL_TYPE&gt;<br /><span class="target" id="ParseCSV_8cpp_1ab37ad041e1eab2b71b9f3001ce65965b"></span>void <code class="descname">replicate_last</code><span class="sig-paren">(</span>ITER_TYPE &amp;<em>start_replicate</em>, unsigned <em>copies</em>, std::list&lt;VAL_TYPE&gt; &amp;<em>target</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core14replicate_lastER9ITER_TYPEjRNSt4listI8VAL_TYPEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Extends a list with a number of copies of its last elements. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">start_replicate</span></code>: All elements after this one (including this one) are replicated. </li>
<li><code class="docutils literal"><span class="pre">copies</span></code>: The number of copies to make. </li>
<li><code class="docutils literal"><span class="pre">target</span></code>: The list this operation is performed on. </li>
</ul>
</dd>
</dl>
</p>
<p>Because the output contains columns of quantities that are aperture dependent (as well as some that are not), it is necessary to create multiple copies of the column identifiers that need to have one column per aperture. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core15parse_real_listERKNSt6stringERKNSt6stringEjj">
<span id="Core::parse_real_list__ssCR.ssCR.unsigned.unsigned"></span><span class="target" id="ParseCSV_8cpp_1ab2d446765e968541185c96f67e808a49"></span><a class="reference internal" href="#_CPPv2N4Core8RealListE" title="Core::RealList">RealList</a> <code class="descname">parse_real_list</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>csv</em>, <em class="property">const</em> std::string &amp;<em>optname</em>, unsigned <em>min_count</em>, unsigned <em>max_count</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core15parse_real_listERKNSt6stringERKNSt6stringEjj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Parses a string of comma separated real values into a list. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">csv</span></code>: The list to parse </li>
<li><code class="docutils literal"><span class="pre">optname</span></code>: The name of the option (only used for error message) </li>
<li><code class="docutils literal"><span class="pre">min_count</span></code>: Minimum required number of values (exception thrown if not met). </li>
<li><code class="docutils literal"><span class="pre">max_count</span></code>: Maximum required number of values (exception thrown if exceeded). </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core14parse_int_listERKNSt6stringERKNSt6stringEjj">
<span id="Core::parse_int_list__ssCR.ssCR.unsigned.unsigned"></span><span class="target" id="ParseCSV_8cpp_1a9b72ac36292e4841ce988699f7e8c487"></span>std::list&lt;int&gt; <code class="descname">parse_int_list</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>csv</em>, <em class="property">const</em> std::string &amp;<em>optname</em>, unsigned <em>min_count</em>, unsigned <em>max_count</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core14parse_int_listERKNSt6stringERKNSt6stringEjj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Pareses a string of comma separated integer values into a list. </p>
<p>See <a class="reference internal" href="#ParseCSV_8cpp_1ab2d446765e968541185c96f67e808a49"><span class="std std-ref">parse_real_list()</span></a> for a description of the arguments. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core17parse_column_listERKNSt6stringEjRKNSt6stringEb">
<span id="Core::parse_column_list__ssCR.unsigned.ssCR.b"></span><span class="target" id="ParseCSV_8cpp_1a4b2a76a808bad9506546105b31b8d29c"></span><a class="reference internal" href="#_CPPv2N4Core10ColumnListE" title="Core::ColumnList">ColumnList</a> <code class="descname">parse_column_list</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>csv</em>, unsigned <em>num_apertures</em>, <em class="property">const</em> std::string &amp;<em>optname</em>, bool <em>allow_unknown</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core17parse_column_listERKNSt6stringEjRKNSt6stringEb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Parses a string of comma separated column names into a list, replicating per-aperture columns appropriately. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">csv</span></code>: The string to parse. </li>
<li><code class="docutils literal"><span class="pre">num_apertures</span></code>: How many copies of per-aperture columns to make. </li>
<li><code class="docutils literal"><span class="pre">optname</span></code>: The name of the option being parsed (only used for error message). </li>
<li><code class="docutils literal"><span class="pre">allow_unknown</span></code>: Instead of throwing an exception assign Phot::unknown to any unrecognized column name. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core17parse_string_listERKNSt6stringERKNSt6stringEjj">
<span id="Core::parse_string_list__ssCR.ssCR.unsigned.unsigned"></span><span class="target" id="ParseCSV_8cpp_1a88c6e051fe01409dd4545e3c129edd0c"></span><a class="reference internal" href="#_CPPv2N4Core10StringListE" title="Core::StringList">StringList</a> <code class="descname">parse_string_list</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>csv</em>, <em class="property">const</em> std::string &amp;<em>optname</em>, unsigned <em>min_count</em>, unsigned <em>max_count</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core17parse_string_listERKNSt6stringERKNSt6stringEjj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Parses a string of comma separated sub-strings into a list. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">csv</span></code>: The list to parse. </li>
<li><code class="docutils literal"><span class="pre">optname</span></code>: The name of the option (only used for error message) </li>
<li><code class="docutils literal"><span class="pre">min_count</span></code>: Minimum required number of values (exception thrown if not met). </li>
<li><code class="docutils literal"><span class="pre">max_count</span></code>: Maximum required number of values (exception thrown if exceeded). </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core14parse_csv_listERKNSt6stringERKNSt6stringEjjRNSt4listI8VAL_TYPEEE">
<span id="Core::parse_csv_list__ssCR.ssCR.unsigned.unsigned.std::list:VAL_TYPE:R"></span><em class="property">template </em>&lt;<em class="property">class</em> VAL_TYPE&gt;<br /><span class="target" id="ParseCSV_8h_1af66f57df1f598b5c2123641090958a45"></span>void <code class="descname">parse_csv_list</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>csv</em>, <em class="property">const</em> std::string &amp;<em>optname</em>, unsigned <em>min_count</em>, unsigned <em>max_count</em>, std::list&lt;VAL_TYPE&gt; &amp;<em>result</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core14parse_csv_listERKNSt6stringERKNSt6stringEjjRNSt4listI8VAL_TYPEEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Perses a string of comma separated values into a list. </p>
<p>See <a class="reference internal" href="#ParseCSV_8cpp_1ab2d446765e968541185c96f67e808a49"><span class="std std-ref">parse_real_list()</span></a> for a description of the arguments. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core9is_digitsEPKc">
<span id="Core::is_digits__cCP"></span><span class="target" id="SourceID_8cpp_1a01a491d3d298c7b9c89f7b55b37f7f04"></span><em class="property">static</em> bool <code class="descname">is_digits</code><span class="sig-paren">(</span><em class="property">const</em> char *<em>str</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core9is_digitsEPKc" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv2N4CorersERNSt7istreamER8SourceID">
<span id="Core::rshift-operator__isR.SourceIDR"></span><span class="target" id="SourceID_8cpp_1a9f678579fc37dfe9b6fb2141a2169a8c"></span>std::istream &amp;<code class="descname">operator&gt;&gt;</code><span class="sig-paren">(</span>std::istream &amp;<em>is</em>, <a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> &amp;<em>id</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4CorersERNSt7istreamER8SourceID" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Read the ID from the given stream. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">is</span></code>: The stream to read from. </li>
<li><code class="docutils literal"><span class="pre">id</span></code>: The variable to set to the parsed ID. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4CorelsERNSt7ostreamERK8SourceID">
<span id="Core::lshift-operator__osR.SourceIDCR"></span><span class="target" id="SourceID_8cpp_1a3642c1819b4066531f46c1698ed104fb"></span>std::ostream &amp;<code class="descname">operator&lt;&lt;</code><span class="sig-paren">(</span>std::ostream &amp;<em>os</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> &amp;<em>id</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4CorelsERNSt7ostreamERK8SourceID" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Output the ID to the given stream. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">os</span></code>: The stream to write to. </li>
<li><code class="docutils literal"><span class="pre">id</span></code>: The source ID to write. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core20apply_subpix_scalingERKN5Eigen10MatrixBaseI9EIGEN_TP1EERKN5Eigen10MatrixBaseI9EIGEN_TP2EE">
<span id="Core::apply_subpix_scaling__Eigen::MatrixBase:EIGEN_TP1:CR.Eigen::MatrixBase:EIGEN_TP2:CR"></span><em class="property">template </em>&lt;<em class="property">typename</em> EIGEN_TP1, <em class="property">typename</em> EIGEN_TP2&gt;<br /><span class="target" id="SubPixelCorrectedFlux_8h_1afbd631a693be987d7bf0323d9b6e2abc"></span>double <code class="descname">apply_subpix_scaling</code><span class="sig-paren">(</span><em class="property">const</em> Eigen::MatrixBase&lt;EIGEN_TP1&gt; &amp;<em>scaling</em>, <em class="property">const</em> Eigen::MatrixBase&lt;EIGEN_TP2&gt; &amp;<em>subpix_map</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core20apply_subpix_scalingERKN5Eigen10MatrixBaseI9EIGEN_TP1EERKN5Eigen10MatrixBaseI9EIGEN_TP2EE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Apply a previously derived sub-pixel independent scaling to calculate the source flux corrected with the given sub-pixel sensitivity map. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">scaling</span></code>: A matrix giving the sub-pixel independent scaling. </li>
<li><code class="docutils literal"><span class="pre">subpix_map</span></code>: The sub-pixel sensitivity map. The x sub-pixel index changes faster going down the vector. </li>
</ul>
</dd>
</dl>
</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>The sub-pixel sensitivity corrected flux. </dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core20apply_subpix_scalingERKN5Eigen10MatrixBaseI8EIGEN_TPEERKN4Core11SubPixelMapE">
<span id="Core::apply_subpix_scaling__Eigen::MatrixBase:EIGEN_TP:CR.Core::SubPixelMapCR"></span><em class="property">template </em>&lt;<em class="property">typename</em> EIGEN_TP&gt;<br /><span class="target" id="SubPixelCorrectedFlux_8h_1a9844b66128140af62912c112e9a54a80"></span>double <code class="descname">apply_subpix_scaling</code><span class="sig-paren">(</span><em class="property">const</em> Eigen::MatrixBase&lt;EIGEN_TP&gt; &amp;<em>scaling</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> &amp;<em>subpix_map</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core20apply_subpix_scalingERKN5Eigen10MatrixBaseI8EIGEN_TPEERKN4Core11SubPixelMapE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See the two template version of <a class="reference internal" href="#SubPixelCorrectedFlux_8h_1a9844b66128140af62912c112e9a54a80"><span class="std std-ref">apply_subpix_scaling()</span></a> for details. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Variables</p>
<dl class="member">
<dt id="_CPPv2N4Core7MASK_OKE">
<span id="Core::MASK_OK__cC"></span><span class="target" id="Core_2Image_8h_1a6bc14782c12c6470864f739a30240dca"></span><em class="property">const</em> char <code class="descname">MASK_OK</code> = 0x00<a class="headerlink" href="#_CPPv2N4Core7MASK_OKE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See Core::MASK_OK. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core10MASK_CLEARE">
<span id="Core::MASK_CLEAR__cC"></span><span class="target" id="Core_2Image_8h_1a93dadf74489c43d7f1ab84259628fa7c"></span><em class="property">const</em> char <code class="descname">MASK_CLEAR</code> = <a class="reference internal" href="c_api.html#IO_2CInterface_8h_1a14c0f248e71bbb781656070d2bba98ad"><span class="std std-ref">MASK_OK</span></a><a class="headerlink" href="#_CPPv2N4Core10MASK_CLEARE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See Core::MASK_CLEAR. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core10MASK_FAULTE">
<span id="Core::MASK_FAULT__cC"></span><span class="target" id="Core_2Image_8h_1acc6ba045891821b973a3a4e0716ad5e2"></span><em class="property">const</em> char <code class="descname">MASK_FAULT</code> = 0x01<a class="headerlink" href="#_CPPv2N4Core10MASK_FAULTE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See Core::MASK_FAULT. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core8MASK_HOTE">
<span id="Core::MASK_HOT__cC"></span><span class="target" id="Core_2Image_8h_1a320b59d0dd25b61e9605c1748e75499f"></span><em class="property">const</em> char <code class="descname">MASK_HOT</code> = 0x02<a class="headerlink" href="#_CPPv2N4Core8MASK_HOTE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See Core::MASK_HOT. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core11MASK_COSMICE">
<span id="Core::MASK_COSMIC__cC"></span><span class="target" id="Core_2Image_8h_1a18d0fdb0bcb94252ee0750ce753aef0e"></span><em class="property">const</em> char <code class="descname">MASK_COSMIC</code> = 0x04<a class="headerlink" href="#_CPPv2N4Core11MASK_COSMICE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See Core::MASK_COSMIC. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core10MASK_OUTERE">
<span id="Core::MASK_OUTER__cC"></span><span class="target" id="Core_2Image_8h_1aa2d7830f97360de9cff36ab9723f580e"></span><em class="property">const</em> char <code class="descname">MASK_OUTER</code> = 0x08<a class="headerlink" href="#_CPPv2N4Core10MASK_OUTERE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See Core::MASK_OUTER. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core18MASK_OVERSATURATEDE">
<span id="Core::MASK_OVERSATURATED__cC"></span><span class="target" id="Core_2Image_8h_1a38928da8840c931c079bde04d22c9160"></span><em class="property">const</em> char <code class="descname">MASK_OVERSATURATED</code> = 0x10<a class="headerlink" href="#_CPPv2N4Core18MASK_OVERSATURATEDE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See Core::MASK_OVERSATURATED. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core11MASK_LEAKEDE">
<span id="Core::MASK_LEAKED__cC"></span><span class="target" id="Core_2Image_8h_1a04035282d0441a8f41a0070cfb8d377e"></span><em class="property">const</em> char <code class="descname">MASK_LEAKED</code> = 0x20<a class="headerlink" href="#_CPPv2N4Core11MASK_LEAKEDE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See Core::MASK_LEAKED. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core14MASK_SATURATEDE">
<span id="Core::MASK_SATURATED__cC"></span><span class="target" id="Core_2Image_8h_1a40cafcbb34aa8573b4215cc9f6c8e019"></span><em class="property">const</em> char <code class="descname">MASK_SATURATED</code> = (<a class="reference internal" href="c_api.html#IO_2CInterface_8h_1a93cb32ad0325e55f03e0aa0c4c7a2697"><span class="std std-ref">MASK_OVERSATURATED</span></a>|<a class="reference internal" href="c_api.html#IO_2CInterface_8h_1a433b9ead55a8db78ae2b94248cbf2b51"><span class="std std-ref">MASK_LEAKED</span></a>)<a class="headerlink" href="#_CPPv2N4Core14MASK_SATURATEDE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See Core::MASK_SATURATED. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core17MASK_INTERPOLATEDE">
<span id="Core::MASK_INTERPOLATED__cC"></span><span class="target" id="Core_2Image_8h_1a4157a7ee6216a8ae5a2fb4bfa6e7fc10"></span><em class="property">const</em> char <code class="descname">MASK_INTERPOLATED</code> = 0x40<a class="headerlink" href="#_CPPv2N4Core17MASK_INTERPOLATEDE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See Core::MASK_INTERPOLATED. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core8MASK_BADE">
<span id="Core::MASK_BAD__cC"></span><span class="target" id="Core_2Image_8h_1a671cfc374d06ece3b4247ee4ebc46d63"></span><em class="property">const</em> char <code class="descname">MASK_BAD</code> = 0x7F<a class="headerlink" href="#_CPPv2N4Core8MASK_BADE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See Core::MASK_BAD. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core8MASK_ALLE">
<span id="Core::MASK_ALL__cC"></span><span class="target" id="Core_2Image_8h_1ab05b547deb0faebc5de0ef4dc626b74c"></span><em class="property">const</em> char <code class="descname">MASK_ALL</code> = <a class="reference internal" href="c_api.html#IO_2CInterface_8h_1a246b9d10513e441bd7554292da690ef6"><span class="std std-ref">MASK_BAD</span></a><a class="headerlink" href="#_CPPv2N4Core8MASK_ALLE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See Core::MASK_ALL. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core8MASK_NANE">
<span id="Core::MASK_NAN__cC"></span><span class="target" id="Core_2Image_8h_1ac46e866856e84437475269e2fe56b61f"></span><em class="property">const</em> char <code class="descname">MASK_NAN</code> = <a class="reference internal" href="c_api.html#IO_2CInterface_8h_1a723d3acde94006c66690f1ad61b15300"><span class="std std-ref">MASK_FAULT</span></a><a class="headerlink" href="#_CPPv2N4Core8MASK_NANE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See Core::MASK_NAN. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core3NaNE">
<span id="Core::NaN__doubleC"></span><span class="target" id="NaN_8h_1a5074e38fbccbd4067c3f16bd62b4d648"></span><em class="property">const</em> double <code class="descname">NaN</code> = std::numeric_limits&lt;double&gt;::quiet_NaN()<a class="headerlink" href="#_CPPv2N4Core3NaNE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Not-a-number. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core3InfE">
<span id="Core::Inf__doubleC"></span><span class="target" id="NaN_8h_1a3493861442e085ee2c913c13bf52a44a"></span><em class="property">const</em> double <code class="descname">Inf</code> = std::numeric_limits&lt;double&gt;::infinity()<a class="headerlink" href="#_CPPv2N4Core3InfE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Positive infinity. </p>
</dd></dl>

</div>
<dl class="class">
<dt id="_CPPv2N4Core10ColumnListE">
<span id="Core::ColumnList"></span><span class="target" id="classCore_1_1ColumnList"></span><em class="property">class </em><code class="descname">ColumnList</code> : <em class="property">public</em> std::list&lt;Phot::Columns&gt;<a class="headerlink" href="#_CPPv2N4Core10ColumnListE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;Typedefs.h&gt;</em><p>Synonim for list of column names (needed for boost command line parsing). </p>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N4Core4FluxE">
<span id="Core::Flux"></span><span class="target" id="classCore_1_1Flux"></span><em class="property">class </em><code class="descname">Flux</code><a class="headerlink" href="#_CPPv2N4Core4FluxE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;Flux.h&gt;</em><p>A class representing the flux measurement for a source, including an error estimate and a flag. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N4Core4Flux4FluxEddN4Core14PhotometryFlagE">
<span id="Core::Flux::Flux__double.double.Core::PhotometryFlag"></span><span class="target" id="classCore_1_1Flux_1a34e3cccf5b063172b0b01ff42a143d74"></span><code class="descname">Flux</code><span class="sig-paren">(</span>double <em>value</em> = NaN, double <em>error</em> = NaN, <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core14PhotometryFlagE" title="Core::PhotometryFlag">PhotometryFlag</a> <em>flag</em> = UNDEFINED<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core4Flux4FluxEddN4Core14PhotometryFlagE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a flux with the given properties. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">value</span></code>: The flux value </li>
<li><code class="docutils literal"><span class="pre">error</span></code>: Error estimate for the flux value. </li>
<li><code class="docutils literal"><span class="pre">flag</span></code>: Quality flag indicating the relaibility of the flux measurement. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core4Flux5valueEv">
<span id="Core::Flux::valueC"></span><span class="target" id="classCore_1_1Flux_1a82d869f1f6e251a06202cb61e8b5dd0e"></span>double <code class="descname">value</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core4Flux5valueEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The estimate of the flux (immutable). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core4Flux5valueEv">
<span id="Core::Flux::value"></span><span class="target" id="classCore_1_1Flux_1a78ab11b09ba4096bb374f8dc54328612"></span>double &amp;<code class="descname">value</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core4Flux5valueEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The estimate of the flux (mutable). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core4Flux5errorEv">
<span id="Core::Flux::errorC"></span><span class="target" id="classCore_1_1Flux_1a8b13f4dc615d1fbda903cca1c37d2a12"></span>double <code class="descname">error</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core4Flux5errorEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>An estimate of the error (immutable). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core4Flux5errorEv">
<span id="Core::Flux::error"></span><span class="target" id="classCore_1_1Flux_1a2bff276ff3a547cc77cb2a28464103be"></span>double &amp;<code class="descname">error</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core4Flux5errorEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>An estimate of the error (mutable). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core4Flux4flagEv">
<span id="Core::Flux::flagC"></span><span class="target" id="classCore_1_1Flux_1a6fcfeb0fda9b1f9f9bd327043937b721"></span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core14PhotometryFlagE" title="Core::PhotometryFlag">PhotometryFlag</a> <code class="descname">flag</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core4Flux4flagEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The quality flag (immutable) </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core4Flux4flagEv">
<span id="Core::Flux::flag"></span><span class="target" id="classCore_1_1Flux_1a2562517d5a5ee27a0445a9a28aa88806"></span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core14PhotometryFlagE" title="Core::PhotometryFlag">PhotometryFlag</a> &amp;<code class="descname">flag</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core4Flux4flagEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The quality flag (mutable) </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N4Core4Flux7__valueE">
<span id="Core::Flux::__value__double"></span><span class="target" id="classCore_1_1Flux_1a59ccb7eadf04ba7fb67d8cb329be8fec"></span>double <code class="descname">__value</code><a class="headerlink" href="#_CPPv2N4Core4Flux7__valueE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classCore_1_1Flux_1a78ab11b09ba4096bb374f8dc54328612"><span class="std std-ref">value()</span></a> </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core4Flux7__errorE">
<span id="Core::Flux::__error__double"></span><span class="target" id="classCore_1_1Flux_1a24cfd0f53abd5b4960c42e820dc0c8e5"></span>double <code class="descname">__error</code><a class="headerlink" href="#_CPPv2N4Core4Flux7__errorE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classCore_1_1Flux_1a2bff276ff3a547cc77cb2a28464103be"><span class="std std-ref">error()</span></a> </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core4Flux6__flagE">
<span id="Core::Flux::__flag__Core::PhotometryFlag"></span><span class="target" id="classCore_1_1Flux_1a119c18378bf22a5601b2207da1e147d7"></span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core14PhotometryFlagE" title="Core::PhotometryFlag">PhotometryFlag</a> <code class="descname">__flag</code><a class="headerlink" href="#_CPPv2N4Core4Flux6__flagE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classCore_1_1Flux_1a2562517d5a5ee27a0445a9a28aa88806"><span class="std std-ref">flag()</span></a> </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N4Core8FluxPairE">
<span id="Core::FluxPair"></span><span class="target" id="classCore_1_1FluxPair"></span><em class="property">class </em><code class="descname">FluxPair</code><a class="headerlink" href="#_CPPv2N4Core8FluxPairE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;FluxPair.h&gt;</em><p>A class with two flux components corresponding to the flux corrected for subpixel sensitivity variations and partially being within the aperture and the full flux over a pixel from the assumed PSF. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N4Core8FluxPair8FluxPairEdd">
<span id="Core::FluxPair::FluxPair__double.double"></span><span class="target" id="classCore_1_1FluxPair_1a3a4e078eed237e4dc0779cc5b52a0d48"></span><code class="descname">FluxPair</code><span class="sig-paren">(</span>double <em>raw</em> = 0, double <em>weighted</em> = 0<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core8FluxPair8FluxPairEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a pair with the given weigthed and unweigthed fluxes. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">raw</span></code>: See <a class="reference internal" href="#classCore_1_1FluxPair_1a43ce650b6f565fa9e137dad986fcfe6f"><span class="std std-ref">raw_flux()</span></a> </li>
<li><code class="docutils literal"><span class="pre">weighted</span></code>: See <a class="reference internal" href="#classCore_1_1FluxPair_1a0164c262adeea6fec097d572d38071f6"><span class="std std-ref">weighted_flux()</span></a> </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core8FluxPair8raw_fluxEv">
<span id="Core::FluxPair::raw_fluxC"></span><span class="target" id="classCore_1_1FluxPair_1a65283fb816de964909e93e960f201c26"></span>double <code class="descname">raw_flux</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core8FluxPair8raw_fluxEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A simple integral of the PSF over the area of a 1x1 pixel. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core8FluxPair8raw_fluxEv">
<span id="Core::FluxPair::raw_flux"></span><span class="target" id="classCore_1_1FluxPair_1a43ce650b6f565fa9e137dad986fcfe6f"></span>double &amp;<code class="descname">raw_flux</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core8FluxPair8raw_fluxEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A simple integral of the PSF over the area of a 1x1 pixel. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core8FluxPair13weighted_fluxEv">
<span id="Core::FluxPair::weighted_fluxC"></span><span class="target" id="classCore_1_1FluxPair_1a931a9b7ad9635ab40f1272205e03f502"></span>double <code class="descname">weighted_flux</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core8FluxPair13weighted_fluxEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>An of the subpixel sensitivity times the PSF over the part of the pixel that fits within the aperture. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core8FluxPair13weighted_fluxEv">
<span id="Core::FluxPair::weighted_flux"></span><span class="target" id="classCore_1_1FluxPair_1a0164c262adeea6fec097d572d38071f6"></span>double &amp;<code class="descname">weighted_flux</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core8FluxPair13weighted_fluxEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>An of the subpixel sensitivity times the PSF over the part of the pixel that fits within the aperture. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N4Core8FluxPair10__raw_fluxE">
<span id="Core::FluxPair::__raw_flux__double"></span><span class="target" id="classCore_1_1FluxPair_1ad906d877f22aa31744b9f1081fc7a290"></span>double <code class="descname">__raw_flux</code><a class="headerlink" href="#_CPPv2N4Core8FluxPair10__raw_fluxE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classCore_1_1FluxPair_1a43ce650b6f565fa9e137dad986fcfe6f"><span class="std std-ref">raw_flux()</span></a> </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core8FluxPair15__weighted_fluxE">
<span id="Core::FluxPair::__weighted_flux__double"></span><span class="target" id="classCore_1_1FluxPair_1abea6ba9afce48320308ebbdba1ea9590"></span>double <code class="descname">__weighted_flux</code><a class="headerlink" href="#_CPPv2N4Core8FluxPair15__weighted_fluxE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classCore_1_1FluxPair_1a0164c262adeea6fec097d572d38071f6"><span class="std std-ref">weighted_flux()</span></a> </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N4Core5ImageE">
<span id="Core::Image"></span><span class="target" id="classCore_1_1Image"></span><em class="property">template </em>&lt;typename <em>DATA_TYPE</em>&gt;<br /><em class="property">class </em><code class="descname">Image</code><a class="headerlink" href="#_CPPv2N4Core5ImageE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;Image.h&gt;</em><p>Declare the minimum functionality expected from input images. </p>
<p>Subclassed by <a class="reference internal" href="#classIO_1_1FitsImage"><span class="std std-ref">IO::FitsImage&lt; DATA_TYPE &gt;</span></a></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N4Core5Image5ImageEPK9DATA_TYPEPKcmmPK9DATA_TYPE">
<span id="Core::Image::Image__DATA_TYPECP.cCP.unsigned-l.unsigned-l.DATA_TYPECP"></span><span class="target" id="classCore_1_1Image_1accfbec37ae4145ece188e7794903699f"></span><code class="descname">Image</code><span class="sig-paren">(</span><em class="property">const</em> DATA_TYPE *<em>values</em> = NULL, <em class="property">const</em> char *<em>mask</em> = NULL, unsigned long <em>x_resolution</em> = 0, unsigned long <em>y_resolution</em> = 0, <em class="property">const</em> DATA_TYPE *<em>errors</em> = NULL<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core5Image5ImageEPK9DATA_TYPEPKcmmPK9DATA_TYPE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classCore_1_1Image_1ab194fb6343c2f28589990ee49a0122ce"><span class="std std-ref">init_from_copy()</span></a>. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">values</span></code>: The pixel values in the image. The x coordinate changes faster than the y with successive entries. The image uses </li>
<li><code class="docutils literal"><span class="pre">mask</span></code>: Quality flags for the image pixels in the same order as values. See comments for values argument. </li>
<li><code class="docutils literal"><span class="pre">x_resolution</span></code>: The number of pixels along the x direction in the image. </li>
<li><code class="docutils literal"><span class="pre">y_resolution</span></code>: The number of pixels along the y direction in the image. </li>
<li><code class="docutils literal"><span class="pre">errors</span></code>: Error estimates for the image pixels. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core5Image5ImageERK5ImageI9DATA_TYPEE">
<span id="Core::Image::Image__Image:DATA_TYPE:CR"></span><span class="target" id="classCore_1_1Image_1a0dbe098fc7d307021df25872e269b8ea"></span><code class="descname">Image</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N4Core5Image5ImageEPK9DATA_TYPEPKcmmPK9DATA_TYPE" title="Core::Image::Image">Image</a>&lt;DATA_TYPE&gt; &amp;<em>image</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core5Image5ImageERK5ImageI9DATA_TYPEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a new image containing a copy of the data of the given image. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">image</span></code>: The image to copy. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core5Image14init_from_copyEPK9DATA_TYPEPKcmmPK9DATA_TYPE">
<span id="Core::Image::init_from_copy__DATA_TYPECP.cCP.unsigned-l.unsigned-l.DATA_TYPECP"></span><span class="target" id="classCore_1_1Image_1ab194fb6343c2f28589990ee49a0122ce"></span>void <code class="descname">init_from_copy</code><span class="sig-paren">(</span><em class="property">const</em> DATA_TYPE *<em>orig_values</em>, <em class="property">const</em> char *<em>orig_mask</em>, unsigned long <em>orig_x_resolution</em>, unsigned long <em>orig_y_resolution</em>, <em class="property">const</em> DATA_TYPE *<em>orig_errors</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core5Image14init_from_copyEPK9DATA_TYPEPKcmmPK9DATA_TYPE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Initialize this image with a copy of the given data. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">orig_values</span></code>: The pixel values in the image. The x coordinate changes faster than the y with successive entries. The image uses </li>
<li><code class="docutils literal"><span class="pre">orig_mask</span></code>: Quality flags for the image pixels in the same order as values. See comments for values argument. If no bad pixel </li>
<li><code class="docutils literal"><span class="pre">orig_x_resolution</span></code>: The number of pixels along the x direction in the image. </li>
<li><code class="docutils literal"><span class="pre">orig_y_resolution</span></code>: The number of pixels along the y direction in the image. </li>
<li><code class="docutils literal"><span class="pre">orig_errors</span></code>: The error estimates. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core5Image4wrapEP9DATA_TYPEPcmmP9DATA_TYPE">
<span id="Core::Image::wrap__DATA_TYPEP.cP.unsigned-l.unsigned-l.DATA_TYPEP"></span><span class="target" id="classCore_1_1Image_1ab64230c162fcfa9e6aa79e83d78743a3"></span><em class="property">virtual</em> void <code class="descname">wrap</code><span class="sig-paren">(</span>DATA_TYPE *<em>values</em>, char *<em>mask</em>, unsigned long <em>x_resolution</em>, unsigned long <em>y_resolution</em>, DATA_TYPE *<em>errors</em> = NULL<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core5Image4wrapEP9DATA_TYPEPcmmP9DATA_TYPE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Wrap the given data in an image. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">values</span></code>: The pixel values in the image. The x coordinate changes faster than the y with successive entries. The data is used directly rather than copying, so it must not be destroyed while this object is still in use and my be modified through this object. To force copying the data, use the constructor with const arguments. </li>
<li><code class="docutils literal"><span class="pre">mask</span></code>: Quality flags for the image pixels in the same order as values. See comments for values argument. </li>
<li><code class="docutils literal"><span class="pre">x_resolution</span></code>: The number of pixels along the x direction in the image. </li>
<li><code class="docutils literal"><span class="pre">y_resolution</span></code>: The number of pixels along the y direction in the image. </li>
<li><code class="docutils literal"><span class="pre">errors</span></code>: Error estimates of the entries in values. If NULL, any query to the error results in an exception. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core5Image4wrapER5ImageI9DATA_TYPEE">
<span id="Core::Image::wrap__Image:DATA_TYPE:R"></span><span class="target" id="classCore_1_1Image_1a108be01ba065fb269491cafd50e7da56"></span><em class="property">virtual</em> void <code class="descname">wrap</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv2N4Core5ImageE" title="Core::Image">Image</a>&lt;DATA_TYPE&gt; &amp;<em>image</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core5Image4wrapER5ImageI9DATA_TYPEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Make this image an alias of the input image. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">image</span></code>: The image to wrap </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core5Image10has_errorsEv">
<span id="Core::Image::has_errorsC"></span><span class="target" id="classCore_1_1Image_1aee21d5ebd7fbbe44065f3aaf1d779075"></span>bool <code class="descname">has_errors</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core5Image10has_errorsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Was an error estimate provided for this image. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core5Image5errorEmm">
<span id="Core::Image::error__unsigned-l.unsigned-l"></span><span class="target" id="classCore_1_1Image_1a6045262c7e157e9ab659e60678b207ec"></span>DATA_TYPE &amp;<code class="descname">error</code><span class="sig-paren">(</span>unsigned long <em>x</em>, unsigned long <em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core5Image5errorEmm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A place-holder for future development where each pixel may have an error estimate. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core5Image5errorEmm">
<span id="Core::Image::error__unsigned-l.unsigned-lC"></span><span class="target" id="classCore_1_1Image_1ad69c6e37aa9aee196738fcc410b9c893"></span>DATA_TYPE <code class="descname">error</code><span class="sig-paren">(</span>unsigned long <em>x</em>, unsigned long <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core5Image5errorEmm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A place-holder for future development where each pixel may have an error estimate. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x</span></code>: The x coordinate of the pixel whose error to return. </li>
<li><code class="docutils literal"><span class="pre">y</span></code>: The y coordinate of the pixel whose error to return. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core5Image12x_resolutionEv">
<span id="Core::Image::x_resolutionC"></span><span class="target" id="classCore_1_1Image_1a8ca9c1d6d7cecb5b80b64a9acc901ac8"></span>unsigned long <code class="descname">x_resolution</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core5Image12x_resolutionEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of pixels in the x direction. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core5Image12y_resolutionEv">
<span id="Core::Image::y_resolutionC"></span><span class="target" id="classCore_1_1Image_1a11697a659239b2458765d4a06f1ed60a"></span>unsigned long <code class="descname">y_resolution</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core5Image12y_resolutionEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of pixels in the y direction. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core5ImageclEmm">
<span id="Core::Image::call-operator__unsigned-l.unsigned-lC"></span><span class="target" id="classCore_1_1Image_1a379ea51ac40fc972932a9e22242ad972"></span>DATA_TYPE <code class="descname">operator()</code><span class="sig-paren">(</span>unsigned long <em>x</em>, unsigned long <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core5ImageclEmm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get the pixel value at the specified position. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core5ImageclEmm">
<span id="Core::Image::call-operator__unsigned-l.unsigned-l"></span><span class="target" id="classCore_1_1Image_1a40ca306e5c75b303773160d65e117a8b"></span>DATA_TYPE &amp;<code class="descname">operator()</code><span class="sig-paren">(</span>unsigned long <em>x</em>, unsigned long <em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core5ImageclEmm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reference to the pixel value at the specified position. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core5Image4goodEmm">
<span id="Core::Image::good__unsigned-l.unsigned-lC"></span><span class="target" id="classCore_1_1Image_1a5e367a2627535c9283ccc9b922e1ddb8"></span><em class="property">virtual</em> bool <code class="descname">good</code><span class="sig-paren">(</span>unsigned long <em>x</em>, unsigned long <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core5Image4goodEmm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>True if the given pixel has no mask flags set. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core5Image5faultEmm">
<span id="Core::Image::fault__unsigned-l.unsigned-lC"></span><span class="target" id="classCore_1_1Image_1a6947ab2b723646b785352443fa1ddc9e"></span><em class="property">virtual</em> bool <code class="descname">fault</code><span class="sig-paren">(</span>unsigned long <em>x</em>, unsigned long <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core5Image5faultEmm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>True if the given pixel is flagged as faulty in the mask. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core5Image3hotEmm">
<span id="Core::Image::hot__unsigned-l.unsigned-lC"></span><span class="target" id="classCore_1_1Image_1af7825a45032fb8a6930c5e31150f7be5"></span><em class="property">virtual</em> bool <code class="descname">hot</code><span class="sig-paren">(</span>unsigned long <em>x</em>, unsigned long <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core5Image3hotEmm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>True if the given pixel is flagged as hot in the mask. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core5Image6cosmicEmm">
<span id="Core::Image::cosmic__unsigned-l.unsigned-lC"></span><span class="target" id="classCore_1_1Image_1a88a992628a2be3480810236f2abd9210"></span><em class="property">virtual</em> bool <code class="descname">cosmic</code><span class="sig-paren">(</span>unsigned long <em>x</em>, unsigned long <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core5Image6cosmicEmm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>True iff the given pixel is flagged as hit by a cosmic ray. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core5Image7outsideEmm">
<span id="Core::Image::outside__unsigned-l.unsigned-lC"></span><span class="target" id="classCore_1_1Image_1a3e491efffd55b8ead315ba71795d14c3"></span><em class="property">virtual</em> bool <code class="descname">outside</code><span class="sig-paren">(</span>unsigned long <em>x</em>, unsigned long <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core5Image7outsideEmm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>True if the given pixel is flagged as coming from outside the image. TODO: this flag is never set. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core5Image13oversaturatedEmm">
<span id="Core::Image::oversaturated__unsigned-l.unsigned-lC"></span><span class="target" id="classCore_1_1Image_1ad3ce42f3a85218e3d44d260b4d62767a"></span><em class="property">virtual</em> bool <code class="descname">oversaturated</code><span class="sig-paren">(</span>unsigned long <em>x</em>, unsigned long <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core5Image13oversaturatedEmm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>True if the given pixel is flagged as oversaturated. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core5Image6leakedEmm">
<span id="Core::Image::leaked__unsigned-l.unsigned-lC"></span><span class="target" id="classCore_1_1Image_1a45c9731e395ec85864e2ae83a1457582"></span><em class="property">virtual</em> bool <code class="descname">leaked</code><span class="sig-paren">(</span>unsigned long <em>x</em>, unsigned long <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core5Image6leakedEmm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>True if the given pixel is flagged as being leaked to. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core5Image9saturatedEmm">
<span id="Core::Image::saturated__unsigned-l.unsigned-lC"></span><span class="target" id="classCore_1_1Image_1a02571ffbd0fde15de023f5cea5b0974f"></span><em class="property">virtual</em> bool <code class="descname">saturated</code><span class="sig-paren">(</span>unsigned long <em>x</em>, unsigned long <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core5Image9saturatedEmm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>True if the given pixel is oversaturated or leaked to. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core5Image12interpolatedEmm">
<span id="Core::Image::interpolated__unsigned-l.unsigned-lC"></span><span class="target" id="classCore_1_1Image_1a07ca9a954fc49f2f60950fb20aa37480"></span><em class="property">virtual</em> bool <code class="descname">interpolated</code><span class="sig-paren">(</span>unsigned long <em>x</em>, unsigned long <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core5Image12interpolatedEmm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>True iff the given pixel is flagged having its value interpolated (rather than really read out). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core5Image3badEmm">
<span id="Core::Image::bad__unsigned-l.unsigned-lC"></span><span class="target" id="classCore_1_1Image_1a1ea6096213df3f149564abb8d013b171"></span><em class="property">virtual</em> bool <code class="descname">bad</code><span class="sig-paren">(</span>unsigned long <em>x</em>, unsigned long <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core5Image3badEmm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>True if any flag is set in the mask for the given pixel. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core5Image15photometry_flagEmm">
<span id="Core::Image::photometry_flag__unsigned-l.unsigned-lC"></span><span class="target" id="classCore_1_1Image_1afff9065880d2e722c7e6ea321534c755"></span><a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core14PhotometryFlagE" title="Core::PhotometryFlag">PhotometryFlag</a> <code class="descname">photometry_flag</code><span class="sig-paren">(</span>unsigned long <em>x</em>, unsigned long <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core5Image15photometry_flagEmm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return the photometry quality flag to assign to results involving the given pixel. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core5ImageD0Ev">
<span id="Core::Image::~Image"></span><span class="target" id="classCore_1_1Image_1af91a8f2d6649c518d77ba8a237e98491"></span><em class="property">virtual</em> <code class="descname">~Image</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core5ImageD0Ev" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Protected Functions</p>
<dl class="function">
<dt id="_CPPv2NK4Core5Image5indexEmm">
<span id="Core::Image::index__unsigned-l.unsigned-lC"></span><span class="target" id="classCore_1_1Image_1ae0052b594406eec92848f48fb8d50bf4"></span>unsigned long <code class="descname">index</code><span class="sig-paren">(</span>unsigned long <em>x</em>, unsigned long <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core5Image5indexEmm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The index of the pixel at the given location within the 1-D array. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core5Image4maskEmm">
<span id="Core::Image::mask__unsigned-l.unsigned-lC"></span><span class="target" id="classCore_1_1Image_1ab778b62eb08b50f5b528984a9dc221c2"></span>char <code class="descname">mask</code><span class="sig-paren">(</span>unsigned long <em>x</em>, unsigned long <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core5Image4maskEmm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The pixel quality flag at the specified position. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N4Core5Image8__valuesE">
<span id="Core::Image::__values__DATA_TYPEP"></span><span class="target" id="classCore_1_1Image_1a84fe03f7b6b4867c9db363bea315fb3f"></span>DATA_TYPE *<code class="descname">__values</code><a class="headerlink" href="#_CPPv2N4Core5Image8__valuesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The pixel values in the image. See values argument of <a class="reference internal" href="#classCore_1_1Image_1accfbec37ae4145ece188e7794903699f"><span class="std std-ref">Image::Image()</span></a> </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core5Image8__errorsE">
<span id="Core::Image::__errors__DATA_TYPEP"></span><span class="target" id="classCore_1_1Image_1ae066ff13c332102f62286130369bd10b"></span>DATA_TYPE *<code class="descname">__errors</code><a class="headerlink" href="#_CPPv2N4Core5Image8__errorsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Error estimates for __values. See errors argument of <a class="reference internal" href="#classCore_1_1Image_1accfbec37ae4145ece188e7794903699f"><span class="std std-ref">Image::Image()</span></a> </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core5Image6__maskE">
<span id="Core::Image::__mask__cP"></span><span class="target" id="classCore_1_1Image_1a0b5c7a4cb5606eeb0335e17c77605940"></span>char *<code class="descname">__mask</code><a class="headerlink" href="#_CPPv2N4Core5Image6__maskE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The quality flags of the image pixels. See mask argument of <a class="reference internal" href="#classCore_1_1Image_1accfbec37ae4145ece188e7794903699f"><span class="std std-ref">Image::Image()</span></a> </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core5Image14__x_resolutionE">
<span id="Core::Image::__x_resolution__unsigned-l"></span><span class="target" id="classCore_1_1Image_1a32cde7b4a589cd720afa6c488bfec446"></span>unsigned long <code class="descname">__x_resolution</code><a class="headerlink" href="#_CPPv2N4Core5Image14__x_resolutionE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The x resolutions of the image. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core5Image14__y_resolutionE">
<span id="Core::Image::__y_resolution__unsigned-l"></span><span class="target" id="classCore_1_1Image_1a484a5edb1ab034fc5736d33a8e7a1e21"></span>unsigned long <code class="descname">__y_resolution</code><a class="headerlink" href="#_CPPv2N4Core5Image14__y_resolutionE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The y resolutions of the image. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core5Image9__wrappedE">
<span id="Core::Image::__wrapped__b"></span><span class="target" id="classCore_1_1Image_1add1118d4c0373fdbf39f21036798bed7"></span>bool <code class="descname">__wrapped</code><a class="headerlink" href="#_CPPv2N4Core5Image9__wrappedE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Is this image a wrap around another (and hence it should not free its memory). </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N4Core5PointE">
<span id="Core::Point"></span><span class="target" id="classCore_1_1Point"></span><em class="property">template </em>&lt;class <em>COORD_TYPE</em>&gt;<br /><em class="property">class </em><code class="descname">Point</code><a class="headerlink" href="#_CPPv2N4Core5PointE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;Point.h&gt;</em><p>Representing a 2D point with real valued cartesian coordinates. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N4Core5Point5PointE10COORD_TYPE10COORD_TYPE">
<span id="Core::Point::Point__COORD_TYPE.COORD_TYPE"></span><span class="target" id="classCore_1_1Point_1a2754bf0ae2b405f1bc4f471c29347bb0"></span><code class="descname">Point</code><span class="sig-paren">(</span>COORD_TYPE <em>x</em> = 0, COORD_TYPE <em>y</em> = 0<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core5Point5PointE10COORD_TYPE10COORD_TYPE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a point at the given location. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core5Point1xEv">
<span id="Core::Point::xC"></span><span class="target" id="classCore_1_1Point_1ad9fddf727792aac3c7967fa0e1fdab9f"></span>COORD_TYPE <code class="descname">x</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core5Point1xEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The abscissa coordinate of the point. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core5Point1xEv">
<span id="Core::Point::x"></span><span class="target" id="classCore_1_1Point_1a5d7884c25972cdf4abc7c1b6eb421068"></span>COORD_TYPE &amp;<code class="descname">x</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core5Point1xEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The abscissa coordinate of the point. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core5Point1yEv">
<span id="Core::Point::yC"></span><span class="target" id="classCore_1_1Point_1a4f860ac2fafe48d27e5a2ebaa13848bf"></span>COORD_TYPE <code class="descname">y</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core5Point1yEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The oordinate coordinate of the point. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core5Point1yEv">
<span id="Core::Point::y"></span><span class="target" id="classCore_1_1Point_1ad0c07d0f6d21b4058acaf0dafea4a3e7"></span>COORD_TYPE &amp;<code class="descname">y</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core5Point1yEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The oordinate coordinate of the point. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N4Core5Point3__xE">
<span id="Core::Point::__x__COORD_TYPE"></span><span class="target" id="classCore_1_1Point_1a8e4a80d059df2cb233bd00543572387c"></span>COORD_TYPE <code class="descname">__x</code><a class="headerlink" href="#_CPPv2N4Core5Point3__xE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The abscissa coordinate of the point. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core5Point3__yE">
<span id="Core::Point::__y__COORD_TYPE"></span><span class="target" id="classCore_1_1Point_1a713e4318b3c92bc33cd8f7dbd68cae72"></span>COORD_TYPE <code class="descname">__y</code><a class="headerlink" href="#_CPPv2N4Core5Point3__yE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The oordinate coordinate of the point. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N4Core8RealListE">
<span id="Core::RealList"></span><span class="target" id="classCore_1_1RealList"></span><em class="property">class </em><code class="descname">RealList</code> : <em class="property">public</em> std::list&lt;double&gt;<a class="headerlink" href="#_CPPv2N4Core8RealListE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;Typedefs.h&gt;</em><p>Synonim for list of doubles (needed for boost command line parsing). </p>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N4Core9SDKSourceE">
<span id="Core::SDKSource"></span><span class="target" id="classCore_1_1SDKSource"></span><em class="property">class </em><code class="descname">SDKSource</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core6SourceE" title="Core::Source">Source</a><a class="headerlink" href="#_CPPv2N4Core9SDKSourceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;SDKSource.h&gt;</em><p>Represents a source with a PSF described by an elliptical gaussian. </p>
<p>Subclassed by <a class="reference internal" href="#classIO_1_1OutputSDKSource"><span class="std std-ref">IO::OutputSDKSource</span></a></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N4Core9SDKSource9SDKSourceERK8SourceIDjddddddRKN10Background6SourceEd">
<span id="Core::SDKSource::SDKSource__SourceIDCR.unsigned.double.double.double.double.double.double.Background::SourceCR.double"></span><span class="target" id="classCore_1_1SDKSource_1a519ca713ca8d84f58dbc0ec512d37ec5"></span><code class="descname">SDKSource</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> &amp;<em>id</em> = SourceID (), unsigned <em>num_apertures</em> = 1, double <em>x</em> = NaN, double <em>y</em> = NaN, double <em>s</em> = NaN, double <em>d</em> = NaN, double <em>k</em> = NaN, double <em>amp</em> = NaN, <em class="property">const</em> <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> &amp;<em>bg</em> = Background::Source (), double <em>max_exp_coef</em> = 1<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core9SDKSource9SDKSourceERK8SourceIDjddddddRKN10Background6SourceEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a source at the specified location with the specified PSF parameters, amplitude and background. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core9SDKSource9SDKSourceERK9SDKSource">
<span id="Core::SDKSource::SDKSource__SDKSourceCR"></span><span class="target" id="classCore_1_1SDKSource_1a84fd47dacf11c4b2d248a007c9e6171f"></span><code class="descname">SDKSource</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N4Core9SDKSource9SDKSourceERK8SourceIDjddddddRKN10Background6SourceEd" title="Core::SDKSource::SDKSource">SDKSource</a> &amp;<em>orig</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core9SDKSource9SDKSourceERK9SDKSource" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Copy a source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core9SDKSource5psf_sEv">
<span id="Core::SDKSource::psf_sC"></span><span class="target" id="classCore_1_1SDKSource_1a94648255839ca2b0ef475ba4172a0dfb"></span>double <code class="descname">psf_s</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core9SDKSource5psf_sEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The coefficient in front of (x^2+y^2) in the exponent. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core9SDKSource5psf_dEv">
<span id="Core::SDKSource::psf_dC"></span><span class="target" id="classCore_1_1SDKSource_1adf50cab3c8d08b6d136243a8e5f07796"></span>double <code class="descname">psf_d</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core9SDKSource5psf_dEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The coefficient in front of (x^2-y^2) in the exponent. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core9SDKSource5psf_kEv">
<span id="Core::SDKSource::psf_kC"></span><span class="target" id="classCore_1_1SDKSource_1a236daec341c4aa5d9143604705bb46c5"></span>double <code class="descname">psf_k</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core9SDKSource5psf_kEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The coefficient in front of (xy) in the exponent. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core9SDKSource13psf_amplitudeEv">
<span id="Core::SDKSource::psf_amplitudeC"></span><span class="target" id="classCore_1_1SDKSource_1a76fb1106c6e1a4100de96c5a089fee08"></span>double <code class="descname">psf_amplitude</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core9SDKSource13psf_amplitudeEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The amplitude of the PSF. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core9SDKSource14psf_backgroundEv">
<span id="Core::SDKSource::psf_backgroundC"></span><span class="target" id="classCore_1_1SDKSource_1a49d05c83f4fc2da0625b6c6eb915c801"></span>double <code class="descname">psf_background</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core9SDKSource14psf_backgroundEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The backrgound under the PSF. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core9SDKSource7set_psfEdddddd">
<span id="Core::SDKSource::set_psf__double.double.double.double.double.double"></span><span class="target" id="classCore_1_1SDKSource_1ae23ddfc07a12ce24696ff7d66cbd9d4b"></span>void <code class="descname">set_psf</code><span class="sig-paren">(</span>double <em>s</em>, double <em>d</em>, double <em>k</em>, double <em>amp</em>, double <em>bg</em>, double <em>max_exp_coef</em> = 1<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core9SDKSource7set_psfEdddddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Changes the PSF of the source to have the given parameters. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core9SDKSourceD0Ev">
<span id="Core::SDKSource::~SDKSource"></span><span class="target" id="classCore_1_1SDKSource_1a4ba0f9f0142f857439ad0c8b1b13f15c"></span><code class="descname">~SDKSource</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core9SDKSourceD0Ev" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N4Core9SDKSource3__sE">
<span id="Core::SDKSource::__s__double"></span><span class="target" id="classCore_1_1SDKSource_1a243ee45fd84966fd5a98bd593ca92744"></span>double <code class="descname">__s</code><a class="headerlink" href="#_CPPv2N4Core9SDKSource3__sE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The coefficient in front of (x^2+y^2) in the exponent. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core9SDKSource3__dE">
<span id="Core::SDKSource::__d__double"></span><span class="target" id="classCore_1_1SDKSource_1abc28d867bc65f01df6253acf296759f2"></span>double <code class="descname">__d</code><a class="headerlink" href="#_CPPv2N4Core9SDKSource3__dE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The coefficient in front of (x^2-y^2) in the exponent. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core9SDKSource3__kE">
<span id="Core::SDKSource::__k__double"></span><span class="target" id="classCore_1_1SDKSource_1a01c5cf081ac432a03ec65cc026a51e41"></span>double <code class="descname">__k</code><a class="headerlink" href="#_CPPv2N4Core9SDKSource3__kE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The coefficient in front of (xy) in the exponent. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core9SDKSource5__ampE">
<span id="Core::SDKSource::__amp__double"></span><span class="target" id="classCore_1_1SDKSource_1a330f868a0ddcfc9030d670a75eb8598e"></span>double <code class="descname">__amp</code><a class="headerlink" href="#_CPPv2N4Core9SDKSource5__ampE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The amplitude of the PSF. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core9SDKSource4__bgE">
<span id="Core::SDKSource::__bg__double"></span><span class="target" id="classCore_1_1SDKSource_1a5ade66bcc8df613dd8874083d4a5545b"></span>double <code class="descname">__bg</code><a class="headerlink" href="#_CPPv2N4Core9SDKSource4__bgE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The background for the PSF only! </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core9SDKSource8__SDKpsfE">
<span id="Core::SDKSource::__SDKpsf__PSF::EllipticalGaussianP"></span><span class="target" id="classCore_1_1SDKSource_1a06ca7ef32dbc2b341418f7c47635bea4"></span><a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF18EllipticalGaussianE" title="PSF::EllipticalGaussian">EllipticalGaussian</a> *<code class="descname">__SDKpsf</code><a class="headerlink" href="#_CPPv2N4Core9SDKSource8__SDKpsfE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The PSF of the source. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N4Core6SourceE">
<span id="Core::Source"></span><span class="target" id="classCore_1_1Source"></span><em class="property">class </em><code class="descname">Source</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core14SourceLocationE" title="Core::SourceLocation">SourceLocation</a><a class="headerlink" href="#_CPPv2N4Core6SourceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;Source.h&gt;</em><p>A base class for all sources in SuperPhot. </p>
<p>Subclassed by <a class="reference internal" href="#classCore_1_1SDKSource"><span class="std std-ref">Core::SDKSource</span></a>, <a class="reference internal" href="#classPSF_1_1MapSource"><span class="std std-ref">PSF::MapSource</span></a></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N4Core6Source6SourceERK8SourceIDjddRKN10Background6SourceE">
<span id="Core::Source::Source__SourceIDCR.unsigned.double.double.Background::SourceCR"></span><span class="target" id="classCore_1_1Source_1a0b03fbb3f4e794bb0832147d0f1b75a2"></span><code class="descname">Source</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> &amp;<em>id</em>, unsigned <em>num_apertures</em> = 1, double <em>x</em> = NaN, double <em>y</em> = NaN, <em class="property">const</em> <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> &amp;<em>bg</em> = Background::Source ()<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core6Source6SourceERK8SourceIDjddRKN10Background6SourceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a source with the given id and position that will have its flux measured in the given number of apertures. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core6Source6SourceEjRK8SourceIDddRKN3PSF3PSFE">
<span id="Core::Source::Source__unsigned.SourceIDCR.double.double.PSF::PSFCR"></span><span class="target" id="classCore_1_1Source_1acb5aa378942f901a0a63f0b29636543c"></span><code class="descname">Source</code><span class="sig-paren">(</span>unsigned <em>num_apertures</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> &amp;<em>id</em>, double <em>x</em>, double <em>y</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF3PSFE" title="PSF::PSF">PSF</a> &amp;<em>psf</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core6Source6SourceEjRK8SourceIDddRKN3PSF3PSFE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a source with the given id and position that will have its flux measured in the given number of apertures, also specifying the point spread function that applies to this source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core6Source6SourceERK6Source">
<span id="Core::Source::Source__SourceCR"></span><span class="target" id="classCore_1_1Source_1a238bbda446c59f9e3a2cf0956a245d51"></span><code class="descname">Source</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N4Core6Source6SourceERK8SourceIDjddRKN10Background6SourceE" title="Core::Source::Source">Source</a> &amp;<em>orig</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core6Source6SourceERK6Source" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Copy orig to *this. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core6Source17set_num_aperturesEj">
<span id="Core::Source::set_num_apertures__unsigned"></span><span class="target" id="classCore_1_1Source_1aa0bb9a6e8192988ad89054f794392f46"></span>void <code class="descname">set_num_apertures</code><span class="sig-paren">(</span>unsigned <em>num_apertures</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core6Source17set_num_aperturesEj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Sets the number of apertures in which this source&#8217;s flux will be measured. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core6Source4fluxEj">
<span id="Core::Source::flux__unsignedC"></span><span class="target" id="classCore_1_1Source_1a31b239e80701fd2e37b8f3171480f734"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N4Core4FluxE" title="Core::Flux">Flux</a> &amp;<code class="descname">flux</code><span class="sig-paren">(</span>unsigned <em>aperture_index</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core6Source4fluxEj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The estimate of the flux of this soruce in the aperture with the given index. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core6Source4fluxEj">
<span id="Core::Source::flux__unsigned"></span><span class="target" id="classCore_1_1Source_1a7e5ccae743008cb960d07ffa95623bf6"></span><a class="reference internal" href="#_CPPv2N4Core4FluxE" title="Core::Flux">Flux</a> &amp;<code class="descname">flux</code><span class="sig-paren">(</span>unsigned <em>aperture_index</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core6Source4fluxEj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The estimate of the flux of this soruce in the aperture with the given index. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core6Source4fluxEv">
<span id="Core::Source::fluxC"></span><span class="target" id="classCore_1_1Source_1a6a5989f5f7dfded34e740275b6dca6d8"></span><em class="property">const</em> std::valarray&lt;<a class="reference internal" href="#_CPPv2N4Core4FluxE" title="Core::Flux">Flux</a>&gt; &amp;<code class="descname">flux</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core6Source4fluxEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The estimate of the flux of this soruce in the aperture with the given index. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core6Source4fluxEv">
<span id="Core::Source::flux"></span><span class="target" id="classCore_1_1Source_1a0a1a23240dc7e8b15efaa8f9b4f80ddc"></span>std::valarray&lt;<a class="reference internal" href="#_CPPv2N4Core4FluxE" title="Core::Flux">Flux</a>&gt; &amp;<code class="descname">flux</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core6Source4fluxEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The estimate of the flux of this soruce in the aperture with the given index. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core6Source10backgroundEv">
<span id="Core::Source::backgroundC"></span><span class="target" id="classCore_1_1Source_1a1d06a462bcb146c9ef325fde16dbfeed"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> &amp;<code class="descname">background</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core6Source10backgroundEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The estimate of the background under this source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core6Source10backgroundEv">
<span id="Core::Source::background"></span><span class="target" id="classCore_1_1Source_1a9abf5acb4a24a83eff1d216567ce4b22"></span><a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> &amp;<code class="descname">background</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core6Source10backgroundEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The estimate of the background under this source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core6Source3psfEv">
<span id="Core::Source::psfC"></span><span class="target" id="classCore_1_1Source_1ae647d592aca10e321a686653899558c8"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF3PSFE" title="PSF::PSF">PSF</a> &amp;<code class="descname">psf</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core6Source3psfEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The point spread function for this source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core6Source7set_psfERKN3PSF3PSFE">
<span id="Core::Source::set_psf__PSF::PSFCR"></span><span class="target" id="classCore_1_1Source_1ac16fa3dcbab505b6878bf465a80bf47b"></span>void <code class="descname">set_psf</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF3PSFE" title="PSF::PSF">PSF</a> &amp;<em>psf</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core6Source7set_psfERKN3PSF3PSFE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Change the point spread function for the source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core6Source6enableEv">
<span id="Core::Source::enable"></span><span class="target" id="classCore_1_1Source_1ab1305834b44cf74e2f2dfc9b86033adb"></span>void <code class="descname">enable</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core6Source6enableEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Enables the source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core6Source7disableEv">
<span id="Core::Source::disable"></span><span class="target" id="classCore_1_1Source_1aa0b8172ef84de55391d5229133a046cc"></span>void <code class="descname">disable</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core6Source7disableEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Disables the source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core6Source10is_enabledEv">
<span id="Core::Source::is_enabledC"></span><span class="target" id="classCore_1_1Source_1ac333020c07349be4440141c7d7d3d4c0"></span>bool <code class="descname">is_enabled</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core6Source10is_enabledEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Checks if the source is enabled. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core6Source5psf_sEv">
<span id="Core::Source::psf_sC"></span><span class="target" id="classCore_1_1Source_1a3714dcc90cbb576b7cd6b60f95df064a"></span><em class="property">virtual</em> double <code class="descname">psf_s</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core6Source5psf_sEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The S value for sources with elliptical Gaussian PSFs. </p>
<p>An exception is thrown for non-elliptical Gaussian PSF sources. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core6Source5psf_dEv">
<span id="Core::Source::psf_dC"></span><span class="target" id="classCore_1_1Source_1ac0825a65a66274f06c17dd544b6869cd"></span><em class="property">virtual</em> double <code class="descname">psf_d</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core6Source5psf_dEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The D value for sources with elliptical Gaussian PSFs. </p>
<p>An exception is thrown for non-elliptical Gaussian PSF sources. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core6Source5psf_kEv">
<span id="Core::Source::psf_kC"></span><span class="target" id="classCore_1_1Source_1ad5b8fae7f20731a7588935dffdc34023"></span><em class="property">virtual</em> double <code class="descname">psf_k</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core6Source5psf_kEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The K value for sources with elliptical Gaussian PSFs. </p>
<p>An exception is thrown for non-elliptical Gaussian PSF sources. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core6Source13psf_amplitudeEv">
<span id="Core::Source::psf_amplitudeC"></span><span class="target" id="classCore_1_1Source_1aa222ceda7b6568ce901f0073d08f5037"></span><em class="property">virtual</em> double <code class="descname">psf_amplitude</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core6Source13psf_amplitudeEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The best fit amplitude of the given source PSF in the image. </p>
<p>An exception is thrown for sources not generated by PSF fitting. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core6Source12reduced_chi2Ev">
<span id="Core::Source::reduced_chi2C"></span><span class="target" id="classCore_1_1Source_1a8d69aff642e0e4331ecfe090c6d6f2da"></span><em class="property">virtual</em> double <code class="descname">reduced_chi2</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core6Source12reduced_chi2Ev" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The best fit reduced <span class="math">\(\chi^2\)</span> of the given source in the image. </p>
<p>An exception is thrown for sources not generated by PSF fitting. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core6Source12reduced_chi2Ev">
<span id="Core::Source::reduced_chi2"></span><span class="target" id="classCore_1_1Source_1aeb7358c8d4a101b961b629fdfb05b813"></span><em class="property">virtual</em> double &amp;<code class="descname">reduced_chi2</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core6Source12reduced_chi2Ev" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reference to the best fit reduced <span class="math">\(\chi^2\)</span> of the given source in the image. </p>
<p>An exception is thrown for sources not generated by PSF fitting. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core6Source15signal_to_noiseEv">
<span id="Core::Source::signal_to_noiseC"></span><span class="target" id="classCore_1_1Source_1a439b9c85b8ccb5a86171903676c6836d"></span><em class="property">virtual</em> double <code class="descname">signal_to_noise</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core6Source15signal_to_noiseEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The signal to noise ratio of the given source in the image. </p>
<p>An exception is thrown for sources not generated by PSF fitting. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core6Source15signal_to_noiseEv">
<span id="Core::Source::signal_to_noise"></span><span class="target" id="classCore_1_1Source_1a10fea17b19b53e5184545ba48d500fdc"></span><em class="property">virtual</em> double &amp;<code class="descname">signal_to_noise</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core6Source15signal_to_noiseEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reference to the signal to noise ratio of the given source in the image. </p>
<p>An exception is thrown for sources not generated by PSF fitting. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core6Source20flux_fit_pixel_countEv">
<span id="Core::Source::flux_fit_pixel_countC"></span><span class="target" id="classCore_1_1Source_1a516c7b4093e93a30dca87007a94e7132"></span><em class="property">virtual</em> size_t <code class="descname">flux_fit_pixel_count</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core6Source20flux_fit_pixel_countEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of pixels assigned to the source. </p>
<p>An exception is thrown for sources not generated by PSF fitting. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N4Core6Source9__enabledE">
<span id="Core::Source::__enabled__b"></span><span class="target" id="classCore_1_1Source_1a59ceb88b86048feb807529d896a6323d"></span>bool <code class="descname">__enabled</code><a class="headerlink" href="#_CPPv2N4Core6Source9__enabledE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Is the source enabled (should it be processed?). </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core6Source6__fluxE">
<span id="Core::Source::__flux__std::valarray:Flux:"></span><span class="target" id="classCore_1_1Source_1a7d1e889cb244db09bb7cd3798d38d87b"></span>std::valarray&lt;<a class="reference internal" href="#_CPPv2N4Core4FluxE" title="Core::Flux">Flux</a>&gt; <code class="descname">__flux</code><a class="headerlink" href="#_CPPv2N4Core6Source6__fluxE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The flux estimate of the source for each aperture. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core6Source12__backgroundE">
<span id="Core::Source::__background__Background::Source"></span><span class="target" id="classCore_1_1Source_1a6374c83adb3ba7250d09203793cdff55"></span><a class="reference internal" href="#_CPPv210Background" title="Background">Background</a>::<a class="reference internal" href="#_CPPv2N10Background6SourceE" title="Background::Source">Source</a> <code class="descname">__background</code><a class="headerlink" href="#_CPPv2N4Core6Source12__backgroundE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>An estimate of the backgound under the source. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core6Source5__psfE">
<span id="Core::Source::__psf__PSF::PSFCP"></span><span class="target" id="classCore_1_1Source_1a9f648b40de11d5b31905469ead4ab1ac"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF3PSFE" title="PSF::PSF">PSF</a> *<code class="descname">__psf</code><a class="headerlink" href="#_CPPv2N4Core6Source5__psfE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The point spread function applicable for this source. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N4Core8SourceIDE">
<span id="Core::SourceID"></span><span class="target" id="classCore_1_1SourceID"></span><em class="property">class </em><code class="descname">SourceID</code><a class="headerlink" href="#_CPPv2N4Core8SourceIDE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;SourceID.h&gt;</em><p>The two components of the HAT i.d. (primary filed and source number) </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N4Core8SourceID8SourceIDERKNSt6stringEb">
<span id="Core::SourceID::SourceID__ssCR.b"></span><span class="target" id="classCore_1_1SourceID_1a238dc32d3736d999bda98d51aa7cfd3a"></span><code class="descname">SourceID</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>id</em>, bool <em>assume_non_hat</em> = false<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core8SourceID8SourceIDERKNSt6stringEb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Construct out of the given string. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core8SourceID8SourceIDEjj">
<span id="Core::SourceID::SourceID__unsigned.unsigned"></span><span class="target" id="classCore_1_1SourceID_1a69a5be8b27d7ffd63c10929d480b3b43"></span><code class="descname">SourceID</code><span class="sig-paren">(</span>unsigned <em>field</em>, unsigned <em>source</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core8SourceID8SourceIDEjj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a source ID from the given field and source number. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">field</span></code>: The HAT field the source belongs to </li>
<li><code class="docutils literal"><span class="pre">source</span></code>: The source number within the HAT field. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core8SourceID8SourceIDEv">
<span id="Core::SourceID::SourceID"></span><span class="target" id="classCore_1_1SourceID_1a128bcbd8c1cc241a54081f950ccd6f22"></span><code class="descname">SourceID</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core8SourceID8SourceIDEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a non-existent source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core8SourceID8SourceIDERK8SourceID">
<span id="Core::SourceID::SourceID__SourceIDCR"></span><span class="target" id="classCore_1_1SourceID_1a797f8dcd87425dcba8856fae6543897c"></span><code class="descname">SourceID</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N4Core8SourceID8SourceIDERKNSt6stringEb" title="Core::SourceID::SourceID">SourceID</a> &amp;<em>id</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core8SourceID8SourceIDERK8SourceID" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Copy constructor. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core8SourceIDcvRKNSt6stringEEv">
<span id="Core::SourceID::castto-ssCR-operatorC"></span><span class="target" id="classCore_1_1SourceID_1ac28dfa7273ebc8f5c043351fd000ca47"></span><em class="property">virtual</em> <code class="descname">operator const std::string&amp;</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core8SourceIDcvRKNSt6stringEEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Convert to string. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core8SourceIDaSERK8SourceID">
<span id="Core::SourceID::assign-operator__SourceIDCR"></span><span class="target" id="classCore_1_1SourceID_1a2e4840d7333242d792dad8aa1e1dc13b"></span><em class="property">virtual</em> <a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> &amp;<code class="descname">operator=</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> &amp;<em>rhs</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core8SourceIDaSERK8SourceID" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Copy RHS to this. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core8SourceIDaSERKNSt6stringE">
<span id="Core::SourceID::assign-operator__ssCR"></span><span class="target" id="classCore_1_1SourceID_1aa8af32e82f99cdda08fc12d95b55e194"></span><em class="property">virtual</em> <a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> &amp;<code class="descname">operator=</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>rhs</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core8SourceIDaSERKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Copy RHS to this. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core8SourceID3strEv">
<span id="Core::SourceID::strC"></span><span class="target" id="classCore_1_1SourceID_1a6607424d004eb54bf1c1192591513c5e"></span><em class="property">virtual</em> <em class="property">const</em> std::string &amp;<code class="descname">str</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core8SourceID3strEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The string representation of the ID. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core8SourceIDneERK8SourceID">
<span id="Core::SourceID::neq-operator__SourceIDCRC"></span><span class="target" id="classCore_1_1SourceID_1a8a4e644127e0dbb3274ceb1dd1274ef9"></span><em class="property">virtual</em> bool <code class="descname">operator!=</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> &amp;<em>rhs</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core8SourceIDneERK8SourceID" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Self explanatory. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core8SourceIDeqERK8SourceID">
<span id="Core::SourceID::eq-operator__SourceIDCRC"></span><span class="target" id="classCore_1_1SourceID_1a0a1dd540430abde202c7fa1be639d041"></span><em class="property">virtual</em> bool <code class="descname">operator==</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> &amp;<em>rhs</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core8SourceIDeqERK8SourceID" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Self explanatory. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core8SourceID8is_hatidEv">
<span id="Core::SourceID::is_hatidC"></span><span class="target" id="classCore_1_1SourceID_1a790c1bcfa5e6cd6c8f06689de83b70c1"></span><em class="property">virtual</em> bool <code class="descname">is_hatid</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core8SourceID8is_hatidEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Is this a HAT-ID? </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core8SourceID5fieldEv">
<span id="Core::SourceID::fieldC"></span><span class="target" id="classCore_1_1SourceID_1afe42fcf2e9023d16a59e0114b4a96828"></span><em class="property">virtual</em> unsigned <code class="descname">field</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core8SourceID5fieldEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The field corresponding to the given source. </p>
<p>An exception is thrown if not a HAT-ID. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core8SourceID6sourceEv">
<span id="Core::SourceID::sourceC"></span><span class="target" id="classCore_1_1SourceID_1accd35d1254e01f8d34ff0e8085bb4e94"></span><em class="property">virtual</em> unsigned <code class="descname">source</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core8SourceID6sourceEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The source corresponding to the given source. </p>
<p>An exception is thrown if not a HAT-ID. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N4Core8SourceID11parse_hatidEv">
<span id="Core::SourceID::parse_hatid"></span><span class="target" id="classCore_1_1SourceID_1a149ae801437bd5c653b5bfbd63c7c1b8"></span>bool <code class="descname">parse_hatid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core8SourceID11parse_hatidEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns HAT field and source index, if ID is in HAT format: HAT-FFF-SSSSSSS (where F is the field, and S is the source index). F and S &gt; 1 for valid IDs. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N4Core8SourceID4__idE">
<span id="Core::SourceID::__id__ss"></span><span class="target" id="classCore_1_1SourceID_1a81d52076c78b16896b26bcab5863eeea"></span>std::string <code class="descname">__id</code><a class="headerlink" href="#_CPPv2N4Core8SourceID4__idE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The string representation of the ID. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core8SourceID10__is_hatidE">
<span id="Core::SourceID::__is_hatid__b"></span><span class="target" id="classCore_1_1SourceID_1a03ee271d857603ee570379d77d66ec4a"></span>bool <code class="descname">__is_hatid</code><a class="headerlink" href="#_CPPv2N4Core8SourceID10__is_hatidE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Is this an ID of the form HAT-FFF-SSSSSSS, which gets parsed into a source and a field. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core8SourceID7__fieldE">
<span id="Core::SourceID::__field__unsigned"></span><span class="target" id="classCore_1_1SourceID_1abdae0e8d3ff77968062f3f356e0798fe"></span>unsigned <code class="descname">__field</code><a class="headerlink" href="#_CPPv2N4Core8SourceID7__fieldE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The field entry (defined only if this is a HAT-ID). </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core8SourceID8__sourceE">
<span id="Core::SourceID::__source__unsigned"></span><span class="target" id="classCore_1_1SourceID_1a52d19b79ec9ba29b648c53cca52598c7"></span>unsigned <code class="descname">__source</code><a class="headerlink" href="#_CPPv2N4Core8SourceID8__sourceE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The source entry (defined only if this is a HAT-ID). </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Friends</p>
<dl class="function">
<dt id="_CPPv2rsRNSt7istreamER8SourceID">
<span id="rshift-operator__isR.SourceIDR"></span><span class="target" id="classCore_1_1SourceID_1a3b500b4526fa5cd0030541a5659247e4"></span>std::istream &amp;<code class="descname">operator&gt;&gt;</code><span class="sig-paren">(</span>std::istream &amp;<em>is</em>, SourceID &amp;<em>id</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2rsRNSt7istreamER8SourceID" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Read the ID from the given stream. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">is</span></code>: The stream to read from. </li>
<li><code class="docutils literal"><span class="pre">id</span></code>: The variable to set to the parsed ID. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2lsRNSt7ostreamERK8SourceID">
<span id="lshift-operator__osR.SourceIDCR"></span><span class="target" id="classCore_1_1SourceID_1a501956bd887e5f4102a932a56cebb23c"></span>std::ostream &amp;<code class="descname">operator&lt;&lt;</code><span class="sig-paren">(</span>std::ostream &amp;<em>os</em>, <em class="property">const</em> SourceID &amp;<em>id</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2lsRNSt7ostreamERK8SourceID" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Output the ID to the given stream. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">os</span></code>: The stream to write to. </li>
<li><code class="docutils literal"><span class="pre">id</span></code>: The source ID to write. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N4Core14SourceLocationE">
<span id="Core::SourceLocation"></span><span class="target" id="classCore_1_1SourceLocation"></span><em class="property">class </em><code class="descname">SourceLocation</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5PointE" title="Core::Point">Point</a>&lt;double&gt;<a class="headerlink" href="#_CPPv2N4Core14SourceLocationE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;SourceLocation.h&gt;</em><p>The minimum requirements for objects specifying where a source is. </p>
<p>Subclassed by <a class="reference internal" href="#classCore_1_1Source"><span class="std std-ref">Core::Source</span></a></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N4Core14SourceLocation14SourceLocationEdd">
<span id="Core::SourceLocation::SourceLocation__double.double"></span><span class="target" id="classCore_1_1SourceLocation_1a7854481e8ba5071ef740c9edbb1bff47"></span><code class="descname">SourceLocation</code><span class="sig-paren">(</span>double <em>x</em> = NaN, double <em>y</em> = NaN<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core14SourceLocation14SourceLocationEdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a source at the given location (x,y). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core14SourceLocation14SourceLocationERK8SourceIDdd">
<span id="Core::SourceLocation::SourceLocation__SourceIDCR.double.double"></span><span class="target" id="classCore_1_1SourceLocation_1a010019f0b4dc4a1fee04e1da0bddb527"></span><code class="descname">SourceLocation</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> &amp;<em>id</em>, double <em>x</em> = NaN, double <em>y</em> = NaN<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core14SourceLocation14SourceLocationERK8SourceIDdd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a source with the given id at the given location (x,y). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core14SourceLocation2idEv">
<span id="Core::SourceLocation::idC"></span><span class="target" id="classCore_1_1SourceLocation_1a74dccb352fdcdf3cd3262456fdf12ad4"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> &amp;<code class="descname">id</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core14SourceLocation2idEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Identifying string for this source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core14SourceLocation2idEv">
<span id="Core::SourceLocation::id"></span><span class="target" id="classCore_1_1SourceLocation_1ab3ab545019b33822ad4ccf48334b2242"></span><a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> &amp;<code class="descname">id</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core14SourceLocation2idEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Identifying string for this source. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core14SourceLocationeqERK14SourceLocation">
<span id="Core::SourceLocation::eq-operator__SourceLocationCRC"></span><span class="target" id="classCore_1_1SourceLocation_1a84663e23052bdf9f3418db6f167b1228"></span>bool <code class="descname">operator==</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N4Core14SourceLocationE" title="Core::SourceLocation">SourceLocation</a> &amp;<em>rhs</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core14SourceLocationeqERK14SourceLocation" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check if the given source has the same ID as this. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N4Core14SourceLocation4__idE">
<span id="Core::SourceLocation::__id__SourceID"></span><span class="target" id="classCore_1_1SourceLocation_1a97cab0a6f743bb817a53e44870c7ebac"></span><a class="reference internal" href="#_CPPv2N4Core8SourceIDE" title="Core::SourceID">SourceID</a> <code class="descname">__id</code><a class="headerlink" href="#_CPPv2N4Core14SourceLocation4__idE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>An identifying string for the source. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N4Core10StringListE">
<span id="Core::StringList"></span><span class="target" id="classCore_1_1StringList"></span><em class="property">class </em><code class="descname">StringList</code> : <em class="property">public</em> std::list&lt;std::string&gt;<a class="headerlink" href="#_CPPv2N4Core10StringListE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;Typedefs.h&gt;</em><p>Synonym for list of strings (needed for boost command line parsing). </p>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N4Core21SubPixelCorrectedFluxE">
<span id="Core::SubPixelCorrectedFlux"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux"></span><em class="property">template </em>&lt;<em class="property">class</em> SUBPIX_TYPE&gt;<br /><em class="property">class </em><code class="descname">SubPixelCorrectedFlux</code><a class="headerlink" href="#_CPPv2N4Core21SubPixelCorrectedFluxE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;SubPixelCorrectedFlux.h&gt;</em><p>A class to do fixed aperture photometry, corrected for variable sensitivity of different parts of a pixel. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N4Core21SubPixelCorrectedFlux21SubPixelCorrectedFluxEdRKNSt4listIdEEdb">
<span id="Core::SubPixelCorrectedFlux::SubPixelCorrectedFlux__double.std::list:double:CR.double.b"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1a8364693b2af0cebcbb4764cf7fe67542"></span><code class="descname">SubPixelCorrectedFlux</code><span class="sig-paren">(</span>double <em>error_offset</em>, <em class="property">const</em> std::list&lt;double&gt; &amp;<em>apertures</em> = std::list&lt; double &gt;(), double <em>gain</em> = 1.5, bool <em>assume_no_photon_noise</em> = false<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core21SubPixelCorrectedFlux21SubPixelCorrectedFluxEdRKNSt4listIdEEdb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a flux measuring object that will use the given apertures. </p>
<p>The subpixel sensitivity map and the image must be specified separately before use. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core21SubPixelCorrectedFlux21SubPixelCorrectedFluxERK11SUBPIX_TYPEdRKNSt4listIdEEdb">
<span id="Core::SubPixelCorrectedFlux::SubPixelCorrectedFlux__SUBPIX_TYPECR.double.std::list:double:CR.double.b"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1a2ad29b63c79188261692c1b0e442cdb3"></span><code class="descname">SubPixelCorrectedFlux</code><span class="sig-paren">(</span><em class="property">const</em> SUBPIX_TYPE &amp;<em>subpixel_map</em>, double <em>error_offset</em>, <em class="property">const</em> std::list&lt;double&gt; &amp;<em>apertures</em> = std::list&lt; double &gt;(), double <em>gain</em> = 1.5, bool <em>assume_no_photon_noise</em> = false<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core21SubPixelCorrectedFlux21SubPixelCorrectedFluxERK11SUBPIX_TYPEdRKNSt4listIdEEdb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a flux measuring object that will use the given apertures and subpixel sensitivity map. </p>
<p>The image must be specified separately before use. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core21SubPixelCorrectedFlux21SubPixelCorrectedFluxERKN4Core5ImageIdEERK11SUBPIX_TYPEdRKNSt4listIdEEdb">
<span id="Core::SubPixelCorrectedFlux::SubPixelCorrectedFlux__Core::Image:double:CR.SUBPIX_TYPECR.double.std::list:double:CR.double.b"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1a03993a9d0b6022ab9c0d8b1104ef0949"></span><code class="descname">SubPixelCorrectedFlux</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5ImageE" title="Core::Image">Image</a>&lt;double&gt; &amp;<em>image</em>, <em class="property">const</em> SUBPIX_TYPE &amp;<em>subpixel_map</em>, double <em>error_offset</em>, <em class="property">const</em> std::list&lt;double&gt; &amp;<em>apertures</em> = std::list&lt; double &gt;(), double <em>gain</em> = 1.5, bool <em>assume_no_photon_noise</em> = false<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core21SubPixelCorrectedFlux21SubPixelCorrectedFluxERKN4Core5ImageIdEERK11SUBPIX_TYPEdRKNSt4listIdEEdb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a flux measuring object that will use the given apertures, subpixel sensitivity map and image. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core21SubPixelCorrectedFlux12add_apertureEd">
<span id="Core::SubPixelCorrectedFlux::add_aperture__double"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1ae53790e832e8a5000d8faffa4897f1b8"></span>void <code class="descname">add_aperture</code><span class="sig-paren">(</span>double <em>aperture</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core21SubPixelCorrectedFlux12add_apertureEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Adds another aperture to the current list of apertures used to measure flux over. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core21SubPixelCorrectedFlux16number_aperturesEv">
<span id="Core::SubPixelCorrectedFlux::number_apertures"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1acebcf94088d90a46fd9125222f3cf2b4"></span>size_t <code class="descname">number_apertures</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core21SubPixelCorrectedFlux16number_aperturesEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The number of apertures for which flux measurements will be performed. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core21SubPixelCorrectedFlux16set_subpixel_mapERK11SUBPIX_TYPE">
<span id="Core::SubPixelCorrectedFlux::set_subpixel_map__SUBPIX_TYPECR"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1a351035399b23644694b125df36949de6"></span>void <code class="descname">set_subpixel_map</code><span class="sig-paren">(</span><em class="property">const</em> SUBPIX_TYPE &amp;<em>subpix_map</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core21SubPixelCorrectedFlux16set_subpixel_mapERK11SUBPIX_TYPE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Sets the subpixel sensitivity map to use. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core21SubPixelCorrectedFlux9set_imageERKN4Core5ImageIdEE">
<span id="Core::SubPixelCorrectedFlux::set_image__Core::Image:double:CR"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1a6e9d5faa0caeae5abe434e96c511f8dc"></span>void <code class="descname">set_image</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5ImageE" title="Core::Image">Image</a>&lt;double&gt; &amp;<em>image</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core21SubPixelCorrectedFlux9set_imageERKN4Core5ImageIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Specifies the image over which photometry will be performed. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core21SubPixelCorrectedFluxclEddRKN3PSF3PSFEddb">
<span id="Core::SubPixelCorrectedFlux::call-operator__double.double.PSF::PSFCR.double.double.b"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1a946d0c821fff67bd6f4badfcd2c73d0b"></span>std::valarray&lt;<a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core4FluxE" title="Core::Flux">Flux</a>&gt; <code class="descname">operator()</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF3PSFE" title="PSF::PSF">PSF</a> &amp;<em>psf</em>, double <em>background</em> = Core::NaN, double <em>background_error</em> = Core::NaN, bool <em>prepare_subpix_scaling</em> = false<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core21SubPixelCorrectedFluxclEddRKN3PSF3PSFEddb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Actually measure the flux in the current set of apertures centered on the given coordinates. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x</span></code>: The horizontal offset of the aperture center relative to the left edge of the image. </li>
<li><code class="docutils literal"><span class="pre">y</span></code>: The vertical offset of the aperture center relative to the bottom edge of the image. </li>
<li><code class="docutils literal"><span class="pre">psf</span></code>: The PSF to assume. </li>
<li><code class="docutils literal"><span class="pre">background</span></code>: If NaN, the PSF should include a background and the returned </li>
<li><code class="docutils literal"><span class="pre">background_error</span></code>: An estimate for the error in the background. </li>
<li><code class="docutils literal"><span class="pre">prepare_subpix_scaling</span></code>: If true, a set of sub-pixel structure independent matrices (one per aperture) is prepared, which can be used with a vector of sub-pixel sensitivities to derive the proper corrected flux for the same source on the same image with a different subpixel structure. These matrices can be accessed through the get_subpix_scaling method. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core21SubPixelCorrectedFlux18get_subpix_scalingE6size_t">
<span id="Core::SubPixelCorrectedFlux::get_subpix_scaling__s"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1ac6a353dddefcb944ea9d55be1a6d2639"></span><em class="property">const</em> Eigen::MatrixXd &amp;<code class="descname">get_subpix_scaling</code><span class="sig-paren">(</span>size_t <em>aperture_ind</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core21SubPixelCorrectedFlux18get_subpix_scalingE6size_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return the last calculated subpixel independent scaling for the aperture with the given index. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core21SubPixelCorrectedFlux8set_gainEd">
<span id="Core::SubPixelCorrectedFlux::set_gain__double"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1a94dc70a8513a11a58c7afae926a7430b"></span>void <code class="descname">set_gain</code><span class="sig-paren">(</span>double <em>gain</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core21SubPixelCorrectedFlux8set_gainEd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set the gain to assume when deriving the flux. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core21SubPixelCorrectedFlux5imageEv">
<span id="Core::SubPixelCorrectedFlux::image"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1a4e53256dc9cca1557cb104736adeaf64"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5ImageE" title="Core::Image">Image</a>&lt;double&gt; &amp;<code class="descname">image</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core21SubPixelCorrectedFlux5imageEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return the image on which the object is operating. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt id="_CPPv2N4Core21SubPixelCorrectedFlux12pixel_fluxesEddRKN3PSF3PSFEdi">
<span id="Core::SubPixelCorrectedFlux::pixel_fluxes__double.double.PSF::PSFCR.double.i"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1a9b231f38fd3373d34733e3bbb7010914"></span><a class="reference internal" href="#_CPPv2N4Core8FluxPairE" title="Core::FluxPair">FluxPair</a> <code class="descname">pixel_fluxes</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv23PSF" title="PSF">PSF</a>::<a class="reference internal" href="#_CPPv2N3PSF3PSFE" title="PSF::PSF">PSF</a> &amp;<em>psf</em>, double <em>r</em> = Core::NaN, int <em>fill_scaling</em> = -1<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core21SubPixelCorrectedFlux12pixel_fluxesEddRKN3PSF3PSFEdi" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return the sum of the integrals of the PSF over each subpixel weighted and not weighted by the subpixel sensitivity. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x</span></code>: The left edge of the pixel relative to the PSF center. </li>
<li><code class="docutils literal"><span class="pre">y</span></code>: The bottom edge of the pixel relative to the PSF center. </li>
<li><code class="docutils literal"><span class="pre">psf</span></code>: The PSF to assume. </li>
<li><code class="docutils literal"><span class="pre">r</span></code>: The radius of the aperture. </li>
<li><code class="docutils literal"><span class="pre">fill_scaling</span></code>: If fill_scaling is non-negative and the entry in __scaling_ind corresponding to the aperture with the given index, the row in the corresponding __subpix_scaling matrix indexed by that entry is filled with the integral of the PSF over individual sub-pixels. The proper entries can then be calculated by dividing by (observed counts)*(raw_flux). </li>
</ul>
</dd>
</dl>
</p>
<p>If __subpixel_map is NULL, the weighted flux it returns is 0. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core21SubPixelCorrectedFlux14classify_pixelEddd">
<span id="Core::SubPixelCorrectedFlux::classify_pixel__double.double.doubleC"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1adad299abeb32fb42224dc2b7786f6d95"></span>int <code class="descname">classify_pixel</code><span class="sig-paren">(</span>double <em>x</em>, double <em>y</em>, double <em>aperture</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core21SubPixelCorrectedFlux14classify_pixelEddd" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return &lt;0 if the pixel is entirely contained within the given aperture, &gt;0 if it is entirely outside of it and 0 if it is partially inside and partially outside. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core21SubPixelCorrectedFlux8varianceERK8FluxPaird">
<span id="Core::SubPixelCorrectedFlux::variance__FluxPairCR.doubleC"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1ac266eaf98a8e4580c0561a6e8d57f46a"></span>double <code class="descname">variance</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N4Core8FluxPairE" title="Core::FluxPair">FluxPair</a> &amp;<em>fluxes</em>, double <em>measured_counts</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core21SubPixelCorrectedFlux8varianceERK8FluxPaird" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Estimate the variance based on the fluxes and measured counts. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core21SubPixelCorrectedFlux8in_imageEll">
<span id="Core::SubPixelCorrectedFlux::in_image__l.lC"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1a8c8ff99a5f11cfd137f266bff47ebc04"></span>bool <code class="descname">in_image</code><span class="sig-paren">(</span>long <em>x_i</em>, long <em>y_i</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core21SubPixelCorrectedFlux8in_imageEll" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return true iff the pixel with the given index is inside the image. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core21SubPixelCorrectedFlux19init_subpix_scalingEv">
<span id="Core::SubPixelCorrectedFlux::init_subpix_scaling"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1a6ed51618503e01b054d8fcec013c837e"></span>void <code class="descname">init_subpix_scaling</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core21SubPixelCorrectedFlux19init_subpix_scalingEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Make sure all members necessary to derive sub-pixel scaling matrices are properly initialized. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N4Core21SubPixelCorrectedFlux11__aperturesE">
<span id="Core::SubPixelCorrectedFlux::__apertures__std::list:double:"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1a3d9e99c1a21d197133ad2e4e5d2517a2"></span>std::list&lt;double&gt; <code class="descname">__apertures</code><a class="headerlink" href="#_CPPv2N4Core21SubPixelCorrectedFlux11__aperturesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The apertures over which to sum up the flux for each source. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core21SubPixelCorrectedFlux14__subpixel_mapE">
<span id="Core::SubPixelCorrectedFlux::__subpixel_map__SUBPIX_TYPECP"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1a5eb1402ba6dbb6d82c50729ef398a9de"></span><em class="property">const</em> SUBPIX_TYPE *<code class="descname">__subpixel_map</code><a class="headerlink" href="#_CPPv2N4Core21SubPixelCorrectedFlux14__subpixel_mapE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The subpixel sensitivity map, normalized to average to 1.0. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core21SubPixelCorrectedFlux7__imageE">
<span id="Core::SubPixelCorrectedFlux::__image__Core::Image:double:CP"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1a68a5e1bf6e82e39560c78b66632eb67d"></span><em class="property">const</em> <a class="reference internal" href="#_CPPv24Core" title="Core">Core</a>::<a class="reference internal" href="#_CPPv2N4Core5ImageE" title="Core::Image">Image</a>&lt;double&gt; *<code class="descname">__image</code><a class="headerlink" href="#_CPPv2N4Core21SubPixelCorrectedFlux7__imageE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The actual pixel values of the fits image. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core21SubPixelCorrectedFlux12__var_offsetE">
<span id="Core::SubPixelCorrectedFlux::__var_offset__double"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1a3677959c572d737ef9296977ceadc298"></span>double <code class="descname">__var_offset</code><a class="headerlink" href="#_CPPv2N4Core21SubPixelCorrectedFlux12__var_offsetE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constant variance to add to flux dependent variance. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core21SubPixelCorrectedFlux6__gainE">
<span id="Core::SubPixelCorrectedFlux::__gain__double"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1a85fea3e014f9cba4aa3d77a28d65c8d8"></span>double <code class="descname">__gain</code><a class="headerlink" href="#_CPPv2N4Core21SubPixelCorrectedFlux6__gainE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See gain argument to constructor. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core21SubPixelCorrectedFlux16__subpix_scalingE">
<span id="Core::SubPixelCorrectedFlux::__subpix_scaling__std::valarray:Eigen::MatrixXd:"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1a3970e8e495b25fae56688b0a6af28604"></span>std::valarray&lt;Eigen::MatrixXd&gt; <code class="descname">__subpix_scaling</code><a class="headerlink" href="#_CPPv2N4Core21SubPixelCorrectedFlux16__subpix_scalingE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A set of sub-pixel structure independent matrices (one for each aperture), which can be used to apply a different sub-pixel sensitivity map to a previously extracted source flux. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core21SubPixelCorrectedFlux13__scaling_indE">
<span id="Core::SubPixelCorrectedFlux::__scaling_ind__std::valarray:i:"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1aa3b6c77507de42b045b4b5d8f4eaa800"></span>std::valarray&lt;int&gt; <code class="descname">__scaling_ind</code><a class="headerlink" href="#_CPPv2N4Core21SubPixelCorrectedFlux13__scaling_indE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The index within __subpix_scaling which needs to be filled next. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core21SubPixelCorrectedFlux14__photon_noiseE">
<span id="Core::SubPixelCorrectedFlux::__photon_noise__b"></span><span class="target" id="classCore_1_1SubPixelCorrectedFlux_1a5d4097784c6499a564aaf9241bcb5940"></span>bool <code class="descname">__photon_noise</code><a class="headerlink" href="#_CPPv2N4Core21SubPixelCorrectedFlux14__photon_noiseE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Whether to assume the presence of Poisson noise in pixel fluxes (disabling is useful for tests). </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N4Core11SubPixelMapE">
<span id="Core::SubPixelMap"></span><span class="target" id="classCore_1_1SubPixelMap"></span><em class="property">class </em><code class="descname">SubPixelMap</code><a class="headerlink" href="#_CPPv2N4Core11SubPixelMapE" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;SubPixelMap.h&gt;</em><p>The base class for all sub-pixel maps. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv2N4Core11SubPixelMap11SubPixelMapERKNSt6stringE">
<span id="Core::SubPixelMap::SubPixelMap__ssCR"></span><span class="target" id="classCore_1_1SubPixelMap_1ad90d606874e53427227e1e2405b91ea9"></span><code class="descname">SubPixelMap</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core11SubPixelMap11SubPixelMapERKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a sub-pixel map (must call set_resolution and actually set sensitivities before use). </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">name</span></code>: See <a class="reference internal" href="#classCore_1_1SubPixelMap_1acf1b1e3e3013a7f398070287d5e9bfac"><span class="std std-ref">name()</span></a> </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core11SubPixelMap11SubPixelMapEjjRKNSt6stringE">
<span id="Core::SubPixelMap::SubPixelMap__unsigned.unsigned.ssCR"></span><span class="target" id="classCore_1_1SubPixelMap_1a85bccc4fb7176736ad4ef7dbf6a15c40"></span><code class="descname">SubPixelMap</code><span class="sig-paren">(</span>unsigned <em>x_res</em>, unsigned <em>y_res</em>, <em class="property">const</em> std::string &amp;<em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core11SubPixelMap11SubPixelMapEjjRKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a sub-pixel map with the given resolution (must set sensitivities before use). </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">x_res</span></code>: Resolution along x </li>
<li><code class="docutils literal"><span class="pre">y_res</span></code>: Resolution along y </li>
<li><code class="docutils literal"><span class="pre">name</span></code>: See <a class="reference internal" href="#classCore_1_1SubPixelMap_1acf1b1e3e3013a7f398070287d5e9bfac"><span class="std std-ref">name()</span></a> </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core11SubPixelMap11SubPixelMapEPdjj">
<span id="Core::SubPixelMap::SubPixelMap__doubleP.unsigned.unsigned"></span><span class="target" id="classCore_1_1SubPixelMap_1aba411eeed1e867a8bfbbb68f80af032c"></span><code class="descname">SubPixelMap</code><span class="sig-paren">(</span>double *<em>sensitivities</em>, unsigned <em>x_res</em>, unsigned <em>y_res</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core11SubPixelMap11SubPixelMapEPdjj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a sub-pixel map with the given resolution and sensitivities. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">sensitivities</span></code>: The sensitivities to set arranged with x varying faster than y. </li>
<li><code class="docutils literal"><span class="pre">x_res</span></code>: Resolution along x </li>
<li><code class="docutils literal"><span class="pre">y_res</span></code>: Resolution along y </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core11SubPixelMap14set_resolutionEjj">
<span id="Core::SubPixelMap::set_resolution__unsigned.unsigned"></span><span class="target" id="classCore_1_1SubPixelMap_1a2cd2e2e429d3931d9d0d99b0a08457fd"></span>void <code class="descname">set_resolution</code><span class="sig-paren">(</span>unsigned <em>x_res</em>, unsigned <em>y_res</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core11SubPixelMap14set_resolutionEjj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Sets the resolution of the sub-pixel map, losing previous content. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core11SubPixelMap12x_resolutionEv">
<span id="Core::SubPixelMap::x_resolutionC"></span><span class="target" id="classCore_1_1SubPixelMap_1a57e32a9428a64919c41bc76be4a8ab2b"></span>unsigned long <code class="descname">x_resolution</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core11SubPixelMap12x_resolutionEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the resolution of the map along the x direction. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core11SubPixelMap12y_resolutionEv">
<span id="Core::SubPixelMap::y_resolutionC"></span><span class="target" id="classCore_1_1SubPixelMap_1a26a38e2d40324b15abfb3e203c61fcb9"></span>unsigned long <code class="descname">y_resolution</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core11SubPixelMap12y_resolutionEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the resolution of the map along the x direction. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core11SubPixelMapclEmm">
<span id="Core::SubPixelMap::call-operator__unsigned-l.unsigned-l"></span><span class="target" id="classCore_1_1SubPixelMap_1ad9cceefbc046a0c96b26191ce69c9a5b"></span>double &amp;<code class="descname">operator()</code><span class="sig-paren">(</span>unsigned long <em>x</em>, unsigned long <em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core11SubPixelMapclEmm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns a modifiable reference to the sensitivity at the given sub-pixel. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core11SubPixelMapclEmm">
<span id="Core::SubPixelMap::call-operator__unsigned-l.unsigned-lC"></span><span class="target" id="classCore_1_1SubPixelMap_1a0d87309e608886d30a1e8f2635be9a7f"></span>double <code class="descname">operator()</code><span class="sig-paren">(</span>unsigned long <em>x</em>, unsigned long <em>y</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core11SubPixelMapclEmm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns a copy of the sensitivity at the given sub-pixel. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core11SubPixelMap4nameEv">
<span id="Core::SubPixelMap::name"></span><span class="target" id="classCore_1_1SubPixelMap_1acf1b1e3e3013a7f398070287d5e9bfac"></span><em class="property">const</em> std::string &amp;<code class="descname">name</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core11SubPixelMap4nameEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the name of the given sub-pixel map (as defined at construction). </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4Core11SubPixelMapaSERK11SubPixelMap">
<span id="Core::SubPixelMap::assign-operator__SubPixelMapCR"></span><span class="target" id="classCore_1_1SubPixelMap_1af8f158e9fdfcc0cb64c30173b3b130b0"></span><a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> &amp;<code class="descname">operator=</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv2N4Core11SubPixelMapE" title="Core::SubPixelMap">SubPixelMap</a> &amp;<em>RHS</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4Core11SubPixelMapaSERK11SubPixelMap" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Copy RHS to *this. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N11SubPixelMap12save_to_fitsERKNSt6stringE">
<span id="SubPixelMap::save_to_fits__ssCR"></span><span class="target" id="classCore_1_1SubPixelMap_1a2e6ce69023d40e566f5034ed0b7b824b"></span>void <code class="descname">save_to_fits</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N11SubPixelMap12save_to_fitsERKNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Saves the sub-pixel map to a FITS image with the given name. </p>
<p>Saves the sub-pixel map to a FITS image with the given name.</p>
<p>If a file with the given name already exists and the filename does not start with &#8216;!&#8217;, an exception is raised. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core11SubPixelMap3minEv">
<span id="Core::SubPixelMap::minC"></span><span class="target" id="classCore_1_1SubPixelMap_1a5b8a42948776225d229dfc9003b05816"></span>double <code class="descname">min</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core11SubPixelMap3minEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The minimum sensitivity in any part of the map. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2NK4Core11SubPixelMap3maxEv">
<span id="Core::SubPixelMap::maxC"></span><span class="target" id="classCore_1_1SubPixelMap_1a80d8d0dd57903573da1e23d5bb1fbc1c"></span>double <code class="descname">max</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv2NK4Core11SubPixelMap3maxEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The maximum sensitivity in any part of the map. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="member">
<dt id="_CPPv2N4Core11SubPixelMap15__sensitivitiesE">
<span id="Core::SubPixelMap::__sensitivities__std::valarray:double:"></span><span class="target" id="classCore_1_1SubPixelMap_1a394ebc2628c6a17ac3570b65f60d8917"></span>std::valarray&lt;double&gt; <code class="descname">__sensitivities</code><a class="headerlink" href="#_CPPv2N4Core11SubPixelMap15__sensitivitiesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The sensitivities of the sub-pixels making up the map, arranged with the x varying fast and y slow. </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core11SubPixelMap7__x_resE">
<span id="Core::SubPixelMap::__x_res__unsigned"></span><span class="target" id="classCore_1_1SubPixelMap_1a61505e689a369172f1713a14074d6815"></span>unsigned <code class="descname">__x_res</code><a class="headerlink" href="#_CPPv2N4Core11SubPixelMap7__x_resE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classCore_1_1SubPixelMap_1a57e32a9428a64919c41bc76be4a8ab2b"><span class="std std-ref">x_resolution()</span></a> </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core11SubPixelMap7__y_resE">
<span id="Core::SubPixelMap::__y_res__unsigned"></span><span class="target" id="classCore_1_1SubPixelMap_1a69c135b80bb7ea2a3607ebee94a468f7"></span>unsigned <code class="descname">__y_res</code><a class="headerlink" href="#_CPPv2N4Core11SubPixelMap7__y_resE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classCore_1_1SubPixelMap_1a57e32a9428a64919c41bc76be4a8ab2b"><span class="std std-ref">x_resolution()</span></a> </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4Core11SubPixelMap6__nameE">
<span id="Core::SubPixelMap::__name__ss"></span><span class="target" id="classCore_1_1SubPixelMap_1abbb2a1cf42e975242db37883937942f1"></span>std::string <code class="descname">__name</code><a class="headerlink" href="#_CPPv2N4Core11SubPixelMap6__nameE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>See <a class="reference internal" href="#classCore_1_1SubPixelMap_1acf1b1e3e3013a7f398070287d5e9bfac"><span class="std std-ref">name()</span></a> </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="c_api.html" class="btn btn-neutral float-right" title="C API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="_implementation/superphot.superphot_io_tree.html" class="btn btn-neutral" title="superphot.superphot_io_tree module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Kaloyan Penev.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>