<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>SuperPhot: FitPSF Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SuperPhot
   &#160;<span id="projectnumber">unspecified</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespaceFitPSF.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">FitPSF Namespace Reference<div class="ingroups"><a class="el" href="group__FitPSF.html">FitPSF</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitPSF_1_1AmplitudeSaturatedPixel.html">AmplitudeSaturatedPixel</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A structure to hold the information about saturated pixels.  <a href="classFitPSF_1_1AmplitudeSaturatedPixel.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitPSF_1_1Config.html">Config</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default configuration from file but overwritten by command line options.  <a href="classFitPSF_1_1Config.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitPSF_1_1Image.html">Image</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class for managing the selection of pixels for PSF/PRF fitting.  <a href="classFitPSF_1_1Image.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitPSF_1_1IOSources.html">IOSources</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parser for a single section of <a class="el" href="namespaceFitPSF.html">FitPSF</a> input source lists.  <a href="classFitPSF_1_1IOSources.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitPSF_1_1LinearSource.html">LinearSource</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class for <a class="el" href="namespacePSF.html">PSF</a> fitting sources whose flux distribution depends linearly on the <a class="el" href="namespacePSF.html">PSF</a> paramaters (for a fixed amplitude).  <a href="classFitPSF_1_1LinearSource.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitPSF_1_1OverlapGroup.html">OverlapGroup</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class representing a group of overlapping sources.  <a href="classFitPSF_1_1OverlapGroup.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitPSF_1_1OverlapSource.html">OverlapSource</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitPSF_1_1PiecewiseBicubicPSFSmoothing.html">PiecewiseBicubicPSFSmoothing</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitPSF_1_1Pixel.html">Pixel</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class tracking all pixel level informaiton for pixels participating in PSF/PRF fitting.  <a href="classFitPSF_1_1Pixel.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitPSF_1_1PixelOrder.html">PixelOrder</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classFitPSF_1_1Pixel.html" title="A class tracking all pixel level informaiton for pixels participating in PSF/PRF fitting. ">Pixel</a> comparison predicate.  <a href="classFitPSF_1_1PixelOrder.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitPSF_1_1PolynomialSDK.html">PolynomialSDK</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class that assumes the <a class="el" href="namespacePSF.html">PSF</a> on an image is described by an elliptical Gaussian, specified via the S, D, K parameters, and that those parameters are low order polynomials of the image position and fits for the coefficients of the polynomials.  <a href="classFitPSF_1_1PolynomialSDK.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitPSF_1_1SDKSource.html">SDKSource</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A <a class="el" href="namespacePSF.html">PSF</a> fitting source class based on a LocalPolynomialPSF.  <a href="classFitPSF_1_1SDKSource.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitPSF_1_1SDKSourceBase.html">SDKSourceBase</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">An abstract class that defines the minimum requirements of a source to participate in the fitting for an elliptical gaussian <a class="el" href="namespacePSF.html">PSF</a> model.  <a href="classFitPSF_1_1SDKSourceBase.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitPSF_1_1Source.html">Source</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">An abstract base class for sources which participate in <a class="el" href="namespacePSF.html">PSF</a> fitting.  <a href="classFitPSF_1_1Source.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a5432cdc9b255de958483cc386d5bba86"><td class="memItemLeft" align="right" valign="top">typedef std::list&lt; <a class="el" href="classFitPSF_1_1LinearSource.html">LinearSource</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a></td></tr>
<tr class="separator:a5432cdc9b255de958483cc386d5bba86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab82a21732b8a5824c90511e45a39c3b8"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#ab82a21732b8a5824c90511e45a39c3b8">GSLSubPixType</a></td></tr>
<tr class="separator:ab82a21732b8a5824c90511e45a39c3b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d5c7354049649ad113478e573eba88a"><td class="memItemLeft" align="right" valign="top">typedef std::list&lt; <a class="el" href="classFitPSF_1_1SDKSource.html">SDKSource</a>&lt; <a class="el" href="namespaceFitPSF.html#ab82a21732b8a5824c90511e45a39c3b8">GSLSubPixType</a> &gt; &gt;::iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a3d5c7354049649ad113478e573eba88a">GSLSourceIteratorType</a></td></tr>
<tr class="separator:a3d5c7354049649ad113478e573eba88a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5585e2324049472e68c6db7e176dc170"><td class="memItemLeft" align="right" valign="top">typedef std::list&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a5585e2324049472e68c6db7e176dc170">ColNameList</a></td></tr>
<tr class="separator:a5585e2324049472e68c6db7e176dc170"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfcf4eb2e56c5c1e97e8abe5d99c5d4e"><td class="memItemLeft" align="right" valign="top">typedef std::vector&lt; std::list&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#adfcf4eb2e56c5c1e97e8abe5d99c5d4e">ColumnData</a></td></tr>
<tr class="separator:adfcf4eb2e56c5c1e97e8abe5d99c5d4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a737ed22b4857eb6931cff820c0f5dc2b"><td class="memItemLeft" align="right" valign="top">LIB_LOCAL std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a737ed22b4857eb6931cff820c0f5dc2b">operator&lt;&lt;</a> (std::ostream &amp;os, const SourceDropReason &amp;reason)</td></tr>
<tr class="memdesc:a737ed22b4857eb6931cff820c0f5dc2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Human readable output of the reasons to drop sources.  <a href="#a737ed22b4857eb6931cff820c0f5dc2b">More...</a><br /></td></tr>
<tr class="separator:a737ed22b4857eb6931cff820c0f5dc2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a106dbfe56aa4178bc327d5d7273cab23"><td class="memTemplParams" colspan="2">template&lt;class SOURCE_TYPE &gt; </td></tr>
<tr class="memitem:a106dbfe56aa4178bc327d5d7273cab23"><td class="memTemplItemLeft" align="right" valign="top">LIB_LOCAL void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a106dbfe56aa4178bc327d5d7273cab23">check_fit_source</a> (SOURCE_TYPE &amp;last_source, const <a class="el" href="classBackground_1_1Source.html">Background::Source</a> &amp;srcbg, double max_saturated_fraction, unsigned min_pixels_per_source, unsigned max_pixels_per_source, double max_circular_aperture, unsigned min_bg_pixels, bool ignore_overlaps)</td></tr>
<tr class="memdesc:a106dbfe56aa4178bc327d5d7273cab23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks of whether a source should be used for <a class="el" href="namespacePSF.html">PSF</a> fitting.  <a href="#a106dbfe56aa4178bc327d5d7273cab23">More...</a><br /></td></tr>
<tr class="separator:a106dbfe56aa4178bc327d5d7273cab23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2d0af7a946074687817444ab22c6330"><td class="memTemplParams" colspan="2">template&lt;class FIT_SOURCE_TYPE &gt; </td></tr>
<tr class="memitem:aa2d0af7a946074687817444ab22c6330"><td class="memTemplItemLeft" align="right" valign="top">LIB_LOCAL void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#aa2d0af7a946074687817444ab22c6330">drop_unsuitable_fit_sources</a> (std::list&lt; FIT_SOURCE_TYPE * &gt; &amp;psf_fit_sources, typename std::list&lt; FIT_SOURCE_TYPE * &gt;::iterator check_start, std::list&lt; FIT_SOURCE_TYPE * &gt; &amp;dropped_sources, unsigned drop_statistics[])</td></tr>
<tr class="memdesc:aa2d0af7a946074687817444ab22c6330"><td class="mdescLeft">&#160;</td><td class="mdescRight">Actually discard sources flagged as unsuitable during pixel selection.  <a href="#aa2d0af7a946074687817444ab22c6330">More...</a><br /></td></tr>
<tr class="separator:aa2d0af7a946074687817444ab22c6330"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93d32d30b1b788f8c3defccfbe70032b"><td class="memTemplParams" colspan="2">template&lt;class FIT_SOURCE_TYPE &gt; </td></tr>
<tr class="memitem:a93d32d30b1b788f8c3defccfbe70032b"><td class="memTemplItemLeft" align="right" valign="top">LIB_LOCAL void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a93d32d30b1b788f8c3defccfbe70032b">trim_fit_sources</a> (std::list&lt; FIT_SOURCE_TYPE * &gt; &amp;psf_fit_sources, unsigned max_sources, std::list&lt; FIT_SOURCE_TYPE * &gt; &amp;dropped_sources)</td></tr>
<tr class="memdesc:a93d32d30b1b788f8c3defccfbe70032b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drop excess sources from <a class="el" href="namespacePSF.html">PSF</a> shape fitting.  <a href="#a93d32d30b1b788f8c3defccfbe70032b">More...</a><br /></td></tr>
<tr class="separator:a93d32d30b1b788f8c3defccfbe70032b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc0f40a5121c84f39e61977a3775f8eb"><td class="memItemLeft" align="right" valign="top">LIB_LOCAL void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#afc0f40a5121c84f39e61977a3775f8eb">add_new_source</a> (<a class="el" href="classFitPSF_1_1Image.html">Image</a>&lt; <a class="el" href="classFitPSF_1_1LinearSource.html">LinearSource</a> &gt; &amp;image, const <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> *subpix_map, const <a class="el" href="classPSF_1_1PiecewiseBicubic.html">PSF::PiecewiseBicubic</a> &amp;psf, double alpha, double max_circular_aperture, const std::string &amp;output_fname, bool cover_psf, const <a class="el" href="classCore_1_1SourceLocation.html">Core::SourceLocation</a> &amp;location, const <a class="el" href="classBackground_1_1Source.html">Background::Source</a> &amp;srcbg, size_t source_assignment_id, <a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;destination)</td></tr>
<tr class="memdesc:afc0f40a5121c84f39e61977a3775f8eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a newly constructed PiecewiseBidcubic source to a list.  <a href="#afc0f40a5121c84f39e61977a3775f8eb">More...</a><br /></td></tr>
<tr class="separator:afc0f40a5121c84f39e61977a3775f8eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8b7c93401ce2682aed24ec91179779f"><td class="memTemplParams" colspan="2">template&lt;class FIT_SOURCE_TYPE , class PSF_TYPE &gt; </td></tr>
<tr class="memitem:ab8b7c93401ce2682aed24ec91179779f"><td class="memTemplItemLeft" align="right" valign="top">LIB_PUBLIC void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#ab8b7c93401ce2682aed24ec91179779f">get_fit_sources</a> (<a class="el" href="classFitPSF_1_1Image.html">Image</a>&lt; FIT_SOURCE_TYPE &gt; &amp;image, const <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> *subpix_map, const std::list&lt; <a class="el" href="classCore_1_1SourceLocation.html">Core::SourceLocation</a> &gt; &amp;source_locations, const PSF_TYPE &amp;psf, double alpha, double max_saturated_fraction, unsigned min_pixels_per_source, unsigned max_pixels_per_source, <a class="el" href="classBackground_1_1Measure.html">Background::Measure</a> &amp;<a class="el" href="PhotColumns_8h.html#a5fef7fc88df7ec49fc9494801ceb0faa">bg</a>, unsigned min_bg_pixels, unsigned max_sources, double max_circular_aperture, const std::string &amp;output_fname, std::list&lt; FIT_SOURCE_TYPE * &gt; &amp;psf_fit_sources, std::list&lt; FIT_SOURCE_TYPE * &gt; &amp;dropped_sources, bool cover_psf=false, bool do_not_drop=false, bool ignore_overlaps=true)</td></tr>
<tr class="memdesc:ab8b7c93401ce2682aed24ec91179779f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Select the sources to use for <a class="el" href="namespacePSF.html">PSF</a> fitting.  <a href="#ab8b7c93401ce2682aed24ec91179779f">More...</a><br /></td></tr>
<tr class="separator:ab8b7c93401ce2682aed24ec91179779f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0ecc69b98e2a83e5b332087ce61e330"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#af0ecc69b98e2a83e5b332087ce61e330">background_excess</a> (double value, double variance, double background_value, double background_variance)</td></tr>
<tr class="memdesc:af0ecc69b98e2a83e5b332087ce61e330"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the square of the signal to noise ratio with which a pixel sticks above a background.  <a href="#af0ecc69b98e2a83e5b332087ce61e330">More...</a><br /></td></tr>
<tr class="separator:af0ecc69b98e2a83e5b332087ce61e330"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27053c460716537f17f695d9ddcea75c"><td class="memTemplParams" colspan="2">template&lt;class SOURCE_TYPE &gt; </td></tr>
<tr class="memitem:a27053c460716537f17f695d9ddcea75c"><td class="memTemplItemLeft" align="right" valign="top">double&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a27053c460716537f17f695d9ddcea75c">background_excess</a> (const <a class="el" href="classFitPSF_1_1Pixel.html">Pixel</a>&lt; SOURCE_TYPE &gt; &amp;pixel, double background_value, double background_variance)</td></tr>
<tr class="memdesc:a27053c460716537f17f695d9ddcea75c"><td class="mdescLeft">&#160;</td><td class="mdescRight">See background_excess(double, double, dobule, double).  <a href="#a27053c460716537f17f695d9ddcea75c">More...</a><br /></td></tr>
<tr class="separator:a27053c460716537f17f695d9ddcea75c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89f6d40590aea942bda9e90f4a45e29e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a89f6d40590aea942bda9e90f4a45e29e">background_excess</a> (double value, double variance, const <a class="el" href="classBackground_1_1Source.html">Background::Source</a> &amp;background_adu, double gain)</td></tr>
<tr class="memdesc:a89f6d40590aea942bda9e90f4a45e29e"><td class="mdescLeft">&#160;</td><td class="mdescRight">See <a class="el" href="namespaceFitPSF.html#af0ecc69b98e2a83e5b332087ce61e330" title="Return the square of the signal to noise ratio with which a pixel sticks above a background. ">background_excess(double, double, double, double)</a>  <a href="#a89f6d40590aea942bda9e90f4a45e29e">More...</a><br /></td></tr>
<tr class="separator:a89f6d40590aea942bda9e90f4a45e29e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90d8894eaa153ebbde3d3b48fad282d0"><td class="memTemplParams" colspan="2">template&lt;class SOURCE_TYPE &gt; </td></tr>
<tr class="memitem:a90d8894eaa153ebbde3d3b48fad282d0"><td class="memTemplItemLeft" align="right" valign="top">double&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a90d8894eaa153ebbde3d3b48fad282d0">background_excess</a> (const <a class="el" href="classFitPSF_1_1Pixel.html">Pixel</a>&lt; SOURCE_TYPE &gt; &amp;pixel, const <a class="el" href="classBackground_1_1Source.html">Background::Source</a> &amp;background, double gain)</td></tr>
<tr class="memdesc:a90d8894eaa153ebbde3d3b48fad282d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">See <a class="el" href="namespaceFitPSF.html#af0ecc69b98e2a83e5b332087ce61e330" title="Return the square of the signal to noise ratio with which a pixel sticks above a background. ">background_excess(double, double, double, double)</a>.  <a href="#a90d8894eaa153ebbde3d3b48fad282d0">More...</a><br /></td></tr>
<tr class="separator:a90d8894eaa153ebbde3d3b48fad282d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ade9bac2b156b8c523cb0d9d13ff80f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a1ade9bac2b156b8c523cb0d9d13ff80f">split_second_deriv</a> (PSF::SDKDerivative second, PSF::SDKDerivative &amp;deriv1, PSF::SDKDerivative &amp;deriv2)</td></tr>
<tr class="memdesc:a1ade9bac2b156b8c523cb0d9d13ff80f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes a second derivative and returns the two first order derivatives which it is composed of (e.g. PSF::SS_DERIV -&gt; PSF::S_DERIV, PSF::S_DERIV). If deriv is not a second derivative, the behaviour is undefined.  <a href="#a1ade9bac2b156b8c523cb0d9d13ff80f">More...</a><br /></td></tr>
<tr class="separator:a1ade9bac2b156b8c523cb0d9d13ff80f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd017ede8a4dcbb302e8148554fd1d4b"><td class="memTemplParams" colspan="2">template&lt;class SOURCE_TYPE , class PSF_TYPE &gt; </td></tr>
<tr class="memitem:afd017ede8a4dcbb302e8148554fd1d4b"><td class="memTemplItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#afd017ede8a4dcbb302e8148554fd1d4b">operator&lt;&lt;</a> (std::ostream &amp;os, const <a class="el" href="classFitPSF_1_1OverlapGroup.html">OverlapGroup</a>&lt; SOURCE_TYPE, PSF_TYPE &gt; &amp;group)</td></tr>
<tr class="separator:afd017ede8a4dcbb302e8148554fd1d4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5548fb9dab21dc33860bad83a56272dc"><td class="memTemplParams" colspan="2">template&lt;class SOURCE_TYPE , class PSF_TYPE &gt; </td></tr>
<tr class="memitem:a5548fb9dab21dc33860bad83a56272dc"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a5548fb9dab21dc33860bad83a56272dc">find_overlap_groups</a> (std::list&lt; SOURCE_TYPE * &gt; &amp;fit_sources, std::list&lt; SOURCE_TYPE * &gt; &amp;dropped_sources, std::list&lt; <a class="el" href="classFitPSF_1_1OverlapGroup.html">OverlapGroup</a>&lt; SOURCE_TYPE, PSF_TYPE &gt; &gt; &amp;overlap_groups)</td></tr>
<tr class="memdesc:a5548fb9dab21dc33860bad83a56272dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds groups of overlapping sources among the given source list.  <a href="#a5548fb9dab21dc33860bad83a56272dc">More...</a><br /></td></tr>
<tr class="separator:a5548fb9dab21dc33860bad83a56272dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aa574012af467b4a2c111efaadacefb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a1aa574012af467b4a2c111efaadacefb">fill_valarray_from_list</a> (const std::list&lt; double &gt; &amp;from, std::valarray&lt; double &gt; &amp;to)</td></tr>
<tr class="separator:a1aa574012af467b4a2c111efaadacefb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0651e86af04c1c22e86d6129fbaf308d"><td class="memTemplParams" colspan="2">template&lt;class SOURCE_ITERATOR &gt; </td></tr>
<tr class="memitem:a0651e86af04c1c22e86d6129fbaf308d"><td class="memTemplItemLeft" align="right" valign="top">double LIB_LOCAL&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a0651e86af04c1c22e86d6129fbaf308d">calculate_chi2</a> (SOURCE_ITERATOR first_source, SOURCE_ITERATOR past_last_source, double max_source_chi2=<a class="el" href="namespaceCore.html#a3493861442e085ee2c913c13bf52a44a">Core::Inf</a>)</td></tr>
<tr class="memdesc:a0651e86af04c1c22e86d6129fbaf308d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <img class="formulaInl" alt="$\chi^2$" src="form_0.png"/> that corresponds to a sequence of sources.  <a href="#a0651e86af04c1c22e86d6129fbaf308d">More...</a><br /></td></tr>
<tr class="separator:a0651e86af04c1c22e86d6129fbaf308d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96adf1649b49921286d322a27b7b7503"><td class="memItemLeft" align="right" valign="top">LIB_LOCAL double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a96adf1649b49921286d322a27b7b7503">gsl_minimization_function</a> (const gsl_vector *poly_coef, void *params)</td></tr>
<tr class="memdesc:a96adf1649b49921286d322a27b7b7503"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function to pass to the GSL simplex minimizer, forced to assume SOURCE_ITERATOR = GSLSourceIteratorType and SUBPIX_TYPE = GSLSubPixType.  <a href="#a96adf1649b49921286d322a27b7b7503">More...</a><br /></td></tr>
<tr class="separator:a96adf1649b49921286d322a27b7b7503"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f59bbe1dfe643f0483a3cb9398215de"><td class="memItemLeft" align="right" valign="top">LIB_LOCAL double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a3f59bbe1dfe643f0483a3cb9398215de">gsl_s_minimization_function</a> (double s, void *params)</td></tr>
<tr class="memdesc:a3f59bbe1dfe643f0483a3cb9398215de"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function to pass to the GSL brent minimizer for finding an initial frame S.  <a href="#a3f59bbe1dfe643f0483a3cb9398215de">More...</a><br /></td></tr>
<tr class="separator:a3f59bbe1dfe643f0483a3cb9398215de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c704565c27365048e07e7b0f512b7cb"><td class="memTemplParams" colspan="2">template&lt;class SourceIterator &gt; </td></tr>
<tr class="memitem:a2c704565c27365048e07e7b0f512b7cb"><td class="memTemplItemLeft" align="right" valign="top">double&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a2c704565c27365048e07e7b0f512b7cb">calculate_chi2</a> (SourceIterator first_source, SourceIterator past_last_source, double max_source_chi2)</td></tr>
<tr class="separator:a2c704565c27365048e07e7b0f512b7cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa97cde81a2041ea839314183cf93bf7d"><td class="memTemplParams" colspan="2">template&lt;class SOURCE_TYPE &gt; </td></tr>
<tr class="memitem:aa97cde81a2041ea839314183cf93bf7d"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#aa97cde81a2041ea839314183cf93bf7d">compare_source_assignment_ids</a> (const SOURCE_TYPE *s1, const SOURCE_TYPE *s2)</td></tr>
<tr class="memdesc:aa97cde81a2041ea839314183cf93bf7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fit the <a class="el" href="namespacePSF.html">PSF</a> of all sources simultaneously assuming smooth variation with position.  <a href="#aa97cde81a2041ea839314183cf93bf7d">More...</a><br /></td></tr>
<tr class="separator:aa97cde81a2041ea839314183cf93bf7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48a7978e311520cf43573b3ef5ec74c1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a48a7978e311520cf43573b3ef5ec74c1">sourceid_not_hat</a> (const <a class="el" href="classCore_1_1SourceLocation.html">Core::SourceLocation</a> *source)</td></tr>
<tr class="separator:a48a7978e311520cf43573b3ef5ec74c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dad75399f74c0531081f9c4a039dca5"><td class="memTemplParams" colspan="2">template&lt;class SOURCE_LIST_TYPE &gt; </td></tr>
<tr class="memitem:a1dad75399f74c0531081f9c4a039dca5"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a1dad75399f74c0531081f9c4a039dca5">fill_output_data_tree_common</a> (const SOURCE_LIST_TYPE &amp;fit_result, <a class="el" href="classIO_1_1H5IODataTree.html">IO::H5IODataTree</a> &amp;output_data_tree, double mag_1adu)</td></tr>
<tr class="memdesc:a1dad75399f74c0531081f9c4a039dca5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates an output data tree with information common to all <a class="el" href="namespacePSF.html">PSF</a> models.  <a href="#a1dad75399f74c0531081f9c4a039dca5">More...</a><br /></td></tr>
<tr class="separator:a1dad75399f74c0531081f9c4a039dca5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92c5963b9d3a86d31bd81f0e8355d9b4"><td class="memTemplParams" colspan="2">template&lt;class SOURCE_LIST_TYPE &gt; </td></tr>
<tr class="memitem:a92c5963b9d3a86d31bd81f0e8355d9b4"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a92c5963b9d3a86d31bd81f0e8355d9b4">add_expansion_terms</a> (const <a class="el" href="classFitPSF_1_1IOSources.html">FitPSF::IOSources</a> &amp;source_list, const std::string &amp;expansion_term_expression, SOURCE_LIST_TYPE &amp;fit_sources, SOURCE_LIST_TYPE &amp;dropped_sources)</td></tr>
<tr class="memdesc:a92c5963b9d3a86d31bd81f0e8355d9b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fills an output data tree from SDK fit sources.  <a href="#a92c5963b9d3a86d31bd81f0e8355d9b4">More...</a><br /></td></tr>
<tr class="separator:a92c5963b9d3a86d31bd81f0e8355d9b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab03b5f6a1f749a49d75f77d159e0d612"><td class="memTemplParams" colspan="2">template&lt;class FIT_SOURCE_TYPE , class PSF_TYPE &gt; </td></tr>
<tr class="memitem:ab03b5f6a1f749a49d75f77d159e0d612"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#ab03b5f6a1f749a49d75f77d159e0d612">get_section_fit_sources</a> (<a class="el" href="classFitPSF_1_1Image.html">FitPSF::Image</a>&lt; FIT_SOURCE_TYPE &gt; &amp;image, const <a class="el" href="classFitPSF_1_1Config.html">FitPSF::Config</a> &amp;options, const <a class="el" href="classFitPSF_1_1IOSources.html">FitPSF::IOSources</a> &amp;source_list, const <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> &amp;subpix_map, const PSF_TYPE &amp;psf, std::list&lt; FIT_SOURCE_TYPE * &gt; &amp;fit_sources, std::list&lt; FIT_SOURCE_TYPE * &gt; &amp;dropped_sources)</td></tr>
<tr class="memdesc:ab03b5f6a1f749a49d75f77d159e0d612"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the source to use for <a class="el" href="namespacePSF.html">PSF</a> fitting for a single input image.  <a href="#ab03b5f6a1f749a49d75f77d159e0d612">More...</a><br /></td></tr>
<tr class="separator:ab03b5f6a1f749a49d75f77d159e0d612"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3308eeb8fd5174b7846d405bf6d80185"><td class="memTemplParams" colspan="2">template&lt;class FIT_SOURCE_TYPE , class PSF_TYPE &gt; </td></tr>
<tr class="memitem:a3308eeb8fd5174b7846d405bf6d80185"><td class="memTemplItemLeft" align="right" valign="top">std::list&lt; <a class="el" href="classFitPSF_1_1Image.html">FitPSF::Image</a>&lt; FIT_SOURCE_TYPE &gt; * &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a3308eeb8fd5174b7846d405bf6d80185">prepare_fit_sources</a> (const <a class="el" href="classFitPSF_1_1Config.html">FitPSF::Config</a> &amp;options, std::list&lt; FIT_SOURCE_TYPE * &gt; &amp;fit_sources, std::list&lt; FIT_SOURCE_TYPE * &gt; &amp;dropped_sources, unsigned &amp;x_resolution, unsigned &amp;y_resolution, const <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> &amp;subpix_map, const PSF_TYPE &amp;psf, <a class="el" href="classIO_1_1H5IODataTree.html">IO::H5IODataTree</a> &amp;output_data_tree)</td></tr>
<tr class="memdesc:a3308eeb8fd5174b7846d405bf6d80185"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the sources on which <a class="el" href="namespacePSF.html">PSF</a> fitting will be performed.  <a href="#a3308eeb8fd5174b7846d405bf6d80185">More...</a><br /></td></tr>
<tr class="separator:a3308eeb8fd5174b7846d405bf6d80185"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07c066dbcc5f3aabaec488b1dfc0b243"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a07c066dbcc5f3aabaec488b1dfc0b243">zero_fit</a> (const <a class="el" href="classFitPSF_1_1Config.html">FitPSF::Config</a> &amp;options, const <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> &amp;subpix_map, <a class="el" href="classIO_1_1H5IODataTree.html">IO::H5IODataTree</a> &amp;output_data_tree)</td></tr>
<tr class="memdesc:a07c066dbcc5f3aabaec488b1dfc0b243"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does not actually fit for the <a class="el" href="namespacePSF.html">PSF</a> but sets up a constant one.  <a href="#a07c066dbcc5f3aabaec488b1dfc0b243">More...</a><br /></td></tr>
<tr class="separator:a07c066dbcc5f3aabaec488b1dfc0b243"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6f4080f1716e09ba6ac66748804694c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#af6f4080f1716e09ba6ac66748804694c">piecewise_bicubic_fit</a> (const <a class="el" href="classFitPSF_1_1Config.html">FitPSF::Config</a> &amp;options, const <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> &amp;subpix_map, <a class="el" href="classIO_1_1H5IODataTree.html">IO::H5IODataTree</a> &amp;output_data_tree)</td></tr>
<tr class="memdesc:af6f4080f1716e09ba6ac66748804694c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fit an elliptical gaussian <a class="el" href="namespacePSF.html">PSF</a> model according to the command line options.  <a href="#af6f4080f1716e09ba6ac66748804694c">More...</a><br /></td></tr>
<tr class="separator:af6f4080f1716e09ba6ac66748804694c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6baa6774c390331c465aface822a97d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a6baa6774c390331c465aface822a97d2">fill_subpix_map</a> (const <a class="el" href="classFitPSF_1_1Config.html">FitPSF::Config</a> &amp;options, <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> &amp;subpix_map)</td></tr>
<tr class="memdesc:a6baa6774c390331c465aface822a97d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fills the sub-pixel map to use for <a class="el" href="namespacePSF.html">PSF</a> fitting.  <a href="#a6baa6774c390331c465aface822a97d2">More...</a><br /></td></tr>
<tr class="separator:a6baa6774c390331c465aface822a97d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2e634ae30775bc4d021a6c0763d9d23"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#af2e634ae30775bc4d021a6c0763d9d23">output</a> (const <a class="el" href="classIO_1_1H5IODataTree.html">IO::H5IODataTree</a> &amp;output_data_tree)</td></tr>
<tr class="separator:af2e634ae30775bc4d021a6c0763d9d23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87e185ed617d2648d7a1dcdfc2b3ae2f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a87e185ed617d2648d7a1dcdfc2b3ae2f">time_this</a> (const std::string=&quot;&quot;)</td></tr>
<tr class="separator:a87e185ed617d2648d7a1dcdfc2b3ae2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a062f745b675e9335e22b3382e42ab7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a7a062f745b675e9335e22b3382e42ab7">fill_parameter_sets</a> (const std::vector&lt; double &gt; &amp;x_grid, const std::vector&lt; double &gt; &amp;y_grid, std::vector&lt; std::valarray&lt; double &gt; &gt; &amp;parameter_sets)</td></tr>
<tr class="separator:a7a062f745b675e9335e22b3382e42ab7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6d6f675c42304b4f29c992d7931db7e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#ac6d6f675c42304b4f29c992d7931db7e">select_basis_vectors</a> (const std::vector&lt; std::valarray&lt; double &gt; &gt; &amp;parameter_sets, const <a class="el" href="classPSF_1_1PiecewiseBicubic.html">PSF::PiecewiseBicubic</a> &amp;psf, Eigen::MatrixXd &amp;basis)</td></tr>
<tr class="separator:ac6d6f675c42304b4f29c992d7931db7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e92ac9b9868ace721ba3d7036f300a6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a2e92ac9b9868ace721ba3d7036f300a6">fill_basis_parameter_sets</a> (const std::vector&lt; std::valarray&lt; double &gt; &gt; &amp;parameter_sets, Eigen::MatrixXd &amp;basis, std::vector&lt; std::valarray&lt; double &gt; &gt; &amp;basis_parameter_sets)</td></tr>
<tr class="separator:a2e92ac9b9868ace721ba3d7036f300a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0ae581b7498385b4fb9af2533fa8e38"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#ad0ae581b7498385b4fb9af2533fa8e38">prepare_linear_regression</a> (<a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;fit_sources, <a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;dropped_sources, const std::vector&lt; std::valarray&lt; double &gt; &gt; &amp;basis_parameter_sets, Eigen::VectorXd &amp;pixel_excesses, Eigen::MatrixXd &amp;pixel_integral_matrix, Eigen::VectorXd &amp;rhs_offset, Eigen::MatrixXd &amp;symmetrized_pix_integral_matrix, Eigen::VectorXd &amp;modified_pixel_excesses, Eigen::VectorXd &amp;modified_rhs_offset)</td></tr>
<tr class="separator:ad0ae581b7498385b4fb9af2533fa8e38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9859ecb79a38ac8f4d34f970d969e582"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a9859ecb79a38ac8f4d34f970d969e582">fill_poly_coef_matrix</a> (const <a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;fit_sources, Eigen::MatrixXd &amp;poly_coef_matrix)</td></tr>
<tr class="separator:a9859ecb79a38ac8f4d34f970d969e582"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a511e38793bcbb76ae9169e68c4b6fe28"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a511e38793bcbb76ae9169e68c4b6fe28">fill_matrix_to_invert</a> (const <a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;fit_sources, const Eigen::MatrixXd &amp;symmetrized_pix_integral_matrix, const Eigen::MatrixXd &amp;poly_coef_matrix, Eigen::MatrixXd &amp;matrix_to_invert)</td></tr>
<tr class="separator:a511e38793bcbb76ae9169e68c4b6fe28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb89760d4d1bd6820c36cc689e1ff9ba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#afb89760d4d1bd6820c36cc689e1ff9ba">fill_flux_scaled_modified_rhs</a> (const <a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;fit_sources, const Eigen::VectorXd &amp;modified_pixel_excesses, const Eigen::VectorXd &amp;modified_rhs_offset, Eigen::VectorXd &amp;flux_scaled_modified_rhs)</td></tr>
<tr class="separator:afb89760d4d1bd6820c36cc689e1ff9ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2e42c5b5ff1a7c36e795b2242dd6807"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#af2e42c5b5ff1a7c36e795b2242dd6807">estimate_initial_amplitudes</a> (<a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;fit_sources, double gain)</td></tr>
<tr class="separator:af2e42c5b5ff1a7c36e795b2242dd6807"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bf42ddc644cbcc55c500d743a70faaa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a0bf42ddc644cbcc55c500d743a70faaa">estimate_initial_amplitudes</a> (<a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;fit_sources, OverlapGroupList &amp;overlap_groups, const <a class="el" href="classPSF_1_1PiecewiseBicubicMap.html">PSF::PiecewiseBicubicMap</a> &amp;psf_map)</td></tr>
<tr class="memdesc:a0bf42ddc644cbcc55c500d743a70faaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use the given <a class="el" href="namespacePSF.html">PSF</a> map to estimate initial fluxes for the sources.  <a href="#a0bf42ddc644cbcc55c500d743a70faaa">More...</a><br /></td></tr>
<tr class="separator:a0bf42ddc644cbcc55c500d743a70faaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d904a383fb6d35de62d39883c1bccab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a9d904a383fb6d35de62d39883c1bccab">estimate_initial_amplitudes</a> (<a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;fit_sources, const <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> &amp;subpix_map, const <a class="el" href="classCore_1_1Image.html">Core::Image</a>&lt; double &gt; &amp;observed_image, double gain, double aperture)</td></tr>
<tr class="separator:a9d904a383fb6d35de62d39883c1bccab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1b981e70ab8623bff27f8fff1b482be"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#af1b981e70ab8623bff27f8fff1b482be">update_fluxes</a> (<a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;fit_sources, OverlapGroupList &amp;overlap_groups, const Eigen::VectorXd &amp;best_fit)</td></tr>
<tr class="separator:af1b981e70ab8623bff27f8fff1b482be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89390a0e2ecfbbe9438a8d182c6fca4d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a89390a0e2ecfbbe9438a8d182c6fca4d">fit_piecewise_bicubic_psf_step</a> (<a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;fit_sources, OverlapGroupList &amp;overlap_groups, const Eigen::MatrixXd &amp;symmetrized_pix_integral_matrix, const Eigen::MatrixXd &amp;poly_coef_matrix, const Eigen::VectorXd &amp;modified_pixel_excesses, const Eigen::VectorXd &amp;modified_rhs_offset, const <a class="el" href="classFitPSF_1_1PiecewiseBicubicPSFSmoothing.html">PiecewiseBicubicPSFSmoothing</a> &amp;smoothing, Eigen::VectorXd &amp;best_fit)</td></tr>
<tr class="separator:a89390a0e2ecfbbe9438a8d182c6fca4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93bf63d0d8e13ea15d918206170fe40f"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a93bf63d0d8e13ea15d918206170fe40f">count_pixels</a> (const <a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;fit_sources, size_t *max_source_pixels)</td></tr>
<tr class="separator:a93bf63d0d8e13ea15d918206170fe40f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9b8be19532f89b97362b0ff8cc1ce96"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#ad9b8be19532f89b97362b0ff8cc1ce96">discard_outlier_pixels</a> (<a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;fit_sources, const Eigen::MatrixXd &amp;pixel_integral_matrix, const Eigen::VectorXd &amp;pixel_excesses, const Eigen::VectorXd &amp;rhs_offset, double max_residual, const Eigen::VectorXd &amp;best_fit)</td></tr>
<tr class="memdesc:ad9b8be19532f89b97362b0ff8cc1ce96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Discards pixels with too large residuals after the last <a class="el" href="namespacePSF.html">PSF</a> fit.  <a href="#ad9b8be19532f89b97362b0ff8cc1ce96">More...</a><br /></td></tr>
<tr class="separator:ad9b8be19532f89b97362b0ff8cc1ce96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91af761d270a247a93d51ed94cbc7c38"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a91af761d270a247a93d51ed94cbc7c38">discard_sources</a> (<a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;fit_sources, double max_chi2, bool discard_by_chi2, <a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;dropped_sources)</td></tr>
<tr class="memdesc:a91af761d270a247a93d51ed94cbc7c38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Discards sources unsuitable for fitting.  <a href="#a91af761d270a247a93d51ed94cbc7c38">More...</a><br /></td></tr>
<tr class="separator:a91af761d270a247a93d51ed94cbc7c38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa849194c7af21245496723061678a40"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#afa849194c7af21245496723061678a40">discard_zero_flux_pixels</a> (<a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;fit_sources, const <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> &amp;subpix_map, const <a class="el" href="classPSF_1_1PiecewiseBicubic.html">PSF::PiecewiseBicubic</a> &amp;psf)</td></tr>
<tr class="memdesc:afa849194c7af21245496723061678a40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Discards pixels whose overlap with the <a class="el" href="namespacePSF.html">PSF</a> domain has zero sub-pixel sensitivity.  <a href="#afa849194c7af21245496723061678a40">More...</a><br /></td></tr>
<tr class="separator:afa849194c7af21245496723061678a40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a878eba39338b4d82656546daf36ec835"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a878eba39338b4d82656546daf36ec835">transform_best_fit_to_direct_parameters</a> (const Eigen::MatrixXd &amp;basis, Eigen::VectorXd &amp;best_fit_poly_coef)</td></tr>
<tr class="separator:a878eba39338b4d82656546daf36ec835"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5141488c910279d60ad23a02ade44c76"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a5141488c910279d60ad23a02ade44c76">convert_flux_to_adu</a> (<a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;sources, double gain)</td></tr>
<tr class="separator:a5141488c910279d60ad23a02ade44c76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bc2dd51f12b4325651053a096fd42a1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a6bc2dd51f12b4325651053a096fd42a1">fit_piecewise_bicubic_psf</a> (<a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;fit_sources, OverlapGroupList &amp;overlap_groups, <a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;dropped_sources, const std::vector&lt; double &gt; &amp;x_grid, const std::vector&lt; double &gt; &amp;y_grid, const <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> &amp;subpix_map, double max_abs_amplitude_change, double max_rel_amplitude_change, double max_chi2, double pixel_rejection, double min_convergence_rate, int max_iterations, double smoothing_penalty, Eigen::VectorXd &amp;best_fit_poly_coef, double gain)</td></tr>
<tr class="memdesc:a6bc2dd51f12b4325651053a096fd42a1"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="namespacePSF.html">PSF</a> fitting, but assumed that sources have their initial amplitudes set.  <a href="#a6bc2dd51f12b4325651053a096fd42a1">More...</a><br /></td></tr>
<tr class="separator:a6bc2dd51f12b4325651053a096fd42a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d65b65c032e461478c899c4ccaabbb8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a6d65b65c032e461478c899c4ccaabbb8">fit_piecewise_bicubic_psf</a> (<a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;fit_sources, <a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;dropped_sources, double gain, const std::vector&lt; double &gt; &amp;x_grid, const std::vector&lt; double &gt; &amp;y_grid, const <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> &amp;subpix_map, double max_abs_amplitude_change, double max_rel_amplitude_change, double max_chi2, double pixel_rejection, double min_convergence_rate, int max_iterations, double smoothing_penalty, Eigen::VectorXd &amp;best_fit_poly_coef)</td></tr>
<tr class="separator:a6d65b65c032e461478c899c4ccaabbb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c74af3ec47c1d56716bf5204f94fbc0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a6c74af3ec47c1d56716bf5204f94fbc0">fit_piecewise_bicubic_psf</a> (<a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;fit_sources, <a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;dropped_sources, const <a class="el" href="classPSF_1_1PiecewiseBicubicMap.html">PSF::PiecewiseBicubicMap</a> &amp;psf_map, const std::vector&lt; double &gt; &amp;x_grid, const std::vector&lt; double &gt; &amp;y_grid, const <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> &amp;subpix_map, double max_abs_amplitude_change, double max_rel_amplitude_change, double max_chi2, double pixel_rejection, double min_convergence_rate, int max_iterations, double smoothing_penalty, Eigen::VectorXd &amp;best_fit_poly_coef, double gain)</td></tr>
<tr class="separator:a6c74af3ec47c1d56716bf5204f94fbc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb1266d210b43b12e5f0592f0003dafa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#acb1266d210b43b12e5f0592f0003dafa">fit_dropped_sources</a> (<a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;dropped_sources, const Eigen::VectorXd &amp;best_fit_poly_coef)</td></tr>
<tr class="separator:acb1266d210b43b12e5f0592f0003dafa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a008c331b311e00a6149bdbc24462fae1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a008c331b311e00a6149bdbc24462fae1">output_best_fit_psf</a> (const Eigen::VectorXd &amp;best_fit_poly_coef, const std::vector&lt; double &gt; &amp;x_grid, const std::vector&lt; double &gt; &amp;y_grid, const std::string &amp;fname)</td></tr>
<tr class="separator:a008c331b311e00a6149bdbc24462fae1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a9307bb97f4f61a3f308f01b7467e9a12"><td class="memItemLeft" align="right" valign="top">const unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceFitPSF.html#a9307bb97f4f61a3f308f01b7467e9a12">ulong1</a> = 1</td></tr>
<tr class="separator:a9307bb97f4f61a3f308f01b7467e9a12"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a5585e2324049472e68c6db7e176dc170"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::list&lt;std::string&gt; <a class="el" href="namespaceFitPSF.html#a5585e2324049472e68c6db7e176dc170">FitPSF::ColNameList</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="adfcf4eb2e56c5c1e97e8abe5d99c5d4e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt; std::list&lt;double&gt; &gt; <a class="el" href="namespaceFitPSF.html#adfcf4eb2e56c5c1e97e8abe5d99c5d4e">FitPSF::ColumnData</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3d5c7354049649ad113478e573eba88a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::list&lt; <a class="el" href="classFitPSF_1_1SDKSource.html">SDKSource</a>&lt;<a class="el" href="namespaceFitPSF.html#ab82a21732b8a5824c90511e45a39c3b8">GSLSubPixType</a>&gt; &gt;::iterator <a class="el" href="namespaceFitPSF.html#a3d5c7354049649ad113478e573eba88a">FitPSF::GSLSourceIteratorType</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab82a21732b8a5824c90511e45a39c3b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> <a class="el" href="namespaceFitPSF.html#ab82a21732b8a5824c90511e45a39c3b8">FitPSF::GSLSubPixType</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a5432cdc9b255de958483cc386d5bba86"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::list&lt;<a class="el" href="classFitPSF_1_1LinearSource.html">LinearSource</a> *&gt; <a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">FitPSF::LinearSourceList</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a92c5963b9d3a86d31bd81f0e8355d9b4"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class SOURCE_LIST_TYPE &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::add_expansion_terms </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFitPSF_1_1IOSources.html">FitPSF::IOSources</a> &amp;&#160;</td>
          <td class="paramname"><em>source_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>expansion_term_expression</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SOURCE_LIST_TYPE &amp;&#160;</td>
          <td class="paramname"><em>fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SOURCE_LIST_TYPE &amp;&#160;</td>
          <td class="paramname"><em>dropped_sources</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fills an output data tree from SDK fit sources. </p>
<p>For each selected and dropped source subject to <a class="el" href="namespacePSF.html">PSF</a> fitting, add the terms the <a class="el" href="namespacePSF.html">PSF</a> is allowed to depend on. </p>

</div>
</div>
<a class="anchor" id="afc0f40a5121c84f39e61977a3775f8eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::add_new_source </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classFitPSF_1_1Image.html">Image</a>&lt; <a class="el" href="classFitPSF_1_1LinearSource.html">LinearSource</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> *&#160;</td>
          <td class="paramname"><em>subpix_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classPSF_1_1PiecewiseBicubic.html">PSF::PiecewiseBicubic</a> &amp;&#160;</td>
          <td class="paramname"><em>psf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_circular_aperture</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>output_fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>cover_psf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCore_1_1SourceLocation.html">Core::SourceLocation</a> &amp;&#160;</td>
          <td class="paramname"><em>location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classBackground_1_1Source.html">Background::Source</a> &amp;&#160;</td>
          <td class="paramname"><em>srcbg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>source_assignment_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>destination</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a newly constructed PiecewiseBidcubic source to a list. </p>
<p>See get_fit_sources for descrption of undocumented arguments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">image</td><td>See same name argument to <a class="el" href="namespaceFitPSF.html#ab8b7c93401ce2682aed24ec91179779f" title="Select the sources to use for PSF fitting. ">get_fit_sources()</a>. </td></tr>
    <tr><td class="paramname">subpix_map</td><td>See same name argument to <a class="el" href="namespaceFitPSF.html#ab8b7c93401ce2682aed24ec91179779f" title="Select the sources to use for PSF fitting. ">get_fit_sources()</a>. </td></tr>
    <tr><td class="paramname">psf</td><td>See same name argument to <a class="el" href="namespaceFitPSF.html#ab8b7c93401ce2682aed24ec91179779f" title="Select the sources to use for PSF fitting. ">get_fit_sources()</a>. </td></tr>
    <tr><td class="paramname">alpha</td><td>See same name argument to <a class="el" href="namespaceFitPSF.html#ab8b7c93401ce2682aed24ec91179779f" title="Select the sources to use for PSF fitting. ">get_fit_sources()</a>. </td></tr>
    <tr><td class="paramname">max_circular_aperture</td><td>See same name argument to <a class="el" href="namespaceFitPSF.html#ab8b7c93401ce2682aed24ec91179779f" title="Select the sources to use for PSF fitting. ">get_fit_sources()</a>. </td></tr>
    <tr><td class="paramname">output_fname</td><td>See same name argument to <a class="el" href="namespaceFitPSF.html#ab8b7c93401ce2682aed24ec91179779f" title="Select the sources to use for PSF fitting. ">get_fit_sources()</a>. </td></tr>
    <tr><td class="paramname">cover_psf</td><td>See same name argument to <a class="el" href="namespaceFitPSF.html#ab8b7c93401ce2682aed24ec91179779f" title="Select the sources to use for PSF fitting. ">get_fit_sources()</a>. </td></tr>
    <tr><td class="paramname">location</td><td>The location of the source to add. </td></tr>
    <tr><td class="paramname">srcbg</td><td>The backgruond to assume under the source. </td></tr>
    <tr><td class="paramname">source_assignment_id</td><td>The source assignment ID of the new source. </td></tr>
    <tr><td class="paramname">destination</td><td>The list to which to add the new source. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af0ecc69b98e2a83e5b332087ce61e330"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double FitPSF::background_excess </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>variance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>background_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>background_variance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the square of the signal to noise ratio with which a pixel sticks above a background. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>The value of the pixel in electrons. </td></tr>
    <tr><td class="paramname">variance</td><td>The variance of the pixel in electrons^2 </td></tr>
    <tr><td class="paramname">background_value</td><td>The background flux to assume in electrons. </td></tr>
    <tr><td class="paramname">background_variance</td><td>The variance to assume for the background in electrons^2. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a27053c460716537f17f695d9ddcea75c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class SOURCE_TYPE &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">double FitPSF::background_excess </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFitPSF_1_1Pixel.html">Pixel</a>&lt; SOURCE_TYPE &gt; &amp;&#160;</td>
          <td class="paramname"><em>pixel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>background_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>background_variance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>See background_excess(double, double, dobule, double). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pixel</td><td>The pixel for which to calculate the background excess. </td></tr>
    <tr><td class="paramname">background_value</td><td>The background flux to assume in electrons. </td></tr>
    <tr><td class="paramname">background_variance</td><td>The variance to assume for the background in electrons^2. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a89f6d40590aea942bda9e90f4a45e29e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double FitPSF::background_excess </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>variance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classBackground_1_1Source.html">Background::Source</a> &amp;&#160;</td>
          <td class="paramname"><em>background_adu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>See <a class="el" href="namespaceFitPSF.html#af0ecc69b98e2a83e5b332087ce61e330" title="Return the square of the signal to noise ratio with which a pixel sticks above a background. ">background_excess(double, double, double, double)</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>The value of the pixel in electrons. </td></tr>
    <tr><td class="paramname">variance</td><td>The variance of the pixel in electrons^2 </td></tr>
    <tr><td class="paramname">background_adu</td><td>The background flux to assume in ADU. </td></tr>
    <tr><td class="paramname">gain</td><td>The gain to use when converting the background value from ADU to electrons. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a90d8894eaa153ebbde3d3b48fad282d0"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class SOURCE_TYPE &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">double FitPSF::background_excess </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFitPSF_1_1Pixel.html">Pixel</a>&lt; SOURCE_TYPE &gt; &amp;&#160;</td>
          <td class="paramname"><em>pixel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classBackground_1_1Source.html">Background::Source</a> &amp;&#160;</td>
          <td class="paramname"><em>background</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>See <a class="el" href="namespaceFitPSF.html#af0ecc69b98e2a83e5b332087ce61e330" title="Return the square of the signal to noise ratio with which a pixel sticks above a background. ">background_excess(double, double, double, double)</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pixel</td><td>The pixel for which to calculate the background excess. </td></tr>
    <tr><td class="paramname">background</td><td>The background flux in electrons to assume. </td></tr>
    <tr><td class="paramname">gain</td><td>The gain to use when converting the background value from ADU to electrons. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2c704565c27365048e07e7b0f512b7cb"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class SourceIterator &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">double FitPSF::calculate_chi2 </td>
          <td>(</td>
          <td class="paramtype">SourceIterator&#160;</td>
          <td class="paramname"><em>first_source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SourceIterator&#160;</td>
          <td class="paramname"><em>past_last_source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_source_chi2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a0651e86af04c1c22e86d6129fbaf308d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class SOURCE_ITERATOR &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">double LIB_LOCAL FitPSF::calculate_chi2 </td>
          <td>(</td>
          <td class="paramtype">SOURCE_ITERATOR&#160;</td>
          <td class="paramname"><em>first_source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SOURCE_ITERATOR&#160;</td>
          <td class="paramname"><em>past_last_source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_source_chi2</em> = <code><a class="el" href="namespaceCore.html#a3493861442e085ee2c913c13bf52a44a">Core::Inf</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The <img class="formulaInl" alt="$\chi^2$" src="form_0.png"/> that corresponds to a sequence of sources. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">first_source</td><td>A source iterator pointing to the first source in the sequence. </td></tr>
    <tr><td class="paramname">past_last_source</td><td>A source iterator pointing to immediately past the last source in the sequence. </td></tr>
    <tr><td class="paramname">max_source_chi2</td><td>If <img class="formulaInl" alt="$\chi^2$" src="form_0.png"/> exceeds this value, the source is considered non-point. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a106dbfe56aa4178bc327d5d7273cab23"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class SOURCE_TYPE &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">LIB_LOCAL void FitPSF::check_fit_source </td>
          <td>(</td>
          <td class="paramtype">SOURCE_TYPE &amp;&#160;</td>
          <td class="paramname"><em>last_source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classBackground_1_1Source.html">Background::Source</a> &amp;&#160;</td>
          <td class="paramname"><em>srcbg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_saturated_fraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>min_pixels_per_source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>max_pixels_per_source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_circular_aperture</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>min_bg_pixels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>ignore_overlaps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks of whether a source should be used for <a class="el" href="namespacePSF.html">PSF</a> fitting. </p>
<p>See get_fit_sources for a description of the arguments. </p>

</div>
</div>
<a class="anchor" id="aa97cde81a2041ea839314183cf93bf7d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class SOURCE_TYPE &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool FitPSF::compare_source_assignment_ids </td>
          <td>(</td>
          <td class="paramtype">const SOURCE_TYPE *&#160;</td>
          <td class="paramname"><em>s1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SOURCE_TYPE *&#160;</td>
          <td class="paramname"><em>s2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fit the <a class="el" href="namespacePSF.html">PSF</a> of all sources simultaneously assuming smooth variation with position. </p>
<p>Perform a global fit for the polynomial expansions of S, D and K over the image using the given sources, starting from the given initial guess if supplied. Perform an individual fit to the PSFs of each source.</p>
<p>The starting point can optionally be specified. The arguments are identical to those of global_sdk_fit(). See there for a description of each argument. </p>

</div>
</div>
<a class="anchor" id="a5141488c910279d60ad23a02ade44c76"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::convert_flux_to_adu </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a93bf63d0d8e13ea15d918206170fe40f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t FitPSF::count_pixels </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>max_source_pixels</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad9b8be19532f89b97362b0ff8cc1ce96"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned FitPSF::discard_outlier_pixels </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::MatrixXd &amp;&#160;</td>
          <td class="paramname"><em>pixel_integral_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>pixel_excesses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>rhs_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_residual</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>best_fit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Discards pixels with too large residuals after the last <a class="el" href="namespacePSF.html">PSF</a> fit. </p>
<p>Returns the number of pixels discarded. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fit_sources</td><td>The sources participating in the fit. </td></tr>
    <tr><td class="paramname">pixel_integral_matrix</td><td>See prepare_linear_regression </td></tr>
    <tr><td class="paramname">pixel_excesses</td><td>See fill_fit_pixel_excesses. </td></tr>
    <tr><td class="paramname">rhs_offset</td><td>See prepare_linear_regression. </td></tr>
    <tr><td class="paramname">max_residual</td><td>If source pixels with residuals larger than this are found, they are discarded from the fit. </td></tr>
    <tr><td class="paramname">best_fit</td><td>The current best fit polynomial expansion coefficients for the <a class="el" href="namespacePSF.html">PSF</a> parameters. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a91af761d270a247a93d51ed94cbc7c38"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned FitPSF::discard_sources </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_chi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>discard_by_chi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>dropped_sources</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Discards sources unsuitable for fitting. </p>
<p>At least one of the following is true of the discarded sources:</p><ul>
<li>the flux estimate is nan or negative</li>
<li>the chi squared is too big (only if discard_by_chi2 is true).</li>
<li>less than two pixels are assigned to the source </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fit_sources</td><td>The sources participating in the fit. </td></tr>
    <tr><td class="paramname">max_chi2</td><td>The maximum allowed reduced chi squared before discarding. </td></tr>
    <tr><td class="paramname">discard_by_chi2</td><td>Should sources be discarded besed on their chi squared. </td></tr>
    <tr><td class="paramname">dropped_sources</td><td>The sources dropped from the fit. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="afa849194c7af21245496723061678a40"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned FitPSF::discard_zero_flux_pixels </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> &amp;&#160;</td>
          <td class="paramname"><em>subpix_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classPSF_1_1PiecewiseBicubic.html">PSF::PiecewiseBicubic</a> &amp;&#160;</td>
          <td class="paramname"><em>psf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Discards pixels whose overlap with the <a class="el" href="namespacePSF.html">PSF</a> domain has zero sub-pixel sensitivity. </p>
<p>Returns the number of pixels discarded. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fit_sources</td><td>The sources participating in the fit. </td></tr>
    <tr><td class="paramname">subpix_map</td><td>The sub-pixel sensitivity map. </td></tr>
    <tr><td class="paramname">psf</td><td>A <a class="el" href="namespacePSF.html">PSF</a> with the correct grid of cells. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa2d0af7a946074687817444ab22c6330"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class FIT_SOURCE_TYPE &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">LIB_LOCAL void FitPSF::drop_unsuitable_fit_sources </td>
          <td>(</td>
          <td class="paramtype">std::list&lt; FIT_SOURCE_TYPE * &gt; &amp;&#160;</td>
          <td class="paramname"><em>psf_fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typename std::list&lt; FIT_SOURCE_TYPE * &gt;::iterator&#160;</td>
          <td class="paramname"><em>check_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::list&lt; FIT_SOURCE_TYPE * &gt; &amp;&#160;</td>
          <td class="paramname"><em>dropped_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>drop_statistics</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Actually discard sources flagged as unsuitable during pixel selection. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">psf_fit_sources</td><td>The list of sources to check. </td></tr>
    <tr><td class="paramname">check_start</td><td>The first newly extracted source in the above list. </td></tr>
    <tr><td class="paramname">dropped_sources</td><td>See get_fit_sources. </td></tr>
    <tr><td class="paramname">drop_statistics</td><td>An output array filled with how many sources were dropped for each drop reason. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af2e42c5b5ff1a7c36e795b2242dd6807"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::estimate_initial_amplitudes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a0bf42ddc644cbcc55c500d743a70faaa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::estimate_initial_amplitudes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OverlapGroupList &amp;&#160;</td>
          <td class="paramname"><em>overlap_groups</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classPSF_1_1PiecewiseBicubicMap.html">PSF::PiecewiseBicubicMap</a> &amp;&#160;</td>
          <td class="paramname"><em>psf_map</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use the given <a class="el" href="namespacePSF.html">PSF</a> map to estimate initial fluxes for the sources. </p>

</div>
</div>
<a class="anchor" id="a9d904a383fb6d35de62d39883c1bccab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::estimate_initial_amplitudes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> &amp;&#160;</td>
          <td class="paramname"><em>subpix_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCore_1_1Image.html">Core::Image</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>observed_image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>aperture</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a2e92ac9b9868ace721ba3d7036f300a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::fill_basis_parameter_sets </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::valarray&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>parameter_sets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::MatrixXd &amp;&#160;</td>
          <td class="paramname"><em>basis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::valarray&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>basis_parameter_sets</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="afb89760d4d1bd6820c36cc689e1ff9ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::fill_flux_scaled_modified_rhs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>modified_pixel_excesses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>modified_rhs_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>flux_scaled_modified_rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a511e38793bcbb76ae9169e68c4b6fe28"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::fill_matrix_to_invert </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::MatrixXd &amp;&#160;</td>
          <td class="paramname"><em>symmetrized_pix_integral_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::MatrixXd &amp;&#160;</td>
          <td class="paramname"><em>poly_coef_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::MatrixXd &amp;&#160;</td>
          <td class="paramname"><em>matrix_to_invert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a1dad75399f74c0531081f9c4a039dca5"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class SOURCE_LIST_TYPE &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::fill_output_data_tree_common </td>
          <td>(</td>
          <td class="paramtype">const SOURCE_LIST_TYPE &amp;&#160;</td>
          <td class="paramname"><em>fit_result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classIO_1_1H5IODataTree.html">IO::H5IODataTree</a> &amp;&#160;</td>
          <td class="paramname"><em>output_data_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mag_1adu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates an output data tree with information common to all <a class="el" href="namespacePSF.html">PSF</a> models. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fit_result</td><td>The sources fitted for <a class="el" href="namespacePSF.html">PSF</a>. </td></tr>
    <tr><td class="paramname">output_data_tree</td><td>The tree to fill. </td></tr>
    <tr><td class="paramname">mag_1adu</td><td>The magnitude that corresponds to a flux of 1ADU. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a7a062f745b675e9335e22b3382e42ab7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::fill_parameter_sets </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>y_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::valarray&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>parameter_sets</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a9859ecb79a38ac8f4d34f970d969e582"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::fill_poly_coef_matrix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::MatrixXd &amp;&#160;</td>
          <td class="paramname"><em>poly_coef_matrix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a6baa6774c390331c465aface822a97d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::fill_subpix_map </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFitPSF_1_1Config.html">FitPSF::Config</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> &amp;&#160;</td>
          <td class="paramname"><em>subpix_map</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fills the sub-pixel map to use for <a class="el" href="namespacePSF.html">PSF</a> fitting. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">options</td><td>The parsed command line options. </td></tr>
    <tr><td class="paramname">subpix_map</td><td>The sub-pixel map to fill. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a1aa574012af467b4a2c111efaadacefb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::fill_valarray_from_list </td>
          <td>(</td>
          <td class="paramtype">const std::list&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::valarray&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>to</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a5548fb9dab21dc33860bad83a56272dc"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class SOURCE_TYPE , class PSF_TYPE &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::find_overlap_groups </td>
          <td>(</td>
          <td class="paramtype">std::list&lt; SOURCE_TYPE * &gt; &amp;&#160;</td>
          <td class="paramname"><em>fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::list&lt; SOURCE_TYPE * &gt; &amp;&#160;</td>
          <td class="paramname"><em>dropped_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::list&lt; <a class="el" href="classFitPSF_1_1OverlapGroup.html">OverlapGroup</a>&lt; SOURCE_TYPE, PSF_TYPE &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>overlap_groups</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds groups of overlapping sources among the given source list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fit_sources</td><td>The current list of shape fit sources. </td></tr>
    <tr><td class="paramname">dropped_sources</td><td>The current list of sources dropped from shape fitting. </td></tr>
    <tr><td class="paramname">overlap_groups</td><td>On output this updated with new overlapping groups found. Each group is a list of iterators pointing to the sources in the group. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="acb1266d210b43b12e5f0592f0003dafa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::fit_dropped_sources </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>dropped_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>best_fit_poly_coef</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a6bc2dd51f12b4325651053a096fd42a1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool FitPSF::fit_piecewise_bicubic_psf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OverlapGroupList &amp;&#160;</td>
          <td class="paramname"><em>overlap_groups</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>dropped_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>y_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> &amp;&#160;</td>
          <td class="paramname"><em>subpix_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_abs_amplitude_change</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_rel_amplitude_change</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_chi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pixel_rejection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>min_convergence_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_iterations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>smoothing_penalty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>best_fit_poly_coef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="namespacePSF.html">PSF</a> fitting, but assumed that sources have their initial amplitudes set. </p>

</div>
</div>
<a class="anchor" id="a6d65b65c032e461478c899c4ccaabbb8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool FitPSF::fit_piecewise_bicubic_psf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>dropped_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>y_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> &amp;&#160;</td>
          <td class="paramname"><em>subpix_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_abs_amplitude_change</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_rel_amplitude_change</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_chi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pixel_rejection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>min_convergence_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_iterations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>smoothing_penalty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>best_fit_poly_coef</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a6c74af3ec47c1d56716bf5204f94fbc0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool FitPSF::fit_piecewise_bicubic_psf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>dropped_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classPSF_1_1PiecewiseBicubicMap.html">PSF::PiecewiseBicubicMap</a> &amp;&#160;</td>
          <td class="paramname"><em>psf_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>y_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> &amp;&#160;</td>
          <td class="paramname"><em>subpix_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_abs_amplitude_change</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_rel_amplitude_change</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_chi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pixel_rejection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>min_convergence_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_iterations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>smoothing_penalty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>best_fit_poly_coef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a89390a0e2ecfbbe9438a8d182c6fca4d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double FitPSF::fit_piecewise_bicubic_psf_step </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OverlapGroupList &amp;&#160;</td>
          <td class="paramname"><em>overlap_groups</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::MatrixXd &amp;&#160;</td>
          <td class="paramname"><em>symmetrized_pix_integral_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::MatrixXd &amp;&#160;</td>
          <td class="paramname"><em>poly_coef_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>modified_pixel_excesses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>modified_rhs_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classFitPSF_1_1PiecewiseBicubicPSFSmoothing.html">PiecewiseBicubicPSFSmoothing</a> &amp;&#160;</td>
          <td class="paramname"><em>smoothing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>best_fit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab8b7c93401ce2682aed24ec91179779f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class FIT_SOURCE_TYPE , class PSF_TYPE &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">LIB_PUBLIC void FitPSF::get_fit_sources </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classFitPSF_1_1Image.html">Image</a>&lt; FIT_SOURCE_TYPE &gt; &amp;&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> *&#160;</td>
          <td class="paramname"><em>subpix_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::list&lt; <a class="el" href="classCore_1_1SourceLocation.html">Core::SourceLocation</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>source_locations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PSF_TYPE &amp;&#160;</td>
          <td class="paramname"><em>psf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_saturated_fraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>min_pixels_per_source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>max_pixels_per_source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classBackground_1_1Measure.html">Background::Measure</a> &amp;&#160;</td>
          <td class="paramname"><em>bg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>min_bg_pixels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>max_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_circular_aperture</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>output_fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::list&lt; FIT_SOURCE_TYPE * &gt; &amp;&#160;</td>
          <td class="paramname"><em>psf_fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::list&lt; FIT_SOURCE_TYPE * &gt; &amp;&#160;</td>
          <td class="paramname"><em>dropped_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>cover_psf</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>do_not_drop</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>ignore_overlaps</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Select the sources to use for <a class="el" href="namespacePSF.html">PSF</a> fitting. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">image</td><td>The image being processed. Should be a reference to the exact same variable for all sources in a single image! </td></tr>
    <tr><td class="paramname">subpix_map</td><td>The sub-pixel sensitivity map to assume. Must not be destroyed while this object is in use. </td></tr>
    <tr><td class="paramname">source_locations</td><td>The cental <a class="el" href="namespacePSF.html">PSF</a> coordinates of the sources in the image. </td></tr>
    <tr><td class="paramname">psf</td><td>The <a class="el" href="namespacePSF.html">PSF</a> to assume for the sources. Obviously parameters cannot be correctly set-up since those are being fitted, but should have the correct structure (i.e. grid for piecewis PSFs). </td></tr>
    <tr><td class="paramname">alpha</td><td>The minimum S/N threshold to considering a pixel above the background </td></tr>
    <tr><td class="paramname">max_saturated_fraction</td><td>The maximum fraction of saturated pixels for a source to be used. </td></tr>
    <tr><td class="paramname">min_pixels_per_source</td><td>The minimum number of pixels a source must have to be used. </td></tr>
    <tr><td class="paramname">max_pixels_per_source</td><td>The maximum number of pixels allowed before excluding a source. </td></tr>
    <tr><td class="paramname">bg</td><td>The background estimate of the sources. </td></tr>
    <tr><td class="paramname">min_bg_pixels</td><td>The minimum number of pixels required in the background determination. </td></tr>
    <tr><td class="paramname">max_sources</td><td>The largest number of sources allowed in the final list. </td></tr>
    <tr><td class="paramname">max_circular_aperture</td><td>If source pixels outside this radius are found, the source is excluded </td></tr>
    <tr><td class="paramname">output_fname</td><td>The name of the file where this source should be saved after the fit. </td></tr>
    <tr><td class="paramname">psf_fit_sources</td><td>The output list of sources selected for <a class="el" href="namespacePSF.html">PSF</a> shape fitting. </td></tr>
    <tr><td class="paramname">dropped_sources</td><td>The output list of sources rejected from the shape fit. </td></tr>
    <tr><td class="paramname">cover_psf</td><td>If true, any pixel which even partially overlaps with the <a class="el" href="namespacePSF.html">PSF</a> gets included. Otherwise, pixels are assigned by signal to noise (optionally filling up a circular aperture). This must be false for </td></tr>
    <tr><td class="paramname">do_not_drop</td><td>Do not drop any sources from <a class="el" href="namespacePSF.html">PSF</a> fitting (only used for zero <a class="el" href="namespacePSF.html">PSF</a> fit at the moment). </td></tr>
    <tr><td class="paramname">ignore_overlaps</td><td>If false, any source which even partially overlaps with another is dropped from the fit. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab03b5f6a1f749a49d75f77d159e0d612"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class FIT_SOURCE_TYPE , class PSF_TYPE &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::get_section_fit_sources </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classFitPSF_1_1Image.html">FitPSF::Image</a>&lt; FIT_SOURCE_TYPE &gt; &amp;&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classFitPSF_1_1Config.html">FitPSF::Config</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classFitPSF_1_1IOSources.html">FitPSF::IOSources</a> &amp;&#160;</td>
          <td class="paramname"><em>source_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> &amp;&#160;</td>
          <td class="paramname"><em>subpix_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PSF_TYPE &amp;&#160;</td>
          <td class="paramname"><em>psf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::list&lt; FIT_SOURCE_TYPE * &gt; &amp;&#160;</td>
          <td class="paramname"><em>fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::list&lt; FIT_SOURCE_TYPE * &gt; &amp;&#160;</td>
          <td class="paramname"><em>dropped_sources</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the source to use for <a class="el" href="namespacePSF.html">PSF</a> fitting for a single input image. </p>

</div>
</div>
<a class="anchor" id="a96adf1649b49921286d322a27b7b7503"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double FitPSF::gsl_minimization_function </td>
          <td>(</td>
          <td class="paramtype">const gsl_vector *&#160;</td>
          <td class="paramname"><em>poly_coef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The function to pass to the GSL simplex minimizer, forced to assume SOURCE_ITERATOR = GSLSourceIteratorType and SUBPIX_TYPE = GSLSubPixType. </p>

</div>
</div>
<a class="anchor" id="a3f59bbe1dfe643f0483a3cb9398215de"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double FitPSF::gsl_s_minimization_function </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The function to pass to the GSL brent minimizer for finding an initial frame S. </p>

</div>
</div>
<a class="anchor" id="a737ed22b4857eb6931cff820c0f5dc2b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream &amp; FitPSF::operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SourceDropReason &amp;&#160;</td>
          <td class="paramname"><em>reason</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Human readable output of the reasons to drop sources. </p>

</div>
</div>
<a class="anchor" id="afd017ede8a4dcbb302e8148554fd1d4b"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class SOURCE_TYPE , class PSF_TYPE &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::ostream&amp; FitPSF::operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classFitPSF_1_1OverlapGroup.html">OverlapGroup</a>&lt; SOURCE_TYPE, PSF_TYPE &gt; &amp;&#160;</td>
          <td class="paramname"><em>group</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af2e634ae30775bc4d021a6c0763d9d23"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::output </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classIO_1_1H5IODataTree.html">IO::H5IODataTree</a> &amp;&#160;</td>
          <td class="paramname"><em>output_data_tree</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a008c331b311e00a6149bdbc24462fae1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::output_best_fit_psf </td>
          <td>(</td>
          <td class="paramtype">const Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>best_fit_poly_coef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>y_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>fname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af6f4080f1716e09ba6ac66748804694c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool FitPSF::piecewise_bicubic_fit </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFitPSF_1_1Config.html">FitPSF::Config</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> &amp;&#160;</td>
          <td class="paramname"><em>subpix_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classIO_1_1H5IODataTree.html">IO::H5IODataTree</a> &amp;&#160;</td>
          <td class="paramname"><em>output_data_tree</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fit an elliptical gaussian <a class="el" href="namespacePSF.html">PSF</a> model according to the command line options. </p>
<p>Fit a piecewise bicubic <a class="el" href="namespacePSF.html">PSF</a> model according to the command line options. </p>

</div>
</div>
<a class="anchor" id="a3308eeb8fd5174b7846d405bf6d80185"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class FIT_SOURCE_TYPE , class PSF_TYPE &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::list&lt; <a class="el" href="classFitPSF_1_1Image.html">FitPSF::Image</a>&lt;FIT_SOURCE_TYPE&gt;* &gt; FitPSF::prepare_fit_sources </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFitPSF_1_1Config.html">FitPSF::Config</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::list&lt; FIT_SOURCE_TYPE * &gt; &amp;&#160;</td>
          <td class="paramname"><em>fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::list&lt; FIT_SOURCE_TYPE * &gt; &amp;&#160;</td>
          <td class="paramname"><em>dropped_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned &amp;&#160;</td>
          <td class="paramname"><em>x_resolution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned &amp;&#160;</td>
          <td class="paramname"><em>y_resolution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> &amp;&#160;</td>
          <td class="paramname"><em>subpix_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PSF_TYPE &amp;&#160;</td>
          <td class="paramname"><em>psf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classIO_1_1H5IODataTree.html">IO::H5IODataTree</a> &amp;&#160;</td>
          <td class="paramname"><em>output_data_tree</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the sources on which <a class="el" href="namespacePSF.html">PSF</a> fitting will be performed. </p>

</div>
</div>
<a class="anchor" id="ad0ae581b7498385b4fb9af2533fa8e38"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::prepare_linear_regression </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>dropped_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::valarray&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>basis_parameter_sets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>pixel_excesses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::MatrixXd &amp;&#160;</td>
          <td class="paramname"><em>pixel_integral_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>rhs_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::MatrixXd &amp;&#160;</td>
          <td class="paramname"><em>symmetrized_pix_integral_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>modified_pixel_excesses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>modified_rhs_offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac6d6f675c42304b4f29c992d7931db7e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::select_basis_vectors </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::valarray&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>parameter_sets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classPSF_1_1PiecewiseBicubic.html">PSF::PiecewiseBicubic</a> &amp;&#160;</td>
          <td class="paramname"><em>psf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::MatrixXd &amp;&#160;</td>
          <td class="paramname"><em>basis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a48a7978e311520cf43573b3ef5ec74c1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool FitPSF::sourceid_not_hat </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCore_1_1SourceLocation.html">Core::SourceLocation</a> *&#160;</td>
          <td class="paramname"><em>source</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a1ade9bac2b156b8c523cb0d9d13ff80f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::split_second_deriv </td>
          <td>(</td>
          <td class="paramtype">PSF::SDKDerivative&#160;</td>
          <td class="paramname"><em>second</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PSF::SDKDerivative &amp;&#160;</td>
          <td class="paramname"><em>deriv1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PSF::SDKDerivative &amp;&#160;</td>
          <td class="paramname"><em>deriv2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes a second derivative and returns the two first order derivatives which it is composed of (e.g. PSF::SS_DERIV -&gt; PSF::S_DERIV, PSF::S_DERIV). If deriv is not a second derivative, the behaviour is undefined. </p>

</div>
</div>
<a class="anchor" id="a87e185ed617d2648d7a1dcdfc2b3ae2f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::time_this </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"> = <code>&quot;&quot;</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a878eba39338b4d82656546daf36ec835"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitPSF::transform_best_fit_to_direct_parameters </td>
          <td>(</td>
          <td class="paramtype">const Eigen::MatrixXd &amp;&#160;</td>
          <td class="paramname"><em>basis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>best_fit_poly_coef</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Transforms a set of best fit coefficients from some basis to directly expressing the spatial dependence of <a class="el" href="namespacePSF.html">PSF</a> parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">basis</td><td>The matrix of basis vectors used when solving </td></tr>
    <tr><td class="paramname">best_fit_poly_coef</td><td>The best fit coefficients in the above basis. Overwritten on output! </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a93d32d30b1b788f8c3defccfbe70032b"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class FIT_SOURCE_TYPE &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">LIB_LOCAL void FitPSF::trim_fit_sources </td>
          <td>(</td>
          <td class="paramtype">std::list&lt; FIT_SOURCE_TYPE * &gt; &amp;&#160;</td>
          <td class="paramname"><em>psf_fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>max_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::list&lt; FIT_SOURCE_TYPE * &gt; &amp;&#160;</td>
          <td class="paramname"><em>dropped_sources</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Drop excess sources from <a class="el" href="namespacePSF.html">PSF</a> shape fitting. </p>
<p>See get_fit_sources for a description of the arguments. </p>

</div>
</div>
<a class="anchor" id="af1b981e70ab8623bff27f8fff1b482be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double FitPSF::update_fluxes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceFitPSF.html#a5432cdc9b255de958483cc386d5bba86">LinearSourceList</a> &amp;&#160;</td>
          <td class="paramname"><em>fit_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OverlapGroupList &amp;&#160;</td>
          <td class="paramname"><em>overlap_groups</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>best_fit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a07c066dbcc5f3aabaec488b1dfc0b243"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool FitPSF::zero_fit </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFitPSF_1_1Config.html">FitPSF::Config</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCore_1_1SubPixelMap.html">Core::SubPixelMap</a> &amp;&#160;</td>
          <td class="paramname"><em>subpix_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classIO_1_1H5IODataTree.html">IO::H5IODataTree</a> &amp;&#160;</td>
          <td class="paramname"><em>output_data_tree</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does not actually fit for the <a class="el" href="namespacePSF.html">PSF</a> but sets up a constant one. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a9307bb97f4f61a3f308f01b7467e9a12"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned long FitPSF::ulong1 = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceFitPSF.html">FitPSF</a></li>
    <li class="footer">Generated on Tue May 8 2018 18:28:30 for SuperPhot by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
